import numpy as np
from scipy.special import gamma,factorial
def v5HM_BOB_optimized_waveform(m1, m2, r, phi, prstar, pphi, chi1, chi2, Hreal, Omega, Omega_circ):
    tmp0 = ((Omega)*(Omega))
    tmp1 = m1 + m2
    tmp5 = np.power(Omega, 8.0/3.0)
    tmp6 = np.log(4*np.cbrt(Omega))
    tmp7 = np.power(Omega, 10.0/3.0)
    tmp14 = np.power(Omega, 5.0/3.0)
    tmp20 = ((np.pi)*(np.pi))
    tmp23 = Hreal*Omega
    tmp10 = (1.0/2.0)*chi1 + (1.0/2.0)*chi2
    tmp11 = (1.0/2.0)*chi1 - 1.0/2.0*chi2
    tmp12 = (m1 - m2)/tmp1
    tmp15 = ((m1)*(m1))*((m2)*(m2))/((tmp1)*(tmp1)*(tmp1)*(tmp1))
    tmp21 = ((m1)*(m1)*(m1))*((m2)*(m2)*(m2))/np.power(tmp1, 6)
    tmp24 = 4*1j*tmp23
    tmp3 = (1.0/((tmp1)*(tmp1)))
    tmp13 = tmp11*tmp12
    tmp16 = ((tmp10)*(tmp10))
    tmp17 = ((tmp11)*(tmp11))
    tmp4 = m1*m2*tmp3
    EulerGamma = 0.57721566490153286
    h22 = -1.0092530088080638*1j*np.pi*tmp0*tmp4*(1 + (1.0/2.0)*((tmp1)*(tmp1))*(((Hreal)*(Hreal)) - 1)/(m1*m2))*((np.power(Omega, 7.0/3.0)*(((tmp10)*(tmp10)*(tmp10))*(tmp4 + 1.0/3.0) + tmp10*tmp17*(-4*tmp15 - 3*tmp4 + 1) + tmp10*(-245717.0/63504.0*tmp15 + (50803.0/63504.0)*tmp21 + (74749.0/5292.0)*tmp4 + 18733.0/15876.0) + ((tmp11)*(tmp11)*(tmp11))*tmp12*(1.0/3.0 - 4.0/3.0*tmp4) + tmp13*tmp16*(2*tmp4 + 1) + tmp13*((97865.0/63504.0)*tmp15 + (50140.0/3969.0)*tmp4 + 18733.0/15876.0)) + np.power(Omega, 4.0/3.0)*(tmp10*tmp13 + (19583.0/42336.0)*tmp15 + (1.0/2.0)*tmp16 + tmp17*(1.0/2.0 - 2*tmp4) - 33025.0/21168.0*tmp4 - 20555.0/10584.0) + np.power(Omega, 2.0/3.0)*((55.0/84.0)*tmp4 - 43.0/42.0) + Omega*(-0.33333333333333331*chi1 - 0.33333333333333331*chi2 + 0.66666666666666663*m1*m2*tmp10*tmp3 - 0.66666666666666663*tmp13) + tmp0*(tmp10*tmp13*(89.0/126.0 - 781.0/252.0*tmp4) - 6292061.0/3259872.0*tmp15 + tmp16*((10.0/9.0)*tmp15 - 1817.0/504.0*tmp4 + 89.0/252.0) + tmp17*(-27.0/14.0*tmp15 - 457.0/504.0*tmp4 + 89.0/252.0) + (41.0/192.0)*tmp20*tmp4 + (10620745.0/39118464.0)*tmp21 - 48993925.0/9779616.0*tmp4 - 428.0/105.0*tmp6 - 428.0/105.0*EulerGamma + 1556919113.0/122245200.0) + tmp14*(tmp10*((209.0/126.0)*tmp15 + (49.0/18.0)*tmp4 - 34.0/21.0) + tmp13*(-19.0/42.0*tmp4 - 34.0/21.0)) + tmp4*(21.199999999999999*tmp5 - 411*tmp7) + tmp5*((9202.0/2205.0)*tmp6 - 387216563023.0/160190110080.0 + (9202.0/2205.0)*EulerGamma) + tmp7*((439877.0/55566.0)*tmp6 - 16094530514677.0/533967033600.0 + (439877.0/55566.0)*EulerGamma) + 1)*(np.power(Omega, 7.0/3.0)*(((tmp10)*(tmp10)*(tmp10))*(tmp4 + 1.0/3.0) + tmp10*tmp17*(-4*tmp15 - 3*tmp4 + 1) + tmp10*(-245717.0/63504.0*tmp15 + (50803.0/63504.0)*tmp21 + (74749.0/5292.0)*tmp4 + 18733.0/15876.0) + ((tmp11)*(tmp11)*(tmp11))*tmp12*(1.0/3.0 - 4.0/3.0*tmp4) + tmp13*tmp16*(2*tmp4 + 1) + tmp13*((97865.0/63504.0)*tmp15 + (50140.0/3969.0)*tmp4 + 18733.0/15876.0)) + np.power(Omega, 4.0/3.0)*(tmp10*tmp13 + (19583.0/42336.0)*tmp15 + (1.0/2.0)*tmp16 + tmp17*(1.0/2.0 - 2*tmp4) - 33025.0/21168.0*tmp4 - 20555.0/10584.0) + np.power(Omega, 2.0/3.0)*((55.0/84.0)*tmp4 - 43.0/42.0) + Omega*(-0.33333333333333331*chi1 - 0.33333333333333331*chi2 + 0.66666666666666663*m1*m2*tmp10*tmp3 - 0.66666666666666663*tmp13) + tmp0*(tmp10*tmp13*(89.0/126.0 - 781.0/252.0*tmp4) - 6292061.0/3259872.0*tmp15 + tmp16*((10.0/9.0)*tmp15 - 1817.0/504.0*tmp4 + 89.0/252.0) + tmp17*(-27.0/14.0*tmp15 - 457.0/504.0*tmp4 + 89.0/252.0) + (41.0/192.0)*tmp20*tmp4 + (10620745.0/39118464.0)*tmp21 - 48993925.0/9779616.0*tmp4 - 428.0/105.0*tmp6 - 428.0/105.0*EulerGamma + 1556919113.0/122245200.0) + tmp14*(tmp10*((209.0/126.0)*tmp15 + (49.0/18.0)*tmp4 - 34.0/21.0) + tmp13*(-19.0/42.0*tmp4 - 34.0/21.0)) + tmp4*(21.199999999999999*tmp5 - 411*tmp7) + tmp5*((9202.0/2205.0)*tmp6 - 387216563023.0/160190110080.0 + (9202.0/2205.0)*EulerGamma) + tmp7*((439877.0/55566.0)*tmp6 - 16094530514677.0/533967033600.0 + (439877.0/55566.0)*EulerGamma) + 1))*np.exp(-2*1j*phi)*np.exp(1.0*1j*(((Hreal)*(Hreal)*(Hreal))*((Omega)*(Omega)*(Omega))*((1712.0/315.0)*tmp20 - 2203.0/81.0) + ((Hreal)*(Hreal))*tmp0*(tmp10*((8.0/3.0)*tmp4 - 4.0/3.0) - 4.0/3.0*tmp13 + (428.0/105.0)*np.pi) - 24*tmp14*tmp4 + (7.0/3.0)*tmp23))*np.exp(2*np.pi*tmp23)*np.exp(tmp24*np.log(8*Omega*np.exp(-1.0/2.0)))*gamma(3 - tmp24)/np.power(Omega_circ, 4.0/3.0)
    return h22