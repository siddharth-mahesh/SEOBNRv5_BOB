import numpy as np
from scipy.special import gamma, factorial, factorial2
def v5HM_unoptimized_flux(m1, m2, r, phi, prstar, pphi, chi1, chi2,Omega,Omega_circ,Hreal):
    M = m1+m2
    eta = m1*m2/(M**2)
    TINYDOUBLE = 1e-100
    delta = (m1 - m2)/M
    min_delta_1em14 = np.divide(1,2)*(delta - 1e-14 + 0 - np.absolute(delta - 1e-14 - 0))
    max_delta_1em14 = np.divide(1,2)*(delta - 1e-14 + TINYDOUBLE + 0 + np.absolute(delta - 1e-14 + TINYDOUBLE - 0))
    noneqcond = max_delta_1em14/(delta - 1e-14+TINYDOUBLE)
    eqcond = min_delta_1em14/(delta - 1e-14-TINYDOUBLE)
    deltainvertible = delta*noneqcond + 1*eqcond
    deltainv = 1/deltainvertible
    chi_S = np.divide(1,2)*(chi1 + chi2)
    chi_A = np.divide(1,2)*(chi1 - chi2)
    vomega = Omega**(np.divide(1,3))
    vphi = Omega*(Omega_circ**(-np.divide(2,3)))
    Heff = (Hreal**2 - 1)/(2*eta) + 1
    eulerlog5 = np.euler_gamma + np.log(2*5*vomega)
    eulerlog4 = np.euler_gamma + np.log(2*4*vomega)
    eulerlog3 = np.euler_gamma + np.log(2*3*vomega)
    eulerlog2v2 = np.euler_gamma + np.log(2*2*vomega**2)
    eulerlog2 = np.euler_gamma + np.log(2*2*vomega)
    eulerlog1v2 = np.euler_gamma + np.log(2*1*vomega**2)
    eulerlog1 = np.euler_gamma + np.log(2*1*vomega)
    khat1 = 1*Omega*Hreal
    khat2 = 2*Omega*Hreal
    khat3 = 3*Omega*Hreal
    khat4 = 4*Omega*Hreal
    khat5 = 5*Omega*Hreal
    khat6 = 6*Omega*Hreal
    khat7 = 7*Omega*Hreal
    khat8 = 8*Omega*Hreal
    delta55=((np.divide(96875,131250)+np.divide(857528,131250)*eta)*(Omega*Hreal)/(1-2*eta)+np.divide(3865,429)*np.pi*(Omega*Hreal)**2+((np.divide(-7686949127,31783752)+np.divide(954500400,31783752)*np.pi**2)*(Omega*Hreal)**3))
    delta43=(((np.divide(4961,810)*eta+np.divide(3,5))*(Omega*Hreal))/(1-2*eta)+np.divide(1571,385)*np.pi*(Omega*Hreal)**2)
    delta44=((np.divide(112,120)+np.divide(219,120)*eta)*(Omega*Hreal)+np.divide(25136,3465)*(Omega*Hreal)**2+(np.divide(201088,10395)*np.pi**2-np.divide(55144,375))*(Omega*Hreal)**3)
    delta32=(((np.divide(11,5)*eta+np.divide(2,3))*(Hreal*Omega))/(1-3*eta)+np.divide(52,21)*np.pi*(Hreal*Omega)**2+((np.divide(208,63)*np.pi**2)-np.divide(9112,405))*(Hreal*Omega)**3)
    delta33=(np.divide(13,10)*(Hreal*Omega)+np.divide(39,7)*(Hreal*Omega)**2+(-np.divide(227827,3000)+np.divide(78,7)*np.pi**2)*(Hreal*Omega)**3-np.divide(80897,2430)*eta*vomega**5)
    delta21=(np.divide(2,3)*Omega*Hreal+(np.divide(107,105)*np.pi)*(Omega*Hreal)**2+((np.divide(214,315)*np.pi**2)-(np.divide(272,81)))*(Omega*Hreal)**3-(np.divide(25,2)*eta*vomega**5))
    delta22=(np.divide(7,3)*Omega*Hreal+(Omega*Hreal)**2*(((np.divide(8,3)*eta-np.divide(4,3))*chi_S)-(np.divide(4,3)*delta*chi_A)+(np.divide(428,105)*np.pi))+(Omega*Hreal)**3*((np.divide(1712,315)*np.pi**2)-(np.divide(2203,81)))-24*eta*vomega**5)
    fspin55_limit=(((np.divide(-70,3)*eta/((-1+2*eta))+np.divide(110,3)*eta**2/((-1+2*eta))+np.divide(10,3)/((-1+2*eta)))*(chi_A))*vomega**3)
    fspin55=(((np.divide(-70,3)*eta/((-1+2*eta))+np.divide(110,3)*eta**2/((-1+2*eta))+np.divide(10,3)/((-1+2*eta)))*(chi_A*deltainv)+(np.divide(10,3)/((-1+2*eta))-10*eta/(-1+2*eta)+10*eta**2/(-1+2*eta))*chi_S)*vomega**3+(np.divide(5,2)*delta**2*chi_A**2+np.divide(5,1)*delta*chi_A*chi_S+np.divide(5,2)*chi_S**2)*vomega**4)
    fspin41_limit=(np.divide(5,2)*eta*vomega/(1-2*eta)*(-chi_A))
    fspin41=(np.divide(5,2)*eta*vomega/(1-2*eta)*(chi_S-chi_A*deltainv))
    fspin43_limit=(vomega/(1-2*eta)*(-np.divide(5,2)*eta*chi_A)+vomega**3/(1-2*eta)*((np.divide(887,44)*eta-np.divide(3143,132)*eta**2)*chi_A)+vomega**4/(1-2*eta)*((np.divide(137,6)*eta**2-18*eta+3)*chi_A*chi_S))
    fspin43=(vomega/(1-2*eta)*(np.divide(5,2)*eta*chi_S-np.divide(5,2)*eta*chi_A*deltainv)+vomega**3/(1-2*eta)*((np.divide(887,44)*eta-np.divide(3143,132)*eta**2)*chi_A*deltainv+(-np.divide(529,132)*eta**2-np.divide(667,44)*eta)*chi_S)+vomega**4/(1-2*eta)*((12*eta**2-np.divide(37,3)*eta+np.divide(3,2))*chi_A**2+(np.divide(137,6)*eta**2-18*eta+3)*chi_A*chi_S*deltainv+(np.divide(35,6)*eta**2+np.divide(1,3)*eta+np.divide(3,2))*chi_S**2))
    fspin31_limit=vomega**3*((np.divide(11,2)*eta-2)*chi_A)
    fspin31=vomega**3*((np.divide(11,2)*eta-2)*chi_A*deltainv+(np.divide(13,2)*eta-2)*chi_S)
    fspin33amp_limit=(vomega**3*((np.divide(19,2)*eta-2)*chi_A)+vomega**4*((3-12*eta)*(chi_A*chi_S))+vomega**5*((np.divide(407,30)*eta**2-np.divide(593,60)*eta+np.divide(2,3))*chi_A)+vomega**6*((44*eta**2-eta-np.divide(7,2))*(chi_A*chi_S)))
    fspin33_limit=vomega**3*((np.divide(19,2)*eta-2)*chi_A)+vomega**4*((3-12*eta)*(chi_A*chi_S))+vomega**5*((np.divide(407,30)*eta**2-np.divide(593,60)*eta+np.divide(2,3))*chi_A)+vomega**6*((44*eta**2-eta-np.divide(7,2))*(chi_A*chi_S))+1j*(Omega*Hreal)**2*(np.divide(7339,540)*eta-np.divide(81,20))*chi_A
    fspin33amp=(vomega**3*(((np.divide(19,2)*eta-2)*chi_A*deltainv)+((np.divide(5,2)*eta-2)*chi_S))+vomega**4*((np.divide(3,2)-6*eta)*chi_A**2+(3-12*eta)*(chi_A*chi_S*deltainv)+np.divide(3,2)*chi_S**2)+vomega**5*(((np.divide(407,30)*eta**2-np.divide(593,60)*eta+np.divide(2,3))*chi_A*deltainv)+((np.divide(241,30)*eta**2+np.divide(11,20)*eta+np.divide(2,3))*chi_S))+vomega**6*((-12*eta**2+np.divide(11,2)*eta-np.divide(7,4))*chi_A**2+(44*eta**2-eta-np.divide(7,2))*(chi_A*chi_S*deltainv)+(6*eta**2-np.divide(27,2)*eta-np.divide(7,4))*chi_S**2))
    fspin33=(vomega**3*(((np.divide(19,2)*eta-2)*chi_A*deltainv)+((np.divide(5,2)*eta-2)*chi_S))+vomega**4*((np.divide(3,2)-6*eta)*chi_A**2+(3-12*eta)*(chi_A*chi_S*deltainv)+np.divide(3,2)*chi_S**2)+vomega**5*(((np.divide(407,30)*eta**2-np.divide(593,60)*eta+np.divide(2,3))*chi_A*deltainv)+((np.divide(241,30)*eta**2+np.divide(11,20)*eta+np.divide(2,3))*chi_S))+vomega**6*((-12*eta**2+np.divide(11,2)*eta-np.divide(7,4))*chi_A**2+(44*eta**2-eta-np.divide(7,2))*(chi_A*chi_S*deltainv)+(6*eta**2-np.divide(27,2)*eta-np.divide(7,4))*chi_S**2)+1j*((Omega*Hreal)**2*(np.divide(7339,540)*eta-np.divide(81,20))*chi_A*deltainv+(np.divide(593,108)*eta-np.divide(81,20))*chi_S))
    fspin21_limit=(-np.divide(3,2)*vomega*(chi_A)+vomega**3*((np.divide(131,84)*eta+np.divide(61,12))*(chi_A))+vomega**4*(+(np.divide(21,2)*eta-6)*(chi_A*chi_S))+vomega**5*((np.divide(-703,112)*eta**2+np.divide(8797,1008)*eta-np.divide(81,16))*(chi_A)+(np.divide(3,4)-3*eta)*(chi_A**3)+(np.divide(9,4)-6*eta)*(chi_A*chi_S**2))+vomega**6*((np.divide(9487,504)*eta**2-np.divide(1636,21)*eta+np.divide(4163,126))*(chi_A*chi_S)))
    fspin21=(-np.divide(3,2)*vomega*(chi_A*deltainv+chi_S)+vomega**3*((np.divide(131,84)*eta+np.divide(61,12))*(chi_A*deltainv)+(np.divide(79,84)*eta+np.divide(61,12))*chi_S)+vomega**4*((-2*eta-3)*chi_A**2+(np.divide(21,2)*eta-6)*(chi_A*chi_S*deltainv)+(np.divide(1,2)*eta-3)*chi_S**2)+vomega**5*((np.divide(-703,112)*eta**2+np.divide(8797,1008)*eta-np.divide(81,16))*(chi_A*deltainv)+(np.divide(613,1008)*eta**2+np.divide(1709,1008)*eta-np.divide(81,16))*chi_S+(np.divide(3,4)-3*eta)*(chi_A**3*deltainv)+(np.divide(9,4)-6*eta)*(chi_A*chi_S**2*deltainv)+(np.divide(9,4)-3*eta)*(chi_A**2*chi_S)+np.divide(3,4)*chi_S**3)+vomega**6*((np.divide(5,7)*eta**2-np.divide(9287,1008)*eta+np.divide(4163,252))*chi_A**2+(np.divide(139,72)*eta**2-np.divide(2633,1008)*eta+np.divide(4163,252))*chi_S**2+(np.divide(9487,504)*eta**2-np.divide(1636,21)*eta+np.divide(4163,126))*(chi_A*chi_S*deltainv)))
    rhoNS81=1+((20022-126451*eta+236922*eta**2-138430*eta**3+21640*eta**4)/(18240*(-1+6*eta-10*eta**2+4*eta**3)))*vomega**2
    rho82=1+((2462-17598*eta+37119*eta**2-22845*eta**3+3063*eta**4)/(2736*(-1+7*eta-14*eta**2+7*eta**3)))*vomega**2
    rhoNS83=1+((20598-131059*eta+249018*eta**2-149950*eta**3+24520*eta**4)/(18240*(-1+6*eta-10*eta**2+4*eta**3)))*vomega**2
    rho84=1+((2666-19434*eta+42627*eta**2-28965*eta**3+4899*eta**4)/(2736*(-1+7*eta-14*eta**2+7*eta**3)))*vomega**2
    rhoNS85=1+((4350-28055*eta+54642*eta**2-34598*eta**3+6056*eta**4)/(3648*(-1+6*eta-10*eta**2+4*eta**3)))*vomega**2
    rho86=1+((1002-7498*eta+17269*eta**2-13055*eta**3+2653*eta**4)/(912*(-1+7*eta-14*eta**2+7*eta**3)))*vomega**2
    rhoNS87=1+((23478-154099*eta+309498*eta**2-207550*eta**3+38920*eta**4)/(18240*(-1+6*eta-10*eta**2+4*eta**3)))*vomega**2
    rho88=1+((3482-26778*eta+64659*eta**2-53445*eta**3+12243*eta**4)/(2736*(-1+7*eta-14*eta**2+7*eta**3)))*vomega**2
    rhoNS71=1+((228*eta**3-2083*eta**2+2518*eta-618)/(714*(3*eta**2-4*eta+1)))*vomega**2
    rho72=1+((32760*eta**4-190239*eta**3+273924*eta**2-123489*eta+16832)/(14994*(7*eta**3-14*eta**2+7*eta-1)))*vomega**2
    rhoNS73=1+((420*eta**3-2563*eta**2+2806*eta-666)/(714*(3*eta**2-4*eta+1)))*vomega**2
    rho74=1+((41076*eta**4-217959*eta**3+298872*eta**2-131805*eta+17756)/(14994*(7*eta**3-14*eta**2+7*eta-1)))*vomega**2
    rhoNS75=1+((804*eta**3-3523*eta**2+3382*eta-762)/(714*(3*eta**2-4*eta+1)))*vomega**2
    rho76=1+((6104*eta**4-29351*eta**3+37828*eta**2-16185*eta+2144)/(1666*(7*eta**3-14*eta**2+7*eta-1)))*vomega**2
    rhoNS77=1+((1380*eta**3-4963*eta**2+4246*eta-906)/(714*(3*eta**2-4*eta+1)))*vomega**2
    rhoNS61=1+((124*eta**3-670*eta**2+694*eta-161)/(144*(3*eta**2-4*eta+1)))*vomega**2
    rho62=1+((49*eta**3-413*eta**2+378*eta-74)/(84*(5*eta**2-5*eta+1)))*vomega**2-np.divide(817991,3298680)*vomega**4
    rhoNS63=1+((156*eta**3-750*eta**2+742*eta-169)/(144*(3*eta**2-4*eta+1)))*vomega**2
    rho64=1+((133*eta**3-581*eta**2+462*eta-86)/(84*(5*eta**2-5*eta+1)))*vomega**2-np.divide(476887,659736)*vomega**4
    rhoNS65=1+((220*eta**3-910*eta**2+838*eta-185)/(144*(3*eta**2-4*eta+1)))*vomega**2
    rho66=1+((273*eta**3-861*eta**2+602*eta-106)/(84*(5*eta**2-5*eta+1)))*vomega**2-np.divide(1025435,659736)*vomega**4
    rhoNS51=1+((8*eta**2-626*eta+319)/(390*(2*eta-1)))*vomega**2-np.divide(31877,304200)*vomega**4
    rho52=1+((21980*eta**3-104930*eta**2+84679*eta-15828)/(13650*(5*eta**2-5*eta+1)))*vomega**2-np.divide(7187914,15526875)*vomega**4
    rhoNS53=1+((176*eta**2-850*eta+375)/(390*(2*eta-1)))*vomega**2-np.divide(410833,709800)*vomega**4
    rho54=1+((33320*eta**3-127610*eta**2+96019*eta-17448)/(13650*(5*eta**2-5*eta+1)))*vomega**2-np.divide(16213384,15526875)*vomega**4
    rhoNS55=1+vomega**2*(np.divide(487,390)/(-1+2*eta)-np.divide(649,195)*eta/(-1+2*eta)+np.divide(256,195)*eta**2/(-1+2*eta))-np.divide(3353747,2129400)*vomega**4+(np.divide(190606537999247,11957879934000)-np.divide(1546,429)*eulerlog5)*vomega**6+(-np.divide(1213641959949291437,118143853747920000)+np.divide(376451,83655)*eulerlog5)*vomega**8+(-np.divide(150082616449726042201261,4837990810977324000000)+np.divide(2592446431,456756300)*eulerlog5)*vomega**10
    rhoNS41=1+((288*eta**2-1385*eta+602)/(528*(2*eta-1)))*vomega**2-(np.divide(7775491,21141120))*vomega**4+((np.divide(1227423222031,1758095539200)-np.divide(1571,6930)*eulerlog1v2)*vomega**6)
    rho42=1+((285*eta**2-3530*eta+1146)/(1320*(3*eta-1)))*vomega**2-(vomega**3/(15*(1-3*eta)))*((78*eta**2-59*eta+10)*chi_S+(10-21*eta)*delta*chi_A)-((-379526805*eta**4-3047981160*eta**3+1204388696*eta**2+295834536*eta-114859044)/(317116800*(1-3*eta)**2))*vomega**4+((848238724511/219761942400)-(3142/3465)*eulerlog2v2)*vomega**6
    rhoNS43=1+vomega**2/(1-2*eta)*(-np.divide(10,11)*eta**2+np.divide(547,176)*eta-np.divide(111,88))-np.divide(6894273,7047040)*vomega**4+vomega**6*(np.divide(1664224207351,195343948800)-np.divide(1571,770)*eulerlog3)+vomega**8*(-np.divide(2465107182496333,460490801971200)+np.divide(174381,67760)*eulerlog3)
    rho44=1+vomega**2*((1614-5870*eta+2625*eta**2)/(1320*(-1+3*eta)))+vomega**3*((np.divide(2,3)-np.divide(41,15)*eta+np.divide(14,5)*eta**2)/(-1+3*eta)*chi_S+delta*(np.divide(2,3)-np.divide(13,5)*eta)/(-1+3*eta)*chi_A)+vomega**4*(-np.divide(14210377,8808800)/(1-3*eta)**2+np.divide(32485357,4404400)*eta/(1-3*eta)**2-np.divide(1401149,1415700)*eta**2/(1-3*eta)**2-np.divide(801565,37752)*eta**3/(1-3*eta)**2+np.divide(3976393,1006720)*eta**4/(1-3*eta)**2+(np.divide(1,2)*chi_A**2-2*eta*chi_A**2+delta*chi_A*chi_S+np.divide(1,2)*chi_S**2))+vomega**5*((-np.divide(69,55)+np.divide(16571,1650)*eta-np.divide(2673,100)*eta**2+np.divide(8539,440)*eta**3+np.divide(591,44)*eta**4)/(1-3*eta)**2*chi_S+delta*(-np.divide(69,55)+np.divide(10679,1650)*eta-np.divide(1933,220)*eta**2+np.divide(597,440)*eta**3)/(1-3*eta)**2*chi_A)+vomega**6*(np.divide(16600939332793,1098809712000)-np.divide(12568,3465)*eulerlog4)+vomega**8*(-np.divide(172066910136202271,19426955708160000)+np.divide(845198,190575)*eulerlog4)+vomega**10*(-np.divide(17154485653213713419357,568432724020761600000)+np.divide(22324502267,3815311500)*eulerlog4)
    rhoNS31=1-vomega**2*(np.divide(2,9)*eta+np.divide(13,18))+vomega**4*(-np.divide(829,1782)*eta**2-np.divide(1685,1782)*eta+np.divide(101,7128))+vomega**6*(np.divide(11706720301,6129723600)-np.divide(26,63)*eulerlog1v2)+vomega**8*(np.divide(169,567)*eulerlog1v2+np.divide(2606097992581,4854741091200))
    rho32=1+vomega*((4*eta*chi_S)/(3*(1-3*eta)))+vomega**2*((np.divide(-32,27)*eta**2+np.divide(223,54)*eta-np.divide(164,135))/(1-3*eta)-(16*eta**2*chi_S**2)/(9*(1-3*eta)**2))+vomega**3*((np.divide(13,9)*eta+np.divide(2,9))*(delta*chi_A)/(1-3*eta)+(np.divide(607,81)*eta**3+np.divide(503,81)*eta**2-np.divide(1478,405)*eta+np.divide(2,9))*chi_S/(1-3*eta)**2+(320*eta**3*chi_S**3)/(81*(1-3*eta)**3))+vomega**4*((np.divide(77141,40095)*eta**4-np.divide(508474,40095)*eta**3-np.divide(945121,320760)*eta**2+np.divide(1610009,320760)*eta-np.divide(180566,200475))/(1-3*eta)**2+(4*eta**2-3*eta+np.divide(1,3))*(chi_A**2)/(1-3*eta)+(np.divide(-50,27)*eta**2-np.divide(88,27)*eta+np.divide(2,3))*(delta*chi_A*chi_S)/(1-3*eta)**2+(np.divide(-2452,243)*eta**4-np.divide(1997,243)*eta**3+np.divide(1435,243)*eta**2-np.divide(43,27)*eta+np.divide(1,3))*(chi_S**2)/((1-3*eta)**3))+vomega**5*((np.divide(-1184225,96228)*eta**5-np.divide(40204523,962280)*eta**4+np.divide(101706029,962280)*eta**3-np.divide(14103833,192456)*eta**2+np.divide(20471053,962280)*eta-np.divide(2788,1215))*chi_S/(1-3*eta)**3+(np.divide(608,81)*eta**3+np.divide(736,81)*eta**2-np.divide(16,9)*eta)*(delta*chi_A*chi_S**2)/(1-3*eta)**3+(np.divide(889673,106920)*eta**3-np.divide(75737,5346)*eta**2+np.divide(376177,35640)*eta-np.divide(2788,1215))*(delta*chi_A)/(1-3*eta)**2+(np.divide(96176,2187)*eta**5+np.divide(43528,2187)*eta**4-np.divide(40232,2187)*eta**3+np.divide(376,81)*eta**2-np.divide(8,9)*eta)*(chi_S**3)/(1-3*eta)**4+(np.divide(-32,3)*eta**3+8*eta**2-np.divide(8,9)*eta)*(chi_A**2*chi_S)/((1-3*eta)**2))+vomega**6*(np.divide(5849948554,940355325)-np.divide(104,63)*eulerlog2)+vomega**8*(np.divide(17056,8505)*eulerlog2-np.divide(10607269449358,3072140846775))+vomega**10*(-np.divide(1312549797426453052,176264081083715625)+np.divide(18778864,12629925)*eulerlog2)
    rhoNS33=1+vomega**2*(np.divide(2,3)*eta-np.divide(7,6))+vomega**4*(-np.divide(6719,3960)-np.divide(1861,990)*eta+np.divide(149,330)*eta*vomega**2)+vomega**6*(np.divide(3203101567,227026800)+(-np.divide(129509,25740)+np.divide(41,192)*np.pi**2)*eta-np.divide(274621,154440)*eta**2+np.divide(12011,46332)*eta**3-np.divide(26,7)*eulerlog3)+vomega**8*(-np.divide(57566572157,8562153600)+np.divide(13,3)*eulerlog3)+vomega**10*(-np.divide(903823148417327,30566888352000)+np.divide(87347,13860)*eulerlog3)
    rhoNS21=1+vomega**2*(np.divide(23,84)*eta-np.divide(59,56))+vomega**4*(np.divide(617,4704)*eta**2-np.divide(10993,14112)*eta-np.divide(47009,56448))+vomega**6*(np.divide(7613184941,2607897600)-np.divide(107,105)*eulerlog1)+vomega**8*(-np.divide(1168617463883,911303737344)+np.divide(6313,5880)*eulerlog1)+vomega**10*(-np.divide(63735873771463,16569158860800)+np.divide(5029963,5927040)*eulerlog1)
    rho22=1+vomega**2*(np.divide(55,84)*eta-np.divide(43,42))+vomega**3*((np.divide(2,3)*eta-np.divide(2,3))*chi_S-np.divide(2,3)*delta*chi_A)+vomega**4*(np.divide(19583,42336)*eta**2-np.divide(33025,21168)*eta-np.divide(20555,10584)+(np.divide(1,2)-2*eta)*chi_A**2+delta*chi_A*chi_S+np.divide(1,2)*chi_S**2)+vomega**5*(delta*(np.divide(-19,42)*eta-np.divide(34,21))*chi_A+(np.divide(209,126)*eta**2+np.divide(49,18)*eta-np.divide(34,21))*chi_S)+vomega**6*(np.divide(10620745,39118464)*eta**3-np.divide(6292061,3259872)*eta**2+np.divide(41,192)*np.pi**2*eta-np.divide(48993925,9779616)*eta-np.divide(428,105)*eulerlog2+np.divide(1556919113,122245200)+delta*(np.divide(89,126)-np.divide(781,252)*eta)*chi_A*chi_S+(np.divide(-27,14)*eta**2-np.divide(457,504)*eta+np.divide(89,252))*chi_A**2+(np.divide(10,9)*eta**2-np.divide(1817,504)*eta+np.divide(89,252))*chi_S**2)+vomega**7*(delta*(np.divide(97865,63504)*eta**2+np.divide(50140,3969)*eta+np.divide(18733,15876))*chi_A+(np.divide(50803,63504)*eta**3-np.divide(245717,63504)*eta**2+np.divide(74749,5292)*eta+np.divide(18733,15876))*chi_S+delta*chi_A**3*(np.divide(1,3)-np.divide(4,3)*eta)+delta*(2*eta+1)*chi_A*chi_S**2+(np.divide(-4,1)*eta**2-np.divide(3,1)*eta+np.divide(1,1))*chi_A**2*chi_S+(eta+np.divide(1,3))*chi_S**3)+vomega**8*(np.divide(9202,2205)*eulerlog2-np.divide(387216563023,160190110080))+vomega**10*(np.divide(439877,55566)*eulerlog2-np.divide(16094530514677,533967033600))
    f81amp = (rhoNS81)**8
    f82amp = (rho82)**8
    f83amp = (rhoNS83)**8
    f84amp = (rho84)**8
    f85amp = (rhoNS85)**8
    f86amp = (rho86)**8
    f87amp = (rhoNS87)**8
    f88amp = (rho88)**8
    f71amp = (rhoNS71)**7
    f72amp = (rho72)**7
    f73amp = (rhoNS73)**7
    f74amp = (rho74)**7
    f75amp = (rhoNS75)**7
    f76amp = (rho76)**7
    f77amp = (rhoNS77)**7
    f61amp = (rhoNS61)**6
    f62amp = (rho62)**6
    f63amp = (rhoNS63)**6
    f64amp = (rho64)**6
    f65amp = (rhoNS65)**6
    f66amp = (rho66)**6
    f51amp = ((rhoNS51)**5)*noneqcond
    f52amp = (rho52)**5
    f53amp = ((rhoNS53)**5)*noneqcond
    f54amp = (rho54)**5
    f55 = ((rhoNS55)**5 + fspin55)*noneqcond + fspin55_limit*eqcond
    f55amp = f55
    f41amp = ((rhoNS41)**4 + fspin41)*noneqcond + fspin41_limit*eqcond
    f42amp = (rho42)**4
    f43 = ((rhoNS43)**4 + fspin43)*noneqcond + fspin43_limit*eqcond
    f43amp = f43
    f44 = (rho44)**4
    f44amp = f44
    f31amp = ((rhoNS31)**3 + fspin31)*noneqcond + fspin31_limit*eqcond
    f32 = (rho32)**3
    f32amp = f32
    f33 = ((rhoNS33)**3 + fspin33)*noneqcond + fspin33_limit*eqcond
    f33amp = ((rhoNS33)**3 + fspin33amp)*noneqcond + fspin33amp_limit*eqcond
    f21 = ((rhoNS21)**2 + fspin21)*noneqcond + fspin21_limit*eqcond
    f21amp = f21
    f22 = (rho22)**2
    f22amp = f22
    Y82amp = 0.32254835519288305
    Y84amp = 0.3382915688890245
    Y86amp = 0.3764161087284946
    Y88amp = 0.5154289843972844
    Y71amp = 0.31937046138540076
    Y73amp = 0.331899519333737
    Y75amp = 0.3669287245764378
    Y77amp = 0.5000395635705508
    Y62amp = 0.32569524293385776
    Y64amp = 0.3567812628539981
    Y66amp = 0.48308411358006625
    Y51amp = 0.32028164857621516
    Y53amp = 0.34594371914684025
    Y55amp = 0.46413220344085826
    Y55 = 0.46413220344085826*np.exp(-5*1j*phi)
    Y42amp = 0.33452327177864466
    Y44amp = 0.4425326924449826
    Y44 = 0.4425326924449826*np.exp(-4*1j*phi)
    Y31amp = 0.3231801841141506
    Y33amp = 0.4172238236327842
    Y33 = 0.4172238236327842*np.exp(-3*1j*phi)
    Y11amp = 0.3454941494713355
    Y11 = 0.3454941494713355*np.exp(-1j*phi)
    Y22amp = 0.3862742020231896
    Y22 = 0.3862742020231896*np.exp(-2*1j*phi)
    c9 = ((1 - delta)/2) + ((-1)**9)*((1 + delta)/2)
    c8 = ((1 - delta)/2) + ((-1)**8)*((1 + delta)/2)
    c7 = ((1 - delta)/2) + ((-1)**7)*((1 + delta)/2)
    c6 = ((1 - delta)/2) + ((-1)**6)*((1 + delta)/2)
    c5 = (((1 - delta)/2) + ((-1)**5)*((1 + delta)/2))*noneqcond + (-np.divide(1,2))*eqcond
    c4 = ((1 - delta)/2) + ((-1)**4)*((1 + delta)/2)
    c3 = (((1 - delta)/2) + ((-1)**3)*((1 + delta)/2))*noneqcond + (-1)*eqcond
    c2 = ((1 - delta)/2) + ((-1)**2)*((1 + delta)/2)
    N81amp = (16*np.pi*(1)**8)*np.sqrt(((8**2 - 1**2)*(2*8 + 1)*(8+2))/((2*8-1)*(8+1)*8*(8- 1)))/factorial2(2*8+1)
    N82amp = (8*np.pi*(2)**8)*np.sqrt(((8 + 1)*(8+2))/(8*(8- 1)))/factorial2(2*8+1)
    N83amp = (16*np.pi*(3)**8)*np.sqrt(((8**2 - 3**2)*(2*8 + 1)*(8+2))/((2*8-1)*(8+1)*8*(8- 1)))/factorial2(2*8+1)
    N84amp = (8*np.pi*(4)**8)*np.sqrt(((8 + 1)*(8+2))/(8*(8- 1)))/factorial2(2*8+1)
    N85amp = (16*np.pi*(5)**8)*np.sqrt(((8**2 - 5**2)*(2*8 + 1)*(8+2))/((2*8-1)*(8+1)*8*(8- 1)))/factorial2(2*8+1)
    N86amp = (8*np.pi*(6)**8)*np.sqrt(((8 + 1)*(8+2))/(8*(8- 1)))/factorial2(2*8+1)
    N87amp = (16*np.pi*(7)**8)*np.sqrt(((8**2 - 7**2)*(2*8 + 1)*(8+2))/((2*8-1)*(8+1)*8*(8- 1)))/factorial2(2*8+1)
    N88amp = (8*np.pi*(8)**8)*np.sqrt(((8 + 1)*(8+2))/(8*(8- 1)))/factorial2(2*8+1)
    N71amp = (8*np.pi*(1)**7)*np.sqrt(((7 + 1)*(7+2))/(7*(7- 1)))/factorial2(2*7+1)
    N72amp = (16*np.pi*(2)**7)*np.sqrt(((7**2 - 2**2)*(2*7 + 1)*(7+2))/((2*7-1)*(7+1)*7*(7- 1)))/factorial2(2*7+1)
    N73amp = (8*np.pi*(3)**7)*np.sqrt(((7 + 1)*(7+2))/(7*(7- 1)))/factorial2(2*7+1)
    N74amp = (16*np.pi*(4)**7)*np.sqrt(((7**2 - 4**2)*(2*7 + 1)*(7+2))/((2*7-1)*(7+1)*7*(7- 1)))/factorial2(2*7+1)
    N75amp = (8*np.pi*(5)**7)*np.sqrt(((7 + 1)*(7+2))/(7*(7- 1)))/factorial2(2*7+1)
    N76amp = (16*np.pi*(6)**7)*np.sqrt(((7**2 - 6**2)*(2*7 + 1)*(7+2))/((2*7-1)*(7+1)*7*(7- 1)))/factorial2(2*7+1)
    N77amp = (8*np.pi*(7)**7)*np.sqrt(((7 + 1)*(7+2))/(7*(7- 1)))/factorial2(2*7+1)
    N61amp = (16*np.pi*(1)**6)*np.sqrt(((6**2 - 1**2)*(2*6 + 1)*(6+2))/((2*6-1)*(6+1)*6*(6- 1)))/factorial2(2*6+1)
    N62amp = (8*np.pi*(2)**6)*np.sqrt(((6 + 1)*(6+2))/(6*(6- 1)))/factorial2(2*6+1)
    N63amp = (16*np.pi*(3)**6)*np.sqrt(((6**2 - 3**2)*(2*6 + 1)*(6+2))/((2*6-1)*(6+1)*6*(6- 1)))/factorial2(2*6+1)
    N64amp = (8*np.pi*(4)**6)*np.sqrt(((6 + 1)*(6+2))/(6*(6- 1)))/factorial2(2*6+1)
    N65amp = (16*np.pi*(5)**6)*np.sqrt(((6**2 - 5**2)*(2*6 + 1)*(6+2))/((2*6-1)*(6+1)*6*(6- 1)))/factorial2(2*6+1)
    N66amp = (8*np.pi*(6)**6)*np.sqrt(((6 + 1)*(6+2))/(6*(6- 1)))/factorial2(2*6+1)
    N51amp = (8*np.pi*(1)**5)*np.sqrt(((5 + 1)*(5+2))/(5*(5- 1)))/factorial2(2*5+1)
    N52amp = (16*np.pi*(2)**5)*np.sqrt(((5**2 - 2**2)*(2*5 + 1)*(5+2))/((2*5-1)*(5+1)*5*(5- 1)))/factorial2(2*5+1)
    N53amp = (8*np.pi*(3)**5)*np.sqrt(((5 + 1)*(5+2))/(5*(5- 1)))/factorial2(2*5+1)
    N54amp = (16*np.pi*(4)**5)*np.sqrt(((5**2 - 4**2)*(2*5 + 1)*(5+2))/((2*5-1)*(5+1)*5*(5- 1)))/factorial2(2*5+1)
    N55amp = (8*np.pi*(5)**5)*np.sqrt(((5 + 1)*(5+2))/(5*(5- 1)))/factorial2(2*5+1)
    N55 = (1j)**5 * N55amp
    N41amp = (16*np.pi*(1)**4)*np.sqrt(((4**2 - 1**2)*(2*4 + 1)*(4+2))/((2*4-1)*(4+1)*4*(4- 1)))/factorial2(2*4+1)
    N42amp = (8*np.pi*(2)**4)*np.sqrt(((4 + 1)*(4+2))/(4*(4- 1)))/factorial2(2*4+1)
    N43amp = (16*np.pi*(3)**4)*np.sqrt(((4**2 - 3**2)*(2*4 + 1)*(4+2))/((2*4-1)*(4+1)*4*(4- 1)))/factorial2(2*4+1)
    N43 = -(1j)**4 * N43amp
    N44amp = (8*np.pi*(4)**4)*np.sqrt(((4 + 1)*(4+2))/(4*(4- 1)))/factorial2(2*4+1)
    N44 = (1j)**4 * N44amp
    N31amp = (8*np.pi*(1)**3)*np.sqrt(((3 + 1)*(3+2))/(3*(3- 1)))/factorial2(2*3+1)
    N32amp = (16*np.pi*(2)**3)*np.sqrt(((3**2 - 2**2)*(2*3 + 1)*(3+2))/((2*3-1)*(3+1)*3*(3- 1)))/factorial2(2*3+1)
    N32 = -(1j)**3 * N32amp
    N33amp = (8*np.pi*(3)**3)*np.sqrt(((3 + 1)*(3+2))/(3*(3- 1)))/factorial2(2*3+1)
    N33 = (1j)**3 * N33amp
    N21amp = (16*np.pi*(1)**2)*np.sqrt(((2**2 - 1**2)*(2*2 + 1)*(2+2))/((2*2-1)*(2+1)*2*(2- 1)))/factorial2(2*2+1)
    N21 = -(1j)**2 * N21amp
    N22amp = (8*np.pi*(2)**2)*np.sqrt(((2 + 1)*(2+2))/(2*(2- 1)))/factorial2(2*2+1)
    N22 = (1j)**2 * N22amp
    r0 = 2/np.sqrt(np.exp(1))
    pikhat1 = khat1*np.pi
    khat12 = 2*khat1
    pikhat2 = khat2*np.pi
    khat22 = 2*khat2
    pikhat3 = khat3*np.pi
    khat32 = 2*khat3
    pikhat4 = khat4*np.pi
    khat42 = 2*khat4
    pikhat5 = khat5*np.pi
    khat52 = 2*khat5
    pikhat6 = khat6*np.pi
    khat62 = 2*khat6
    pikhat7 = khat7*np.pi
    khat72 = 2*khat7
    pikhat8 = khat8*np.pi
    khat82 = 2*khat8
    T1prefac = 2*pikhat1/(np.exp(pikhat1) - np.exp(-pikhat1))
    T2prefac = 2*pikhat2/(np.exp(pikhat2) - np.exp(-pikhat2))
    T3prefac = 2*pikhat3/(np.exp(pikhat3) - np.exp(-pikhat3))
    T4prefac = 2*pikhat4/(np.exp(pikhat4) - np.exp(-pikhat4))
    T5prefac = 2*pikhat5/(np.exp(pikhat5) - np.exp(-pikhat5))
    T6prefac = 2*pikhat6/(np.exp(pikhat6) - np.exp(-pikhat6))
    T7prefac = 2*pikhat7/(np.exp(pikhat7) - np.exp(-pikhat7))
    T8prefac = 2*pikhat8/(np.exp(pikhat8) - np.exp(-pikhat8))
    j2plusb2_21 = (1**2 + khat1**2)*(2**2 + khat12**2)
    j2plusb2_31 = j2plusb2_21*(3**2 + khat12**2)
    j2plusb2_41 = j2plusb2_31*(4**2 + khat12**2)
    j2plusb2_51 = j2plusb2_41*(5**2 + khat12**2)
    j2plusb2_61 = j2plusb2_51*(6**2 + khat12**2)
    j2plusb2_71 = j2plusb2_61*(7**2 + khat12**2)
    j2plusb2_81 = j2plusb2_71*(8**2 + khat12**2)
    j2plusb2_22 = (1**2 + khat2**2)*(2**2 + khat22**2)
    j2plusb2_32 = j2plusb2_22*(3**2 + khat2**2)
    j2plusb2_42 = j2plusb2_32*(4**2 + khat22**2)
    j2plusb2_52 = j2plusb2_42*(5**2 + khat22**2)
    j2plusb2_62 = j2plusb2_52*(6**2 + khat22**2)
    j2plusb2_72 = j2plusb2_62*(7**2 + khat22**2)
    j2plusb2_82 = j2plusb2_72*(8**2 + khat22**2)
    j2plusb2_23 = (1**2 + khat3**2)*(2**2 + khat32**2)
    j2plusb2_33 = j2plusb2_23*(3**2 + khat32**2)
    j2plusb2_43 = j2plusb2_33*(4**2 + khat32**2)
    j2plusb2_53 = j2plusb2_43*(5**2 + khat32**2)
    j2plusb2_63 = j2plusb2_53*(6**2 + khat32**2)
    j2plusb2_73 = j2plusb2_63*(7**2 + khat32**2)
    j2plusb2_83 = j2plusb2_73*(8**2 + khat32**2)
    j2plusb2_24 = (1**2 + khat4**2)*(2**2 + khat42**2)
    j2plusb2_34 = j2plusb2_24*(3**2 + khat42**2)
    j2plusb2_44 = j2plusb2_34*(4**2 + khat42**2)
    j2plusb2_54 = j2plusb2_44*(5**2 + khat42**2)
    j2plusb2_64 = j2plusb2_54*(6**2 + khat42**2)
    j2plusb2_74 = j2plusb2_64*(7**2 + khat42**2)
    j2plusb2_84 = j2plusb2_74*(8**2 + khat42**2)
    j2plusb2_25 = (1**2 + khat5**2)*(2**2 + khat52**2)
    j2plusb2_35 = j2plusb2_25*(3**2 + khat52**2)
    j2plusb2_45 = j2plusb2_35*(4**2 + khat52**2)
    j2plusb2_55 = j2plusb2_45*(5**2 + khat52**2)
    j2plusb2_65 = j2plusb2_55*(6**2 + khat52**2)
    j2plusb2_75 = j2plusb2_65*(7**2 + khat52**2)
    j2plusb2_85 = j2plusb2_75*(8**2 + khat52**2)
    j2plusb2_26 = (1**2 + khat6**2)*(2**2 + khat62**2)
    j2plusb2_36 = j2plusb2_26*(3**2 + khat62**2)
    j2plusb2_46 = j2plusb2_36*(4**2 + khat62**2)
    j2plusb2_56 = j2plusb2_46*(5**2 + khat62**2)
    j2plusb2_66 = j2plusb2_56*(6**2 + khat62**2)
    j2plusb2_76 = j2plusb2_66*(7**2 + khat62**2)
    j2plusb2_86 = j2plusb2_76*(8**2 + khat62**2)
    j2plusb2_27 = (1**2 + khat7**2)*(2**2 + khat72**2)
    j2plusb2_37 = j2plusb2_27*(3**2 + khat72**2)
    j2plusb2_47 = j2plusb2_37*(4**2 + khat72**2)
    j2plusb2_57 = j2plusb2_47*(5**2 + khat72**2)
    j2plusb2_67 = j2plusb2_57*(6**2 + khat72**2)
    j2plusb2_77 = j2plusb2_67*(7**2 + khat72**2)
    j2plusb2_87 = j2plusb2_77*(8**2 + khat72**2)
    j2plusb2_28 = (1**2 + khat8**2)*(2**2 + khat82**2)
    j2plusb2_38 = j2plusb2_28*(3**2 + khat82**2)
    j2plusb2_48 = j2plusb2_38*(4**2 + khat82**2)
    j2plusb2_58 = j2plusb2_48*(5**2 + khat82**2)
    j2plusb2_68 = j2plusb2_58*(6**2 + khat82**2)
    j2plusb2_78 = j2plusb2_68*(7**2 + khat82**2)
    j2plusb2_88 = j2plusb2_78*(8**2 + khat82**2)
    gamma_amp_21 = np.sqrt(T1prefac*j2plusb2_21)
    gamma_amp_22 = np.sqrt(T2prefac*j2plusb2_22)
    gamma_amp_31 = np.sqrt(T1prefac*j2plusb2_31)
    gamma_amp_32 = np.sqrt(T2prefac*j2plusb2_32)
    gamma_amp_33 = np.sqrt(T3prefac*j2plusb2_33)
    gamma_amp_41 = np.sqrt(T1prefac*j2plusb2_41)
    gamma_amp_42 = np.sqrt(T2prefac*j2plusb2_42)
    gamma_amp_43 = np.sqrt(T3prefac*j2plusb2_43)
    gamma_amp_44 = np.sqrt(T4prefac*j2plusb2_44)
    gamma_amp_51 = np.sqrt(T1prefac*j2plusb2_51)
    gamma_amp_52 = np.sqrt(T2prefac*j2plusb2_52)
    gamma_amp_53 = np.sqrt(T3prefac*j2plusb2_53)
    gamma_amp_54 = np.sqrt(T4prefac*j2plusb2_54)
    gamma_amp_55 = np.sqrt(T5prefac*j2plusb2_55)
    gamma_amp_61 = np.sqrt(T1prefac*j2plusb2_61)
    gamma_amp_62 = np.sqrt(T2prefac*j2plusb2_62)
    gamma_amp_63 = np.sqrt(T3prefac*j2plusb2_63)
    gamma_amp_64 = np.sqrt(T4prefac*j2plusb2_64)
    gamma_amp_65 = np.sqrt(T5prefac*j2plusb2_65)
    gamma_amp_66 = np.sqrt(T6prefac*j2plusb2_66)
    gamma_amp_71 = np.sqrt(T1prefac*j2plusb2_71)
    gamma_amp_72 = np.sqrt(T2prefac*j2plusb2_72)
    gamma_amp_73 = np.sqrt(T3prefac*j2plusb2_73)
    gamma_amp_74 = np.sqrt(T4prefac*j2plusb2_74)
    gamma_amp_75 = np.sqrt(T5prefac*j2plusb2_75)
    gamma_amp_76 = np.sqrt(T6prefac*j2plusb2_76)
    gamma_amp_77 = np.sqrt(T7prefac*j2plusb2_77)
    gamma_amp_81 = np.sqrt(T1prefac*j2plusb2_81)
    gamma_amp_82 = np.sqrt(T2prefac*j2plusb2_82)
    gamma_amp_83 = np.sqrt(T3prefac*j2plusb2_83)
    gamma_amp_84 = np.sqrt(T4prefac*j2plusb2_84)
    gamma_amp_85 = np.sqrt(T5prefac*j2plusb2_85)
    gamma_amp_86 = np.sqrt(T6prefac*j2plusb2_86)
    gamma_amp_87 = np.sqrt(T7prefac*j2plusb2_87)
    gamma_amp_88 = np.sqrt(T8prefac*j2plusb2_88)
    T81amp = -gamma_amp_81*np.exp(pikhat1)/factorial(8)
    T82amp = -gamma_amp_82*np.exp(pikhat2)/factorial(8)
    T83amp = -gamma_amp_83*np.exp(pikhat3)/factorial(8)
    T84amp = -gamma_amp_84*np.exp(pikhat4)/factorial(8)
    T85amp = -gamma_amp_85*np.exp(pikhat5)/factorial(8)
    T86amp = -gamma_amp_86*np.exp(pikhat6)/factorial(8)
    T87amp = -gamma_amp_87*np.exp(pikhat7)/factorial(8)
    T88amp = -gamma_amp_88*np.exp(pikhat8)/factorial(8)
    T71amp = -gamma_amp_71*np.exp(pikhat1)/factorial(7)
    T72amp = -gamma_amp_72*np.exp(pikhat2)/factorial(7)
    T73amp = -gamma_amp_73*np.exp(pikhat3)/factorial(7)
    T74amp = -gamma_amp_74*np.exp(pikhat4)/factorial(7)
    T75amp = -gamma_amp_75*np.exp(pikhat5)/factorial(7)
    T76amp = -gamma_amp_76*np.exp(pikhat6)/factorial(7)
    T77amp = -gamma_amp_77*np.exp(pikhat7)/factorial(7)
    T61amp = -gamma_amp_61*np.exp(pikhat1)/factorial(6)
    T62amp = -gamma_amp_62*np.exp(pikhat2)/factorial(6)
    T63amp = -gamma_amp_63*np.exp(pikhat3)/factorial(6)
    T64amp = -gamma_amp_64*np.exp(pikhat4)/factorial(6)
    T65amp = -gamma_amp_65*np.exp(pikhat5)/factorial(6)
    T66amp = -gamma_amp_66*np.exp(pikhat6)/factorial(6)
    T51amp = -gamma_amp_51*np.exp(pikhat1)/factorial(5)
    T52amp = -gamma_amp_52*np.exp(pikhat2)/factorial(5)
    T53amp = -gamma_amp_53*np.exp(pikhat3)/factorial(5)
    T54amp = -gamma_amp_54*np.exp(pikhat4)/factorial(5)
    T55amp = -gamma_amp_55*np.exp(pikhat5)/factorial(5)
    T55 = -gamma(5 + 1 - 2*1j*khat5)*np.exp(pikhat5)*(np.exp(2*1j*khat5*np.log(2*5*Omega*r0)))/factorial(5)
    T41amp = -gamma_amp_41*np.exp(pikhat1)/factorial(4)
    T42amp = -gamma_amp_42*np.exp(pikhat2)/factorial(4)
    T43amp = -gamma_amp_43*np.exp(pikhat3)/factorial(4)
    T43 = -gamma(4 + 1 - 2*1j*khat3)*np.exp(pikhat3)*(np.exp(2*1j*khat3*np.log(2*3*Omega*r0)))/factorial(4)
    T44amp = -gamma_amp_44*np.exp(pikhat4)/factorial(4)
    T44 = -gamma(4 + 1 - 2*1j*khat4)*np.exp(pikhat4)*(np.exp(2*1j*khat4*np.log(2*4*Omega*r0)))/factorial(4)
    T31amp = -gamma_amp_31*np.exp(pikhat1)/factorial(3)
    T32amp = -gamma_amp_32*np.exp(pikhat2)/factorial(3)
    T32 = -gamma(3 + 1 - 2*1j*khat2)*np.exp(pikhat2)*(np.exp(2*1j*khat2*np.log(2*2*Omega*r0)))/factorial(3)
    T33amp = -gamma_amp_33*np.exp(pikhat3)/factorial(3)
    T33 = -gamma(3 + 1 - 2*1j*khat3)*np.exp(pikhat3)*(np.exp(2*1j*khat3*np.log(2*3*Omega*r0)))/factorial(3)
    T21amp = -gamma_amp_21*np.exp(pikhat1)/factorial(2)
    T21 = -gamma(2 + 1 - 2*1j*khat1)*np.exp(pikhat1)*(np.exp(2*1j*khat1*np.log(2*1*Omega*r0)))/factorial(2)
    T22amp = -gamma_amp_22*np.exp(pikhat2)/factorial(2)
    T22 = -gamma(2 + 1 - 2*1j*khat2)*np.exp(pikhat2)*(np.exp(2*1j*khat2*np.log(2*2*Omega*r0)))/factorial(2)
    source_odd = vomega*pphi
    source_even = Heff
    hN81amp = eta*N81amp*c9*vphi**9*Y71amp
    hN82amp = eta*N82amp*c8*vphi**8*Y82amp
    hN83amp = eta*N83amp*c9*vphi**9*Y73amp
    hN84amp = eta*N84amp*c8*vphi**8*Y84amp
    hN85amp = eta*N85amp*c9*vphi**9*Y75amp
    hN86amp = eta*N86amp*c8*vphi**8*Y86amp
    hN87amp = eta*N87amp*c9*vphi**9*Y77amp
    hN88amp = eta*N88amp*c8*vphi**8*Y88amp
    hN71amp = eta*N71amp*c7*vphi**7*Y71amp
    hN72amp = eta*N72amp*c8*vphi**8*Y62amp
    hN73amp = eta*N73amp*c7*vphi**7*Y73amp
    hN74amp = eta*N74amp*c8*vphi**8*Y64amp
    hN75amp = eta*N75amp*c7*vphi**7*Y75amp
    hN76amp = eta*N76amp*c8*vphi**8*Y66amp
    hN77amp = eta*N77amp*c7*vphi**7*Y77amp
    hN61amp = eta*N61amp*c7*vphi**7*Y51amp
    hN62amp = eta*N62amp*c6*vphi**6*Y62amp
    hN63amp = eta*N63amp*c7*vphi**7*Y53amp
    hN64amp = eta*N64amp*c6*vphi**6*Y64amp
    hN65amp = eta*N65amp*c7*vphi**7*Y55amp
    hN66amp = eta*N66amp*c6*vphi**6*Y66amp
    hN51amp = eta*N51amp*c5*vphi**5*Y51amp
    hN52amp = eta*N52amp*c6*vphi**6*Y42amp
    hN53amp = eta*N53amp*c5*vphi**5*Y53amp
    hN54amp = eta*N54amp*c6*vphi**6*Y44amp
    hN55amp = eta*N55amp*c5*vphi**5*Y55amp
    hN55 = eta*N55*c5*vphi**5*Y55
    hN41amp = eta*N41amp*c5*vphi**5*Y31amp
    hN42amp = eta*N42amp*c4*vphi**4*Y42amp
    hN43amp = eta*N43amp*c5*vphi**5*Y33amp
    hN43 = eta*N43*c5*vphi**5*Y33
    hN44amp = eta*N44amp*c4*vphi**4*Y44amp
    hN44 = eta*N44*c4*vphi**4*Y44
    hN31amp = eta*N31amp*c3*vphi**3*Y31amp
    hN32amp = eta*N32amp*c4*vphi**4*Y22amp
    hN32 = eta*N32*c4*vphi**4*Y22
    hN33amp = eta*N33amp*c3*vphi**3*Y33amp
    hN33 = eta*N33*c3*vphi**3*Y33
    hN21amp = eta*N21amp*c3*vphi**3*Y11amp
    hN21 = eta*N21*c3*vphi**3*Y11
    hN22amp = eta*N22amp*c2*vphi**2*Y22amp
    hN22 = eta*N22*c2*vphi**2*Y22
    h81amp = hN81amp*source_odd*T81amp*f81amp
    h82amp = hN82amp*source_even*T82amp*f82amp
    h83amp = hN83amp*source_odd*T83amp*f83amp
    h84amp = hN84amp*source_even*T84amp*f84amp
    h85amp = hN85amp*source_odd*T85amp*f85amp
    h86amp = hN86amp*source_even*T86amp*f86amp
    h87amp = hN87amp*source_odd*T87amp*f87amp
    h88amp = hN88amp*source_even*T88amp*f88amp
    h71amp = hN71amp*source_even*T71amp*f71amp
    h72amp = hN72amp*source_odd*T72amp*f72amp
    h73amp = hN73amp*source_even*T73amp*f73amp
    h74amp = hN74amp*source_odd*T74amp*f74amp
    h75amp = hN75amp*source_even*T75amp*f75amp
    h76amp = hN76amp*source_odd*T76amp*f76amp
    h77amp = hN77amp*source_even*T77amp*f77amp
    h61amp = hN61amp*source_odd*T61amp*f61amp
    h62amp = hN62amp*source_even*T62amp*f62amp
    h63amp = hN63amp*source_odd*T63amp*f63amp
    h64amp = hN64amp*source_even*T64amp*f64amp
    h65amp = hN65amp*source_odd*T65amp*f65amp
    h66amp = hN66amp*source_even*T66amp*f66amp
    h51amp = hN51amp*source_even*T51amp*f51amp
    h52amp = hN52amp*source_odd*T52amp*f52amp
    h53amp = hN53amp*source_even*T53amp*f53amp
    h54amp = hN54amp*source_odd*T54amp*f54amp
    h55amp = hN55amp*source_even*T55amp*f55amp
    h55 = hN55*source_even*T55*f55*(np.cos(delta55) + 1j*np.sin(delta55))
    h41amp = hN41amp*source_odd*T41amp*f41amp
    h42amp = hN42amp*source_even*T42amp*f42amp
    h43amp = hN43amp*source_odd*T43amp*f43amp
    h43 = hN43*source_odd*T43*f43*(np.cos(delta43) + 1j*np.sin(delta43))
    h44amp = hN44amp*source_even*T44amp*f44amp
    h44 = hN44*source_even*T44*f44*(np.cos(delta44) + 1j*np.sin(delta44))
    h31amp = hN31amp*source_even*T31amp*f31amp
    h32amp = hN32amp*source_odd*T32amp*f32amp
    h32 = hN32*source_odd*T32*f32*(np.cos(delta32) + 1j*np.sin(delta32))
    h33amp = hN33amp*source_even*T33amp*f33amp
    h33 = hN33*source_even*T33*f33*(np.cos(delta33) + 1j*np.sin(delta33))
    h21amp = hN21amp*source_odd*T21amp*f21amp
    h21 = hN21*source_odd*T21*f21*(np.cos(delta21) + 1j*np.sin(delta21))
    h22amp = hN22amp*source_even*T22amp*f22amp
    h22 = hN22*source_even*T22*f22*(np.cos(delta22) + 1j*np.sin(delta22))
    flux=-(Omega/8/np.pi)*(2*2*h22amp**2+1*1*h21amp**2+3*3*h33amp**2+2*2*h32amp**2+1*1*h31amp**2+4*4*h44amp**2+3*3*h43amp**2+2*2*h42amp**2+1*1*h41amp**2+5*5*h55amp**2+4*4*h54amp**2+3*3*h53amp**2+2*2*h52amp**2+1*1*h51amp**2+6*6*h66amp**2+5*5*h65amp**2+4*4*h64amp**2+3*3*h63amp**2+2*2*h62amp**2+1*1*h61amp**2+7*7*h77amp**2+6*6*h76amp**2+5*5*h75amp**2+4*4*h74amp**2+3*3*h73amp**2+2*2*h72amp**2+1*1*h71amp**2+8*8*h88amp**2+7*7*h87amp**2+6*6*h86amp**2+5*5*h85amp**2+4*4*h84amp**2+3*3*h83amp**2+2*2*h82amp**2+1*1*h81amp**2)
    return flux