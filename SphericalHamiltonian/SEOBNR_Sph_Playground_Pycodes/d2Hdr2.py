from __future__ import division
import numpy as np
def compute_d2Hdr2(m1, m2, eta, r, theta, phi, pr, ptheta, pphi, S1r, S1theta, S1phi, S2r, S2theta, S2phi, KK, k0, k1, dSO, dSS, tortoise, EMgamma):
    M = m1+m2
    mu = m1*m2/M
    eta = mu/M
    u = 1/r
    sigmastar3 = m2/m1*S1phi+m1/m2*S2phi
    sigmastar2 = m2/m1*S1theta+m1/m2*S2theta
    sigmastar1 = m2/m1*S1r+m1/m2*S2r
    sigma3 = S1phi+S2phi##Sid:Snp.pinsshouldbeinpolardirections
    sigma2 = S1theta+S2theta
    sigma1 = S1r+S2r
    Skerr3 = sigma3##Sid:Snp.pinsshouldbeinpolardirections
    Skerr2 = sigma2
    Skerr1 = sigma1
    Skerrmag = np.sqrt(Skerr1*Skerr1+Skerr2*Skerr2+Skerr3*Skerr3)
    Skerrhat3 = Skerr3/Skerrmag
    Skerrhat2 = Skerr2/Skerrmag
    Skerrhat1 = Skerr1/Skerrmag
    a = Skerrmag
    n3 = 0
    n2 = 0
    n1 = 1
    e33 = Skerrhat3##Sid:insphericalpolar,nisjust(1,0,0)
    e32 = Skerrhat2
    e31 = Skerrhat1
    xi3 = e31*n2-e32*n1
    xi2 = e33*n1-e31*n3
    xi1 = e32*n3-e33*n2
    v3 = n1*xi2-n2*xi1##Sid:Testingoutatypohere
    v2 = n3*xi1-n1*xi3
    v1 = n2*xi3-n3*xi2
    costhetaBL = e31*n1+e32*n2+e33*n3
    sin2thetaBL = 1-costhetaBL*costhetaBL
    xisq = sin2thetaBL
    w2 = a*a+r*r
    Sigma = r*r+a*a*costhetaBL*costhetaBL
    sintheta = np.sin(theta)##Sid:costhetaBLsubstitution
    Dinv = 1+np.log(1+6*eta*u*u+2*(26-3*eta)*eta*u*u*u)
    omegatilde = 2*a*r
    K = 1.712-1.803949138004582*eta-39.77229225266885*eta*eta+103.16588921239249*eta*eta*eta
    etaKminus1 = eta*K-1
    Delta0 = K*(eta*K-2)
    Delta1 = -2*etaKminus1*(K+Delta0)
    Delta2 = np.true_divide(1,2)*Delta1*(Delta1-4*etaKminus1)-a*a*etaKminus1*etaKminus1*Delta0
    Delta3 = -np.true_divide(1,3)*Delta1*Delta1*Delta1+etaKminus1*Delta1*Delta1+Delta2*Delta1-2*etaKminus1*(Delta2-etaKminus1)-a*a*etaKminus1*etaKminus1*Delta1
    Delta4 = np.true_divide(1,12)*(6*a*a*(Delta1*Delta1-2*Delta2)*etaKminus1*etaKminus1+3*Delta1*Delta1*Delta1*Delta1-8*etaKminus1*Delta1*Delta1*Delta1-12*Delta2*Delta1*Delta1+12*(2*etaKminus1*Delta2+Delta3)*Delta1+12*(np.true_divide(94,3)-np.true_divide(41,32)*np.pi*np.pi)*etaKminus1*etaKminus1+6*(Delta2*Delta2-4*Delta3*etaKminus1))
    Delta5 = etaKminus1*etaKminus1*((np.true_divide(-4237,60)+np.true_divide(128,5)*EMgamma+np.true_divide(2275,512)*np.pi*np.pi-np.true_divide(1,3)*a*a*(Delta1*Delta1*Delta1-3*Delta1*Delta2+3*Delta3)-(Delta1*Delta1*Delta1*Delta1*Delta1-5*Delta1*Delta1*Delta1*Delta2+5*Delta1*Delta2*Delta2+5*Delta1*Delta1*Delta3-5*Delta2*Delta3-5*Delta1*Delta4)/(5*etaKminus1*etaKminus1)+(Delta1*Delta1*Delta1*Delta1-4*Delta1*Delta1*Delta2+2*Delta2*Delta2+4*Delta1*Delta3-4*Delta4)/(2*etaKminus1)+np.true_divide(256,5)*np.log(2)))
    Delta5l = etaKminus1*etaKminus1*np.true_divide(64,5)
    logarg = u*(Delta1+u*(Delta2+u*(Delta3+u*(Delta4+u*(Delta5+Delta5l*np.log(u))))))
    Deltaucalib = 1+eta*(Delta0+np.log(1+logarg))
    Deltaucalibprime = -eta*u*u*(Delta1+u*(2*Delta2+u*(3*Delta3+u*(4*Delta4+u*(5*(Delta5+Delta5l*np.log(u)))))))/(1+logarg)
    Deltaubar = a*a*u*u+(2*u+1/etaKminus1)/etaKminus1
    Deltaubarprime = -2*a*a*u*u*u-2*u*u/(etaKminus1)
    Deltau = Deltaubar*Deltaucalib
    Deltauprime = Deltaubarprime*Deltaucalib+Deltaubar*Deltaucalibprime
    Deltatprime = 2*r*Deltau+r*r*Deltauprime
    Deltat = r*r*Deltau
    Deltar = Deltat*Dinv
    Lambt = w2*w2-a*a*Deltat*sin2thetaBL
    csi = np.sqrt(Deltar*Deltat)/w2##Sid:sin2thetaBLsubstitution
    csi1 = 1+(1-abs(1-tortoise))*(csi-1)
    csi2 = 1+(np.true_divide(1,2)-np.true_divide(1,2)*np.sign(np.true_divide(3,2)-tortoise))*(csi-1)
    prT = csi2*(pr*n1+ptheta*n2/r+pphi*n3/r/sintheta)
    phat3 = pphi/r/sintheta+prT*(1-1/csi1)*n3##Sid:Rewritewithsphericalmomenta
    phat2 = ptheta/r+prT*(1-1/csi1)*n2
    phat1 = pr+prT*(1-1/csi1)*n1
    pdotxir = (phat1*xi1+phat2*xi2+phat3*xi3)*r##Sid:Rewritewithsphericalmomenta
    pdotn = phat1*n1+phat2*n2+phat3*n3
    pdotvr = (phat1*v1+phat2*v2+phat3*v3)*r
    Qcoeff2 = 1/(Sigma*sin2thetaBL)
    Qcoeff1 = Sigma/(Lambt*sin2thetaBL)##Sid:sin2thetaBLsubstitution
    DrSipn2 = Deltar*pdotn*pdotn/Sigma##Sid:sin2thetaBLsubstitution
    Q = 1+DrSipn2+Qcoeff1*pdotxir*pdotxir+Qcoeff2*pdotvr*pdotvr
    Qminus1 = Q-1
    Jtilde = np.sqrt(Deltar)
    exp2mu = Sigma
    expmu = np.sqrt(exp2mu)
    Brtilde = (np.sqrt(Deltar)*Deltatprime-2*Deltat)/(2*np.sqrt(Deltar*Deltat))
    Btilde = np.sqrt(Deltat)
    exp2nu = Deltat*Sigma/Lambt
    expnu = np.sqrt(exp2nu)
    omega = omegatilde/Lambt
    omegatildeprime = 2*a
    Lambtprime = 4*(a*a+r*r)*r-2*a*a*Deltatprime*sin2thetaBL
    mucostheta = a*a*costhetaBL/Sigma##Sid:sin2thetaBLsubstitution
    nucostheta = a*a*w2*costhetaBL*(w2-Deltat)/(Lambt*Sigma)##Sid:costhetaBLsubstitution
    omegacostheta = -2*a*a*costhetaBL*Deltat*omegatilde/(Lambt*Lambt)##Sid:costhetaBLsubstitution
    mur = r/Sigma-1/np.sqrt(Deltar)##Sid:costhetaBLsubstitution
    nur = r/Sigma+w2*(w2*Deltatprime-4*r*Deltat)/(2*Lambt*Deltat)
    omegar = (Lambt*omegatildeprime-Lambtprime*omegatilde)/(Lambt*Lambt)
    dSO = -74.71-156.*eta+627.5*eta*eta
    sigmacoeffTerm3 = eta*dSO*u*u*u
    sigmacoeffTerm2 = eta/(144*r*r)*(-896+r*(-436*Qminus1-96*DrSipn2+r*(-45*Qminus1*Qminus1+36*Qminus1*DrSipn2))+eta*(-336+r*(204*Qminus1-882*DrSipn2+r*(810*DrSipn2*DrSipn2-234*Qminus1*DrSipn2))))
    sigmacoeffTerm1 = eta/12*(-8*u+3*Qminus1-36*DrSipn2)
    sigmacoeff = sigmacoeffTerm1+sigmacoeffTerm2+sigmacoeffTerm3##Sid:Again,multiplybyuinstead
    sigmastarcoeffTerm2 = eta/(72*r*r)*(706+r*(-206*Qminus1+282*DrSipn2+r*Qminus1*(96*DrSipn2-23*Qminus1))+eta*(-54+r*(120*Qminus1-324*DrSipn2+r*(360*DrSipn2*DrSipn2+Qminus1*(-126*DrSipn2-3*Qminus1)))))
    sigmastarcoeffTerm1 = eta/12*(14*u+4*Qminus1-30*DrSipn2)
    sigmastarcoeff = sigmastarcoeffTerm1+sigmastarcoeffTerm2##Sid:Multiplybyuoncemore
    Deltasigmastar3 = sigmastar3*sigmastarcoeff+sigma3*sigmacoeff
    Deltasigmastar2 = sigmastar2*sigmastarcoeff+sigma2*sigmacoeff
    Deltasigmastar1 = sigmastar1*sigmastarcoeff+sigma1*sigmacoeff
    Sstar3 = sigmastar3+Deltasigmastar3
    Sstar2 = sigmastar2+Deltasigmastar2
    Sstar1 = sigmastar1+Deltasigmastar1
    S3 = Sstar3
    S2 = Sstar2
    S1 = Sstar1
    Sstardotn = Sstar1*n1+Sstar2*n2+Sstar3*n3
    SdotSkerrhat = S1*Skerrhat1+S2*Skerrhat2+S3*Skerrhat3
    Sdotn = S1*n1+S2*n2+S3*n3
    Sdotv = S1*v1+S2*v2+S3*v3
    Sdotxi = S1*xi1+S2*xi2+S3*xi3
    HdsumTerm2 = 3*Sstardotn*Sstardotn
    HdsumTerm1 = Sstar1*Sstar1+Sstar2*Sstar2+Sstar3*Sstar3
    Hdsum = HdsumTerm1-HdsumTerm2
    Hdcoeff = np.true_divide(1,2)*(u*u*u)
    Q4 = 2*prT*prT*prT*prT*u*u*(4-3*eta)*eta##Sid:Whydividebyrwhenyoucanmultiplybyu?
    gammappsum = Deltar/Sigma*pdotn*pdotn+1/Sigma*pdotvr*pdotvr/sin2thetaBL+Sigma/Lambt/sin2thetaBL*pdotxir*pdotxir
    Hnsradicand = 1+gammappsum+Q4##Sid:sin2thetaBLsubstitution
    alpha = np.sqrt(Deltat*Sigma/Lambt)
    betapsum = omegatilde*pdotxir/Lambt
    HssTerm3 = expmu*expnu*pdotxir*(Jtilde*pdotn*Sdotxi*Btilde-expmu*expnu*pdotxir*Sdotn)+(pdotvr*(Sdotn*pdotvr-Jtilde*pdotn*Sdotv)-exp2mu*(np.sqrt(Q)+Q)*Sdotn*xisq)*Btilde*Btilde##Sid:Changedtopdotxirtoeliminatepphi
    HssTerm3coeff = omegacostheta/(2*exp2mu*expmu*expnu*Btilde*(Q+np.sqrt(Q)))
    HssTerm2 = expmu*pdotxir*(expmu*exp2nu*pdotxir*Sdotv-expnu*pdotvr*Sdotxi*Btilde)+xisq*Btilde*Btilde*(exp2mu*(np.sqrt(Q)+Q)*Sdotv+Jtilde*pdotn*(pdotvr*Sdotn-Jtilde*pdotn*Sdotv))
    HssTerm2coeff = Jtilde*omegar/(2*exp2mu*expmu*expnu*Btilde*(Q+np.sqrt(Q))*xisq)
    HssTerm1 = omega*SdotSkerrhat
    Hss = HssTerm1+HssTerm2coeff*HssTerm2+HssTerm3coeff*HssTerm3
    HsoTerm2c = Jtilde*Brtilde*expmu*expnu*pdotxir*(np.sqrt(Q)+1)*Sdotv
    HsoTerm2b = expmu*expnu*pdotxir*(2*np.sqrt(Q)+1)*(Jtilde*nur*Sdotv-nucostheta*Sdotn*xisq)*Btilde
    HsoTerm2a = Sdotxi*Jtilde*(mur*pdotvr*(np.sqrt(Q)+1)-mucostheta*pdotn*xisq-np.sqrt(Q)*(nur*pdotvr+(mucostheta-nucostheta)*pdotn*xisq))*Btilde*Btilde
    HsoTerm2 = HsoTerm2a+HsoTerm2b-HsoTerm2c
    HsoTerm2coeff = expnu/(exp2mu*Btilde*Btilde*(Q+np.sqrt(Q))*xisq)
    HsoTerm1 = exp2nu*(expmu*expnu-Btilde)*pdotxir*SdotSkerrhat/(expmu*Btilde*Btilde*np.sqrt(Q)*xisq)
    Hso = HsoTerm1+HsoTerm2coeff*HsoTerm2
    Hd = Hdcoeff*Hdsum
    Hns = betapsum+alpha*np.sqrt(Hnsradicand)
    Hs = Hso+Hss
    dSS = 8.127-154.2*eta+830.8*eta*eta
    Heff = Hs+Hns-Hd+dSS*eta*u*u*u*u*(S1r*S1r+S1theta*S1theta+S1phi*S1phi+S2r*S2r+S2theta*S2theta+S2phi*S2phi)
    u_r = -1/r**2
    w2_r = 2*r
    Sigma_r = 2*r
    Dinv_r = (3*eta*u**2*u_r*(-6*eta+52)+12*eta*u*u_r)/(eta*u**3*(-6*eta+52)+6*eta*u**2+1)
    omegatilde_r = 2*a
    logarg_r = u*(u*(u*(u*(Delta5l*u_r+u_r*(Delta5+Delta5l*np.log(u)))+u_r*(Delta4+u*(Delta5+Delta5l*np.log(u))))+u_r*(Delta3+u*(Delta4+u*(Delta5+Delta5l*np.log(u)))))+u_r*(Delta2+u*(Delta3+u*(Delta4+u*(Delta5+Delta5l*np.log(u))))))+u_r*(Delta1+u*(Delta2+u*(Delta3+u*(Delta4+u*(Delta5+Delta5l*np.log(u))))))
    Deltaucalib_r = eta*logarg_r/(logarg+1)
    Deltaucalibprime_r = eta*logarg_r*u**2*(Delta1+u*(2*Delta2+u*(3*Delta3+u*(4*Delta4+u*(5*Delta5+5*Delta5l*np.log(u))))))/(logarg+1)**2-eta*u**2*(u*(u*(u*(5*Delta5l*u_r+u_r*(5*Delta5+5*Delta5l*np.log(u)))+u_r*(4*Delta4+u*(5*Delta5+5*Delta5l*np.log(u))))+u_r*(3*Delta3+u*(4*Delta4+u*(5*Delta5+5*Delta5l*np.log(u)))))+u_r*(2*Delta2+u*(3*Delta3+u*(4*Delta4+u*(5*Delta5+5*Delta5l*np.log(u))))))/(logarg+1)-2*eta*u*u_r*(Delta1+u*(2*Delta2+u*(3*Delta3+u*(4*Delta4+u*(5*Delta5+5*Delta5l*np.log(u))))))/(logarg+1)
    Deltaubar_r = 2*a**2*u*u_r+2*u_r/etaKminus1
    Deltaubarprime_r = -6*a**2*u**2*u_r-4*u*u_r/etaKminus1
    Deltau_r = Deltaubar*Deltaucalib_r+Deltaubar_r*Deltaucalib
    Deltauprime_r = Deltaubar*Deltaucalibprime_r+Deltaubarprime*Deltaucalib_r+Deltaubarprime_r*Deltaucalib+Deltaubar_r*Deltaucalibprime
    Deltatprime_r = 2*Deltau+2*Deltauprime*r+Deltauprime_r*r**2+2*Deltau_r*r
    Deltat_r = 2*Deltau*r+Deltau_r*r**2
    Deltar_r = Deltat*Dinv_r+Deltat_r*Dinv
    Lambt_r = -Deltat_r*a**2*sin2thetaBL+2*w2*w2_r
    csi_r = -w2_r*np.sqrt(Deltar*Deltat)/w2**2+np.sqrt(Deltar*Deltat)*(Deltar*Deltat_r/2+Deltar_r*Deltat/2)/(Deltar*Deltat*w2)
    csi1_r = csi_r*(-abs(-tortoise+1)+1)
    csi2_r = csi_r*(-np.sign(-tortoise+3/2)/2+1/2)
    prT_r = csi2*(-n2*ptheta/r**2-n3*pphi/(r**2*sintheta))+csi2_r*(n1*pr+n2*ptheta/r+n3*pphi/(r*sintheta))
    phat3_r = n3*prT_r*(1-1/csi1)-pphi/(r**2*sintheta)+csi1_r*n3*prT/csi1**2
    phat2_r = n2*prT_r*(1-1/csi1)-ptheta/r**2+csi1_r*n2*prT/csi1**2
    phat1_r = n1*prT_r*(1-1/csi1)+csi1_r*n1*prT/csi1**2
    pdotxir_r = phat1*xi1+phat2*xi2+phat3*xi3+r*(phat1_r*xi1+phat2_r*xi2+phat3_r*xi3)
    pdotn_r = n1*phat1_r+n2*phat2_r+n3*phat3_r
    pdotvr_r = phat1*v1+phat2*v2+phat3*v3+r*(phat1_r*v1+phat2_r*v2+phat3_r*v3)
    Qcoeff2_r = -Sigma_r/(Sigma**2*sin2thetaBL)
    Qcoeff1_r = Sigma_r/(Lambt*sin2thetaBL)-Lambt_r*Sigma/(Lambt**2*sin2thetaBL)
    DrSipn2_r = 2*Deltar*pdotn*pdotn_r/Sigma-Deltar*Sigma_r*pdotn**2/Sigma**2+Deltar_r*pdotn**2/Sigma
    Q_r = DrSipn2_r+2*Qcoeff1*pdotxir*pdotxir_r+Qcoeff1_r*pdotxir**2+2*Qcoeff2*pdotvr*pdotvr_r+Qcoeff2_r*pdotvr**2
    Qminus1_r = Q_r
    Jtilde_r = Deltar_r/(2*np.sqrt(Deltar))
    exp2mu_r = Sigma_r
    expmu_r = exp2mu_r/(2*np.sqrt(exp2mu))
    Brtilde_r = (np.sqrt(Deltar)*Deltatprime_r-2*Deltat_r+Deltar_r*Deltatprime/(2*np.sqrt(Deltar)))/(2*np.sqrt(Deltar*Deltat))+(np.sqrt(Deltar)*Deltatprime-2*Deltat)*(-Deltar*Deltat_r/2-Deltar_r*Deltat/2)/(2*Deltar*Deltat*np.sqrt(Deltar*Deltat))
    Btilde_r = Deltat_r/(2*np.sqrt(Deltat))
    exp2nu_r = Deltat*Sigma_r/Lambt-Deltat*Lambt_r*Sigma/Lambt**2+Deltat_r*Sigma/Lambt
    expnu_r = exp2nu_r/(2*np.sqrt(exp2nu))
    omega_r = omegatilde_r/Lambt-Lambt_r*omegatilde/Lambt**2
    Lambtprime_r = -2*Deltatprime_r*a**2*sin2thetaBL+4*a**2+12*r**2
    mucostheta_r = -Sigma_r*a**2*costhetaBL/Sigma**2
    nucostheta_r = a**2*costhetaBL*w2*(-Deltat_r+w2_r)/(Lambt*Sigma)+a**2*costhetaBL*w2_r*(-Deltat+w2)/(Lambt*Sigma)-Sigma_r*a**2*costhetaBL*w2*(-Deltat+w2)/(Lambt*Sigma**2)-Lambt_r*a**2*costhetaBL*w2*(-Deltat+w2)/(Lambt**2*Sigma)
    omegacostheta_r = -2*Deltat*a**2*costhetaBL*omegatilde_r/Lambt**2+4*Deltat*Lambt_r*a**2*costhetaBL*omegatilde/Lambt**3-2*Deltat_r*a**2*costhetaBL*omegatilde/Lambt**2
    mur_r = 1/Sigma-Sigma_r*r/Sigma**2+Deltar_r/(2*Deltar**(3/2))
    nur_r = 1/Sigma-Sigma_r*r/Sigma**2+w2*(-4*Deltat+Deltatprime*w2_r+Deltatprime_r*w2-4*Deltat_r*r)/(2*Deltat*Lambt)+w2_r*(-4*Deltat*r+Deltatprime*w2)/(2*Deltat*Lambt)-Lambt_r*w2*(-4*Deltat*r+Deltatprime*w2)/(2*Deltat*Lambt**2)-Deltat_r*w2*(-4*Deltat*r+Deltatprime*w2)/(2*Deltat**2*Lambt)
    omegar_r = (-Lambtprime*omegatilde_r-Lambtprime_r*omegatilde+Lambt_r*omegatildeprime)/Lambt**2+Lambt_r*(-2*Lambt*omegatildeprime+2*Lambtprime*omegatilde)/Lambt**3
    sigmacoeffTerm3_r = 3*dSO*eta*u**2*u_r
    sigmacoeffTerm2_r = eta*(-96*DrSipn2-436*Qminus1+eta*(-882*DrSipn2+204*Qminus1+r*(810*DrSipn2**2-234*DrSipn2*Qminus1)+r*(810*DrSipn2**2-234*DrSipn2*Qminus1-882*DrSipn2_r+204*Qminus1_r+r*(1620*DrSipn2*DrSipn2_r-234*DrSipn2*Qminus1_r-234*DrSipn2_r*Qminus1)))+r*(36*DrSipn2*Qminus1-45*Qminus1**2)+r*(36*DrSipn2*Qminus1-96*DrSipn2_r-45*Qminus1**2-436*Qminus1_r+r*(36*DrSipn2*Qminus1_r+36*DrSipn2_r*Qminus1-90*Qminus1*Qminus1_r)))/(144*r**2)-eta*(eta*(r*(-882*DrSipn2+204*Qminus1+r*(810*DrSipn2**2-234*DrSipn2*Qminus1))-336)+r*(-96*DrSipn2-436*Qminus1+r*(36*DrSipn2*Qminus1-45*Qminus1**2))-896)/(72*r**3)
    sigmacoeffTerm1_r = eta*(-36*DrSipn2_r+3*Qminus1_r-8*u_r)/12
    sigmacoeff_r = sigmacoeffTerm1_r+sigmacoeffTerm2_r+sigmacoeffTerm3_r
    sigmastarcoeffTerm2_r = eta*(282*DrSipn2+Qminus1*r*(96*DrSipn2-23*Qminus1)-206*Qminus1+eta*(-324*DrSipn2+120*Qminus1+r*(360*DrSipn2**2+Qminus1*(-126*DrSipn2-3*Qminus1))+r*(360*DrSipn2**2-324*DrSipn2_r+Qminus1*(-126*DrSipn2-3*Qminus1)+120*Qminus1_r+r*(720*DrSipn2*DrSipn2_r+Qminus1*(-126*DrSipn2_r-3*Qminus1_r)+Qminus1_r*(-126*DrSipn2-3*Qminus1))))+r*(282*DrSipn2_r+Qminus1*r*(96*DrSipn2_r-23*Qminus1_r)+Qminus1*(96*DrSipn2-23*Qminus1)+Qminus1_r*r*(96*DrSipn2-23*Qminus1)-206*Qminus1_r))/(72*r**2)-eta*(eta*(r*(-324*DrSipn2+120*Qminus1+r*(360*DrSipn2**2+Qminus1*(-126*DrSipn2-3*Qminus1)))-54)+r*(282*DrSipn2+Qminus1*r*(96*DrSipn2-23*Qminus1)-206*Qminus1)+706)/(36*r**3)
    sigmastarcoeffTerm1_r = eta*(-30*DrSipn2_r+4*Qminus1_r+14*u_r)/12
    sigmastarcoeff_r = sigmastarcoeffTerm1_r+sigmastarcoeffTerm2_r
    Deltasigmastar3_r = sigma3*sigmacoeff_r+sigmastar3*sigmastarcoeff_r
    Deltasigmastar2_r = sigma2*sigmacoeff_r+sigmastar2*sigmastarcoeff_r
    Deltasigmastar1_r = sigma1*sigmacoeff_r+sigmastar1*sigmastarcoeff_r
    Sstar3_r = Deltasigmastar3_r
    Sstar2_r = Deltasigmastar2_r
    Sstar1_r = Deltasigmastar1_r
    S3_r = Sstar3_r
    S2_r = Sstar2_r
    S1_r = Sstar1_r
    Sstardotn_r = Sstar1_r*n1+Sstar2_r*n2+Sstar3_r*n3
    SdotSkerrhat_r = S1_r*Skerrhat1+S2_r*Skerrhat2+S3_r*Skerrhat3
    Sdotn_r = S1_r*n1+S2_r*n2+S3_r*n3
    Sdotv_r = S1_r*v1+S2_r*v2+S3_r*v3
    Sdotxi_r = S1_r*xi1+S2_r*xi2+S3_r*xi3
    HdsumTerm2_r = 6*Sstardotn*Sstardotn_r
    HdsumTerm1_r = 2*Sstar1*Sstar1_r+2*Sstar2*Sstar2_r+2*Sstar3*Sstar3_r
    Hdsum_r = HdsumTerm1_r-HdsumTerm2_r
    Hdcoeff_r = 3*u**2*u_r/2
    Q4_r = 4*eta*prT**4*u*u_r*(-3*eta+4)+8*eta*prT**3*prT_r*u**2*(-3*eta+4)
    gammappsum_r = 2*Deltar*pdotn*pdotn_r/Sigma-Deltar*Sigma_r*pdotn**2/Sigma**2+Deltar_r*pdotn**2/Sigma+2*pdotvr*pdotvr_r/(Sigma*sin2thetaBL)-Sigma_r*pdotvr**2/(Sigma**2*sin2thetaBL)+2*Sigma*pdotxir*pdotxir_r/(Lambt*sin2thetaBL)+Sigma_r*pdotxir**2/(Lambt*sin2thetaBL)-Lambt_r*Sigma*pdotxir**2/(Lambt**2*sin2thetaBL)
    Hnsradicand_r = Q4_r+gammappsum_r
    alpha_r = Lambt*np.sqrt(Deltat*Sigma/Lambt)*(Deltat*Sigma_r/(2*Lambt)-Deltat*Lambt_r*Sigma/(2*Lambt**2)+Deltat_r*Sigma/(2*Lambt))/(Deltat*Sigma)
    betapsum_r = omegatilde*pdotxir_r/Lambt+omegatilde_r*pdotxir/Lambt-Lambt_r*omegatilde*pdotxir/Lambt**2
    HssTerm3_r = Btilde**2*(Sdotn*exp2mu*xisq*(-Q_r-Q_r/(2*np.sqrt(Q)))+Sdotn*exp2mu_r*xisq*(-np.sqrt(Q)-Q)+Sdotn_r*exp2mu*xisq*(-np.sqrt(Q)-Q)+pdotvr*(-Jtilde*Sdotv*pdotn_r-Jtilde*Sdotv_r*pdotn-Jtilde_r*Sdotv*pdotn+Sdotn*pdotvr_r+Sdotn_r*pdotvr)+pdotvr_r*(-Jtilde*Sdotv*pdotn+Sdotn*pdotvr))+Btilde*Btilde_r*(-2*Sdotn*exp2mu*xisq*(np.sqrt(Q)+Q)+2*pdotvr*(-Jtilde*Sdotv*pdotn+Sdotn*pdotvr))+expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_r+Btilde*Jtilde*Sdotxi_r*pdotn+Btilde*Jtilde_r*Sdotxi*pdotn+Btilde_r*Jtilde*Sdotxi*pdotn-Sdotn*expmu*expnu*pdotxir_r-Sdotn*expmu*expnu_r*pdotxir-Sdotn*expmu_r*expnu*pdotxir-Sdotn_r*expmu*expnu*pdotxir)+expmu*expnu*pdotxir_r*(Btilde*Jtilde*Sdotxi*pdotn-Sdotn*expmu*expnu*pdotxir)+expmu*expnu_r*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn-Sdotn*expmu*expnu*pdotxir)+expmu_r*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn-Sdotn*expmu*expnu*pdotxir)
    HssTerm3coeff_r = omegacostheta*(-Q_r-Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*(np.sqrt(Q)+Q)**2)+omegacostheta_r/(Btilde*exp2mu*expmu*expnu*(2*np.sqrt(Q)+2*Q))-expnu_r*omegacostheta/(Btilde*exp2mu*expmu*expnu**2*(2*np.sqrt(Q)+2*Q))-expmu_r*omegacostheta/(Btilde*exp2mu*expmu**2*expnu*(2*np.sqrt(Q)+2*Q))-exp2mu_r*omegacostheta/(Btilde*exp2mu**2*expmu*expnu*(2*np.sqrt(Q)+2*Q))-Btilde_r*omegacostheta/(Btilde**2*exp2mu*expmu*expnu*(2*np.sqrt(Q)+2*Q))
    HssTerm2_r = Btilde**2*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_r-Jtilde*Sdotv_r*pdotn-Jtilde_r*Sdotv*pdotn+Sdotn*pdotvr_r+Sdotn_r*pdotvr)+Jtilde*pdotn_r*(-Jtilde*Sdotv*pdotn+Sdotn*pdotvr)+Jtilde_r*pdotn*(-Jtilde*Sdotv*pdotn+Sdotn*pdotvr)+Sdotv*exp2mu*(Q_r+Q_r/(2*np.sqrt(Q)))+Sdotv*exp2mu_r*(np.sqrt(Q)+Q)+Sdotv_r*exp2mu*(np.sqrt(Q)+Q))+Btilde*Btilde_r*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn+Sdotn*pdotvr)+2*Sdotv*exp2mu*(np.sqrt(Q)+Q))+expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_r-Btilde*Sdotxi*expnu_r*pdotvr-Btilde*Sdotxi_r*expnu*pdotvr-Btilde_r*Sdotxi*expnu*pdotvr+Sdotv*exp2nu*expmu*pdotxir_r+Sdotv*exp2nu*expmu_r*pdotxir+Sdotv*exp2nu_r*expmu*pdotxir+Sdotv_r*exp2nu*expmu*pdotxir)+expmu*pdotxir_r*(-Btilde*Sdotxi*expnu*pdotvr+Sdotv*exp2nu*expmu*pdotxir)+expmu_r*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr+Sdotv*exp2nu*expmu*pdotxir)
    HssTerm2coeff_r = Jtilde*omegar*(-Q_r-Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*xisq*(np.sqrt(Q)+Q)**2)+Jtilde*omegar_r/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q)+2*Q))-Jtilde*expnu_r*omegar/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q)+2*Q))-Jtilde*expmu_r*omegar/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q)+2*Q))-Jtilde*exp2mu_r*omegar/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q)+2*Q))+Jtilde_r*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q)+2*Q))-Btilde_r*Jtilde*omegar/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q)+2*Q))
    HssTerm1_r = SdotSkerrhat*omega_r+SdotSkerrhat_r*omega
    Hss_r = HssTerm1_r+HssTerm2*HssTerm2coeff_r+HssTerm2coeff*HssTerm2_r+HssTerm3*HssTerm3coeff_r+HssTerm3coeff*HssTerm3_r
    HsoTerm2c_r = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_r*(np.sqrt(Q)+1)+Brtilde*Jtilde*Sdotv*expmu*expnu_r*pdotxir*(np.sqrt(Q)+1)+Brtilde*Jtilde*Sdotv*expmu_r*expnu*pdotxir*(np.sqrt(Q)+1)+Brtilde*Jtilde*Sdotv_r*expmu*expnu*pdotxir*(np.sqrt(Q)+1)+Brtilde*Jtilde*Q_r*Sdotv*expmu*expnu*pdotxir/(2*np.sqrt(Q))+Brtilde*Jtilde_r*Sdotv*expmu*expnu*pdotxir*(np.sqrt(Q)+1)+Brtilde_r*Jtilde*Sdotv*expmu*expnu*pdotxir*(np.sqrt(Q)+1)
    HsoTerm2b_r = Btilde*expmu*expnu*pdotxir*(2*np.sqrt(Q)+1)*(Jtilde*Sdotv*nur_r+Jtilde*Sdotv_r*nur+Jtilde_r*Sdotv*nur-Sdotn*nucostheta_r*xisq-Sdotn_r*nucostheta*xisq)+Btilde*expmu*expnu*pdotxir_r*(2*np.sqrt(Q)+1)*(Jtilde*Sdotv*nur-Sdotn*nucostheta*xisq)+Btilde*expmu*expnu_r*pdotxir*(2*np.sqrt(Q)+1)*(Jtilde*Sdotv*nur-Sdotn*nucostheta*xisq)+Btilde*expmu_r*expnu*pdotxir*(2*np.sqrt(Q)+1)*(Jtilde*Sdotv*nur-Sdotn*nucostheta*xisq)+Btilde*Q_r*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur-Sdotn*nucostheta*xisq)/np.sqrt(Q)+Btilde_r*expmu*expnu*pdotxir*(2*np.sqrt(Q)+1)*(Jtilde*Sdotv*nur-Sdotn*nucostheta*xisq)
    HsoTerm2a_r = Btilde**2*Jtilde*Sdotxi*(-np.sqrt(Q)*(nur*pdotvr_r+nur_r*pdotvr+pdotn*xisq*(mucostheta_r-nucostheta_r)+pdotn_r*xisq*(mucostheta-nucostheta))-mucostheta*pdotn_r*xisq-mucostheta_r*pdotn*xisq+mur*pdotvr_r*(np.sqrt(Q)+1)+mur_r*pdotvr*(np.sqrt(Q)+1)+Q_r*mur*pdotvr/(2*np.sqrt(Q))+Q_r*(-nur*pdotvr-pdotn*xisq*(mucostheta-nucostheta))/(2*np.sqrt(Q)))+Btilde**2*Jtilde*Sdotxi_r*(np.sqrt(Q)*(-nur*pdotvr-pdotn*xisq*(mucostheta-nucostheta))-mucostheta*pdotn*xisq+mur*pdotvr*(np.sqrt(Q)+1))+Btilde**2*Jtilde_r*Sdotxi*(np.sqrt(Q)*(-nur*pdotvr-pdotn*xisq*(mucostheta-nucostheta))-mucostheta*pdotn*xisq+mur*pdotvr*(np.sqrt(Q)+1))+Btilde*Btilde_r*Jtilde*Sdotxi*(2*np.sqrt(Q)*(-nur*pdotvr-pdotn*xisq*(mucostheta-nucostheta))-2*mucostheta*pdotn*xisq+2*mur*pdotvr*(np.sqrt(Q)+1))
    HsoTerm2_r = HsoTerm2a_r+HsoTerm2b_r-HsoTerm2c_r
    HsoTerm2coeff_r = expnu*(-Q_r-Q_r/(2*np.sqrt(Q)))/(Btilde**2*exp2mu*xisq*(np.sqrt(Q)+Q)**2)+expnu_r/(Btilde**2*exp2mu*xisq*(np.sqrt(Q)+Q))-exp2mu_r*expnu/(Btilde**2*exp2mu**2*xisq*(np.sqrt(Q)+Q))-2*Btilde_r*expnu/(Btilde**3*exp2mu*xisq*(np.sqrt(Q)+Q))
    HsoTerm1_r = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_r+expmu*expnu_r+expmu_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq)+SdotSkerrhat*exp2nu*pdotxir_r*(-Btilde+expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq)-SdotSkerrhat*exp2nu*expmu_r*pdotxir*(-Btilde+expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq)+SdotSkerrhat*exp2nu_r*pdotxir*(-Btilde+expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq)+SdotSkerrhat_r*exp2nu*pdotxir*(-Btilde+expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq)-Q_r*SdotSkerrhat*exp2nu*pdotxir*(-Btilde+expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq)-Btilde_r*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde+2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq)
    Hso_r = HsoTerm1_r+HsoTerm2*HsoTerm2coeff_r+HsoTerm2coeff*HsoTerm2_r
    Hd_r = Hdcoeff*Hdsum_r+Hdcoeff_r*Hdsum
    Hns_r = np.sqrt(Hnsradicand)*alpha_r+betapsum_r+Hnsradicand_r*alpha/(2*np.sqrt(Hnsradicand))
    Hs_r = Hso_r+Hss_r
    Heff_r = -Hd_r+Hns_r+Hs_r+4*dSS*eta*u**3*u_r*(S1phi**2+S1r**2+S1theta**2+S2phi**2+S2r**2+S2theta**2)
    uprm_r = -1/r**2
    w2prm_r = 2*r
    Sigmaprm_r = 2*r
    Dinvprm_r = (3*eta*u**2*uprm_r*(-6*eta + 52) + 12*eta*u*uprm_r)/(eta*u**3*(-6*eta + 52) + 6*eta*u**2 + 1)
    omegatildeprm_r = 2*a
    logargprm_r = u*(u*(u*(u*(Delta5l*uprm_r + uprm_r*(Delta5 + Delta5l*np.log(u))) + uprm_r*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))) + uprm_r*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u))))) + uprm_r*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))))) + uprm_r*(Delta1 + u*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u))))))
    Deltaucalibprm_r = eta*logargprm_r/(logarg + 1)
    Deltaucalibprimeprm_r = eta*logargprm_r*u**2*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)**2 - eta*u**2*(u*(u*(u*(5*Delta5l*uprm_r + uprm_r*(5*Delta5 + 5*Delta5l*np.log(u))) + uprm_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + uprm_r*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))) + uprm_r*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1) - 2*eta*u*uprm_r*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)
    Deltaubarprm_r = 2*a**2*u*uprm_r + 2*uprm_r/etaKminus1
    Deltaubarprimeprm_r = -6*a**2*u**2*uprm_r - 4*u*uprm_r/etaKminus1
    Deltauprm_r = Deltaubar*Deltaucalibprm_r + Deltaubarprm_r*Deltaucalib
    Deltauprimeprm_r = Deltaubar*Deltaucalibprimeprm_r + Deltaubarprime*Deltaucalibprm_r + Deltaubarprimeprm_r*Deltaucalib + Deltaubarprm_r*Deltaucalibprime
    Deltatprimeprm_r = 2*Deltau + 2*Deltauprime*r + Deltauprimeprm_r*r**2 + 2*Deltauprm_r*r
    Deltatprm_r = 2*Deltau*r + Deltauprm_r*r**2
    Deltarprm_r = Deltat*Dinvprm_r + Deltatprm_r*Dinv
    Lambtprm_r = -Deltatprm_r*a**2*sin2thetaBL + 2*w2*w2prm_r
    csiprm_r = -w2prm_r*np.sqrt(Deltar*Deltat)/w2**2 + np.sqrt(Deltar*Deltat)*(Deltar*Deltatprm_r/2 + Deltarprm_r*Deltat/2)/(Deltar*Deltat*w2)
    csi1prm_r = csiprm_r*(-abs(-tortoise + 1) + 1)
    csi2prm_r = csiprm_r*(-np.sign(-tortoise + 3/2)/2 + 1/2)
    prTprm_r = csi2*(-n2*ptheta/r**2 - n3*pphi/(r**2*sintheta)) + csi2prm_r*(n1*pr + n2*ptheta/r + n3*pphi/(r*sintheta))
    phat3prm_r = n3*prTprm_r*(1 - 1/csi1) - pphi/(r**2*sintheta) + csi1prm_r*n3*prT/csi1**2
    phat2prm_r = n2*prTprm_r*(1 - 1/csi1) - ptheta/r**2 + csi1prm_r*n2*prT/csi1**2
    phat1prm_r = n1*prTprm_r*(1 - 1/csi1) + csi1prm_r*n1*prT/csi1**2
    pdotxirprm_r = phat1*xi1 + phat2*xi2 + phat3*xi3 + r*(phat1prm_r*xi1 + phat2prm_r*xi2 + phat3prm_r*xi3)
    pdotnprm_r = n1*phat1prm_r + n2*phat2prm_r + n3*phat3prm_r
    pdotvrprm_r = phat1*v1 + phat2*v2 + phat3*v3 + r*(phat1prm_r*v1 + phat2prm_r*v2 + phat3prm_r*v3)
    Qcoeff2prm_r = -Sigmaprm_r/(Sigma**2*sin2thetaBL)
    Qcoeff1prm_r = Sigmaprm_r/(Lambt*sin2thetaBL) - Lambtprm_r*Sigma/(Lambt**2*sin2thetaBL)
    DrSipn2prm_r = 2*Deltar*pdotn*pdotnprm_r/Sigma - Deltar*Sigmaprm_r*pdotn**2/Sigma**2 + Deltarprm_r*pdotn**2/Sigma
    Qprm_r = DrSipn2prm_r + 2*Qcoeff1*pdotxir*pdotxirprm_r + Qcoeff1prm_r*pdotxir**2 + 2*Qcoeff2*pdotvr*pdotvrprm_r + Qcoeff2prm_r*pdotvr**2
    Qminus1prm_r = Qprm_r
    Jtildeprm_r = Deltarprm_r/(2*np.sqrt(Deltar))
    exp2muprm_r = Sigmaprm_r
    expmuprm_r = exp2muprm_r/(2*np.sqrt(exp2mu))
    Brtildeprm_r = (np.sqrt(Deltar)*Deltatprimeprm_r - 2*Deltatprm_r + Deltarprm_r*Deltatprime/(2*np.sqrt(Deltar)))/(2*np.sqrt(Deltar*Deltat)) + (np.sqrt(Deltar)*Deltatprime - 2*Deltat)*(-Deltar*Deltatprm_r/2 - Deltarprm_r*Deltat/2)/(2*Deltar*Deltat*np.sqrt(Deltar*Deltat))
    Btildeprm_r = Deltatprm_r/(2*np.sqrt(Deltat))
    exp2nuprm_r = Deltat*Sigmaprm_r/Lambt - Deltat*Lambtprm_r*Sigma/Lambt**2 + Deltatprm_r*Sigma/Lambt
    expnuprm_r = exp2nuprm_r/(2*np.sqrt(exp2nu))
    omegaprm_r = omegatildeprm_r/Lambt - Lambtprm_r*omegatilde/Lambt**2
    Lambtprimeprm_r = -2*Deltatprimeprm_r*a**2*sin2thetaBL + 4*a**2 + 12*r**2
    mucosthetaprm_r = -Sigmaprm_r*a**2*costhetaBL/Sigma**2
    nucosthetaprm_r = a**2*costhetaBL*w2*(-Deltatprm_r + w2prm_r)/(Lambt*Sigma) + a**2*costhetaBL*w2prm_r*(-Deltat + w2)/(Lambt*Sigma) - Sigmaprm_r*a**2*costhetaBL*w2*(-Deltat + w2)/(Lambt*Sigma**2) - Lambtprm_r*a**2*costhetaBL*w2*(-Deltat + w2)/(Lambt**2*Sigma)
    omegacosthetaprm_r = -2*Deltat*a**2*costhetaBL*omegatildeprm_r/Lambt**2 + 4*Deltat*Lambtprm_r*a**2*costhetaBL*omegatilde/Lambt**3 - 2*Deltatprm_r*a**2*costhetaBL*omegatilde/Lambt**2
    murprm_r = 1/Sigma - Sigmaprm_r*r/Sigma**2 + Deltarprm_r/(2*Deltar**(3/2))
    nurprm_r = 1/Sigma - Sigmaprm_r*r/Sigma**2 + w2*(-4*Deltat + Deltatprime*w2prm_r + Deltatprimeprm_r*w2 - 4*Deltatprm_r*r)/(2*Deltat*Lambt) + w2prm_r*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt) - Lambtprm_r*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt**2) - Deltatprm_r*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt)
    omegarprm_r = (-Lambtprime*omegatildeprm_r - Lambtprimeprm_r*omegatilde + Lambtprm_r*omegatildeprime)/Lambt**2 + Lambtprm_r*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/Lambt**3
    sigmacoeffTerm3prm_r = 3*dSO*eta*u**2*uprm_r
    sigmacoeffTerm2prm_r = eta*(-96*DrSipn2 - 436*Qminus1 + eta*(-882*DrSipn2 + 204*Qminus1 + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1) + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1 - 882*DrSipn2prm_r + 204*Qminus1prm_r + r*(1620*DrSipn2*DrSipn2prm_r - 234*DrSipn2*Qminus1prm_r - 234*DrSipn2prm_r*Qminus1))) + r*(36*DrSipn2*Qminus1 - 45*Qminus1**2) + r*(36*DrSipn2*Qminus1 - 96*DrSipn2prm_r - 45*Qminus1**2 - 436*Qminus1prm_r + r*(36*DrSipn2*Qminus1prm_r + 36*DrSipn2prm_r*Qminus1 - 90*Qminus1*Qminus1prm_r)))/(144*r**2) - eta*(eta*(r*(-882*DrSipn2 + 204*Qminus1 + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1)) - 336) + r*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*Qminus1**2)) - 896)/(72*r**3)
    sigmacoeffTerm1prm_r = eta*(-36*DrSipn2prm_r + 3*Qminus1prm_r - 8*uprm_r)/12
    sigmacoeffprm_r = sigmacoeffTerm1prm_r + sigmacoeffTerm2prm_r + sigmacoeffTerm3prm_r
    sigmastarcoeffTerm2prm_r = eta*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1 + eta*(-324*DrSipn2 + 120*Qminus1 + r*(360*DrSipn2**2 + Qminus1*(-126*DrSipn2 - 3*Qminus1)) + r*(360*DrSipn2**2 - 324*DrSipn2prm_r + Qminus1*(-126*DrSipn2 - 3*Qminus1) + 120*Qminus1prm_r + r*(720*DrSipn2*DrSipn2prm_r + Qminus1*(-126*DrSipn2prm_r - 3*Qminus1prm_r) + Qminus1prm_r*(-126*DrSipn2 - 3*Qminus1)))) + r*(282*DrSipn2prm_r + Qminus1*r*(96*DrSipn2prm_r - 23*Qminus1prm_r) + Qminus1*(96*DrSipn2 - 23*Qminus1) + Qminus1prm_r*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1prm_r))/(72*r**2) - eta*(eta*(r*(-324*DrSipn2 + 120*Qminus1 + r*(360*DrSipn2**2 + Qminus1*(-126*DrSipn2 - 3*Qminus1))) - 54) + r*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1) + 706)/(36*r**3)
    sigmastarcoeffTerm1prm_r = eta*(-30*DrSipn2prm_r + 4*Qminus1prm_r + 14*uprm_r)/12
    sigmastarcoeffprm_r = sigmastarcoeffTerm1prm_r + sigmastarcoeffTerm2prm_r
    Deltasigmastar3prm_r = sigma3*sigmacoeffprm_r + sigmastar3*sigmastarcoeffprm_r
    Deltasigmastar2prm_r = sigma2*sigmacoeffprm_r + sigmastar2*sigmastarcoeffprm_r
    Deltasigmastar1prm_r = sigma1*sigmacoeffprm_r + sigmastar1*sigmastarcoeffprm_r
    Sstar3prm_r = Deltasigmastar3prm_r
    Sstar2prm_r = Deltasigmastar2prm_r
    Sstar1prm_r = Deltasigmastar1prm_r
    S3prm_r = Sstar3prm_r
    S2prm_r = Sstar2prm_r
    S1prm_r = Sstar1prm_r
    Sstardotnprm_r = Sstar1prm_r*n1 + Sstar2prm_r*n2 + Sstar3prm_r*n3
    SdotSkerrhatprm_r = S1prm_r*Skerrhat1 + S2prm_r*Skerrhat2 + S3prm_r*Skerrhat3
    Sdotnprm_r = S1prm_r*n1 + S2prm_r*n2 + S3prm_r*n3
    Sdotvprm_r = S1prm_r*v1 + S2prm_r*v2 + S3prm_r*v3
    Sdotxiprm_r = S1prm_r*xi1 + S2prm_r*xi2 + S3prm_r*xi3
    HdsumTerm2prm_r = 6*Sstardotn*Sstardotnprm_r
    HdsumTerm1prm_r = 2*Sstar1*Sstar1prm_r + 2*Sstar2*Sstar2prm_r + 2*Sstar3*Sstar3prm_r
    Hdsumprm_r = HdsumTerm1prm_r - HdsumTerm2prm_r
    Hdcoeffprm_r = 3*u**2*uprm_r/2
    Q4prm_r = 4*eta*prT**4*u*uprm_r*(-3*eta + 4) + 8*eta*prT**3*prTprm_r*u**2*(-3*eta + 4)
    gammappsumprm_r = 2*Deltar*pdotn*pdotnprm_r/Sigma - Deltar*Sigmaprm_r*pdotn**2/Sigma**2 + Deltarprm_r*pdotn**2/Sigma + 2*pdotvr*pdotvrprm_r/(Sigma*sin2thetaBL) - Sigmaprm_r*pdotvr**2/(Sigma**2*sin2thetaBL) + 2*Sigma*pdotxir*pdotxirprm_r/(Lambt*sin2thetaBL) + Sigmaprm_r*pdotxir**2/(Lambt*sin2thetaBL) - Lambtprm_r*Sigma*pdotxir**2/(Lambt**2*sin2thetaBL)
    Hnsradicandprm_r = Q4prm_r + gammappsumprm_r
    alphaprm_r = Lambt*np.sqrt(Deltat*Sigma/Lambt)*(Deltat*Sigmaprm_r/(2*Lambt) - Deltat*Lambtprm_r*Sigma/(2*Lambt**2) + Deltatprm_r*Sigma/(2*Lambt))/(Deltat*Sigma)
    betapsumprm_r = omegatilde*pdotxirprm_r/Lambt + omegatildeprm_r*pdotxir/Lambt - Lambtprm_r*omegatilde*pdotxir/Lambt**2
    HssTerm3prm_r = Btilde**2*(Sdotn*exp2mu*xisq*(-Qprm_r - Qprm_r/(2*np.sqrt(Q))) + Sdotn*exp2muprm_r*xisq*(-np.sqrt(Q) - Q) + Sdotnprm_r*exp2mu*xisq*(-np.sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotnprm_r - Jtilde*Sdotvprm_r*pdotn - Jtildeprm_r*Sdotv*pdotn + Sdotn*pdotvrprm_r + Sdotnprm_r*pdotvr) + pdotvrprm_r*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btildeprm_r*(-2*Sdotn*exp2mu*xisq*(np.sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotnprm_r + Btilde*Jtilde*Sdotxiprm_r*pdotn + Btilde*Jtildeprm_r*Sdotxi*pdotn + Btildeprm_r*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxirprm_r - Sdotn*expmu*expnuprm_r*pdotxir - Sdotn*expmuprm_r*expnu*pdotxir - Sdotnprm_r*expmu*expnu*pdotxir) + expmu*expnu*pdotxirprm_r*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnuprm_r*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmuprm_r*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir)
    HssTerm3coeffprm_r = omegacostheta*(-Qprm_r - Qprm_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*(np.sqrt(Q) + Q)**2) + omegacosthetaprm_r/(Btilde*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) - expnuprm_r*omegacostheta/(Btilde*exp2mu*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)) - expmuprm_r*omegacostheta/(Btilde*exp2mu*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)) - exp2muprm_r*omegacostheta/(Btilde*exp2mu**2*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) - Btildeprm_r*omegacostheta/(Btilde**2*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q))
    HssTerm2prm_r = Btilde**2*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotnprm_r - Jtilde*Sdotvprm_r*pdotn - Jtildeprm_r*Sdotv*pdotn + Sdotn*pdotvrprm_r + Sdotnprm_r*pdotvr) + Jtilde*pdotnprm_r*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtildeprm_r*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Qprm_r + Qprm_r/(2*np.sqrt(Q))) + Sdotv*exp2muprm_r*(np.sqrt(Q) + Q) + Sdotvprm_r*exp2mu*(np.sqrt(Q) + Q)) + Btilde*Btildeprm_r*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(np.sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvrprm_r - Btilde*Sdotxi*expnuprm_r*pdotvr - Btilde*Sdotxiprm_r*expnu*pdotvr - Btildeprm_r*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxirprm_r + Sdotv*exp2nu*expmuprm_r*pdotxir + Sdotv*exp2nuprm_r*expmu*pdotxir + Sdotvprm_r*exp2nu*expmu*pdotxir) + expmu*pdotxirprm_r*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmuprm_r*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir)
    HssTerm2coeffprm_r = Jtilde*omegar*(-Qprm_r - Qprm_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*xisq*(np.sqrt(Q) + Q)**2) + Jtilde*omegarprm_r/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*expnuprm_r*omegar/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*expmuprm_r*omegar/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*exp2muprm_r*omegar/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtildeprm_r*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Btildeprm_r*Jtilde*omegar/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q))
    HssTerm1prm_r = SdotSkerrhat*omegaprm_r + SdotSkerrhatprm_r*omega
    Hssprm_r = HssTerm1prm_r + HssTerm2*HssTerm2coeffprm_r + HssTerm2coeff*HssTerm2prm_r + HssTerm3*HssTerm3coeffprm_r + HssTerm3coeff*HssTerm3prm_r
    HsoTerm2cprm_r = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxirprm_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnuprm_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmuprm_r*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotvprm_r*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Qprm_r*Sdotv*expmu*expnu*pdotxir/(2*np.sqrt(Q)) + Brtilde*Jtildeprm_r*Sdotv*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtildeprm_r*Jtilde*Sdotv*expmu*expnu*pdotxir*(np.sqrt(Q) + 1)
    HsoTerm2bprm_r = Btilde*expmu*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nurprm_r + Jtilde*Sdotvprm_r*nur + Jtildeprm_r*Sdotv*nur - Sdotn*nucosthetaprm_r*xisq - Sdotnprm_r*nucostheta*xisq) + Btilde*expmu*expnu*pdotxirprm_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnuprm_r*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmuprm_r*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Qprm_r*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) + Btildeprm_r*expmu*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)
    HsoTerm2aprm_r = Btilde**2*Jtilde*Sdotxi*(-np.sqrt(Q)*(nur*pdotvrprm_r + nurprm_r*pdotvr + pdotn*xisq*(mucosthetaprm_r - nucosthetaprm_r) + pdotnprm_r*xisq*(mucostheta - nucostheta)) - mucostheta*pdotnprm_r*xisq - mucosthetaprm_r*pdotn*xisq + mur*pdotvrprm_r*(np.sqrt(Q) + 1) + murprm_r*pdotvr*(np.sqrt(Q) + 1) + Qprm_r*mur*pdotvr/(2*np.sqrt(Q)) + Qprm_r*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/(2*np.sqrt(Q))) + Btilde**2*Jtilde*Sdotxiprm_r*(np.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(np.sqrt(Q) + 1)) + Btilde**2*Jtildeprm_r*Sdotxi*(np.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(np.sqrt(Q) + 1)) + Btilde*Btildeprm_r*Jtilde*Sdotxi*(2*np.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(np.sqrt(Q) + 1))
    HsoTerm2prm_r = HsoTerm2aprm_r + HsoTerm2bprm_r - HsoTerm2cprm_r
    HsoTerm2coeffprm_r = expnu*(-Qprm_r - Qprm_r/(2*np.sqrt(Q)))/(Btilde**2*exp2mu*xisq*(np.sqrt(Q) + Q)**2) + expnuprm_r/(Btilde**2*exp2mu*xisq*(np.sqrt(Q) + Q)) - exp2muprm_r*expnu/(Btilde**2*exp2mu**2*xisq*(np.sqrt(Q) + Q)) - 2*Btildeprm_r*expnu/(Btilde**3*exp2mu*xisq*(np.sqrt(Q) + Q))
    HsoTerm1prm_r = SdotSkerrhat*exp2nu*pdotxir*(-Btildeprm_r + expmu*expnuprm_r + expmuprm_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxirprm_r*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmuprm_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) + SdotSkerrhat*exp2nuprm_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhatprm_r*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) - Qprm_r*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Btildeprm_r*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq)
    Hsoprm_r = HsoTerm1prm_r + HsoTerm2*HsoTerm2coeffprm_r + HsoTerm2coeff*HsoTerm2prm_r
    Hdprm_r = Hdcoeff*Hdsumprm_r + Hdcoeffprm_r*Hdsum
    Hnsprm_r = np.sqrt(Hnsradicand)*alphaprm_r + betapsumprm_r + Hnsradicandprm_r*alpha/(2*np.sqrt(Hnsradicand))
    Hsprm_r = Hsoprm_r + Hssprm_r
    Heffprm_r = -Hdprm_r + Hnsprm_r + Hsprm_r + 4*dSS*eta*u**3*uprm_r*(S1phi**2 + S1r**2 + S1theta**2 + S2phi**2 + S2r**2 + S2theta**2)
    u_rprm_r = 2/r**3
    w2_rprm_r = 2
    Sigma_rprm_r = 2
    Dinv_rprm_r = (3*eta*u**2*u_r*(-6*eta + 52) + 12*eta*u*u_r)*(-3*eta*u**2*uprm_r*(-6*eta + 52) - 12*eta*u*uprm_r)/(eta*u**3*(-6*eta + 52) + 6*eta*u**2 + 1)**2 + (3*eta*u**2*u_rprm_r*(-6*eta + 52) + 6*eta*u*u_r*uprm_r*(-6*eta + 52) + 12*eta*u*u_rprm_r + 12*eta*u_r*uprm_r)/(eta*u**3*(-6*eta + 52) + 6*eta*u**2 + 1)
    logarg_rprm_r = u*(u*(u*(u*(Delta5l*u_rprm_r + Delta5l*u_r*uprm_r/u + u_rprm_r*(Delta5 + Delta5l*np.log(u))) + u_r*(Delta5l*uprm_r + uprm_r*(Delta5 + Delta5l*np.log(u))) + u_rprm_r*(Delta4 + u*(Delta5 + Delta5l*np.log(u))) + uprm_r*(Delta5l*u_r + u_r*(Delta5 + Delta5l*np.log(u)))) + u_r*(u*(Delta5l*uprm_r + uprm_r*(Delta5 + Delta5l*np.log(u))) + uprm_r*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))) + u_rprm_r*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))) + uprm_r*(u*(Delta5l*u_r + u_r*(Delta5 + Delta5l*np.log(u))) + u_r*(Delta4 + u*(Delta5 + Delta5l*np.log(u))))) + u_r*(u*(u*(Delta5l*uprm_r + uprm_r*(Delta5 + Delta5l*np.log(u))) + uprm_r*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))) + uprm_r*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u))))) + u_rprm_r*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u))))) + uprm_r*(u*(u*(Delta5l*u_r + u_r*(Delta5 + Delta5l*np.log(u))) + u_r*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))) + u_r*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))))) + u_r*(u*(u*(u*(Delta5l*uprm_r + uprm_r*(Delta5 + Delta5l*np.log(u))) + uprm_r*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))) + uprm_r*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u))))) + uprm_r*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))))) + u_rprm_r*(Delta1 + u*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))))) + uprm_r*(u*(u*(u*(Delta5l*u_r + u_r*(Delta5 + Delta5l*np.log(u))) + u_r*(Delta4 + u*(Delta5 + Delta5l*np.log(u)))) + u_r*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u))))) + u_r*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*np.log(u))))))
    Deltaucalib_rprm_r = -eta*logarg_r*logargprm_r/(logarg + 1)**2 + eta*logarg_rprm_r/(logarg + 1)
    Deltaucalibprime_rprm_r = -2*eta*logarg_r*logargprm_r*u**2*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)**3 + eta*logarg_r*u**2*(u*(u*(u*(5*Delta5l*uprm_r + uprm_r*(5*Delta5 + 5*Delta5l*np.log(u))) + uprm_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + uprm_r*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))) + uprm_r*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)**2 + 2*eta*logarg_r*u*uprm_r*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)**2 + eta*logarg_rprm_r*u**2*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)**2 + eta*logargprm_r*u**2*(u*(u*(u*(5*Delta5l*u_r + u_r*(5*Delta5 + 5*Delta5l*np.log(u))) + u_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + u_r*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))) + u_r*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)**2 + 2*eta*logargprm_r*u*u_r*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)**2 - eta*u**2*(u*(u*(u*(5*Delta5l*u_rprm_r + 5*Delta5l*u_r*uprm_r/u + u_rprm_r*(5*Delta5 + 5*Delta5l*np.log(u))) + u_r*(5*Delta5l*uprm_r + uprm_r*(5*Delta5 + 5*Delta5l*np.log(u))) + u_rprm_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))) + uprm_r*(5*Delta5l*u_r + u_r*(5*Delta5 + 5*Delta5l*np.log(u)))) + u_r*(u*(5*Delta5l*uprm_r + uprm_r*(5*Delta5 + 5*Delta5l*np.log(u))) + uprm_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + u_rprm_r*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + uprm_r*(u*(5*Delta5l*u_r + u_r*(5*Delta5 + 5*Delta5l*np.log(u))) + u_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))) + u_r*(u*(u*(5*Delta5l*uprm_r + uprm_r*(5*Delta5 + 5*Delta5l*np.log(u))) + uprm_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + uprm_r*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))) + u_rprm_r*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))) + uprm_r*(u*(u*(5*Delta5l*u_r + u_r*(5*Delta5 + 5*Delta5l*np.log(u))) + u_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + u_r*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1) - 2*eta*u*u_r*(u*(u*(u*(5*Delta5l*uprm_r + uprm_r*(5*Delta5 + 5*Delta5l*np.log(u))) + uprm_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + uprm_r*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))) + uprm_r*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1) - 2*eta*u*u_rprm_r*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1) - 2*eta*u*uprm_r*(u*(u*(u*(5*Delta5l*u_r + u_r*(5*Delta5 + 5*Delta5l*np.log(u))) + u_r*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u)))) + u_r*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))) + u_r*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1) - 2*eta*u_r*uprm_r*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*np.log(u))))))/(logarg + 1)
    Deltaubar_rprm_r = 2*a**2*u*u_rprm_r + 2*a**2*u_r*uprm_r + 2*u_rprm_r/etaKminus1
    Deltaubarprime_rprm_r = -6*a**2*u**2*u_rprm_r - 12*a**2*u*u_r*uprm_r - 4*u*u_rprm_r/etaKminus1 - 4*u_r*uprm_r/etaKminus1
    Deltau_rprm_r = Deltaubar*Deltaucalib_rprm_r + Deltaubar_r*Deltaucalibprm_r + Deltaubar_rprm_r*Deltaucalib + Deltaubarprm_r*Deltaucalib_r
    Deltauprime_rprm_r = Deltaubar*Deltaucalibprime_rprm_r + Deltaubar_r*Deltaucalibprimeprm_r + Deltaubar_rprm_r*Deltaucalibprime + Deltaubarprime*Deltaucalib_rprm_r + Deltaubarprime_r*Deltaucalibprm_r + Deltaubarprime_rprm_r*Deltaucalib + Deltaubarprimeprm_r*Deltaucalib_r + Deltaubarprm_r*Deltaucalibprime_r
    Deltatprime_rprm_r = 2*Deltau_r + 2*Deltau_rprm_r*r + 2*Deltauprime + 2*Deltauprime_r*r + Deltauprime_rprm_r*r**2 + 2*Deltauprimeprm_r*r + 2*Deltauprm_r
    Deltat_rprm_r = 2*Deltau + 2*Deltau_r*r + Deltau_rprm_r*r**2 + 2*Deltauprm_r*r
    Deltar_rprm_r = Deltat*Dinv_rprm_r + Deltat_r*Dinvprm_r + Deltat_rprm_r*Dinv + Deltatprm_r*Dinv_r
    Lambt_rprm_r = -Deltat_rprm_r*a**2*sin2thetaBL + 2*w2*w2_rprm_r + 2*w2_r*w2prm_r
    csi_rprm_r = -w2_rprm_r*np.sqrt(Deltar*Deltat)/w2**2 + 2*w2_r*w2prm_r*np.sqrt(Deltar*Deltat)/w2**3 + np.sqrt(Deltar*Deltat)*(Deltar*Deltat_rprm_r/2 + Deltar_r*Deltatprm_r/2 + Deltar_rprm_r*Deltat/2 + Deltarprm_r*Deltat_r/2)/(Deltar*Deltat*w2) - w2_r*np.sqrt(Deltar*Deltat)*(Deltar*Deltatprm_r/2 + Deltarprm_r*Deltat/2)/(Deltar*Deltat*w2**2) - w2prm_r*np.sqrt(Deltar*Deltat)*(Deltar*Deltat_r/2 + Deltar_r*Deltat/2)/(Deltar*Deltat*w2**2) - Deltatprm_r*np.sqrt(Deltar*Deltat)*(Deltar*Deltat_r/2 + Deltar_r*Deltat/2)/(Deltar*Deltat**2*w2) - Deltarprm_r*np.sqrt(Deltar*Deltat)*(Deltar*Deltat_r/2 + Deltar_r*Deltat/2)/(Deltar**2*Deltat*w2) + np.sqrt(Deltar*Deltat)*(Deltar*Deltat_r/2 + Deltar_r*Deltat/2)*(Deltar*Deltatprm_r/2 + Deltarprm_r*Deltat/2)/(Deltar**2*Deltat**2*w2)
    csi1_rprm_r = csi_rprm_r*(-abs(-tortoise + 1) + 1)
    csi2_rprm_r = csi_rprm_r*(-np.sign(-tortoise + 3/2)/2 + 1/2)
    prT_rprm_r = csi2*(2*n2*ptheta/r**3 + 2*n3*pphi/(r**3*sintheta)) + csi2_r*(-n2*ptheta/r**2 - n3*pphi/(r**2*sintheta)) + csi2_rprm_r*(n1*pr + n2*ptheta/r + n3*pphi/(r*sintheta)) + csi2prm_r*(-n2*ptheta/r**2 - n3*pphi/(r**2*sintheta))
    phat3_rprm_r = n3*prT_rprm_r*(1 - 1/csi1) + 2*pphi/(r**3*sintheta) + csi1_r*n3*prTprm_r/csi1**2 + csi1_rprm_r*n3*prT/csi1**2 + csi1prm_r*n3*prT_r/csi1**2 - 2*csi1_r*csi1prm_r*n3*prT/csi1**3
    phat2_rprm_r = n2*prT_rprm_r*(1 - 1/csi1) + 2*ptheta/r**3 + csi1_r*n2*prTprm_r/csi1**2 + csi1_rprm_r*n2*prT/csi1**2 + csi1prm_r*n2*prT_r/csi1**2 - 2*csi1_r*csi1prm_r*n2*prT/csi1**3
    phat1_rprm_r = n1*prT_rprm_r*(1 - 1/csi1) + csi1_r*n1*prTprm_r/csi1**2 + csi1_rprm_r*n1*prT/csi1**2 + csi1prm_r*n1*prT_r/csi1**2 - 2*csi1_r*csi1prm_r*n1*prT/csi1**3
    pdotxir_rprm_r = phat1_r*xi1 + phat1prm_r*xi1 + phat2_r*xi2 + phat2prm_r*xi2 + phat3_r*xi3 + phat3prm_r*xi3 + r*(phat1_rprm_r*xi1 + phat2_rprm_r*xi2 + phat3_rprm_r*xi3)
    pdotn_rprm_r = n1*phat1_rprm_r + n2*phat2_rprm_r + n3*phat3_rprm_r
    pdotvr_rprm_r = phat1_r*v1 + phat1prm_r*v1 + phat2_r*v2 + phat2prm_r*v2 + phat3_r*v3 + phat3prm_r*v3 + r*(phat1_rprm_r*v1 + phat2_rprm_r*v2 + phat3_rprm_r*v3)
    Qcoeff2_rprm_r = -Sigma_rprm_r/(Sigma**2*sin2thetaBL) + 2*Sigma_r*Sigmaprm_r/(Sigma**3*sin2thetaBL)
    Qcoeff1_rprm_r = Sigma_rprm_r/(Lambt*sin2thetaBL) - Lambt_r*Sigmaprm_r/(Lambt**2*sin2thetaBL) - Lambt_rprm_r*Sigma/(Lambt**2*sin2thetaBL) - Lambtprm_r*Sigma_r/(Lambt**2*sin2thetaBL) + 2*Lambt_r*Lambtprm_r*Sigma/(Lambt**3*sin2thetaBL)
    DrSipn2_rprm_r = 2*Deltar*pdotn*pdotn_rprm_r/Sigma + 2*Deltar*pdotn_r*pdotnprm_r/Sigma - 2*Deltar*Sigma_r*pdotn*pdotnprm_r/Sigma**2 - Deltar*Sigma_rprm_r*pdotn**2/Sigma**2 - 2*Deltar*Sigmaprm_r*pdotn*pdotn_r/Sigma**2 + 2*Deltar*Sigma_r*Sigmaprm_r*pdotn**2/Sigma**3 + 2*Deltar_r*pdotn*pdotnprm_r/Sigma - Deltar_r*Sigmaprm_r*pdotn**2/Sigma**2 + Deltar_rprm_r*pdotn**2/Sigma + 2*Deltarprm_r*pdotn*pdotn_r/Sigma - Deltarprm_r*Sigma_r*pdotn**2/Sigma**2
    Q_rprm_r = DrSipn2_rprm_r + 2*Qcoeff1*pdotxir*pdotxir_rprm_r + 2*Qcoeff1*pdotxir_r*pdotxirprm_r + 2*Qcoeff1_r*pdotxir*pdotxirprm_r + Qcoeff1_rprm_r*pdotxir**2 + 2*Qcoeff1prm_r*pdotxir*pdotxir_r + 2*Qcoeff2*pdotvr*pdotvr_rprm_r + 2*Qcoeff2*pdotvr_r*pdotvrprm_r + 2*Qcoeff2_r*pdotvr*pdotvrprm_r + Qcoeff2_rprm_r*pdotvr**2 + 2*Qcoeff2prm_r*pdotvr*pdotvr_r
    Qminus1_rprm_r = Q_rprm_r
    Jtilde_rprm_r = Deltar_rprm_r/(2*np.sqrt(Deltar)) - Deltar_r*Deltarprm_r/(4*Deltar**(3/2))
    exp2mu_rprm_r = Sigma_rprm_r
    expmu_rprm_r = exp2mu_rprm_r/(2*np.sqrt(exp2mu)) - exp2mu_r*exp2muprm_r/(4*exp2mu**(3/2))
    Brtilde_rprm_r = (np.sqrt(Deltar)*Deltatprime_rprm_r - 2*Deltat_rprm_r + Deltar_r*Deltatprimeprm_r/(2*np.sqrt(Deltar)) + Deltar_rprm_r*Deltatprime/(2*np.sqrt(Deltar)) + Deltarprm_r*Deltatprime_r/(2*np.sqrt(Deltar)) - Deltar_r*Deltarprm_r*Deltatprime/(4*Deltar**(3/2)))/(2*np.sqrt(Deltar*Deltat)) + (np.sqrt(Deltar)*Deltatprime - 2*Deltat)*(-Deltar*Deltat_rprm_r/2 - Deltar_r*Deltatprm_r/2 - Deltar_rprm_r*Deltat/2 - Deltarprm_r*Deltat_r/2)/(2*Deltar*Deltat*np.sqrt(Deltar*Deltat)) + (-Deltar*Deltat_r/2 - Deltar_r*Deltat/2)*(np.sqrt(Deltar)*Deltatprimeprm_r - 2*Deltatprm_r + Deltarprm_r*Deltatprime/(2*np.sqrt(Deltar)))/(2*Deltar*Deltat*np.sqrt(Deltar*Deltat)) + (-Deltar*Deltatprm_r/2 - Deltarprm_r*Deltat/2)*(np.sqrt(Deltar)*Deltatprime_r - 2*Deltat_r + Deltar_r*Deltatprime/(2*np.sqrt(Deltar)))/(2*Deltar*Deltat*np.sqrt(Deltar*Deltat)) - Deltatprm_r*(np.sqrt(Deltar)*Deltatprime - 2*Deltat)*(-Deltar*Deltat_r/2 - Deltar_r*Deltat/2)/(2*Deltar*Deltat**2*np.sqrt(Deltar*Deltat)) - Deltarprm_r*(np.sqrt(Deltar)*Deltatprime - 2*Deltat)*(-Deltar*Deltat_r/2 - Deltar_r*Deltat/2)/(2*Deltar**2*Deltat*np.sqrt(Deltar*Deltat)) + (np.sqrt(Deltar)*Deltatprime - 2*Deltat)*(-Deltar*Deltat_r/2 - Deltar_r*Deltat/2)*(-Deltar*Deltatprm_r/2 - Deltarprm_r*Deltat/2)/(2*Deltar**2*Deltat**2*np.sqrt(Deltar*Deltat))
    Btilde_rprm_r = Deltat_rprm_r/(2*np.sqrt(Deltat)) - Deltat_r*Deltatprm_r/(4*Deltat**(3/2))
    exp2nu_rprm_r = Deltat*Sigma_rprm_r/Lambt - Deltat*Lambt_r*Sigmaprm_r/Lambt**2 - Deltat*Lambt_rprm_r*Sigma/Lambt**2 - Deltat*Lambtprm_r*Sigma_r/Lambt**2 + 2*Deltat*Lambt_r*Lambtprm_r*Sigma/Lambt**3 + Deltat_r*Sigmaprm_r/Lambt - Deltat_r*Lambtprm_r*Sigma/Lambt**2 + Deltat_rprm_r*Sigma/Lambt + Deltatprm_r*Sigma_r/Lambt - Deltatprm_r*Lambt_r*Sigma/Lambt**2
    expnu_rprm_r = exp2nu_rprm_r/(2*np.sqrt(exp2nu)) - exp2nu_r*exp2nuprm_r/(4*exp2nu**(3/2))
    omega_rprm_r = -Lambt_r*omegatildeprm_r/Lambt**2 - Lambt_rprm_r*omegatilde/Lambt**2 - Lambtprm_r*omegatilde_r/Lambt**2 + 2*Lambt_r*Lambtprm_r*omegatilde/Lambt**3
    Lambtprime_rprm_r = -2*Deltatprime_rprm_r*a**2*sin2thetaBL + 24*r
    mucostheta_rprm_r = -Sigma_rprm_r*a**2*costhetaBL/Sigma**2 + 2*Sigma_r*Sigmaprm_r*a**2*costhetaBL/Sigma**3
    nucostheta_rprm_r = a**2*costhetaBL*w2*(-Deltat_rprm_r + w2_rprm_r)/(Lambt*Sigma) + a**2*costhetaBL*w2_r*(-Deltatprm_r + w2prm_r)/(Lambt*Sigma) + a**2*costhetaBL*w2_rprm_r*(-Deltat + w2)/(Lambt*Sigma) + a**2*costhetaBL*w2prm_r*(-Deltat_r + w2_r)/(Lambt*Sigma) - Sigma_r*a**2*costhetaBL*w2*(-Deltatprm_r + w2prm_r)/(Lambt*Sigma**2) - Sigma_r*a**2*costhetaBL*w2prm_r*(-Deltat + w2)/(Lambt*Sigma**2) - Sigma_rprm_r*a**2*costhetaBL*w2*(-Deltat + w2)/(Lambt*Sigma**2) - Sigmaprm_r*a**2*costhetaBL*w2*(-Deltat_r + w2_r)/(Lambt*Sigma**2) - Sigmaprm_r*a**2*costhetaBL*w2_r*(-Deltat + w2)/(Lambt*Sigma**2) + Sigma_r*Sigmaprm_r*a**2*costhetaBL*w2*(-2*Deltat + 2*w2)/(Lambt*Sigma**3) - Lambt_r*a**2*costhetaBL*w2*(-Deltatprm_r + w2prm_r)/(Lambt**2*Sigma) - Lambt_r*a**2*costhetaBL*w2prm_r*(-Deltat + w2)/(Lambt**2*Sigma) + Lambt_r*Sigmaprm_r*a**2*costhetaBL*w2*(-Deltat + w2)/(Lambt**2*Sigma**2) - Lambt_rprm_r*a**2*costhetaBL*w2*(-Deltat + w2)/(Lambt**2*Sigma) - Lambtprm_r*a**2*costhetaBL*w2*(-Deltat_r + w2_r)/(Lambt**2*Sigma) - Lambtprm_r*a**2*costhetaBL*w2_r*(-Deltat + w2)/(Lambt**2*Sigma) + Lambtprm_r*Sigma_r*a**2*costhetaBL*w2*(-Deltat + w2)/(Lambt**2*Sigma**2) + Lambt_r*Lambtprm_r*a**2*costhetaBL*w2*(-2*Deltat + 2*w2)/(Lambt**3*Sigma)
    omegacostheta_rprm_r = 4*Deltat*Lambt_r*a**2*costhetaBL*omegatildeprm_r/Lambt**3 + 4*Deltat*Lambt_rprm_r*a**2*costhetaBL*omegatilde/Lambt**3 + 4*Deltat*Lambtprm_r*a**2*costhetaBL*omegatilde_r/Lambt**3 - 12*Deltat*Lambt_r*Lambtprm_r*a**2*costhetaBL*omegatilde/Lambt**4 - 2*Deltat_r*a**2*costhetaBL*omegatildeprm_r/Lambt**2 + 4*Deltat_r*Lambtprm_r*a**2*costhetaBL*omegatilde/Lambt**3 - 2*Deltat_rprm_r*a**2*costhetaBL*omegatilde/Lambt**2 - 2*Deltatprm_r*a**2*costhetaBL*omegatilde_r/Lambt**2 + 4*Deltatprm_r*Lambt_r*a**2*costhetaBL*omegatilde/Lambt**3
    mur_rprm_r = -Sigma_r/Sigma**2 - Sigma_rprm_r*r/Sigma**2 - Sigmaprm_r/Sigma**2 + 2*Sigma_r*Sigmaprm_r*r/Sigma**3 + Deltar_rprm_r/(2*Deltar**(3/2)) - 3*Deltar_r*Deltarprm_r/(4*Deltar**(5/2))
    nur_rprm_r = -Sigma_r/Sigma**2 - Sigma_rprm_r*r/Sigma**2 - Sigmaprm_r/Sigma**2 + 2*Sigma_r*Sigmaprm_r*r/Sigma**3 + w2*(-4*Deltat_r - 4*Deltat_rprm_r*r + Deltatprime*w2_rprm_r + Deltatprime_r*w2prm_r + Deltatprime_rprm_r*w2 + Deltatprimeprm_r*w2_r - 4*Deltatprm_r)/(2*Deltat*Lambt) + w2_r*(-4*Deltat + Deltatprime*w2prm_r + Deltatprimeprm_r*w2 - 4*Deltatprm_r*r)/(2*Deltat*Lambt) + w2_rprm_r*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt) + w2prm_r*(-4*Deltat - 4*Deltat_r*r + Deltatprime*w2_r + Deltatprime_r*w2)/(2*Deltat*Lambt) - Lambt_r*w2*(-4*Deltat + Deltatprime*w2prm_r + Deltatprimeprm_r*w2 - 4*Deltatprm_r*r)/(2*Deltat*Lambt**2) - Lambt_r*w2prm_r*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt**2) - Lambt_rprm_r*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt**2) - Lambtprm_r*w2*(-4*Deltat - 4*Deltat_r*r + Deltatprime*w2_r + Deltatprime_r*w2)/(2*Deltat*Lambt**2) - Lambtprm_r*w2_r*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt**2) + Lambt_r*Lambtprm_r*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt**3) - Deltat_r*w2*(-4*Deltat + Deltatprime*w2prm_r + Deltatprimeprm_r*w2 - 4*Deltatprm_r*r)/(2*Deltat**2*Lambt) - Deltat_r*w2prm_r*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt) + Deltat_r*Lambtprm_r*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt**2) - Deltat_rprm_r*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt) - Deltatprm_r*w2*(-4*Deltat - 4*Deltat_r*r + Deltatprime*w2_r + Deltatprime_r*w2)/(2*Deltat**2*Lambt) - Deltatprm_r*w2_r*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt) + Deltatprm_r*Lambt_r*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt**2) + Deltat_r*Deltatprm_r*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat**3*Lambt)
    omegar_rprm_r = (Lambt_rprm_r*omegatildeprime - Lambtprime_r*omegatildeprm_r - Lambtprime_rprm_r*omegatilde - Lambtprimeprm_r*omegatilde_r)/Lambt**2 + Lambt_r*(2*Lambtprime*omegatildeprm_r + 2*Lambtprimeprm_r*omegatilde - 2*Lambtprm_r*omegatildeprime)/Lambt**3 + Lambt_rprm_r*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/Lambt**3 - Lambtprm_r*(2*Lambt_r*omegatildeprime - 2*Lambtprime*omegatilde_r - 2*Lambtprime_r*omegatilde)/Lambt**3 - Lambt_r*Lambtprm_r*(-6*Lambt*omegatildeprime + 6*Lambtprime*omegatilde)/Lambt**4
    sigmacoeffTerm3_rprm_r = 3*dSO*eta*u**2*u_rprm_r + 6*dSO*eta*u*u_r*uprm_r
    sigmacoeffTerm2_rprm_r = eta*(72*DrSipn2*Qminus1 - 96*DrSipn2_r - 96*DrSipn2prm_r - 90*Qminus1**2 - 436*Qminus1_r - 436*Qminus1prm_r + eta*(1620*DrSipn2**2 - 468*DrSipn2*Qminus1 - 882*DrSipn2_r - 882*DrSipn2prm_r + 204*Qminus1_r + 204*Qminus1prm_r + r*(1620*DrSipn2*DrSipn2_r - 234*DrSipn2*Qminus1_r - 234*DrSipn2_r*Qminus1) + r*(1620*DrSipn2*DrSipn2prm_r - 234*DrSipn2*Qminus1prm_r - 234*DrSipn2prm_r*Qminus1) + r*(1620*DrSipn2*DrSipn2_r + 1620*DrSipn2*DrSipn2prm_r - 234*DrSipn2*Qminus1_r - 234*DrSipn2*Qminus1prm_r - 234*DrSipn2_r*Qminus1 - 882*DrSipn2_rprm_r - 234*DrSipn2prm_r*Qminus1 + 204*Qminus1_rprm_r + r*(1620*DrSipn2*DrSipn2_rprm_r - 234*DrSipn2*Qminus1_rprm_r + 1620*DrSipn2_r*DrSipn2prm_r - 234*DrSipn2_r*Qminus1prm_r - 234*DrSipn2_rprm_r*Qminus1 - 234*DrSipn2prm_r*Qminus1_r))) + r*(36*DrSipn2*Qminus1_r + 36*DrSipn2_r*Qminus1 - 90*Qminus1*Qminus1_r) + r*(36*DrSipn2*Qminus1prm_r + 36*DrSipn2prm_r*Qminus1 - 90*Qminus1*Qminus1prm_r) + r*(36*DrSipn2*Qminus1_r + 36*DrSipn2*Qminus1prm_r + 36*DrSipn2_r*Qminus1 - 96*DrSipn2_rprm_r + 36*DrSipn2prm_r*Qminus1 - 90*Qminus1*Qminus1_r - 90*Qminus1*Qminus1prm_r - 436*Qminus1_rprm_r + r*(36*DrSipn2*Qminus1_rprm_r + 36*DrSipn2_r*Qminus1prm_r + 36*DrSipn2_rprm_r*Qminus1 + 36*DrSipn2prm_r*Qminus1_r - 90*Qminus1*Qminus1_rprm_r - 90*Qminus1_r*Qminus1prm_r)))/(144*r**2) - eta*(-96*DrSipn2 - 436*Qminus1 + eta*(-882*DrSipn2 + 204*Qminus1 + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1) + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1 - 882*DrSipn2_r + 204*Qminus1_r + r*(1620*DrSipn2*DrSipn2_r - 234*DrSipn2*Qminus1_r - 234*DrSipn2_r*Qminus1))) + r*(36*DrSipn2*Qminus1 - 45*Qminus1**2) + r*(36*DrSipn2*Qminus1 - 96*DrSipn2_r - 45*Qminus1**2 - 436*Qminus1_r + r*(36*DrSipn2*Qminus1_r + 36*DrSipn2_r*Qminus1 - 90*Qminus1*Qminus1_r)))/(72*r**3) - eta*(-96*DrSipn2 - 436*Qminus1 + eta*(-882*DrSipn2 + 204*Qminus1 + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1) + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1 - 882*DrSipn2prm_r + 204*Qminus1prm_r + r*(1620*DrSipn2*DrSipn2prm_r - 234*DrSipn2*Qminus1prm_r - 234*DrSipn2prm_r*Qminus1))) + r*(36*DrSipn2*Qminus1 - 45*Qminus1**2) + r*(36*DrSipn2*Qminus1 - 96*DrSipn2prm_r - 45*Qminus1**2 - 436*Qminus1prm_r + r*(36*DrSipn2*Qminus1prm_r + 36*DrSipn2prm_r*Qminus1 - 90*Qminus1*Qminus1prm_r)))/(72*r**3) + eta*(eta*(r*(-882*DrSipn2 + 204*Qminus1 + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1)) - 336) + r*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*Qminus1**2)) - 896)/(24*r**4)
    sigmacoeffTerm1_rprm_r = eta*(-36*DrSipn2_rprm_r + 3*Qminus1_rprm_r - 8*u_rprm_r)/12
    sigmacoeff_rprm_r = sigmacoeffTerm1_rprm_r + sigmacoeffTerm2_rprm_r + sigmacoeffTerm3_rprm_r
    sigmastarcoeffTerm2_rprm_r = eta*(282*DrSipn2_r + 282*DrSipn2prm_r + Qminus1*r*(96*DrSipn2_r - 23*Qminus1_r) + Qminus1*r*(96*DrSipn2prm_r - 23*Qminus1prm_r) + 2*Qminus1*(96*DrSipn2 - 23*Qminus1) + Qminus1_r*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_r + Qminus1prm_r*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1prm_r + eta*(720*DrSipn2**2 - 324*DrSipn2_r - 324*DrSipn2prm_r + 2*Qminus1*(-126*DrSipn2 - 3*Qminus1) + 120*Qminus1_r + 120*Qminus1prm_r + r*(720*DrSipn2*DrSipn2_r + Qminus1*(-126*DrSipn2_r - 3*Qminus1_r) + Qminus1_r*(-126*DrSipn2 - 3*Qminus1)) + r*(720*DrSipn2*DrSipn2prm_r + Qminus1*(-126*DrSipn2prm_r - 3*Qminus1prm_r) + Qminus1prm_r*(-126*DrSipn2 - 3*Qminus1)) + r*(720*DrSipn2*DrSipn2_r + 720*DrSipn2*DrSipn2prm_r - 324*DrSipn2_rprm_r + Qminus1*(-126*DrSipn2_r - 3*Qminus1_r) + Qminus1*(-126*DrSipn2prm_r - 3*Qminus1prm_r) + Qminus1_r*(-126*DrSipn2 - 3*Qminus1) + 120*Qminus1_rprm_r + Qminus1prm_r*(-126*DrSipn2 - 3*Qminus1) + r*(720*DrSipn2*DrSipn2_rprm_r + 720*DrSipn2_r*DrSipn2prm_r + Qminus1*(-126*DrSipn2_rprm_r - 3*Qminus1_rprm_r) + Qminus1_r*(-126*DrSipn2prm_r - 3*Qminus1prm_r) + Qminus1_rprm_r*(-126*DrSipn2 - 3*Qminus1) + Qminus1prm_r*(-126*DrSipn2_r - 3*Qminus1_r)))) + r*(282*DrSipn2_rprm_r + Qminus1*r*(96*DrSipn2_rprm_r - 23*Qminus1_rprm_r) + Qminus1*(96*DrSipn2_r - 23*Qminus1_r) + Qminus1*(96*DrSipn2prm_r - 23*Qminus1prm_r) + Qminus1_r*r*(96*DrSipn2prm_r - 23*Qminus1prm_r) + Qminus1_r*(96*DrSipn2 - 23*Qminus1) + Qminus1_rprm_r*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_rprm_r + Qminus1prm_r*r*(96*DrSipn2_r - 23*Qminus1_r) + Qminus1prm_r*(96*DrSipn2 - 23*Qminus1)))/(72*r**2) - eta*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1 + eta*(-324*DrSipn2 + 120*Qminus1 + r*(360*DrSipn2**2 + Qminus1*(-126*DrSipn2 - 3*Qminus1)) + r*(360*DrSipn2**2 - 324*DrSipn2_r + Qminus1*(-126*DrSipn2 - 3*Qminus1) + 120*Qminus1_r + r*(720*DrSipn2*DrSipn2_r + Qminus1*(-126*DrSipn2_r - 3*Qminus1_r) + Qminus1_r*(-126*DrSipn2 - 3*Qminus1)))) + r*(282*DrSipn2_r + Qminus1*r*(96*DrSipn2_r - 23*Qminus1_r) + Qminus1*(96*DrSipn2 - 23*Qminus1) + Qminus1_r*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_r))/(36*r**3) - eta*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1 + eta*(-324*DrSipn2 + 120*Qminus1 + r*(360*DrSipn2**2 + Qminus1*(-126*DrSipn2 - 3*Qminus1)) + r*(360*DrSipn2**2 - 324*DrSipn2prm_r + Qminus1*(-126*DrSipn2 - 3*Qminus1) + 120*Qminus1prm_r + r*(720*DrSipn2*DrSipn2prm_r + Qminus1*(-126*DrSipn2prm_r - 3*Qminus1prm_r) + Qminus1prm_r*(-126*DrSipn2 - 3*Qminus1)))) + r*(282*DrSipn2prm_r + Qminus1*r*(96*DrSipn2prm_r - 23*Qminus1prm_r) + Qminus1*(96*DrSipn2 - 23*Qminus1) + Qminus1prm_r*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1prm_r))/(36*r**3) + eta*(eta*(r*(-324*DrSipn2 + 120*Qminus1 + r*(360*DrSipn2**2 + Qminus1*(-126*DrSipn2 - 3*Qminus1))) - 54) + r*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1) + 706)/(12*r**4)
    sigmastarcoeffTerm1_rprm_r = eta*(-30*DrSipn2_rprm_r + 4*Qminus1_rprm_r + 14*u_rprm_r)/12
    sigmastarcoeff_rprm_r = sigmastarcoeffTerm1_rprm_r + sigmastarcoeffTerm2_rprm_r
    Deltasigmastar3_rprm_r = sigma3*sigmacoeff_rprm_r + sigmastar3*sigmastarcoeff_rprm_r
    Deltasigmastar2_rprm_r = sigma2*sigmacoeff_rprm_r + sigmastar2*sigmastarcoeff_rprm_r
    Deltasigmastar1_rprm_r = sigma1*sigmacoeff_rprm_r + sigmastar1*sigmastarcoeff_rprm_r
    Sstar3_rprm_r = Deltasigmastar3_rprm_r
    Sstar2_rprm_r = Deltasigmastar2_rprm_r
    Sstar1_rprm_r = Deltasigmastar1_rprm_r
    S3_rprm_r = Sstar3_rprm_r
    S2_rprm_r = Sstar2_rprm_r
    S1_rprm_r = Sstar1_rprm_r
    Sstardotn_rprm_r = Sstar1_rprm_r*n1 + Sstar2_rprm_r*n2 + Sstar3_rprm_r*n3
    SdotSkerrhat_rprm_r = S1_rprm_r*Skerrhat1 + S2_rprm_r*Skerrhat2 + S3_rprm_r*Skerrhat3
    Sdotn_rprm_r = S1_rprm_r*n1 + S2_rprm_r*n2 + S3_rprm_r*n3
    Sdotv_rprm_r = S1_rprm_r*v1 + S2_rprm_r*v2 + S3_rprm_r*v3
    Sdotxi_rprm_r = S1_rprm_r*xi1 + S2_rprm_r*xi2 + S3_rprm_r*xi3
    HdsumTerm2_rprm_r = 6*Sstardotn*Sstardotn_rprm_r + 6*Sstardotn_r*Sstardotnprm_r
    HdsumTerm1_rprm_r = 2*Sstar1*Sstar1_rprm_r + 2*Sstar1_r*Sstar1prm_r + 2*Sstar2*Sstar2_rprm_r + 2*Sstar2_r*Sstar2prm_r + 2*Sstar3*Sstar3_rprm_r + 2*Sstar3_r*Sstar3prm_r
    Hdsum_rprm_r = HdsumTerm1_rprm_r - HdsumTerm2_rprm_r
    Hdcoeff_rprm_r = 3*u**2*u_rprm_r/2 + 3*u*u_r*uprm_r
    Q4_rprm_r = 4*eta*prT**4*u*u_rprm_r*(-3*eta + 4) + 4*eta*prT**4*u_r*uprm_r*(-3*eta + 4) + 16*eta*prT**3*prT_r*u*uprm_r*(-3*eta + 4) + 8*eta*prT**3*prT_rprm_r*u**2*(-3*eta + 4) + 16*eta*prT**3*prTprm_r*u*u_r*(-3*eta + 4) + 24*eta*prT**2*prT_r*prTprm_r*u**2*(-3*eta + 4)
    gammappsum_rprm_r = 2*Deltar*pdotn*pdotn_rprm_r/Sigma + 2*Deltar*pdotn_r*pdotnprm_r/Sigma - 2*Deltar*Sigma_r*pdotn*pdotnprm_r/Sigma**2 - Deltar*Sigma_rprm_r*pdotn**2/Sigma**2 - 2*Deltar*Sigmaprm_r*pdotn*pdotn_r/Sigma**2 + 2*Deltar*Sigma_r*Sigmaprm_r*pdotn**2/Sigma**3 + 2*Deltar_r*pdotn*pdotnprm_r/Sigma - Deltar_r*Sigmaprm_r*pdotn**2/Sigma**2 + Deltar_rprm_r*pdotn**2/Sigma + 2*Deltarprm_r*pdotn*pdotn_r/Sigma - Deltarprm_r*Sigma_r*pdotn**2/Sigma**2 + 2*pdotvr*pdotvr_rprm_r/(Sigma*sin2thetaBL) + 2*pdotvr_r*pdotvrprm_r/(Sigma*sin2thetaBL) - 2*Sigma_r*pdotvr*pdotvrprm_r/(Sigma**2*sin2thetaBL) - Sigma_rprm_r*pdotvr**2/(Sigma**2*sin2thetaBL) - 2*Sigmaprm_r*pdotvr*pdotvr_r/(Sigma**2*sin2thetaBL) + 2*Sigma_r*Sigmaprm_r*pdotvr**2/(Sigma**3*sin2thetaBL) + 2*Sigma*pdotxir*pdotxir_rprm_r/(Lambt*sin2thetaBL) + 2*Sigma*pdotxir_r*pdotxirprm_r/(Lambt*sin2thetaBL) + 2*Sigma_r*pdotxir*pdotxirprm_r/(Lambt*sin2thetaBL) + Sigma_rprm_r*pdotxir**2/(Lambt*sin2thetaBL) + 2*Sigmaprm_r*pdotxir*pdotxir_r/(Lambt*sin2thetaBL) - 2*Lambt_r*Sigma*pdotxir*pdotxirprm_r/(Lambt**2*sin2thetaBL) - Lambt_r*Sigmaprm_r*pdotxir**2/(Lambt**2*sin2thetaBL) - Lambt_rprm_r*Sigma*pdotxir**2/(Lambt**2*sin2thetaBL) - 2*Lambtprm_r*Sigma*pdotxir*pdotxir_r/(Lambt**2*sin2thetaBL) - Lambtprm_r*Sigma_r*pdotxir**2/(Lambt**2*sin2thetaBL) + 2*Lambt_r*Lambtprm_r*Sigma*pdotxir**2/(Lambt**3*sin2thetaBL)
    Hnsradicand_rprm_r = Q4_rprm_r + gammappsum_rprm_r
    alpha_rprm_r = Lambt*np.sqrt(Deltat*Sigma/Lambt)*(Deltat*Sigma_rprm_r/(2*Lambt) - Deltat*Lambt_r*Sigmaprm_r/(2*Lambt**2) - Deltat*Lambt_rprm_r*Sigma/(2*Lambt**2) - Deltat*Lambtprm_r*Sigma_r/(2*Lambt**2) + Deltat*Lambt_r*Lambtprm_r*Sigma/Lambt**3 + Deltat_r*Sigmaprm_r/(2*Lambt) - Deltat_r*Lambtprm_r*Sigma/(2*Lambt**2) + Deltat_rprm_r*Sigma/(2*Lambt) + Deltatprm_r*Sigma_r/(2*Lambt) - Deltatprm_r*Lambt_r*Sigma/(2*Lambt**2))/(Deltat*Sigma) - Lambt*Sigmaprm_r*np.sqrt(Deltat*Sigma/Lambt)*(Deltat*Sigma_r/(2*Lambt) - Deltat*Lambt_r*Sigma/(2*Lambt**2) + Deltat_r*Sigma/(2*Lambt))/(Deltat*Sigma**2) + Lambtprm_r*np.sqrt(Deltat*Sigma/Lambt)*(Deltat*Sigma_r/(2*Lambt) - Deltat*Lambt_r*Sigma/(2*Lambt**2) + Deltat_r*Sigma/(2*Lambt))/(Deltat*Sigma) - Deltatprm_r*Lambt*np.sqrt(Deltat*Sigma/Lambt)*(Deltat*Sigma_r/(2*Lambt) - Deltat*Lambt_r*Sigma/(2*Lambt**2) + Deltat_r*Sigma/(2*Lambt))/(Deltat**2*Sigma) + Lambt**2*np.sqrt(Deltat*Sigma/Lambt)*(Deltat*Sigma_r/(2*Lambt) - Deltat*Lambt_r*Sigma/(2*Lambt**2) + Deltat_r*Sigma/(2*Lambt))*(Deltat*Sigmaprm_r/(2*Lambt) - Deltat*Lambtprm_r*Sigma/(2*Lambt**2) + Deltatprm_r*Sigma/(2*Lambt))/(Deltat**2*Sigma**2)
    betapsum_rprm_r = omegatilde*pdotxir_rprm_r/Lambt + omegatilde_r*pdotxirprm_r/Lambt + omegatildeprm_r*pdotxir_r/Lambt - Lambt_r*omegatilde*pdotxirprm_r/Lambt**2 - Lambt_r*omegatildeprm_r*pdotxir/Lambt**2 - Lambt_rprm_r*omegatilde*pdotxir/Lambt**2 - Lambtprm_r*omegatilde*pdotxir_r/Lambt**2 - Lambtprm_r*omegatilde_r*pdotxir/Lambt**2 + 2*Lambt_r*Lambtprm_r*omegatilde*pdotxir/Lambt**3
    HssTerm3_rprm_r = Btilde**2*(Sdotn*exp2mu*xisq*(-Q_rprm_r - Q_rprm_r/(2*np.sqrt(Q)) + Q_r*Qprm_r/(4*Q**(3/2))) + Sdotn*exp2mu_r*xisq*(-Qprm_r - Qprm_r/(2*np.sqrt(Q))) + Sdotn*exp2mu_rprm_r*xisq*(-np.sqrt(Q) - Q) + Sdotn*exp2muprm_r*xisq*(-Q_r - Q_r/(2*np.sqrt(Q))) + Sdotn_r*exp2mu*xisq*(-Qprm_r - Qprm_r/(2*np.sqrt(Q))) + Sdotn_r*exp2muprm_r*xisq*(-np.sqrt(Q) - Q) + Sdotn_rprm_r*exp2mu*xisq*(-np.sqrt(Q) - Q) + Sdotnprm_r*exp2mu*xisq*(-Q_r - Q_r/(2*np.sqrt(Q))) + Sdotnprm_r*exp2mu_r*xisq*(-np.sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_rprm_r - Jtilde*Sdotv_r*pdotnprm_r - Jtilde*Sdotv_rprm_r*pdotn - Jtilde*Sdotvprm_r*pdotn_r - Jtilde_r*Sdotv*pdotnprm_r - Jtilde_r*Sdotvprm_r*pdotn - Jtilde_rprm_r*Sdotv*pdotn - Jtildeprm_r*Sdotv*pdotn_r - Jtildeprm_r*Sdotv_r*pdotn + Sdotn*pdotvr_rprm_r + Sdotn_r*pdotvrprm_r + Sdotn_rprm_r*pdotvr + Sdotnprm_r*pdotvr_r) + pdotvr_r*(-Jtilde*Sdotv*pdotnprm_r - Jtilde*Sdotvprm_r*pdotn - Jtildeprm_r*Sdotv*pdotn + Sdotn*pdotvrprm_r + Sdotnprm_r*pdotvr) + pdotvr_rprm_r*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + pdotvrprm_r*(-Jtilde*Sdotv*pdotn_r - Jtilde*Sdotv_r*pdotn - Jtilde_r*Sdotv*pdotn + Sdotn*pdotvr_r + Sdotn_r*pdotvr)) + Btilde*Btilde_r*(Sdotn*exp2mu*xisq*(-2*Qprm_r - Qprm_r/np.sqrt(Q)) + Sdotn*exp2muprm_r*xisq*(-2*np.sqrt(Q) - 2*Q) + Sdotnprm_r*exp2mu*xisq*(-2*np.sqrt(Q) - 2*Q) + pdotvr*(-2*Jtilde*Sdotv*pdotnprm_r - 2*Jtilde*Sdotvprm_r*pdotn - 2*Jtildeprm_r*Sdotv*pdotn + 2*Sdotn*pdotvrprm_r + 2*Sdotnprm_r*pdotvr) + pdotvrprm_r*(-2*Jtilde*Sdotv*pdotn + 2*Sdotn*pdotvr)) + Btilde*Btilde_rprm_r*(-Sdotn*exp2mu*xisq*(2*np.sqrt(Q) + 2*Q) + pdotvr*(-2*Jtilde*Sdotv*pdotn + 2*Sdotn*pdotvr)) + Btilde*Btildeprm_r*(2*Sdotn*exp2mu*xisq*(-Q_r - Q_r/(2*np.sqrt(Q))) + 2*Sdotn*exp2mu_r*xisq*(-np.sqrt(Q) - Q) + 2*Sdotn_r*exp2mu*xisq*(-np.sqrt(Q) - Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn_r - Jtilde*Sdotv_r*pdotn - Jtilde_r*Sdotv*pdotn + Sdotn*pdotvr_r + Sdotn_r*pdotvr) + 2*pdotvr_r*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde_r*Btildeprm_r*(-Sdotn*exp2mu*xisq*(2*np.sqrt(Q) + 2*Q) + pdotvr*(-2*Jtilde*Sdotv*pdotn + 2*Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_rprm_r + Btilde*Jtilde*Sdotxi_r*pdotnprm_r + Btilde*Jtilde*Sdotxi_rprm_r*pdotn + Btilde*Jtilde*Sdotxiprm_r*pdotn_r + Btilde*Jtilde_r*Sdotxi*pdotnprm_r + Btilde*Jtilde_r*Sdotxiprm_r*pdotn + Btilde*Jtilde_rprm_r*Sdotxi*pdotn + Btilde*Jtildeprm_r*Sdotxi*pdotn_r + Btilde*Jtildeprm_r*Sdotxi_r*pdotn + Btilde_r*Jtilde*Sdotxi*pdotnprm_r + Btilde_r*Jtilde*Sdotxiprm_r*pdotn + Btilde_r*Jtildeprm_r*Sdotxi*pdotn + Btilde_rprm_r*Jtilde*Sdotxi*pdotn + Btildeprm_r*Jtilde*Sdotxi*pdotn_r + Btildeprm_r*Jtilde*Sdotxi_r*pdotn + Btildeprm_r*Jtilde_r*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_rprm_r - Sdotn*expmu*expnu_r*pdotxirprm_r - Sdotn*expmu*expnu_rprm_r*pdotxir - Sdotn*expmu*expnuprm_r*pdotxir_r - Sdotn*expmu_r*expnu*pdotxirprm_r - Sdotn*expmu_r*expnuprm_r*pdotxir - Sdotn*expmu_rprm_r*expnu*pdotxir - Sdotn*expmuprm_r*expnu*pdotxir_r - Sdotn*expmuprm_r*expnu_r*pdotxir - Sdotn_r*expmu*expnu*pdotxirprm_r - Sdotn_r*expmu*expnuprm_r*pdotxir - Sdotn_r*expmuprm_r*expnu*pdotxir - Sdotn_rprm_r*expmu*expnu*pdotxir - Sdotnprm_r*expmu*expnu*pdotxir_r - Sdotnprm_r*expmu*expnu_r*pdotxir - Sdotnprm_r*expmu_r*expnu*pdotxir) + expmu*expnu*pdotxir_r*(Btilde*Jtilde*Sdotxi*pdotnprm_r + Btilde*Jtilde*Sdotxiprm_r*pdotn + Btilde*Jtildeprm_r*Sdotxi*pdotn + Btildeprm_r*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxirprm_r - Sdotn*expmu*expnuprm_r*pdotxir - Sdotn*expmuprm_r*expnu*pdotxir - Sdotnprm_r*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_rprm_r*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu*pdotxirprm_r*(Btilde*Jtilde*Sdotxi*pdotn_r + Btilde*Jtilde*Sdotxi_r*pdotn + Btilde*Jtilde_r*Sdotxi*pdotn + Btilde_r*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_r - Sdotn*expmu*expnu_r*pdotxir - Sdotn*expmu_r*expnu*pdotxir - Sdotn_r*expmu*expnu*pdotxir) + expmu*expnu_r*pdotxir*(Btilde*Jtilde*Sdotxi*pdotnprm_r + Btilde*Jtilde*Sdotxiprm_r*pdotn + Btilde*Jtildeprm_r*Sdotxi*pdotn + Btildeprm_r*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxirprm_r - Sdotn*expmu*expnuprm_r*pdotxir - Sdotn*expmuprm_r*expnu*pdotxir - Sdotnprm_r*expmu*expnu*pdotxir) + expmu*expnu_r*pdotxirprm_r*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_rprm_r*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnuprm_r*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_r + Btilde*Jtilde*Sdotxi_r*pdotn + Btilde*Jtilde_r*Sdotxi*pdotn + Btilde_r*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_r - Sdotn*expmu*expnu_r*pdotxir - Sdotn*expmu_r*expnu*pdotxir - Sdotn_r*expmu*expnu*pdotxir) + expmu*expnuprm_r*pdotxir_r*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_r*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotnprm_r + Btilde*Jtilde*Sdotxiprm_r*pdotn + Btilde*Jtildeprm_r*Sdotxi*pdotn + Btildeprm_r*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxirprm_r - Sdotn*expmu*expnuprm_r*pdotxir - Sdotn*expmuprm_r*expnu*pdotxir - Sdotnprm_r*expmu*expnu*pdotxir) + expmu_r*expnu*pdotxirprm_r*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_r*expnuprm_r*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_rprm_r*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmuprm_r*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_r + Btilde*Jtilde*Sdotxi_r*pdotn + Btilde*Jtilde_r*Sdotxi*pdotn + Btilde_r*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_r - Sdotn*expmu*expnu_r*pdotxir - Sdotn*expmu_r*expnu*pdotxir - Sdotn_r*expmu*expnu*pdotxir) + expmuprm_r*expnu*pdotxir_r*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmuprm_r*expnu_r*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir)
    HssTerm3coeff_rprm_r = omegacostheta*(-Q_rprm_r - Q_rprm_r/(2*np.sqrt(Q)) + Q_r*Qprm_r/(4*Q**(3/2)))/(2*Btilde*exp2mu*expmu*expnu*(np.sqrt(Q) + Q)**2) + omegacostheta*(-Q_r - Q_r/(2*np.sqrt(Q)))*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(2*Btilde*exp2mu*expmu*expnu*(np.sqrt(Q) + Q)**3) + omegacostheta_r*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q)**2) + omegacostheta_rprm_r/(Btilde*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) + omegacosthetaprm_r*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*(np.sqrt(Q) + Q)**2) - expnu_r*omegacostheta*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)**2) - expnu_r*omegacosthetaprm_r/(Btilde*exp2mu*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)) - expnu_rprm_r*omegacostheta/(Btilde*exp2mu*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)) - expnuprm_r*omegacostheta*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu**2*(np.sqrt(Q) + Q)**2) - expnuprm_r*omegacostheta_r/(Btilde*exp2mu*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)) + 2*expnu_r*expnuprm_r*omegacostheta/(Btilde*exp2mu*expmu*expnu**3*(2*np.sqrt(Q) + 2*Q)) - expmu_r*omegacostheta*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)**2) - expmu_r*omegacosthetaprm_r/(Btilde*exp2mu*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)) + expmu_r*expnuprm_r*omegacostheta/(Btilde*exp2mu*expmu**2*expnu**2*(2*np.sqrt(Q) + 2*Q)) - expmu_rprm_r*omegacostheta/(Btilde*exp2mu*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)) - expmuprm_r*omegacostheta*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu**2*expnu*(np.sqrt(Q) + Q)**2) - expmuprm_r*omegacostheta_r/(Btilde*exp2mu*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)) + expmuprm_r*expnu_r*omegacostheta/(Btilde*exp2mu*expmu**2*expnu**2*(2*np.sqrt(Q) + 2*Q)) + 2*expmu_r*expmuprm_r*omegacostheta/(Btilde*exp2mu*expmu**3*expnu*(2*np.sqrt(Q) + 2*Q)) - exp2mu_r*omegacostheta*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu**2*expmu*expnu*(2*np.sqrt(Q) + 2*Q)**2) - exp2mu_r*omegacosthetaprm_r/(Btilde*exp2mu**2*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) + exp2mu_r*expnuprm_r*omegacostheta/(Btilde*exp2mu**2*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)) + exp2mu_r*expmuprm_r*omegacostheta/(Btilde*exp2mu**2*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)) - exp2mu_rprm_r*omegacostheta/(Btilde*exp2mu**2*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) - exp2muprm_r*omegacostheta*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu**2*expmu*expnu*(np.sqrt(Q) + Q)**2) - exp2muprm_r*omegacostheta_r/(Btilde*exp2mu**2*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) + exp2muprm_r*expnu_r*omegacostheta/(Btilde*exp2mu**2*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)) + exp2muprm_r*expmu_r*omegacostheta/(Btilde*exp2mu**2*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)) + 2*exp2mu_r*exp2muprm_r*omegacostheta/(Btilde*exp2mu**3*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) - Btilde_r*omegacostheta*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde**2*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q)**2) - Btilde_r*omegacosthetaprm_r/(Btilde**2*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) + Btilde_r*expnuprm_r*omegacostheta/(Btilde**2*exp2mu*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)) + Btilde_r*expmuprm_r*omegacostheta/(Btilde**2*exp2mu*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)) + Btilde_r*exp2muprm_r*omegacostheta/(Btilde**2*exp2mu**2*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) - Btilde_rprm_r*omegacostheta/(Btilde**2*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) - Btildeprm_r*omegacostheta*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde**2*exp2mu*expmu*expnu*(np.sqrt(Q) + Q)**2) - Btildeprm_r*omegacostheta_r/(Btilde**2*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) + Btildeprm_r*expnu_r*omegacostheta/(Btilde**2*exp2mu*expmu*expnu**2*(2*np.sqrt(Q) + 2*Q)) + Btildeprm_r*expmu_r*omegacostheta/(Btilde**2*exp2mu*expmu**2*expnu*(2*np.sqrt(Q) + 2*Q)) + Btildeprm_r*exp2mu_r*omegacostheta/(Btilde**2*exp2mu**2*expmu*expnu*(2*np.sqrt(Q) + 2*Q)) + 2*Btilde_r*Btildeprm_r*omegacostheta/(Btilde**3*exp2mu*expmu*expnu*(2*np.sqrt(Q) + 2*Q))
    HssTerm2_rprm_r = Btilde**2*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_rprm_r - Jtilde*Sdotv_r*pdotnprm_r - Jtilde*Sdotv_rprm_r*pdotn - Jtilde*Sdotvprm_r*pdotn_r - Jtilde_r*Sdotv*pdotnprm_r - Jtilde_r*Sdotvprm_r*pdotn - Jtilde_rprm_r*Sdotv*pdotn - Jtildeprm_r*Sdotv*pdotn_r - Jtildeprm_r*Sdotv_r*pdotn + Sdotn*pdotvr_rprm_r + Sdotn_r*pdotvrprm_r + Sdotn_rprm_r*pdotvr + Sdotnprm_r*pdotvr_r) + Jtilde*pdotn_r*(-Jtilde*Sdotv*pdotnprm_r - Jtilde*Sdotvprm_r*pdotn - Jtildeprm_r*Sdotv*pdotn + Sdotn*pdotvrprm_r + Sdotnprm_r*pdotvr) + Jtilde*pdotn_rprm_r*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde*pdotnprm_r*(-Jtilde*Sdotv*pdotn_r - Jtilde*Sdotv_r*pdotn - Jtilde_r*Sdotv*pdotn + Sdotn*pdotvr_r + Sdotn_r*pdotvr) + Jtilde_r*pdotn*(-Jtilde*Sdotv*pdotnprm_r - Jtilde*Sdotvprm_r*pdotn - Jtildeprm_r*Sdotv*pdotn + Sdotn*pdotvrprm_r + Sdotnprm_r*pdotvr) + Jtilde_r*pdotnprm_r*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_rprm_r*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtildeprm_r*pdotn*(-Jtilde*Sdotv*pdotn_r - Jtilde*Sdotv_r*pdotn - Jtilde_r*Sdotv*pdotn + Sdotn*pdotvr_r + Sdotn_r*pdotvr) + Jtildeprm_r*pdotn_r*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_rprm_r + Q_rprm_r/(2*np.sqrt(Q)) - Q_r*Qprm_r/(4*Q**(3/2))) + Sdotv*exp2mu_r*(Qprm_r + Qprm_r/(2*np.sqrt(Q))) + Sdotv*exp2mu_rprm_r*(np.sqrt(Q) + Q) + Sdotv*exp2muprm_r*(Q_r + Q_r/(2*np.sqrt(Q))) + Sdotv_r*exp2mu*(Qprm_r + Qprm_r/(2*np.sqrt(Q))) + Sdotv_r*exp2muprm_r*(np.sqrt(Q) + Q) + Sdotv_rprm_r*exp2mu*(np.sqrt(Q) + Q) + Sdotvprm_r*exp2mu*(Q_r + Q_r/(2*np.sqrt(Q))) + Sdotvprm_r*exp2mu_r*(np.sqrt(Q) + Q)) + Btilde*Btilde_r*xisq*(Jtilde*pdotn*(-2*Jtilde*Sdotv*pdotnprm_r - 2*Jtilde*Sdotvprm_r*pdotn - 2*Jtildeprm_r*Sdotv*pdotn + 2*Sdotn*pdotvrprm_r + 2*Sdotnprm_r*pdotvr) + Jtilde*pdotnprm_r*(-2*Jtilde*Sdotv*pdotn + 2*Sdotn*pdotvr) + Jtildeprm_r*pdotn*(-2*Jtilde*Sdotv*pdotn + 2*Sdotn*pdotvr) + Sdotv*exp2mu*(2*Qprm_r + Qprm_r/np.sqrt(Q)) + Sdotv*exp2muprm_r*(2*np.sqrt(Q) + 2*Q) + Sdotvprm_r*exp2mu*(2*np.sqrt(Q) + 2*Q)) + Btilde*Btilde_rprm_r*xisq*(Jtilde*pdotn*(-2*Jtilde*Sdotv*pdotn + 2*Sdotn*pdotvr) + Sdotv*exp2mu*(2*np.sqrt(Q) + 2*Q)) + Btilde*Btildeprm_r*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_r - Jtilde*Sdotv_r*pdotn - Jtilde_r*Sdotv*pdotn + Sdotn*pdotvr_r + Sdotn_r*pdotvr) + 2*Jtilde*pdotn_r*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Jtilde_r*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(Q_r + Q_r/(2*np.sqrt(Q))) + 2*Sdotv*exp2mu_r*(np.sqrt(Q) + Q) + 2*Sdotv_r*exp2mu*(np.sqrt(Q) + Q)) + Btilde_r*Btildeprm_r*xisq*(Jtilde*pdotn*(-2*Jtilde*Sdotv*pdotn + 2*Sdotn*pdotvr) + Sdotv*exp2mu*(2*np.sqrt(Q) + 2*Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_rprm_r - Btilde*Sdotxi*expnu_r*pdotvrprm_r - Btilde*Sdotxi*expnu_rprm_r*pdotvr - Btilde*Sdotxi*expnuprm_r*pdotvr_r - Btilde*Sdotxi_r*expnu*pdotvrprm_r - Btilde*Sdotxi_r*expnuprm_r*pdotvr - Btilde*Sdotxi_rprm_r*expnu*pdotvr - Btilde*Sdotxiprm_r*expnu*pdotvr_r - Btilde*Sdotxiprm_r*expnu_r*pdotvr - Btilde_r*Sdotxi*expnu*pdotvrprm_r - Btilde_r*Sdotxi*expnuprm_r*pdotvr - Btilde_r*Sdotxiprm_r*expnu*pdotvr - Btilde_rprm_r*Sdotxi*expnu*pdotvr - Btildeprm_r*Sdotxi*expnu*pdotvr_r - Btildeprm_r*Sdotxi*expnu_r*pdotvr - Btildeprm_r*Sdotxi_r*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_rprm_r + Sdotv*exp2nu*expmu_r*pdotxirprm_r + Sdotv*exp2nu*expmu_rprm_r*pdotxir + Sdotv*exp2nu*expmuprm_r*pdotxir_r + Sdotv*exp2nu_r*expmu*pdotxirprm_r + Sdotv*exp2nu_r*expmuprm_r*pdotxir + Sdotv*exp2nu_rprm_r*expmu*pdotxir + Sdotv*exp2nuprm_r*expmu*pdotxir_r + Sdotv*exp2nuprm_r*expmu_r*pdotxir + Sdotv_r*exp2nu*expmu*pdotxirprm_r + Sdotv_r*exp2nu*expmuprm_r*pdotxir + Sdotv_r*exp2nuprm_r*expmu*pdotxir + Sdotv_rprm_r*exp2nu*expmu*pdotxir + Sdotvprm_r*exp2nu*expmu*pdotxir_r + Sdotvprm_r*exp2nu*expmu_r*pdotxir + Sdotvprm_r*exp2nu_r*expmu*pdotxir) + expmu*pdotxir_r*(-Btilde*Sdotxi*expnu*pdotvrprm_r - Btilde*Sdotxi*expnuprm_r*pdotvr - Btilde*Sdotxiprm_r*expnu*pdotvr - Btildeprm_r*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxirprm_r + Sdotv*exp2nu*expmuprm_r*pdotxir + Sdotv*exp2nuprm_r*expmu*pdotxir + Sdotvprm_r*exp2nu*expmu*pdotxir) + expmu*pdotxir_rprm_r*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu*pdotxirprm_r*(-Btilde*Sdotxi*expnu*pdotvr_r - Btilde*Sdotxi*expnu_r*pdotvr - Btilde*Sdotxi_r*expnu*pdotvr - Btilde_r*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_r + Sdotv*exp2nu*expmu_r*pdotxir + Sdotv*exp2nu_r*expmu*pdotxir + Sdotv_r*exp2nu*expmu*pdotxir) + expmu_r*pdotxir*(-Btilde*Sdotxi*expnu*pdotvrprm_r - Btilde*Sdotxi*expnuprm_r*pdotvr - Btilde*Sdotxiprm_r*expnu*pdotvr - Btildeprm_r*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxirprm_r + Sdotv*exp2nu*expmuprm_r*pdotxir + Sdotv*exp2nuprm_r*expmu*pdotxir + Sdotvprm_r*exp2nu*expmu*pdotxir) + expmu_r*pdotxirprm_r*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_rprm_r*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmuprm_r*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_r - Btilde*Sdotxi*expnu_r*pdotvr - Btilde*Sdotxi_r*expnu*pdotvr - Btilde_r*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_r + Sdotv*exp2nu*expmu_r*pdotxir + Sdotv*exp2nu_r*expmu*pdotxir + Sdotv_r*exp2nu*expmu*pdotxir) + expmuprm_r*pdotxir_r*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir)
    HssTerm2coeff_rprm_r = Jtilde*omegar*(-Q_rprm_r - Q_rprm_r/(2*np.sqrt(Q)) + Q_r*Qprm_r/(4*Q**(3/2)))/(2*Btilde*exp2mu*expmu*expnu*xisq*(np.sqrt(Q) + Q)**2) + Jtilde*omegar*(-Q_r - Q_r/(2*np.sqrt(Q)))*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(2*Btilde*exp2mu*expmu*expnu*xisq*(np.sqrt(Q) + Q)**3) + Jtilde*omegar_r*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)**2) + Jtilde*omegar_rprm_r/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde*omegarprm_r*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*xisq*(np.sqrt(Q) + Q)**2) - Jtilde*expnu_r*omegar*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)**2) - Jtilde*expnu_r*omegarprm_r/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*expnu_rprm_r*omegar/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*expnuprm_r*omegar*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu**2*xisq*(np.sqrt(Q) + Q)**2) - Jtilde*expnuprm_r*omegar_r/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) + 2*Jtilde*expnu_r*expnuprm_r*omegar/(Btilde*exp2mu*expmu*expnu**3*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*expmu_r*omegar*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)**2) - Jtilde*expmu_r*omegarprm_r/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde*expmu_r*expnuprm_r*omegar/(Btilde*exp2mu*expmu**2*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*expmu_rprm_r*omegar/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*expmuprm_r*omegar*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu**2*expnu*xisq*(np.sqrt(Q) + Q)**2) - Jtilde*expmuprm_r*omegar_r/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde*expmuprm_r*expnu_r*omegar/(Btilde*exp2mu*expmu**2*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) + 2*Jtilde*expmu_r*expmuprm_r*omegar/(Btilde*exp2mu*expmu**3*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*exp2mu_r*omegar*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)**2) - Jtilde*exp2mu_r*omegarprm_r/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde*exp2mu_r*expnuprm_r*omegar/(Btilde*exp2mu**2*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde*exp2mu_r*expmuprm_r*omegar/(Btilde*exp2mu**2*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*exp2mu_rprm_r*omegar/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde*exp2muprm_r*omegar*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu**2*expmu*expnu*xisq*(np.sqrt(Q) + Q)**2) - Jtilde*exp2muprm_r*omegar_r/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde*exp2muprm_r*expnu_r*omegar/(Btilde*exp2mu**2*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde*exp2muprm_r*expmu_r*omegar/(Btilde*exp2mu**2*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + 2*Jtilde*exp2mu_r*exp2muprm_r*omegar/(Btilde*exp2mu**3*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde_r*omegar*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)**2) + Jtilde_r*omegarprm_r/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde_r*expnuprm_r*omegar/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde_r*expmuprm_r*omegar/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtilde_r*exp2muprm_r*omegar/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtilde_rprm_r*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Jtildeprm_r*omegar*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*xisq*(np.sqrt(Q) + Q)**2) + Jtildeprm_r*omegar_r/(Btilde*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtildeprm_r*expnu_r*omegar/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtildeprm_r*expmu_r*omegar/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Jtildeprm_r*exp2mu_r*omegar/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Btilde_r*Jtilde*omegar*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)**2) - Btilde_r*Jtilde*omegarprm_r/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Btilde_r*Jtilde*expnuprm_r*omegar/(Btilde**2*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) + Btilde_r*Jtilde*expmuprm_r*omegar/(Btilde**2*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Btilde_r*Jtilde*exp2muprm_r*omegar/(Btilde**2*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Btilde_r*Jtildeprm_r*omegar/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Btilde_rprm_r*Jtilde*omegar/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Btildeprm_r*Jtilde*omegar*(-Q_r - Q_r/(2*np.sqrt(Q)))/(2*Btilde**2*exp2mu*expmu*expnu*xisq*(np.sqrt(Q) + Q)**2) - Btildeprm_r*Jtilde*omegar_r/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Btildeprm_r*Jtilde*expnu_r*omegar/(Btilde**2*exp2mu*expmu*expnu**2*xisq*(2*np.sqrt(Q) + 2*Q)) + Btildeprm_r*Jtilde*expmu_r*omegar/(Btilde**2*exp2mu*expmu**2*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + Btildeprm_r*Jtilde*exp2mu_r*omegar/(Btilde**2*exp2mu**2*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) - Btildeprm_r*Jtilde_r*omegar/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q)) + 2*Btilde_r*Btildeprm_r*Jtilde*omegar/(Btilde**3*exp2mu*expmu*expnu*xisq*(2*np.sqrt(Q) + 2*Q))
    HssTerm1_rprm_r = SdotSkerrhat*omega_rprm_r + SdotSkerrhat_r*omegaprm_r + SdotSkerrhat_rprm_r*omega + SdotSkerrhatprm_r*omega_r
    Hss_rprm_r = HssTerm1_rprm_r + HssTerm2*HssTerm2coeff_rprm_r + HssTerm2_r*HssTerm2coeffprm_r + HssTerm2_rprm_r*HssTerm2coeff + HssTerm2coeff_r*HssTerm2prm_r + HssTerm3*HssTerm3coeff_rprm_r + HssTerm3_r*HssTerm3coeffprm_r + HssTerm3_rprm_r*HssTerm3coeff + HssTerm3coeff_r*HssTerm3prm_r
    HsoTerm2c_rprm_r = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_rprm_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_r*pdotxirprm_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_rprm_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnuprm_r*pdotxir_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_r*expnu*pdotxirprm_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_r*expnuprm_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_rprm_r*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmuprm_r*expnu*pdotxir_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmuprm_r*expnu_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_r*expmu*expnu*pdotxirprm_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_r*expmu*expnuprm_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_r*expmuprm_r*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_rprm_r*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotvprm_r*expmu*expnu*pdotxir_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotvprm_r*expmu*expnu_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotvprm_r*expmu_r*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde*Q_r*Sdotv*expmu*expnu*pdotxirprm_r/(2*np.sqrt(Q)) + Brtilde*Jtilde*Q_r*Sdotv*expmu*expnuprm_r*pdotxir/(2*np.sqrt(Q)) + Brtilde*Jtilde*Q_r*Sdotv*expmuprm_r*expnu*pdotxir/(2*np.sqrt(Q)) + Brtilde*Jtilde*Q_r*Sdotvprm_r*expmu*expnu*pdotxir/(2*np.sqrt(Q)) + Brtilde*Jtilde*Q_rprm_r*Sdotv*expmu*expnu*pdotxir/(2*np.sqrt(Q)) + Brtilde*Jtilde*Qprm_r*Sdotv*expmu*expnu*pdotxir_r/(2*np.sqrt(Q)) + Brtilde*Jtilde*Qprm_r*Sdotv*expmu*expnu_r*pdotxir/(2*np.sqrt(Q)) + Brtilde*Jtilde*Qprm_r*Sdotv*expmu_r*expnu*pdotxir/(2*np.sqrt(Q)) + Brtilde*Jtilde*Qprm_r*Sdotv_r*expmu*expnu*pdotxir/(2*np.sqrt(Q)) - Brtilde*Jtilde*Q_r*Qprm_r*Sdotv*expmu*expnu*pdotxir/(4*Q**(3/2)) + Brtilde*Jtilde_r*Sdotv*expmu*expnu*pdotxirprm_r*(np.sqrt(Q) + 1) + Brtilde*Jtilde_r*Sdotv*expmu*expnuprm_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde_r*Sdotv*expmuprm_r*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde_r*Sdotvprm_r*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtilde_r*Qprm_r*Sdotv*expmu*expnu*pdotxir/(2*np.sqrt(Q)) + Brtilde*Jtilde_rprm_r*Sdotv*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtildeprm_r*Sdotv*expmu*expnu*pdotxir_r*(np.sqrt(Q) + 1) + Brtilde*Jtildeprm_r*Sdotv*expmu*expnu_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtildeprm_r*Sdotv*expmu_r*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtildeprm_r*Sdotv_r*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde*Jtildeprm_r*Q_r*Sdotv*expmu*expnu*pdotxir/(2*np.sqrt(Q)) + Brtilde_r*Jtilde*Sdotv*expmu*expnu*pdotxirprm_r*(np.sqrt(Q) + 1) + Brtilde_r*Jtilde*Sdotv*expmu*expnuprm_r*pdotxir*(np.sqrt(Q) + 1) + Brtilde_r*Jtilde*Sdotv*expmuprm_r*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde_r*Jtilde*Sdotvprm_r*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde_r*Jtilde*Qprm_r*Sdotv*expmu*expnu*pdotxir/(2*np.sqrt(Q)) + Brtilde_r*Jtildeprm_r*Sdotv*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtilde_rprm_r*Jtilde*Sdotv*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtildeprm_r*Jtilde*Sdotv*expmu*expnu*pdotxir_r*(np.sqrt(Q) + 1) + Brtildeprm_r*Jtilde*Sdotv*expmu*expnu_r*pdotxir*(np.sqrt(Q) + 1) + Brtildeprm_r*Jtilde*Sdotv*expmu_r*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtildeprm_r*Jtilde*Sdotv_r*expmu*expnu*pdotxir*(np.sqrt(Q) + 1) + Brtildeprm_r*Jtilde*Q_r*Sdotv*expmu*expnu*pdotxir/(2*np.sqrt(Q)) + Brtildeprm_r*Jtilde_r*Sdotv*expmu*expnu*pdotxir*(np.sqrt(Q) + 1)
    HsoTerm2b_rprm_r = Btilde*expmu*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur_rprm_r + Jtilde*Sdotv_r*nurprm_r + Jtilde*Sdotv_rprm_r*nur + Jtilde*Sdotvprm_r*nur_r + Jtilde_r*Sdotv*nurprm_r + Jtilde_r*Sdotvprm_r*nur + Jtilde_rprm_r*Sdotv*nur + Jtildeprm_r*Sdotv*nur_r + Jtildeprm_r*Sdotv_r*nur - Sdotn*nucostheta_rprm_r*xisq - Sdotn_r*nucosthetaprm_r*xisq - Sdotn_rprm_r*nucostheta*xisq - Sdotnprm_r*nucostheta_r*xisq) + Btilde*expmu*expnu*pdotxir_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nurprm_r + Jtilde*Sdotvprm_r*nur + Jtildeprm_r*Sdotv*nur - Sdotn*nucosthetaprm_r*xisq - Sdotnprm_r*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_rprm_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu*pdotxirprm_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur_r + Jtilde*Sdotv_r*nur + Jtilde_r*Sdotv*nur - Sdotn*nucostheta_r*xisq - Sdotn_r*nucostheta*xisq) + Btilde*expmu*expnu_r*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nurprm_r + Jtilde*Sdotvprm_r*nur + Jtildeprm_r*Sdotv*nur - Sdotn*nucosthetaprm_r*xisq - Sdotnprm_r*nucostheta*xisq) + Btilde*expmu*expnu_r*pdotxirprm_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_rprm_r*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnuprm_r*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur_r + Jtilde*Sdotv_r*nur + Jtilde_r*Sdotv*nur - Sdotn*nucostheta_r*xisq - Sdotn_r*nucostheta*xisq) + Btilde*expmu*expnuprm_r*pdotxir_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_r*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nurprm_r + Jtilde*Sdotvprm_r*nur + Jtildeprm_r*Sdotv*nur - Sdotn*nucosthetaprm_r*xisq - Sdotnprm_r*nucostheta*xisq) + Btilde*expmu_r*expnu*pdotxirprm_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_r*expnuprm_r*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_rprm_r*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmuprm_r*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur_r + Jtilde*Sdotv_r*nur + Jtilde_r*Sdotv*nur - Sdotn*nucostheta_r*xisq - Sdotn_r*nucostheta*xisq) + Btilde*expmuprm_r*expnu*pdotxir_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmuprm_r*expnu_r*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_r*expmu*expnu*pdotxir*(Jtilde*Sdotv*nurprm_r + Jtilde*Sdotvprm_r*nur + Jtildeprm_r*Sdotv*nur - Sdotn*nucosthetaprm_r*xisq - Sdotnprm_r*nucostheta*xisq)/np.sqrt(Q) + Btilde*Q_r*expmu*expnu*pdotxirprm_r*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) + Btilde*Q_r*expmu*expnuprm_r*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) + Btilde*Q_r*expmuprm_r*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) + Btilde*Q_rprm_r*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) + Btilde*Qprm_r*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur_r + Jtilde*Sdotv_r*nur + Jtilde_r*Sdotv*nur - Sdotn*nucostheta_r*xisq - Sdotn_r*nucostheta*xisq)/np.sqrt(Q) + Btilde*Qprm_r*expmu*expnu*pdotxir_r*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) + Btilde*Qprm_r*expmu*expnu_r*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) + Btilde*Qprm_r*expmu_r*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) - Btilde*Q_r*Qprm_r*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/(2*Q**(3/2)) + Btilde_r*expmu*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nurprm_r + Jtilde*Sdotvprm_r*nur + Jtildeprm_r*Sdotv*nur - Sdotn*nucosthetaprm_r*xisq - Sdotnprm_r*nucostheta*xisq) + Btilde_r*expmu*expnu*pdotxirprm_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde_r*expmu*expnuprm_r*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde_r*expmuprm_r*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde_r*Qprm_r*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q) + Btilde_rprm_r*expmu*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btildeprm_r*expmu*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur_r + Jtilde*Sdotv_r*nur + Jtilde_r*Sdotv*nur - Sdotn*nucostheta_r*xisq - Sdotn_r*nucostheta*xisq) + Btildeprm_r*expmu*expnu*pdotxir_r*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btildeprm_r*expmu*expnu_r*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btildeprm_r*expmu_r*expnu*pdotxir*(2*np.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btildeprm_r*Q_r*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/np.sqrt(Q)
    HsoTerm2a_rprm_r = Btilde**2*Jtilde*Sdotxi*(-np.sqrt(Q)*(nur*pdotvr_rprm_r + nur_r*pdotvrprm_r + nur_rprm_r*pdotvr + nurprm_r*pdotvr_r + pdotn*xisq*(mucostheta_rprm_r - nucostheta_rprm_r) + pdotn_r*xisq*(mucosthetaprm_r - nucosthetaprm_r) + pdotn_rprm_r*xisq*(mucostheta - nucostheta) + pdotnprm_r*xisq*(mucostheta_r - nucostheta_r)) - mucostheta*pdotn_rprm_r*xisq - mucostheta_r*pdotnprm_r*xisq - mucostheta_rprm_r*pdotn*xisq - mucosthetaprm_r*pdotn_r*xisq + mur*pdotvr_rprm_r*(np.sqrt(Q) + 1) + mur_r*pdotvrprm_r*(np.sqrt(Q) + 1) + mur_rprm_r*pdotvr*(np.sqrt(Q) + 1) + murprm_r*pdotvr_r*(np.sqrt(Q) + 1) + Q_r*mur*pdotvrprm_r/(2*np.sqrt(Q)) + Q_r*murprm_r*pdotvr/(2*np.sqrt(Q)) + Q_r*(-nur*pdotvrprm_r - nurprm_r*pdotvr + pdotn*xisq*(-mucosthetaprm_r + nucosthetaprm_r) + pdotnprm_r*xisq*(-mucostheta + nucostheta))/(2*np.sqrt(Q)) + Q_rprm_r*mur*pdotvr/(2*np.sqrt(Q)) + Q_rprm_r*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta))/(2*np.sqrt(Q)) + Qprm_r*mur*pdotvr_r/(2*np.sqrt(Q)) + Qprm_r*mur_r*pdotvr/(2*np.sqrt(Q)) - Qprm_r*(nur*pdotvr_r + nur_r*pdotvr + pdotn*xisq*(mucostheta_r - nucostheta_r) + pdotn_r*xisq*(mucostheta - nucostheta))/(2*np.sqrt(Q)) - Q_r*Qprm_r*mur*pdotvr/(4*Q**(3/2)) - Q_r*Qprm_r*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta))/(4*Q**(3/2))) + Btilde**2*Jtilde*Sdotxi_r*(np.sqrt(Q)*(-nur*pdotvrprm_r - nurprm_r*pdotvr + pdotn*xisq*(-mucosthetaprm_r + nucosthetaprm_r) + pdotnprm_r*xisq*(-mucostheta + nucostheta)) - mucostheta*pdotnprm_r*xisq - mucosthetaprm_r*pdotn*xisq + mur*pdotvrprm_r*(np.sqrt(Q) + 1) + murprm_r*pdotvr*(np.sqrt(Q) + 1) + Qprm_r*mur*pdotvr/(2*np.sqrt(Q)) + Qprm_r*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta))/(2*np.sqrt(Q))) + Btilde**2*Jtilde*Sdotxi_rprm_r*(np.sqrt(Q)*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(np.sqrt(Q) + 1)) + Btilde**2*Jtilde*Sdotxiprm_r*(-np.sqrt(Q)*(nur*pdotvr_r + nur_r*pdotvr + pdotn*xisq*(mucostheta_r - nucostheta_r) + pdotn_r*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn_r*xisq - mucostheta_r*pdotn*xisq + mur*pdotvr_r*(np.sqrt(Q) + 1) + mur_r*pdotvr*(np.sqrt(Q) + 1) + Q_r*mur*pdotvr/(2*np.sqrt(Q)) + Q_r*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta))/(2*np.sqrt(Q))) + Btilde**2*Jtilde_r*Sdotxi*(np.sqrt(Q)*(-nur*pdotvrprm_r - nurprm_r*pdotvr + pdotn*xisq*(-mucosthetaprm_r + nucosthetaprm_r) + pdotnprm_r*xisq*(-mucostheta + nucostheta)) - mucostheta*pdotnprm_r*xisq - mucosthetaprm_r*pdotn*xisq + mur*pdotvrprm_r*(np.sqrt(Q) + 1) + murprm_r*pdotvr*(np.sqrt(Q) + 1) + Qprm_r*mur*pdotvr/(2*np.sqrt(Q)) + Qprm_r*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta))/(2*np.sqrt(Q))) + Btilde**2*Jtilde_r*Sdotxiprm_r*(np.sqrt(Q)*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(np.sqrt(Q) + 1)) + Btilde**2*Jtilde_rprm_r*Sdotxi*(np.sqrt(Q)*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(np.sqrt(Q) + 1)) + Btilde**2*Jtildeprm_r*Sdotxi*(-np.sqrt(Q)*(nur*pdotvr_r + nur_r*pdotvr + pdotn*xisq*(mucostheta_r - nucostheta_r) + pdotn_r*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn_r*xisq - mucostheta_r*pdotn*xisq + mur*pdotvr_r*(np.sqrt(Q) + 1) + mur_r*pdotvr*(np.sqrt(Q) + 1) + Q_r*mur*pdotvr/(2*np.sqrt(Q)) + Q_r*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta))/(2*np.sqrt(Q))) + Btilde**2*Jtildeprm_r*Sdotxi_r*(np.sqrt(Q)*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(np.sqrt(Q) + 1)) + Btilde*Btilde_r*Jtilde*Sdotxi*(np.sqrt(Q)*(-2*nur*pdotvrprm_r - 2*nurprm_r*pdotvr + 2*pdotn*xisq*(-mucosthetaprm_r + nucosthetaprm_r) + 2*pdotnprm_r*xisq*(-mucostheta + nucostheta)) - 2*mucostheta*pdotnprm_r*xisq - 2*mucosthetaprm_r*pdotn*xisq + mur*pdotvrprm_r*(2*np.sqrt(Q) + 2) + murprm_r*pdotvr*(2*np.sqrt(Q) + 2) + Qprm_r*mur*pdotvr/np.sqrt(Q) + Qprm_r*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta))/np.sqrt(Q)) + Btilde*Btilde_r*Jtilde*Sdotxiprm_r*(np.sqrt(Q)*(-2*nur*pdotvr + 2*pdotn*xisq*(-mucostheta + nucostheta)) - 2*mucostheta*pdotn*xisq + mur*pdotvr*(2*np.sqrt(Q) + 2)) + Btilde*Btilde_r*Jtildeprm_r*Sdotxi*(np.sqrt(Q)*(-2*nur*pdotvr + 2*pdotn*xisq*(-mucostheta + nucostheta)) - 2*mucostheta*pdotn*xisq + mur*pdotvr*(2*np.sqrt(Q) + 2)) + Btilde*Btilde_rprm_r*Jtilde*Sdotxi*(np.sqrt(Q)*(-2*nur*pdotvr + 2*pdotn*xisq*(-mucostheta + nucostheta)) - 2*mucostheta*pdotn*xisq + mur*pdotvr*(2*np.sqrt(Q) + 2)) + Btilde*Btildeprm_r*Jtilde*Sdotxi*(-2*np.sqrt(Q)*(nur*pdotvr_r + nur_r*pdotvr + pdotn*xisq*(mucostheta_r - nucostheta_r) + pdotn_r*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn_r*xisq - 2*mucostheta_r*pdotn*xisq + 2*mur*pdotvr_r*(np.sqrt(Q) + 1) + 2*mur_r*pdotvr*(np.sqrt(Q) + 1) + Q_r*mur*pdotvr/np.sqrt(Q) + Q_r*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta))/np.sqrt(Q)) + Btilde*Btildeprm_r*Jtilde*Sdotxi_r*(2*np.sqrt(Q)*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(np.sqrt(Q) + 1)) + Btilde*Btildeprm_r*Jtilde_r*Sdotxi*(2*np.sqrt(Q)*(-nur*pdotvr + pdotn*xisq*(-mucostheta + nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(np.sqrt(Q) + 1)) + Btilde_r*Btildeprm_r*Jtilde*Sdotxi*(np.sqrt(Q)*(-2*nur*pdotvr + 2*pdotn*xisq*(-mucostheta + nucostheta)) - 2*mucostheta*pdotn*xisq + mur*pdotvr*(2*np.sqrt(Q) + 2))
    HsoTerm2_rprm_r = HsoTerm2a_rprm_r + HsoTerm2b_rprm_r - HsoTerm2c_rprm_r
    HsoTerm2coeff_rprm_r = expnu*(-Q_rprm_r - Q_rprm_r/(2*np.sqrt(Q)) + Q_r*Qprm_r/(4*Q**(3/2)))/(Btilde**2*exp2mu*xisq*(np.sqrt(Q) + Q)**2) + expnu*(-Q_r - Q_r/(2*np.sqrt(Q)))*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde**2*exp2mu*xisq*(np.sqrt(Q) + Q)**3) + expnu_r*(-Qprm_r - Qprm_r/(2*np.sqrt(Q)))/(Btilde**2*exp2mu*xisq*(np.sqrt(Q) + Q)**2) + expnu_rprm_r/(Btilde**2*exp2mu*xisq*(np.sqrt(Q) + Q)) + expnuprm_r*(-Q_r - Q_r/(2*np.sqrt(Q)))/(Btilde**2*exp2mu*xisq*(np.sqrt(Q) + Q)**2) - exp2mu_r*expnu*(-Qprm_r - Qprm_r/(2*np.sqrt(Q)))/(Btilde**2*exp2mu**2*xisq*(np.sqrt(Q) + Q)**2) - exp2mu_r*expnuprm_r/(Btilde**2*exp2mu**2*xisq*(np.sqrt(Q) + Q)) - exp2mu_rprm_r*expnu/(Btilde**2*exp2mu**2*xisq*(np.sqrt(Q) + Q)) - exp2muprm_r*expnu*(-Q_r - Q_r/(2*np.sqrt(Q)))/(Btilde**2*exp2mu**2*xisq*(np.sqrt(Q) + Q)**2) - exp2muprm_r*expnu_r/(Btilde**2*exp2mu**2*xisq*(np.sqrt(Q) + Q)) + 2*exp2mu_r*exp2muprm_r*expnu/(Btilde**2*exp2mu**3*xisq*(np.sqrt(Q) + Q)) - Btilde_r*expnu*(-2*Qprm_r - Qprm_r/np.sqrt(Q))/(Btilde**3*exp2mu*xisq*(np.sqrt(Q) + Q)**2) - 2*Btilde_r*expnuprm_r/(Btilde**3*exp2mu*xisq*(np.sqrt(Q) + Q)) + 2*Btilde_r*exp2muprm_r*expnu/(Btilde**3*exp2mu**2*xisq*(np.sqrt(Q) + Q)) - 2*Btilde_rprm_r*expnu/(Btilde**3*exp2mu*xisq*(np.sqrt(Q) + Q)) - Btildeprm_r*expnu*(-2*Q_r - Q_r/np.sqrt(Q))/(Btilde**3*exp2mu*xisq*(np.sqrt(Q) + Q)**2) - 2*Btildeprm_r*expnu_r/(Btilde**3*exp2mu*xisq*(np.sqrt(Q) + Q)) + 2*Btildeprm_r*exp2mu_r*expnu/(Btilde**3*exp2mu**2*xisq*(np.sqrt(Q) + Q)) + 6*Btilde_r*Btildeprm_r*expnu/(Btilde**4*exp2mu*xisq*(np.sqrt(Q) + Q))
    HsoTerm1_rprm_r = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_rprm_r + expmu*expnu_rprm_r + expmu_r*expnuprm_r + expmu_rprm_r*expnu + expmuprm_r*expnu_r)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir_r*(-Btildeprm_r + expmu*expnuprm_r + expmuprm_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir_rprm_r*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxirprm_r*(-Btilde_r + expmu*expnu_r + expmu_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_r*pdotxir*(-Btildeprm_r + expmu*expnuprm_r + expmuprm_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) - SdotSkerrhat*exp2nu*expmu_r*pdotxirprm_r*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) - SdotSkerrhat*exp2nu*expmu_rprm_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) - SdotSkerrhat*exp2nu*expmuprm_r*pdotxir*(-Btilde_r + expmu*expnu_r + expmu_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) - SdotSkerrhat*exp2nu*expmuprm_r*pdotxir_r*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) + SdotSkerrhat*exp2nu*expmu_r*expmuprm_r*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**3*xisq) + SdotSkerrhat*exp2nu_r*pdotxir*(-Btildeprm_r + expmu*expnuprm_r + expmuprm_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu_r*pdotxirprm_r*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu_r*expmuprm_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) + SdotSkerrhat*exp2nu_rprm_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nuprm_r*pdotxir*(-Btilde_r + expmu*expnu_r + expmu_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nuprm_r*pdotxir_r*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nuprm_r*expmu_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) + SdotSkerrhat_r*exp2nu*pdotxir*(-Btildeprm_r + expmu*expnuprm_r + expmuprm_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat_r*exp2nu*pdotxirprm_r*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) - SdotSkerrhat_r*exp2nu*expmuprm_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) + SdotSkerrhat_r*exp2nuprm_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhat_rprm_r*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhatprm_r*exp2nu*pdotxir*(-Btilde_r + expmu*expnu_r + expmu_r*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) + SdotSkerrhatprm_r*exp2nu*pdotxir_r*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) - SdotSkerrhatprm_r*exp2nu*expmu_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu**2*xisq) + SdotSkerrhatprm_r*exp2nu_r*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*np.sqrt(Q)*expmu*xisq) - Q_r*SdotSkerrhat*exp2nu*pdotxir*(-Btildeprm_r + expmu*expnuprm_r + expmuprm_r*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Q_r*SdotSkerrhat*exp2nu*pdotxirprm_r*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) + Q_r*SdotSkerrhat*exp2nu*expmuprm_r*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu**2*xisq) - Q_r*SdotSkerrhat*exp2nuprm_r*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Q_r*SdotSkerrhatprm_r*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Q_rprm_r*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Qprm_r*SdotSkerrhat*exp2nu*pdotxir*(-Btilde_r + expmu*expnu_r + expmu_r*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Qprm_r*SdotSkerrhat*exp2nu*pdotxir_r*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) + Qprm_r*SdotSkerrhat*exp2nu*expmu_r*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu**2*xisq) - Qprm_r*SdotSkerrhat*exp2nu_r*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Qprm_r*SdotSkerrhat_r*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) + Q_r*Qprm_r*SdotSkerrhat*exp2nu*pdotxir*(-3*Btilde + 3*expmu*expnu)/(4*Btilde**2*Q**(5/2)*expmu*xisq) - Btilde_r*SdotSkerrhat*exp2nu*pdotxir*(-2*Btildeprm_r + 2*expmu*expnuprm_r + 2*expmuprm_r*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) - Btilde_r*SdotSkerrhat*exp2nu*pdotxirprm_r*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) + Btilde_r*SdotSkerrhat*exp2nu*expmuprm_r*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu**2*xisq) - Btilde_r*SdotSkerrhat*exp2nuprm_r*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) - Btilde_r*SdotSkerrhatprm_r*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) + Btilde_r*Qprm_r*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(2*Btilde**3*Q**(3/2)*expmu*xisq) - Btilde_rprm_r*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) - Btildeprm_r*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde_r + 2*expmu*expnu_r + 2*expmu_r*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) - Btildeprm_r*SdotSkerrhat*exp2nu*pdotxir_r*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) + Btildeprm_r*SdotSkerrhat*exp2nu*expmu_r*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu**2*xisq) - Btildeprm_r*SdotSkerrhat*exp2nu_r*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) - Btildeprm_r*SdotSkerrhat_r*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*np.sqrt(Q)*expmu*xisq) + Btildeprm_r*Q_r*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(Btilde**3*Q**(3/2)*expmu*xisq) + Btilde_r*Btildeprm_r*SdotSkerrhat*exp2nu*pdotxir*(-6*Btilde + 6*expmu*expnu)/(Btilde**4*np.sqrt(Q)*expmu*xisq)
    Hso_rprm_r = HsoTerm1_rprm_r + HsoTerm2*HsoTerm2coeff_rprm_r + HsoTerm2_r*HsoTerm2coeffprm_r + HsoTerm2_rprm_r*HsoTerm2coeff + HsoTerm2coeff_r*HsoTerm2prm_r
    Hd_rprm_r = Hdcoeff*Hdsum_rprm_r + Hdcoeff_r*Hdsumprm_r + Hdcoeff_rprm_r*Hdsum + Hdcoeffprm_r*Hdsum_r
    Hns_rprm_r = np.sqrt(Hnsradicand)*alpha_rprm_r + betapsum_rprm_r + Hnsradicand_r*alphaprm_r/(2*np.sqrt(Hnsradicand)) + Hnsradicand_rprm_r*alpha/(2*np.sqrt(Hnsradicand)) + Hnsradicandprm_r*alpha_r/(2*np.sqrt(Hnsradicand)) - Hnsradicand_r*Hnsradicandprm_r*alpha/(4*Hnsradicand**(3/2))
    Hs_rprm_r = Hso_rprm_r + Hss_rprm_r
    Heff_rprm_r = -Hd_rprm_r + Hns_rprm_r + Hs_rprm_r + 4*dSS*eta*u**3*u_rprm_r*(S1phi**2 + S1r**2 + S1theta**2 + S2phi**2 + S2r**2 + S2theta**2) + 12*dSS*eta*u**2*u_r*uprm_r*(S1phi**2 + S1r**2 + S1theta**2 + S2phi**2 + S2r**2 + S2theta**2)
    Hreal_rprm_r = -Heff_r*Heffprm_r*eta**2/(2*eta*(Heff - 1) + 1)**(3/2) + Heff_rprm_r*eta/np.sqrt(2*eta*(Heff - 1) + 1)
    Hreal=np.sqrt(1+2*eta*(Heff-1))
    return np.array([Hreal_rprm_r])