int ham_first_derivs(double dvalues[],double dcsi[],double m1,double m2,int tortoise,double values[]){
    double x = values[0]
    double y = values[1]
    double z = values[2]
    double p1 = values[3]
    double p2 = values[4]
    double p3 = values[5]
    double S1x = values[6]
    double S1y = values[7]
    double S1z = values[8]
    double S2x = values[9]
    double S2y = values[10]
    double S2z = values[11]
    double EMgamma = 0.57721566490153286;
    double M = m1 + m2;
    double mu = m1*m2/M;
    double eta = mu/M;
    double r = sqrt(pow(x, 2) + pow(y, 2) + pow(z, 2));
    double u = 1.0/r;
    double sigmastar3 = S1z*m2/m1 + S2z*m1/m2;
    double sigmastar2 = S1y*m2/m1 + S2y*m1/m2;
    double sigmastar1 = S1x*m2/m1 + S2x*m1/m2;
    double sigma3 = S1z + S2z;
    double sigma2 = S1y + S2y;
    double sigma1 = S1x + S2x;
    double Skerr3 = sigma3;
    double Skerr2 = sigma2;
    double Skerr1 = sigma1;
    double Skerrmag = sqrt(pow(Skerr1, 2) + pow(Skerr2, 2) + pow(Skerr3, 2));
    double Skerrhat3 = Skerr3/Skerrmag;
    double Skerrhat2 = Skerr2/Skerrmag;
    double Skerrhat1 = Skerr1/Skerrmag;
    double a = Skerrmag;
    double L3 = -p1*y + p2*x;
    double L2 = p1*z - p3*x;
    double L1 = -p2*z + p3*y;
    double Lnorm = sqrt(pow(L1, 2) + pow(L2, 2) + pow(L3, 2));
    double Lhat3 = L3/Lnorm;
    double Lhat2 = L2/Lnorm;
    double Lhat1 = L1/Lnorm;
    double S2dotLhat = Lhat1*S2x + Lhat2*S2y + Lhat3*S2z;
    double S1dotLhat = Lhat1*S1x + Lhat2*S1y + Lhat3*S1z;
    double S1perp3 = -Lhat3*S1dotLhat + S1z;
    double S1perp2 = -Lhat2*S1dotLhat + S1y;
    double S1perp1 = -Lhat1*S1dotLhat + S1x;
    double S2perp3 = -Lhat3*S2dotLhat + S2z;
    double S2perp2 = -Lhat2*S2dotLhat + S2y;
    double S2perp1 = -Lhat1*S2dotLhat + S2x;
    double Sperp3 = S1perp3 + S2perp3;
    double Sperp2 = S1perp2 + S2perp2;
    double Sperp1 = S1perp1 + S2perp1;
    double n3 = z/r;
    double n2 = y/r;
    double n1 = x/r;
    double e33 = Skerrhat3;
    double e32 = Skerrhat2;
    double e31 = Skerrhat1;
    double xi3 = e31*n2 - e32*n1;
    double xi2 = -e31*n3 + e33*n1;
    double xi1 = e32*n3 - e33*n2;
    double v3 = n1*xi2 - n2*xi1;
    double v2 = -n1*xi3 + n3*xi1;
    double v1 = n2*xi3 - n3*xi2;
    double costheta = e31*n1 + e32*n2 + e33*n3;
    double sin2theta = 1 - pow(costheta, 2);
    double xisq = sin2theta;
    double w2 = pow(a, 2) + pow(r, 2);
    double Sigma = pow(a, 2)*pow(costheta, 2) + pow(r, 2);
    double Dinv = log(eta*pow(u, 3)*(52 - 6*eta) + 6*eta*pow(u, 2) + 1) + 1;
    double omegatilde = 2*a*r;
    double chi = (Lhat1*Skerr1 + Lhat2*Skerr2 + Lhat3*Skerr3)/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1 + (1.0/2.0)*Skerr2*Sperp2 + (1.0/2.0)*Skerr3*Sperp3)/(Skerrmag*(1.0 - 2.0*eta));
    double Kchi0 = 267.78800000000001*pow(eta, 3) - 126.687*pow(eta, 2) + 10.257300000000001*eta + 1.7336;
    double K = Kchi0 - 59.165799999999997*pow(chi, 3)*pow(eta, 3) - 0.426958*pow(chi, 3)*eta + 1.43659*pow(chi, 3) + 31.174600000000002*pow(chi, 2)*pow(eta, 3) + 6.1646599999999996*pow(chi, 2)*pow(eta, 2) - 1.38086*pow(chi, 2) - 27.520099999999999*chi*pow(eta, 3) + 17.3736*chi*pow(eta, 2) + 2.26831*chi*eta - 1.6204499999999999*chi;
    double etaKminus1 = K*eta - 1;
    double Delta0 = K*(K*eta - 2);
    double Delta1 = -2*etaKminus1*(Delta0 + K);
    double Delta2 = -Delta0*pow(a, 2)*pow(etaKminus1, 2) + (1.0/2.0)*Delta1*(Delta1 - 4*etaKminus1);
    double Delta3 = -1.0/3.0*pow(Delta1, 3) + pow(Delta1, 2)*etaKminus1 + Delta1*Delta2 - Delta1*pow(a, 2)*pow(etaKminus1, 2) - 2*etaKminus1*(Delta2 - etaKminus1);
    double Delta4 = (1.0/4.0)*pow(Delta1, 4) - 2.0/3.0*pow(Delta1, 3)*etaKminus1 - pow(Delta1, 2)*Delta2 + (1.0/12.0)*Delta1*(24*Delta2*etaKminus1 + 12*Delta3) + (1.0/2.0)*pow(Delta2, 2) - 2*Delta3*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(pow(Delta1, 2) - 2*Delta2) + (1.0/12.0)*pow(etaKminus1, 2)*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5 = pow(etaKminus1, 2)*((128.0/5.0)*EMgamma - 1.0/3.0*pow(a, 2)*(pow(Delta1, 3) - 3*Delta1*Delta2 + 3*Delta3) + eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/60.0 + (256.0/5.0)*M_LN2 + (2275.0/512.0)*pow(M_PI, 2) + (1.0/2.0)*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(pow(Delta1, 5) - 5*pow(Delta1, 3)*Delta2 + 5*pow(Delta1, 2)*Delta3 + 5*Delta1*pow(Delta2, 2) - 5*Delta1*Delta4 - 5*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l = (64.0/5.0)*pow(etaKminus1, 2);
    double logarg = u*(Delta1 + u*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u))))));
    double Deltaucalib = eta*(Delta0 + log(fabs(logarg + 1))) + 1;
    double Deltaucalibprime = -eta*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/(logarg + 1);
    double Deltaubar = pow(a, 2)*pow(u, 2) + (2*u + 1.0/etaKminus1)/etaKminus1;
    double Deltaubarprime = -2*pow(a, 2)*pow(u, 3) - 2*pow(u, 2)/etaKminus1;
    double Deltau = fabs(Deltaubar*Deltaucalib);
    double Deltauprime = Deltaubar*Deltaucalibprime + Deltaubarprime*Deltaucalib;
    double Deltatprime = 2*Deltau*r + Deltauprime*pow(r, 2);
    double Deltat = Deltau*pow(r, 2);
    double Deltar = Deltat*Dinv;
    double Lambt = fabs(Deltat*pow(a, 2)*sin2theta - pow(w2, 2));
    double csi = sqrt(fabs(Deltar*Deltat))/w2;
    double csi1 = (1 - fabs((double)tortoise - 1))*(csi - 1) + 1;
    double csi2 = (1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)))*(csi - 1) + 1;
    double prT = csi2*(n1*p1 + n2*p2 + n3*p3);
    double phat3 = -n3*prT*(1 - 1/csi1) + p3;
    double phat2 = -n2*prT*(1 - 1/csi1) + p2;
    double phat1 = -n1*prT*(1 - 1/csi1) + p1;
    double pdotxir = r*(phat1*xi1 + phat2*xi2 + phat3*xi3);
    double pdotn = n1*phat1 + n2*phat2 + n3*phat3;
    double pdotvr = r*(phat1*v1 + phat2*v2 + phat3*v3);
    double pphi = pdotxir;
    double Qcoeff2 = 1/(Sigma*sin2theta);
    double Qcoeff1 = Sigma/(Lambt*sin2theta);
    double DrSipn2 = Deltar*pow(pdotn, 2)/Sigma;
    double Q = DrSipn2 + Qcoeff1*pow(pdotxir, 2) + Qcoeff2*pow(pdotvr, 2) + 1;
    double Qminus1 = Q - 1;
    double Jtilde = sqrt(Deltar);
    double exp2mu = Sigma;
    double expmu = sqrt(exp2mu);
    double Brtilde = (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)/sqrt(Deltar*Deltat);
    double Btilde = sqrt(Deltat);
    double exp2nu = Deltat*Sigma/Lambt;
    double expnu = sqrt(exp2nu);
    double omega = omegatilde/Lambt;
    double omegatildeprime = 2*a;
    double Lambtprime = -Deltatprime*pow(a, 2)*sin2theta + r*(4*pow(a, 2) + 4*pow(r, 2));
    double mucostheta = pow(a, 2)*costheta/Sigma;
    double nucostheta = pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*Sigma);
    double omegacostheta = -2*Deltat*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur = r/Sigma - 1/sqrt(Deltar);
    double nur = r/Sigma + (1.0/2.0)*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt);
    double omegar = (Lambt*omegatildeprime - Lambtprime*omegatilde)/pow(Lambt, 2);
    double dSO = 147.48099999999999*pow(chi, 3)*pow(eta, 2) - 568.65099999999995*pow(chi, 3)*eta + 66.198700000000002*pow(chi, 3) - 343.31299999999999*pow(chi, 2)*eta + 2495.29*chi*pow(eta, 2) - 44.532400000000003;
    double sigmacoeffTerm3 = dSO*eta*pow(u, 3);
    double sigmacoeffTerm2 = (1.0/144.0)*eta*(eta*(r*(-882*DrSipn2 + 204*Qminus1 + r*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1)) - 336) + r*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))) - 896)/pow(r, 2);
    double sigmacoeffTerm1 = (1.0/12.0)*eta*(-36*DrSipn2 + 3*Qminus1 - 8/r);
    double sigmacoeff = sigmacoeffTerm1 + sigmacoeffTerm2 + sigmacoeffTerm3;
    double sigmastarcoeffTerm2 = (1.0/72.0)*eta*(eta*(r*(-324*DrSipn2 + 120*Qminus1 + r*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1))) - 54) + r*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1) + 706)/pow(r, 2);
    double sigmastarcoeffTerm1 = (1.0/12.0)*eta*(-30*DrSipn2 + 4*Qminus1 + 14/r);
    double sigmastarcoeff = sigmastarcoeffTerm1 + sigmastarcoeffTerm2;
    double Deltasigmastar3 = sigma3*sigmacoeff + sigmastar3*sigmastarcoeff;
    double Deltasigmastar2 = sigma2*sigmacoeff + sigmastar2*sigmastarcoeff;
    double Deltasigmastar1 = sigma1*sigmacoeff + sigmastar1*sigmastarcoeff;
    double Sstar3 = Deltasigmastar3 + sigmastar3;
    double Sstar2 = Deltasigmastar2 + sigmastar2;
    double Sstar1 = Deltasigmastar1 + sigmastar1;
    double S3 = Sstar3;
    double S2 = Sstar2;
    double S1 = Sstar1;
    double Sstardotn = Sstar1*n1 + Sstar2*n2 + Sstar3*n3;
    double SdotSkerrhat = S1*Skerrhat1 + S2*Skerrhat2 + S3*Skerrhat3;
    double Sdotn = S1*n1 + S2*n2 + S3*n3;
    double Sdotv = S1*v1 + S2*v2 + S3*v3;
    double Sdotxi = S1*xi1 + S2*xi2 + S3*xi3;
    double HdsumTerm2 = 3*pow(Sstardotn, 2);
    double HdsumTerm1 = pow(Sstar1, 2) + pow(Sstar2, 2) + pow(Sstar3, 2);
    double Hdsum = HdsumTerm1 - HdsumTerm2;
    double Hdcoeff = (1.0/2.0)/pow(r, 3);
    double Q4 = 2*eta*pow(prT, 4)*pow(u, 2)*(4 - 3*eta);
    double gammappsum = Deltar*pow(pdotn, 2)/Sigma + pow(pdotvr, 2)/(Sigma*sin2theta) + Sigma*pow(pdotxir, 2)/(Lambt*sin2theta);
    double Hnsradicand = Q4 + gammappsum + 1;
    double alpha = sqrt(Deltat*Sigma/Lambt);
    double betapsum = omegatilde*pphi/Lambt;
    double HssTerm3 = pow(Btilde, 2)*(-Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff = (1.0/2.0)*omegacostheta/(Btilde*exp2mu*expmu*expnu*(sqrt(Q) + Q));
    double HssTerm2 = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff = (1.0/2.0)*Jtilde*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(sqrt(Q) + Q));
    double HssTerm1 = SdotSkerrhat*omega;
    double Hss = HssTerm1 + HssTerm2*HssTerm2coeff + HssTerm3*HssTerm3coeff;
    double HsoTerm2c = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr + pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2 = HsoTerm2a + HsoTerm2b - HsoTerm2c;
    double HsoTerm2coeff = expnu/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1 = SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq);
    double Hso = HsoTerm1 + HsoTerm2*HsoTerm2coeff;
    double Hd = Hdcoeff*Hdsum;
    double Hns = sqrt(Hnsradicand)*alpha + betapsum;
    double Hs = Hso + Hss;
    double dSS = 528.51099999999997*pow(chi, 3)*pow(eta, 2) - 41.000300000000003*pow(chi, 3)*eta + 1161.78*pow(chi, 2)*pow(eta, 3) - 326.32499999999999*pow(chi, 2)*pow(eta, 2) + 37.196399999999997*chi*eta + 706.95799999999997*pow(eta, 3) - 36.027200000000001*eta + 6.0680699999999996;
    double Heff = -Hd + Hns + Hs + dSS*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal = sqrt(2*eta*(fabs(Heff) - 1) + 1);

    double r_prmx = x/sqrt(pow(x, 2) + pow(y, 2) + pow(z, 2));
    double u_prmx = -r_prmx/pow(r, 2);
    double L3_prmx = p2;
    double L2_prmx = -p3;
    double Lnorm_prmx = (L2*L2_prmx + L3*L3_prmx)/sqrt(pow(L1, 2) + pow(L2, 2) + pow(L3, 2));
    double Lhat3_prmx = -L3*Lnorm_prmx/pow(Lnorm, 2) + L3_prmx/Lnorm;
    double Lhat2_prmx = -L2*Lnorm_prmx/pow(Lnorm, 2) + L2_prmx/Lnorm;
    double Lhat1_prmx = -L1*Lnorm_prmx/pow(Lnorm, 2);
    double S2dotLhat_prmx = Lhat1_prmx*S2x + Lhat2_prmx*S2y + Lhat3_prmx*S2z;
    double S1dotLhat_prmx = Lhat1_prmx*S1x + Lhat2_prmx*S1y + Lhat3_prmx*S1z;
    double S1perp3_prmx = -Lhat3*S1dotLhat_prmx - Lhat3_prmx*S1dotLhat;
    double S1perp2_prmx = -Lhat2*S1dotLhat_prmx - Lhat2_prmx*S1dotLhat;
    double S1perp1_prmx = -Lhat1*S1dotLhat_prmx - Lhat1_prmx*S1dotLhat;
    double S2perp3_prmx = -Lhat3*S2dotLhat_prmx - Lhat3_prmx*S2dotLhat;
    double S2perp2_prmx = -Lhat2*S2dotLhat_prmx - Lhat2_prmx*S2dotLhat;
    double S2perp1_prmx = -Lhat1*S2dotLhat_prmx - Lhat1_prmx*S2dotLhat;
    double Sperp3_prmx = S1perp3_prmx + S2perp3_prmx;
    double Sperp2_prmx = S1perp2_prmx + S2perp2_prmx;
    double Sperp1_prmx = S1perp1_prmx + S2perp1_prmx;
    double n3_prmx = -r_prmx*z/pow(r, 2);
    double n2_prmx = -r_prmx*y/pow(r, 2);
    double n1_prmx = 1.0/r - r_prmx*x/pow(r, 2);
    double xi3_prmx = e31*n2_prmx - e32*n1_prmx;
    double xi2_prmx = -e31*n3_prmx + e33*n1_prmx;
    double xi1_prmx = e32*n3_prmx - e33*n2_prmx;
    double v3_prmx = n1*xi2_prmx + n1_prmx*xi2 - n2*xi1_prmx - n2_prmx*xi1;
    double v2_prmx = -n1*xi3_prmx - n1_prmx*xi3 + n3*xi1_prmx + n3_prmx*xi1;
    double v1_prmx = n2*xi3_prmx + n2_prmx*xi3 - n3*xi2_prmx - n3_prmx*xi2;
    double costheta_prmx = e31*n1_prmx + e32*n2_prmx + e33*n3_prmx;
    double sin2theta_prmx = -2*costheta*costheta_prmx;
    double xisq_prmx = sin2theta_prmx;
    double w2_prmx = 2*r*r_prmx;
    double Sigma_prmx = 2*pow(a, 2)*costheta*costheta_prmx + 2*r*r_prmx;
    double Dinv_prmx = (eta*pow(u, 2)*u_prmx*(156 - 18*eta) + 12*eta*u*u_prmx)/(eta*pow(u, 3)*(52 - 6*eta) + 6*eta*pow(u, 2) + 1);
    double omegatilde_prmx = 2*a*r_prmx;
    double chi_prmx = (Lhat1_prmx*Skerr1 + Lhat2_prmx*Skerr2 + Lhat3_prmx*Skerr3)/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmx + (1.0/2.0)*Skerr2*Sperp2_prmx + (1.0/2.0)*Skerr3*Sperp3_prmx)/(Skerrmag*(1.0 - 2.0*eta));
    double K_prmx = -177.4974*pow(chi, 2)*chi_prmx*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmx*eta + 4.3097700000000003*pow(chi, 2)*chi_prmx + 62.349200000000003*chi*chi_prmx*pow(eta, 3) + 12.329319999999999*chi*chi_prmx*pow(eta, 2) - 2.76172*chi*chi_prmx - 27.520099999999999*chi_prmx*pow(eta, 3) + 17.3736*chi_prmx*pow(eta, 2) + 2.26831*chi_prmx*eta - 1.6204499999999999*chi_prmx;
    double etaKminus1_prmx = K_prmx*eta;
    double Delta0_prmx = K*K_prmx*eta + K_prmx*(K*eta - 2);
    double Delta1_prmx = etaKminus1*(-2*Delta0_prmx - 2*K_prmx) + etaKminus1_prmx*(-2*Delta0 - 2*K);
    double Delta2_prmx = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmx - Delta0_prmx*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmx - 2*etaKminus1_prmx) + Delta1_prmx*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmx = -pow(Delta1, 2)*Delta1_prmx + pow(Delta1, 2)*etaKminus1_prmx + 2*Delta1*Delta1_prmx*etaKminus1 + Delta1*Delta2_prmx - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmx + Delta1_prmx*Delta2 - Delta1_prmx*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmx + 2*etaKminus1_prmx) + etaKminus1_prmx*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmx = pow(Delta1, 3)*Delta1_prmx - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmx - 2*pow(Delta1, 2)*Delta1_prmx*etaKminus1 - pow(Delta1, 2)*Delta2_prmx - 2*Delta1*Delta1_prmx*Delta2 + Delta1*(2*Delta2*etaKminus1_prmx + 2*Delta2_prmx*etaKminus1 + Delta3_prmx) + Delta1_prmx*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmx - 2*Delta3*etaKminus1_prmx - 2*Delta3_prmx*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmx - 2*Delta2_prmx) + pow(a, 2)*etaKminus1*etaKminus1_prmx*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmx*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmx = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmx - 3*Delta1*Delta2_prmx - 3*Delta1_prmx*Delta2 + 3*Delta3_prmx) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmx - 4*pow(Delta1, 2)*Delta2_prmx - 8*Delta1*Delta1_prmx*Delta2 + 4*Delta1*Delta3_prmx + 4*Delta1_prmx*Delta3 + 4*Delta2*Delta2_prmx - 4*Delta4_prmx)/etaKminus1 - 1.0/2.0*etaKminus1_prmx*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmx - 5*pow(Delta1, 3)*Delta2_prmx - 15*pow(Delta1, 2)*Delta1_prmx*Delta2 + 5*pow(Delta1, 2)*Delta3_prmx + 10*Delta1*Delta1_prmx*Delta3 + 10*Delta1*Delta2*Delta2_prmx - 5*Delta1*Delta4_prmx + 5*Delta1_prmx*pow(Delta2, 2) - 5*Delta1_prmx*Delta4 - 5*Delta2*Delta3_prmx - 5*Delta2_prmx*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmx*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmx*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmx = (128.0/5.0)*etaKminus1*etaKminus1_prmx;
    double logarg_prmx = u*(Delta1_prmx + u*(Delta2_prmx + u*(Delta3_prmx + u*(Delta4_prmx + u*(Delta5_prmx + Delta5l*u_prmx/u + Delta5l_prmx*log(u)) + u_prmx*(Delta5 + Delta5l*log(u))) + u_prmx*(Delta4 + u*(Delta5 + Delta5l*log(u)))) + u_prmx*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u))))) + u_prmx*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u)))))) + u_prmx*(Delta1 + u*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u))))));
    double Deltaucalib_prmx = eta*(Delta0_prmx + logarg_prmx*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmx = eta*logarg_prmx*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmx + u*(2*Delta2_prmx + u*(3*Delta3_prmx + u*(4*Delta4_prmx + u*(5*Delta5_prmx + 5*Delta5l*u_prmx/u + 5*Delta5l_prmx*log(u)) + u_prmx*(5*Delta5 + 5*Delta5l*log(u))) + u_prmx*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u)))) + u_prmx*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))) + u_prmx*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/(logarg + 1) + eta*u*u_prmx*(-2*Delta1 - 2*u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/(logarg + 1);
    double Deltaubar_prmx = 2*pow(a, 2)*u*u_prmx + (2*u_prmx - etaKminus1_prmx/pow(etaKminus1, 2))/etaKminus1 + etaKminus1_prmx*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2);
    double Deltaubarprime_prmx = -6*pow(a, 2)*pow(u, 2)*u_prmx - 4*u*u_prmx/etaKminus1 + 2*etaKminus1_prmx*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmx = (Deltaubar*Deltaucalib_prmx + Deltaubar_prmx*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmx = Deltaubar*Deltaucalibprime_prmx + Deltaubar_prmx*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmx + Deltaubarprime_prmx*Deltaucalib;
    double Deltatprime_prmx = 2*Deltau*r_prmx + 2*Deltau_prmx*r + 2*Deltauprime*r*r_prmx + Deltauprime_prmx*pow(r, 2);
    double Deltat_prmx = 2*Deltau*r*r_prmx + Deltau_prmx*pow(r, 2);
    double Deltar_prmx = Deltat*Dinv_prmx + Deltat_prmx*Dinv;
    double Lambt_prmx = (Deltat*pow(a, 2)*sin2theta_prmx + Deltat_prmx*pow(a, 2)*sin2theta - 2*w2*w2_prmx)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmx = (1.0/2.0)*(Deltar*Deltat_prmx + Deltar_prmx*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmx*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmx = csi_prmx*(1 - fabs((double)tortoise - 1));
    double csi2_prmx = csi_prmx*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmx = csi2*(n1_prmx*p1 + n2_prmx*p2 + n3_prmx*p3) + csi2_prmx*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmx = n3*prT_prmx*(-1 + 1.0/csi1) + n3_prmx*prT*(-1 + 1.0/csi1) - csi1_prmx*n3*prT/pow(csi1, 2);
    double phat2_prmx = n2*prT_prmx*(-1 + 1.0/csi1) + n2_prmx*prT*(-1 + 1.0/csi1) - csi1_prmx*n2*prT/pow(csi1, 2);
    double phat1_prmx = n1*prT_prmx*(-1 + 1.0/csi1) + n1_prmx*prT*(-1 + 1.0/csi1) - csi1_prmx*n1*prT/pow(csi1, 2);
    double pdotxir_prmx = r*(phat1*xi1_prmx + phat1_prmx*xi1 + phat2*xi2_prmx + phat2_prmx*xi2 + phat3*xi3_prmx + phat3_prmx*xi3) + r_prmx*(phat1*xi1 + phat2*xi2 + phat3*xi3);
    double pdotn_prmx = n1*phat1_prmx + n1_prmx*phat1 + n2*phat2_prmx + n2_prmx*phat2 + n3*phat3_prmx + n3_prmx*phat3;
    double pdotvr_prmx = r*(phat1*v1_prmx + phat1_prmx*v1 + phat2*v2_prmx + phat2_prmx*v2 + phat3*v3_prmx + phat3_prmx*v3) + r_prmx*(phat1*v1 + phat2*v2 + phat3*v3);
    double pphi_prmx = pdotxir_prmx;
    double Qcoeff2_prmx = -sin2theta_prmx/(Sigma*pow(sin2theta, 2)) - Sigma_prmx/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmx = -Sigma*sin2theta_prmx/(Lambt*pow(sin2theta, 2)) + Sigma_prmx/(Lambt*sin2theta) - Lambt_prmx*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmx = 2*Deltar*pdotn*pdotn_prmx/Sigma - Deltar*Sigma_prmx*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmx*pow(pdotn, 2)/Sigma;
    double Q_prmx = DrSipn2_prmx + 2*Qcoeff1*pdotxir*pdotxir_prmx + Qcoeff1_prmx*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmx + Qcoeff2_prmx*pow(pdotvr, 2);
    double Qminus1_prmx = Q_prmx;
    double Jtilde_prmx = (1.0/2.0)*Deltar_prmx/sqrt(Deltar);
    double exp2mu_prmx = Sigma_prmx;
    double expmu_prmx = (1.0/2.0)*exp2mu_prmx/sqrt(exp2mu);
    double Brtilde_prmx = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmx - 2*Deltat_prmx + (1.0/2.0)*Deltar_prmx*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmx - 1.0/2.0*Deltar_prmx*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmx = (1.0/2.0)*Deltat_prmx/sqrt(Deltat);
    double exp2nu_prmx = Deltat*Sigma_prmx/Lambt - Deltat*Lambt_prmx*Sigma/pow(Lambt, 2) + Deltat_prmx*Sigma/Lambt;
    double expnu_prmx = (1.0/2.0)*exp2nu_prmx/sqrt(exp2nu);
    double omega_prmx = omegatilde_prmx/Lambt - Lambt_prmx*omegatilde/pow(Lambt, 2);
    double Lambtprime_prmx = -Deltatprime*pow(a, 2)*sin2theta_prmx - Deltatprime_prmx*pow(a, 2)*sin2theta + 8*pow(r, 2)*r_prmx + r_prmx*(4*pow(a, 2) + 4*pow(r, 2));
    double mucostheta_prmx = pow(a, 2)*costheta_prmx/Sigma - Sigma_prmx*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmx = pow(a, 2)*costheta*w2*(-Deltat_prmx + w2_prmx)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmx*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmx*w2*(-Deltat + w2)/(Lambt*Sigma) - Sigma_prmx*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmx*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmx = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmx/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmx*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmx*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmx*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmx = r_prmx/Sigma - Sigma_prmx*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmx/pow(Deltar, 3.0/2.0);
    double nur_prmx = r_prmx/Sigma - Sigma_prmx*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat*r_prmx - 4*Deltat_prmx*r + Deltatprime*w2_prmx + Deltatprime_prmx*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmx*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmx*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmx*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmx = (Lambt_prmx*omegatildeprime - Lambtprime*omegatilde_prmx - Lambtprime_prmx*omegatilde)/pow(Lambt, 2) + Lambt_prmx*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmx = 442.44299999999998*pow(chi, 2)*chi_prmx*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmx*eta + 198.59610000000001*pow(chi, 2)*chi_prmx - 686.62599999999998*chi*chi_prmx*eta + 2495.29*chi_prmx*pow(eta, 2);
    double sigmacoeffTerm3_prmx = 3*dSO*eta*pow(u, 2)*u_prmx + dSO_prmx*eta*pow(u, 3);
    double sigmacoeffTerm2_prmx = (1.0/144.0)*eta*(eta*(r*(-882*DrSipn2_prmx + 204*Qminus1_prmx + r*(1620*DrSipn2*DrSipn2_prmx - 234*DrSipn2*Qminus1_prmx - 234*DrSipn2_prmx*Qminus1) + r_prmx*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1)) + r_prmx*(-882*DrSipn2 + 204*Qminus1 + r*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1))) + r*(-96*DrSipn2_prmx - 436*Qminus1_prmx + r*(36*DrSipn2*Qminus1_prmx + 36*DrSipn2_prmx*Qminus1 - 90*Qminus1*Qminus1_prmx) + r_prmx*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))) + r_prmx*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))))/pow(r, 2) + (1.0/72.0)*eta*r_prmx*(-eta*(r*(-882*DrSipn2 + 204*Qminus1 + r*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1)) - 336) - r*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))) + 896)/pow(r, 3);
    double sigmacoeffTerm1_prmx = eta*(-3*DrSipn2_prmx + (1.0/4.0)*Qminus1_prmx + (2.0/3.0)*r_prmx/pow(r, 2));
    double sigmacoeff_prmx = sigmacoeffTerm1_prmx + sigmacoeffTerm2_prmx + sigmacoeffTerm3_prmx;
    double sigmastarcoeffTerm2_prmx = (1.0/72.0)*eta*(eta*(r*(-324*DrSipn2_prmx + 120*Qminus1_prmx + r*(720*DrSipn2*DrSipn2_prmx + Qminus1*(-126*DrSipn2_prmx - 3*Qminus1_prmx) + Qminus1_prmx*(-126*DrSipn2 - 3*Qminus1)) + r_prmx*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1))) + r_prmx*(-324*DrSipn2 + 120*Qminus1 + r*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1)))) + r*(282*DrSipn2_prmx + Qminus1*r*(96*DrSipn2_prmx - 23*Qminus1_prmx) + Qminus1*r_prmx*(96*DrSipn2 - 23*Qminus1) + Qminus1_prmx*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmx) + r_prmx*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1))/pow(r, 2) + (1.0/36.0)*eta*r_prmx*(-eta*(r*(-324*DrSipn2 + 120*Qminus1 + r*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1))) - 54) - r*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1) - 706)/pow(r, 3);
    double sigmastarcoeffTerm1_prmx = eta*(-5.0/2.0*DrSipn2_prmx + (1.0/3.0)*Qminus1_prmx - 7.0/6.0*r_prmx/pow(r, 2));
    double sigmastarcoeff_prmx = sigmastarcoeffTerm1_prmx + sigmastarcoeffTerm2_prmx;
    double Deltasigmastar3_prmx = sigma3*sigmacoeff_prmx + sigmastar3*sigmastarcoeff_prmx;
    double Deltasigmastar2_prmx = sigma2*sigmacoeff_prmx + sigmastar2*sigmastarcoeff_prmx;
    double Deltasigmastar1_prmx = sigma1*sigmacoeff_prmx + sigmastar1*sigmastarcoeff_prmx;
    double Sstar3_prmx = Deltasigmastar3_prmx;
    double Sstar2_prmx = Deltasigmastar2_prmx;
    double Sstar1_prmx = Deltasigmastar1_prmx;
    double S3_prmx = Sstar3_prmx;
    double S2_prmx = Sstar2_prmx;
    double S1_prmx = Sstar1_prmx;
    double Sstardotn_prmx = Sstar1*n1_prmx + Sstar1_prmx*n1 + Sstar2*n2_prmx + Sstar2_prmx*n2 + Sstar3*n3_prmx + Sstar3_prmx*n3;
    double SdotSkerrhat_prmx = S1_prmx*Skerrhat1 + S2_prmx*Skerrhat2 + S3_prmx*Skerrhat3;
    double Sdotn_prmx = S1*n1_prmx + S1_prmx*n1 + S2*n2_prmx + S2_prmx*n2 + S3*n3_prmx + S3_prmx*n3;
    double Sdotv_prmx = S1*v1_prmx + S1_prmx*v1 + S2*v2_prmx + S2_prmx*v2 + S3*v3_prmx + S3_prmx*v3;
    double Sdotxi_prmx = S1*xi1_prmx + S1_prmx*xi1 + S2*xi2_prmx + S2_prmx*xi2 + S3*xi3_prmx + S3_prmx*xi3;
    double HdsumTerm2_prmx = 6*Sstardotn*Sstardotn_prmx;
    double HdsumTerm1_prmx = 2*Sstar1*Sstar1_prmx + 2*Sstar2*Sstar2_prmx + 2*Sstar3*Sstar3_prmx;
    double Hdsum_prmx = HdsumTerm1_prmx - HdsumTerm2_prmx;
    double Hdcoeff_prmx = -3.0/2.0*r_prmx/pow(r, 4);
    double Q4_prmx = eta*pow(prT, 4)*u*u_prmx*(16 - 12*eta) + eta*pow(prT, 3)*prT_prmx*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmx = 2*Deltar*pdotn*pdotn_prmx/Sigma - Deltar*Sigma_prmx*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmx*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmx/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmx/(Sigma*sin2theta) - Sigma_prmx*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmx/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmx/(Lambt*sin2theta) + Sigma_prmx*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmx*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmx = Q4_prmx + gammappsum_prmx;
    double alpha_prmx = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmx/Lambt - 1.0/2.0*Deltat*Lambt_prmx*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmx*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmx = omegatilde*pphi_prmx/Lambt + omegatilde_prmx*pphi/Lambt - Lambt_prmx*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmx = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmx - 1.0/2.0*Q_prmx/sqrt(Q)) + Sdotn*exp2mu*xisq_prmx*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmx*xisq*(-sqrt(Q) - Q) + Sdotn_prmx*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmx - Jtilde*Sdotv_prmx*pdotn - Jtilde_prmx*Sdotv*pdotn + Sdotn*pdotvr_prmx + Sdotn_prmx*pdotvr) + pdotvr_prmx*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmx*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmx + Btilde*Jtilde*Sdotxi_prmx*pdotn + Btilde*Jtilde_prmx*Sdotxi*pdotn + Btilde_prmx*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmx - Sdotn*expmu*expnu_prmx*pdotxir - Sdotn*expmu_prmx*expnu*pdotxir - Sdotn_prmx*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmx*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmx*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmx*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmx = (1.0/2.0)*omegacostheta*(-Q_prmx - 1.0/2.0*Q_prmx/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmx/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmx*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmx*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmx*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmx*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmx = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmx - Jtilde*Sdotv_prmx*pdotn - Jtilde_prmx*Sdotv*pdotn + Sdotn*pdotvr_prmx + Sdotn_prmx*pdotvr) + Jtilde*pdotn_prmx*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmx*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmx + (1.0/2.0)*Q_prmx/sqrt(Q)) + Sdotv*exp2mu_prmx*(sqrt(Q) + Q) + Sdotv_prmx*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmx*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmx*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmx - Btilde*Sdotxi*expnu_prmx*pdotvr - Btilde*Sdotxi_prmx*expnu*pdotvr - Btilde_prmx*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmx + Sdotv*exp2nu*expmu_prmx*pdotxir + Sdotv*exp2nu_prmx*expmu*pdotxir + Sdotv_prmx*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmx*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmx*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmx = (1.0/2.0)*Jtilde*omegar*(-Q_prmx - 1.0/2.0*Q_prmx/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmx/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmx/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmx*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmx*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmx*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmx*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmx*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmx = SdotSkerrhat*omega_prmx + SdotSkerrhat_prmx*omega;
    double Hss_prmx = HssTerm1_prmx + HssTerm2*HssTerm2coeff_prmx + HssTerm2_prmx*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmx + HssTerm3_prmx*HssTerm3coeff;
    double HsoTerm2c_prmx = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmx*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmx*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmx*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmx*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmx*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmx*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmx*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmx = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmx + Jtilde*Sdotv_prmx*nur + Jtilde_prmx*Sdotv*nur - Sdotn*nucostheta*xisq_prmx - Sdotn*nucostheta_prmx*xisq - Sdotn_prmx*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmx*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmx*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmx*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmx*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmx*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmx = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmx + nur_prmx*pdotvr + pdotn*xisq*(mucostheta_prmx - nucostheta_prmx) + pdotn*xisq_prmx*(mucostheta - nucostheta) + pdotn_prmx*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmx - mucostheta*pdotn_prmx*xisq - mucostheta_prmx*pdotn*xisq + mur*pdotvr_prmx*(sqrt(Q) + 1) + mur_prmx*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmx*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmx*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmx*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmx*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmx*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmx = HsoTerm2a_prmx + HsoTerm2b_prmx - HsoTerm2c_prmx;
    double HsoTerm2coeff_prmx = expnu*(-Q_prmx - 1.0/2.0*Q_prmx/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmx/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmx/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmx*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmx*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmx = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmx + expmu*expnu_prmx + expmu_prmx*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmx*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmx*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmx*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmx*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmx*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmx*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmx*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmx = HsoTerm1_prmx + HsoTerm2*HsoTerm2coeff_prmx + HsoTerm2_prmx*HsoTerm2coeff;
    double Hd_prmx = Hdcoeff*Hdsum_prmx + Hdcoeff_prmx*Hdsum;
    double Hns_prmx = sqrt(Hnsradicand)*alpha_prmx + betapsum_prmx + (1.0/2.0)*Hnsradicand_prmx*alpha/sqrt(Hnsradicand);
    double Hs_prmx = Hso_prmx + Hss_prmx;
    double dSS_prmx = 1585.5329999999999*pow(chi, 2)*chi_prmx*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmx*eta + 2323.5599999999999*chi*chi_prmx*pow(eta, 3) - 652.64999999999998*chi*chi_prmx*pow(eta, 2) + 37.196399999999997*chi_prmx*eta;
    double Heff_prmx = -Hd_prmx + Hns_prmx + Hs_prmx + dSS*eta*pow(u, 3)*u_prmx*(4*pow(S1x, 2) + 4*pow(S1y, 2) + 4*pow(S1z, 2) + 4*pow(S2x, 2) + 4*pow(S2y, 2) + 4*pow(S2z, 2)) + dSS_prmx*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmx = Heff_prmx*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double r_prmy = y/sqrt(pow(x, 2) + pow(y, 2) + pow(z, 2));
    double u_prmy = -r_prmy/pow(r, 2);
    double L3_prmy = -p1;
    double L1_prmy = p3;
    double Lnorm_prmy = (L1*L1_prmy + L3*L3_prmy)/sqrt(pow(L1, 2) + pow(L2, 2) + pow(L3, 2));
    double Lhat3_prmy = -L3*Lnorm_prmy/pow(Lnorm, 2) + L3_prmy/Lnorm;
    double Lhat2_prmy = -L2*Lnorm_prmy/pow(Lnorm, 2);
    double Lhat1_prmy = -L1*Lnorm_prmy/pow(Lnorm, 2) + L1_prmy/Lnorm;
    double S2dotLhat_prmy = Lhat1_prmy*S2x + Lhat2_prmy*S2y + Lhat3_prmy*S2z;
    double S1dotLhat_prmy = Lhat1_prmy*S1x + Lhat2_prmy*S1y + Lhat3_prmy*S1z;
    double S1perp3_prmy = -Lhat3*S1dotLhat_prmy - Lhat3_prmy*S1dotLhat;
    double S1perp2_prmy = -Lhat2*S1dotLhat_prmy - Lhat2_prmy*S1dotLhat;
    double S1perp1_prmy = -Lhat1*S1dotLhat_prmy - Lhat1_prmy*S1dotLhat;
    double S2perp3_prmy = -Lhat3*S2dotLhat_prmy - Lhat3_prmy*S2dotLhat;
    double S2perp2_prmy = -Lhat2*S2dotLhat_prmy - Lhat2_prmy*S2dotLhat;
    double S2perp1_prmy = -Lhat1*S2dotLhat_prmy - Lhat1_prmy*S2dotLhat;
    double Sperp3_prmy = S1perp3_prmy + S2perp3_prmy;
    double Sperp2_prmy = S1perp2_prmy + S2perp2_prmy;
    double Sperp1_prmy = S1perp1_prmy + S2perp1_prmy;
    double n3_prmy = -r_prmy*z/pow(r, 2);
    double n2_prmy = 1.0/r - r_prmy*y/pow(r, 2);
    double n1_prmy = -r_prmy*x/pow(r, 2);
    double xi3_prmy = e31*n2_prmy - e32*n1_prmy;
    double xi2_prmy = -e31*n3_prmy + e33*n1_prmy;
    double xi1_prmy = e32*n3_prmy - e33*n2_prmy;
    double v3_prmy = n1*xi2_prmy + n1_prmy*xi2 - n2*xi1_prmy - n2_prmy*xi1;
    double v2_prmy = -n1*xi3_prmy - n1_prmy*xi3 + n3*xi1_prmy + n3_prmy*xi1;
    double v1_prmy = n2*xi3_prmy + n2_prmy*xi3 - n3*xi2_prmy - n3_prmy*xi2;
    double costheta_prmy = e31*n1_prmy + e32*n2_prmy + e33*n3_prmy;
    double sin2theta_prmy = -2*costheta*costheta_prmy;
    double xisq_prmy = sin2theta_prmy;
    double w2_prmy = 2*r*r_prmy;
    double Sigma_prmy = 2*pow(a, 2)*costheta*costheta_prmy + 2*r*r_prmy;
    double Dinv_prmy = (eta*pow(u, 2)*u_prmy*(156 - 18*eta) + 12*eta*u*u_prmy)/(eta*pow(u, 3)*(52 - 6*eta) + 6*eta*pow(u, 2) + 1);
    double omegatilde_prmy = 2*a*r_prmy;
    double chi_prmy = (Lhat1_prmy*Skerr1 + Lhat2_prmy*Skerr2 + Lhat3_prmy*Skerr3)/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmy + (1.0/2.0)*Skerr2*Sperp2_prmy + (1.0/2.0)*Skerr3*Sperp3_prmy)/(Skerrmag*(1.0 - 2.0*eta));
    double K_prmy = -177.4974*pow(chi, 2)*chi_prmy*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmy*eta + 4.3097700000000003*pow(chi, 2)*chi_prmy + 62.349200000000003*chi*chi_prmy*pow(eta, 3) + 12.329319999999999*chi*chi_prmy*pow(eta, 2) - 2.76172*chi*chi_prmy - 27.520099999999999*chi_prmy*pow(eta, 3) + 17.3736*chi_prmy*pow(eta, 2) + 2.26831*chi_prmy*eta - 1.6204499999999999*chi_prmy;
    double etaKminus1_prmy = K_prmy*eta;
    double Delta0_prmy = K*K_prmy*eta + K_prmy*(K*eta - 2);
    double Delta1_prmy = etaKminus1*(-2*Delta0_prmy - 2*K_prmy) + etaKminus1_prmy*(-2*Delta0 - 2*K);
    double Delta2_prmy = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmy - Delta0_prmy*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmy - 2*etaKminus1_prmy) + Delta1_prmy*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmy = -pow(Delta1, 2)*Delta1_prmy + pow(Delta1, 2)*etaKminus1_prmy + 2*Delta1*Delta1_prmy*etaKminus1 + Delta1*Delta2_prmy - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmy + Delta1_prmy*Delta2 - Delta1_prmy*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmy + 2*etaKminus1_prmy) + etaKminus1_prmy*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmy = pow(Delta1, 3)*Delta1_prmy - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmy - 2*pow(Delta1, 2)*Delta1_prmy*etaKminus1 - pow(Delta1, 2)*Delta2_prmy - 2*Delta1*Delta1_prmy*Delta2 + Delta1*(2*Delta2*etaKminus1_prmy + 2*Delta2_prmy*etaKminus1 + Delta3_prmy) + Delta1_prmy*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmy - 2*Delta3*etaKminus1_prmy - 2*Delta3_prmy*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmy - 2*Delta2_prmy) + pow(a, 2)*etaKminus1*etaKminus1_prmy*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmy*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmy = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmy - 3*Delta1*Delta2_prmy - 3*Delta1_prmy*Delta2 + 3*Delta3_prmy) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmy - 4*pow(Delta1, 2)*Delta2_prmy - 8*Delta1*Delta1_prmy*Delta2 + 4*Delta1*Delta3_prmy + 4*Delta1_prmy*Delta3 + 4*Delta2*Delta2_prmy - 4*Delta4_prmy)/etaKminus1 - 1.0/2.0*etaKminus1_prmy*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmy - 5*pow(Delta1, 3)*Delta2_prmy - 15*pow(Delta1, 2)*Delta1_prmy*Delta2 + 5*pow(Delta1, 2)*Delta3_prmy + 10*Delta1*Delta1_prmy*Delta3 + 10*Delta1*Delta2*Delta2_prmy - 5*Delta1*Delta4_prmy + 5*Delta1_prmy*pow(Delta2, 2) - 5*Delta1_prmy*Delta4 - 5*Delta2*Delta3_prmy - 5*Delta2_prmy*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmy*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmy*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmy = (128.0/5.0)*etaKminus1*etaKminus1_prmy;
    double logarg_prmy = u*(Delta1_prmy + u*(Delta2_prmy + u*(Delta3_prmy + u*(Delta4_prmy + u*(Delta5_prmy + Delta5l*u_prmy/u + Delta5l_prmy*log(u)) + u_prmy*(Delta5 + Delta5l*log(u))) + u_prmy*(Delta4 + u*(Delta5 + Delta5l*log(u)))) + u_prmy*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u))))) + u_prmy*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u)))))) + u_prmy*(Delta1 + u*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u))))));
    double Deltaucalib_prmy = eta*(Delta0_prmy + logarg_prmy*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmy = eta*logarg_prmy*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmy + u*(2*Delta2_prmy + u*(3*Delta3_prmy + u*(4*Delta4_prmy + u*(5*Delta5_prmy + 5*Delta5l*u_prmy/u + 5*Delta5l_prmy*log(u)) + u_prmy*(5*Delta5 + 5*Delta5l*log(u))) + u_prmy*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u)))) + u_prmy*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))) + u_prmy*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/(logarg + 1) + eta*u*u_prmy*(-2*Delta1 - 2*u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/(logarg + 1);
    double Deltaubar_prmy = 2*pow(a, 2)*u*u_prmy + (2*u_prmy - etaKminus1_prmy/pow(etaKminus1, 2))/etaKminus1 + etaKminus1_prmy*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2);
    double Deltaubarprime_prmy = -6*pow(a, 2)*pow(u, 2)*u_prmy - 4*u*u_prmy/etaKminus1 + 2*etaKminus1_prmy*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmy = (Deltaubar*Deltaucalib_prmy + Deltaubar_prmy*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmy = Deltaubar*Deltaucalibprime_prmy + Deltaubar_prmy*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmy + Deltaubarprime_prmy*Deltaucalib;
    double Deltatprime_prmy = 2*Deltau*r_prmy + 2*Deltau_prmy*r + 2*Deltauprime*r*r_prmy + Deltauprime_prmy*pow(r, 2);
    double Deltat_prmy = 2*Deltau*r*r_prmy + Deltau_prmy*pow(r, 2);
    double Deltar_prmy = Deltat*Dinv_prmy + Deltat_prmy*Dinv;
    double Lambt_prmy = (Deltat*pow(a, 2)*sin2theta_prmy + Deltat_prmy*pow(a, 2)*sin2theta - 2*w2*w2_prmy)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmy = (1.0/2.0)*(Deltar*Deltat_prmy + Deltar_prmy*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmy*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmy = csi_prmy*(1 - fabs((double)tortoise - 1));
    double csi2_prmy = csi_prmy*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmy = csi2*(n1_prmy*p1 + n2_prmy*p2 + n3_prmy*p3) + csi2_prmy*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmy = n3*prT_prmy*(-1 + 1.0/csi1) + n3_prmy*prT*(-1 + 1.0/csi1) - csi1_prmy*n3*prT/pow(csi1, 2);
    double phat2_prmy = n2*prT_prmy*(-1 + 1.0/csi1) + n2_prmy*prT*(-1 + 1.0/csi1) - csi1_prmy*n2*prT/pow(csi1, 2);
    double phat1_prmy = n1*prT_prmy*(-1 + 1.0/csi1) + n1_prmy*prT*(-1 + 1.0/csi1) - csi1_prmy*n1*prT/pow(csi1, 2);
    double pdotxir_prmy = r*(phat1*xi1_prmy + phat1_prmy*xi1 + phat2*xi2_prmy + phat2_prmy*xi2 + phat3*xi3_prmy + phat3_prmy*xi3) + r_prmy*(phat1*xi1 + phat2*xi2 + phat3*xi3);
    double pdotn_prmy = n1*phat1_prmy + n1_prmy*phat1 + n2*phat2_prmy + n2_prmy*phat2 + n3*phat3_prmy + n3_prmy*phat3;
    double pdotvr_prmy = r*(phat1*v1_prmy + phat1_prmy*v1 + phat2*v2_prmy + phat2_prmy*v2 + phat3*v3_prmy + phat3_prmy*v3) + r_prmy*(phat1*v1 + phat2*v2 + phat3*v3);
    double pphi_prmy = pdotxir_prmy;
    double Qcoeff2_prmy = -sin2theta_prmy/(Sigma*pow(sin2theta, 2)) - Sigma_prmy/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmy = -Sigma*sin2theta_prmy/(Lambt*pow(sin2theta, 2)) + Sigma_prmy/(Lambt*sin2theta) - Lambt_prmy*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmy = 2*Deltar*pdotn*pdotn_prmy/Sigma - Deltar*Sigma_prmy*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmy*pow(pdotn, 2)/Sigma;
    double Q_prmy = DrSipn2_prmy + 2*Qcoeff1*pdotxir*pdotxir_prmy + Qcoeff1_prmy*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmy + Qcoeff2_prmy*pow(pdotvr, 2);
    double Qminus1_prmy = Q_prmy;
    double Jtilde_prmy = (1.0/2.0)*Deltar_prmy/sqrt(Deltar);
    double exp2mu_prmy = Sigma_prmy;
    double expmu_prmy = (1.0/2.0)*exp2mu_prmy/sqrt(exp2mu);
    double Brtilde_prmy = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmy - 2*Deltat_prmy + (1.0/2.0)*Deltar_prmy*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmy - 1.0/2.0*Deltar_prmy*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmy = (1.0/2.0)*Deltat_prmy/sqrt(Deltat);
    double exp2nu_prmy = Deltat*Sigma_prmy/Lambt - Deltat*Lambt_prmy*Sigma/pow(Lambt, 2) + Deltat_prmy*Sigma/Lambt;
    double expnu_prmy = (1.0/2.0)*exp2nu_prmy/sqrt(exp2nu);
    double omega_prmy = omegatilde_prmy/Lambt - Lambt_prmy*omegatilde/pow(Lambt, 2);
    double Lambtprime_prmy = -Deltatprime*pow(a, 2)*sin2theta_prmy - Deltatprime_prmy*pow(a, 2)*sin2theta + 8*pow(r, 2)*r_prmy + r_prmy*(4*pow(a, 2) + 4*pow(r, 2));
    double mucostheta_prmy = pow(a, 2)*costheta_prmy/Sigma - Sigma_prmy*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmy = pow(a, 2)*costheta*w2*(-Deltat_prmy + w2_prmy)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmy*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmy*w2*(-Deltat + w2)/(Lambt*Sigma) - Sigma_prmy*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmy*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmy = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmy/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmy*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmy*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmy*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmy = r_prmy/Sigma - Sigma_prmy*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmy/pow(Deltar, 3.0/2.0);
    double nur_prmy = r_prmy/Sigma - Sigma_prmy*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat*r_prmy - 4*Deltat_prmy*r + Deltatprime*w2_prmy + Deltatprime_prmy*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmy*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmy*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmy*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmy = (Lambt_prmy*omegatildeprime - Lambtprime*omegatilde_prmy - Lambtprime_prmy*omegatilde)/pow(Lambt, 2) + Lambt_prmy*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmy = 442.44299999999998*pow(chi, 2)*chi_prmy*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmy*eta + 198.59610000000001*pow(chi, 2)*chi_prmy - 686.62599999999998*chi*chi_prmy*eta + 2495.29*chi_prmy*pow(eta, 2);
    double sigmacoeffTerm3_prmy = 3*dSO*eta*pow(u, 2)*u_prmy + dSO_prmy*eta*pow(u, 3);
    double sigmacoeffTerm2_prmy = (1.0/144.0)*eta*(eta*(r*(-882*DrSipn2_prmy + 204*Qminus1_prmy + r*(1620*DrSipn2*DrSipn2_prmy - 234*DrSipn2*Qminus1_prmy - 234*DrSipn2_prmy*Qminus1) + r_prmy*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1)) + r_prmy*(-882*DrSipn2 + 204*Qminus1 + r*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1))) + r*(-96*DrSipn2_prmy - 436*Qminus1_prmy + r*(36*DrSipn2*Qminus1_prmy + 36*DrSipn2_prmy*Qminus1 - 90*Qminus1*Qminus1_prmy) + r_prmy*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))) + r_prmy*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))))/pow(r, 2) + (1.0/72.0)*eta*r_prmy*(-eta*(r*(-882*DrSipn2 + 204*Qminus1 + r*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1)) - 336) - r*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))) + 896)/pow(r, 3);
    double sigmacoeffTerm1_prmy = eta*(-3*DrSipn2_prmy + (1.0/4.0)*Qminus1_prmy + (2.0/3.0)*r_prmy/pow(r, 2));
    double sigmacoeff_prmy = sigmacoeffTerm1_prmy + sigmacoeffTerm2_prmy + sigmacoeffTerm3_prmy;
    double sigmastarcoeffTerm2_prmy = (1.0/72.0)*eta*(eta*(r*(-324*DrSipn2_prmy + 120*Qminus1_prmy + r*(720*DrSipn2*DrSipn2_prmy + Qminus1*(-126*DrSipn2_prmy - 3*Qminus1_prmy) + Qminus1_prmy*(-126*DrSipn2 - 3*Qminus1)) + r_prmy*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1))) + r_prmy*(-324*DrSipn2 + 120*Qminus1 + r*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1)))) + r*(282*DrSipn2_prmy + Qminus1*r*(96*DrSipn2_prmy - 23*Qminus1_prmy) + Qminus1*r_prmy*(96*DrSipn2 - 23*Qminus1) + Qminus1_prmy*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmy) + r_prmy*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1))/pow(r, 2) + (1.0/36.0)*eta*r_prmy*(-eta*(r*(-324*DrSipn2 + 120*Qminus1 + r*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1))) - 54) - r*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1) - 706)/pow(r, 3);
    double sigmastarcoeffTerm1_prmy = eta*(-5.0/2.0*DrSipn2_prmy + (1.0/3.0)*Qminus1_prmy - 7.0/6.0*r_prmy/pow(r, 2));
    double sigmastarcoeff_prmy = sigmastarcoeffTerm1_prmy + sigmastarcoeffTerm2_prmy;
    double Deltasigmastar3_prmy = sigma3*sigmacoeff_prmy + sigmastar3*sigmastarcoeff_prmy;
    double Deltasigmastar2_prmy = sigma2*sigmacoeff_prmy + sigmastar2*sigmastarcoeff_prmy;
    double Deltasigmastar1_prmy = sigma1*sigmacoeff_prmy + sigmastar1*sigmastarcoeff_prmy;
    double Sstar3_prmy = Deltasigmastar3_prmy;
    double Sstar2_prmy = Deltasigmastar2_prmy;
    double Sstar1_prmy = Deltasigmastar1_prmy;
    double S3_prmy = Sstar3_prmy;
    double S2_prmy = Sstar2_prmy;
    double S1_prmy = Sstar1_prmy;
    double Sstardotn_prmy = Sstar1*n1_prmy + Sstar1_prmy*n1 + Sstar2*n2_prmy + Sstar2_prmy*n2 + Sstar3*n3_prmy + Sstar3_prmy*n3;
    double SdotSkerrhat_prmy = S1_prmy*Skerrhat1 + S2_prmy*Skerrhat2 + S3_prmy*Skerrhat3;
    double Sdotn_prmy = S1*n1_prmy + S1_prmy*n1 + S2*n2_prmy + S2_prmy*n2 + S3*n3_prmy + S3_prmy*n3;
    double Sdotv_prmy = S1*v1_prmy + S1_prmy*v1 + S2*v2_prmy + S2_prmy*v2 + S3*v3_prmy + S3_prmy*v3;
    double Sdotxi_prmy = S1*xi1_prmy + S1_prmy*xi1 + S2*xi2_prmy + S2_prmy*xi2 + S3*xi3_prmy + S3_prmy*xi3;
    double HdsumTerm2_prmy = 6*Sstardotn*Sstardotn_prmy;
    double HdsumTerm1_prmy = 2*Sstar1*Sstar1_prmy + 2*Sstar2*Sstar2_prmy + 2*Sstar3*Sstar3_prmy;
    double Hdsum_prmy = HdsumTerm1_prmy - HdsumTerm2_prmy;
    double Hdcoeff_prmy = -3.0/2.0*r_prmy/pow(r, 4);
    double Q4_prmy = eta*pow(prT, 4)*u*u_prmy*(16 - 12*eta) + eta*pow(prT, 3)*prT_prmy*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmy = 2*Deltar*pdotn*pdotn_prmy/Sigma - Deltar*Sigma_prmy*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmy*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmy/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmy/(Sigma*sin2theta) - Sigma_prmy*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmy/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmy/(Lambt*sin2theta) + Sigma_prmy*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmy*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmy = Q4_prmy + gammappsum_prmy;
    double alpha_prmy = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmy/Lambt - 1.0/2.0*Deltat*Lambt_prmy*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmy*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmy = omegatilde*pphi_prmy/Lambt + omegatilde_prmy*pphi/Lambt - Lambt_prmy*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmy = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmy - 1.0/2.0*Q_prmy/sqrt(Q)) + Sdotn*exp2mu*xisq_prmy*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmy*xisq*(-sqrt(Q) - Q) + Sdotn_prmy*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmy - Jtilde*Sdotv_prmy*pdotn - Jtilde_prmy*Sdotv*pdotn + Sdotn*pdotvr_prmy + Sdotn_prmy*pdotvr) + pdotvr_prmy*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmy*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmy + Btilde*Jtilde*Sdotxi_prmy*pdotn + Btilde*Jtilde_prmy*Sdotxi*pdotn + Btilde_prmy*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmy - Sdotn*expmu*expnu_prmy*pdotxir - Sdotn*expmu_prmy*expnu*pdotxir - Sdotn_prmy*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmy*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmy*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmy*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmy = (1.0/2.0)*omegacostheta*(-Q_prmy - 1.0/2.0*Q_prmy/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmy/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmy*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmy*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmy*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmy*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmy = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmy - Jtilde*Sdotv_prmy*pdotn - Jtilde_prmy*Sdotv*pdotn + Sdotn*pdotvr_prmy + Sdotn_prmy*pdotvr) + Jtilde*pdotn_prmy*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmy*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmy + (1.0/2.0)*Q_prmy/sqrt(Q)) + Sdotv*exp2mu_prmy*(sqrt(Q) + Q) + Sdotv_prmy*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmy*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmy*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmy - Btilde*Sdotxi*expnu_prmy*pdotvr - Btilde*Sdotxi_prmy*expnu*pdotvr - Btilde_prmy*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmy + Sdotv*exp2nu*expmu_prmy*pdotxir + Sdotv*exp2nu_prmy*expmu*pdotxir + Sdotv_prmy*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmy*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmy*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmy = (1.0/2.0)*Jtilde*omegar*(-Q_prmy - 1.0/2.0*Q_prmy/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmy/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmy/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmy*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmy*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmy*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmy*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmy*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmy = SdotSkerrhat*omega_prmy + SdotSkerrhat_prmy*omega;
    double Hss_prmy = HssTerm1_prmy + HssTerm2*HssTerm2coeff_prmy + HssTerm2_prmy*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmy + HssTerm3_prmy*HssTerm3coeff;
    double HsoTerm2c_prmy = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmy*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmy*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmy*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmy*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmy*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmy*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmy*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmy = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmy + Jtilde*Sdotv_prmy*nur + Jtilde_prmy*Sdotv*nur - Sdotn*nucostheta*xisq_prmy - Sdotn*nucostheta_prmy*xisq - Sdotn_prmy*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmy*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmy*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmy*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmy*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmy*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmy = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmy + nur_prmy*pdotvr + pdotn*xisq*(mucostheta_prmy - nucostheta_prmy) + pdotn*xisq_prmy*(mucostheta - nucostheta) + pdotn_prmy*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmy - mucostheta*pdotn_prmy*xisq - mucostheta_prmy*pdotn*xisq + mur*pdotvr_prmy*(sqrt(Q) + 1) + mur_prmy*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmy*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmy*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmy*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmy*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmy*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmy = HsoTerm2a_prmy + HsoTerm2b_prmy - HsoTerm2c_prmy;
    double HsoTerm2coeff_prmy = expnu*(-Q_prmy - 1.0/2.0*Q_prmy/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmy/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmy/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmy*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmy*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmy = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmy + expmu*expnu_prmy + expmu_prmy*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmy*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmy*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmy*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmy*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmy*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmy*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmy*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmy = HsoTerm1_prmy + HsoTerm2*HsoTerm2coeff_prmy + HsoTerm2_prmy*HsoTerm2coeff;
    double Hd_prmy = Hdcoeff*Hdsum_prmy + Hdcoeff_prmy*Hdsum;
    double Hns_prmy = sqrt(Hnsradicand)*alpha_prmy + betapsum_prmy + (1.0/2.0)*Hnsradicand_prmy*alpha/sqrt(Hnsradicand);
    double Hs_prmy = Hso_prmy + Hss_prmy;
    double dSS_prmy = 1585.5329999999999*pow(chi, 2)*chi_prmy*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmy*eta + 2323.5599999999999*chi*chi_prmy*pow(eta, 3) - 652.64999999999998*chi*chi_prmy*pow(eta, 2) + 37.196399999999997*chi_prmy*eta;
    double Heff_prmy = -Hd_prmy + Hns_prmy + Hs_prmy + dSS*eta*pow(u, 3)*u_prmy*(4*pow(S1x, 2) + 4*pow(S1y, 2) + 4*pow(S1z, 2) + 4*pow(S2x, 2) + 4*pow(S2y, 2) + 4*pow(S2z, 2)) + dSS_prmy*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmy = Heff_prmy*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double r_prmz = z/sqrt(pow(x, 2) + pow(y, 2) + pow(z, 2));
    double u_prmz = -r_prmz/pow(r, 2);
    double L2_prmz = p1;
    double L1_prmz = -p2;
    double Lnorm_prmz = (L1*L1_prmz + L2*L2_prmz)/sqrt(pow(L1, 2) + pow(L2, 2) + pow(L3, 2));
    double Lhat3_prmz = -L3*Lnorm_prmz/pow(Lnorm, 2);
    double Lhat2_prmz = -L2*Lnorm_prmz/pow(Lnorm, 2) + L2_prmz/Lnorm;
    double Lhat1_prmz = -L1*Lnorm_prmz/pow(Lnorm, 2) + L1_prmz/Lnorm;
    double S2dotLhat_prmz = Lhat1_prmz*S2x + Lhat2_prmz*S2y + Lhat3_prmz*S2z;
    double S1dotLhat_prmz = Lhat1_prmz*S1x + Lhat2_prmz*S1y + Lhat3_prmz*S1z;
    double S1perp3_prmz = -Lhat3*S1dotLhat_prmz - Lhat3_prmz*S1dotLhat;
    double S1perp2_prmz = -Lhat2*S1dotLhat_prmz - Lhat2_prmz*S1dotLhat;
    double S1perp1_prmz = -Lhat1*S1dotLhat_prmz - Lhat1_prmz*S1dotLhat;
    double S2perp3_prmz = -Lhat3*S2dotLhat_prmz - Lhat3_prmz*S2dotLhat;
    double S2perp2_prmz = -Lhat2*S2dotLhat_prmz - Lhat2_prmz*S2dotLhat;
    double S2perp1_prmz = -Lhat1*S2dotLhat_prmz - Lhat1_prmz*S2dotLhat;
    double Sperp3_prmz = S1perp3_prmz + S2perp3_prmz;
    double Sperp2_prmz = S1perp2_prmz + S2perp2_prmz;
    double Sperp1_prmz = S1perp1_prmz + S2perp1_prmz;
    double n3_prmz = 1.0/r - r_prmz*z/pow(r, 2);
    double n2_prmz = -r_prmz*y/pow(r, 2);
    double n1_prmz = -r_prmz*x/pow(r, 2);
    double xi3_prmz = e31*n2_prmz - e32*n1_prmz;
    double xi2_prmz = -e31*n3_prmz + e33*n1_prmz;
    double xi1_prmz = e32*n3_prmz - e33*n2_prmz;
    double v3_prmz = n1*xi2_prmz + n1_prmz*xi2 - n2*xi1_prmz - n2_prmz*xi1;
    double v2_prmz = -n1*xi3_prmz - n1_prmz*xi3 + n3*xi1_prmz + n3_prmz*xi1;
    double v1_prmz = n2*xi3_prmz + n2_prmz*xi3 - n3*xi2_prmz - n3_prmz*xi2;
    double costheta_prmz = e31*n1_prmz + e32*n2_prmz + e33*n3_prmz;
    double sin2theta_prmz = -2*costheta*costheta_prmz;
    double xisq_prmz = sin2theta_prmz;
    double w2_prmz = 2*r*r_prmz;
    double Sigma_prmz = 2*pow(a, 2)*costheta*costheta_prmz + 2*r*r_prmz;
    double Dinv_prmz = (eta*pow(u, 2)*u_prmz*(156 - 18*eta) + 12*eta*u*u_prmz)/(eta*pow(u, 3)*(52 - 6*eta) + 6*eta*pow(u, 2) + 1);
    double omegatilde_prmz = 2*a*r_prmz;
    double chi_prmz = (Lhat1_prmz*Skerr1 + Lhat2_prmz*Skerr2 + Lhat3_prmz*Skerr3)/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmz + (1.0/2.0)*Skerr2*Sperp2_prmz + (1.0/2.0)*Skerr3*Sperp3_prmz)/(Skerrmag*(1.0 - 2.0*eta));
    double K_prmz = -177.4974*pow(chi, 2)*chi_prmz*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmz*eta + 4.3097700000000003*pow(chi, 2)*chi_prmz + 62.349200000000003*chi*chi_prmz*pow(eta, 3) + 12.329319999999999*chi*chi_prmz*pow(eta, 2) - 2.76172*chi*chi_prmz - 27.520099999999999*chi_prmz*pow(eta, 3) + 17.3736*chi_prmz*pow(eta, 2) + 2.26831*chi_prmz*eta - 1.6204499999999999*chi_prmz;
    double etaKminus1_prmz = K_prmz*eta;
    double Delta0_prmz = K*K_prmz*eta + K_prmz*(K*eta - 2);
    double Delta1_prmz = etaKminus1*(-2*Delta0_prmz - 2*K_prmz) + etaKminus1_prmz*(-2*Delta0 - 2*K);
    double Delta2_prmz = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmz - Delta0_prmz*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmz - 2*etaKminus1_prmz) + Delta1_prmz*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmz = -pow(Delta1, 2)*Delta1_prmz + pow(Delta1, 2)*etaKminus1_prmz + 2*Delta1*Delta1_prmz*etaKminus1 + Delta1*Delta2_prmz - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmz + Delta1_prmz*Delta2 - Delta1_prmz*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmz + 2*etaKminus1_prmz) + etaKminus1_prmz*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmz = pow(Delta1, 3)*Delta1_prmz - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmz - 2*pow(Delta1, 2)*Delta1_prmz*etaKminus1 - pow(Delta1, 2)*Delta2_prmz - 2*Delta1*Delta1_prmz*Delta2 + Delta1*(2*Delta2*etaKminus1_prmz + 2*Delta2_prmz*etaKminus1 + Delta3_prmz) + Delta1_prmz*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmz - 2*Delta3*etaKminus1_prmz - 2*Delta3_prmz*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmz - 2*Delta2_prmz) + pow(a, 2)*etaKminus1*etaKminus1_prmz*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmz*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmz = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmz - 3*Delta1*Delta2_prmz - 3*Delta1_prmz*Delta2 + 3*Delta3_prmz) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmz - 4*pow(Delta1, 2)*Delta2_prmz - 8*Delta1*Delta1_prmz*Delta2 + 4*Delta1*Delta3_prmz + 4*Delta1_prmz*Delta3 + 4*Delta2*Delta2_prmz - 4*Delta4_prmz)/etaKminus1 - 1.0/2.0*etaKminus1_prmz*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmz - 5*pow(Delta1, 3)*Delta2_prmz - 15*pow(Delta1, 2)*Delta1_prmz*Delta2 + 5*pow(Delta1, 2)*Delta3_prmz + 10*Delta1*Delta1_prmz*Delta3 + 10*Delta1*Delta2*Delta2_prmz - 5*Delta1*Delta4_prmz + 5*Delta1_prmz*pow(Delta2, 2) - 5*Delta1_prmz*Delta4 - 5*Delta2*Delta3_prmz - 5*Delta2_prmz*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmz*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmz*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmz = (128.0/5.0)*etaKminus1*etaKminus1_prmz;
    double logarg_prmz = u*(Delta1_prmz + u*(Delta2_prmz + u*(Delta3_prmz + u*(Delta4_prmz + u*(Delta5_prmz + Delta5l*u_prmz/u + Delta5l_prmz*log(u)) + u_prmz*(Delta5 + Delta5l*log(u))) + u_prmz*(Delta4 + u*(Delta5 + Delta5l*log(u)))) + u_prmz*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u))))) + u_prmz*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u)))))) + u_prmz*(Delta1 + u*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*log(u))))));
    double Deltaucalib_prmz = eta*(Delta0_prmz + logarg_prmz*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmz = eta*logarg_prmz*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmz + u*(2*Delta2_prmz + u*(3*Delta3_prmz + u*(4*Delta4_prmz + u*(5*Delta5_prmz + 5*Delta5l*u_prmz/u + 5*Delta5l_prmz*log(u)) + u_prmz*(5*Delta5 + 5*Delta5l*log(u))) + u_prmz*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u)))) + u_prmz*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))) + u_prmz*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/(logarg + 1) + eta*u*u_prmz*(-2*Delta1 - 2*u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/(logarg + 1);
    double Deltaubar_prmz = 2*pow(a, 2)*u*u_prmz + (2*u_prmz - etaKminus1_prmz/pow(etaKminus1, 2))/etaKminus1 + etaKminus1_prmz*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2);
    double Deltaubarprime_prmz = -6*pow(a, 2)*pow(u, 2)*u_prmz - 4*u*u_prmz/etaKminus1 + 2*etaKminus1_prmz*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmz = (Deltaubar*Deltaucalib_prmz + Deltaubar_prmz*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmz = Deltaubar*Deltaucalibprime_prmz + Deltaubar_prmz*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmz + Deltaubarprime_prmz*Deltaucalib;
    double Deltatprime_prmz = 2*Deltau*r_prmz + 2*Deltau_prmz*r + 2*Deltauprime*r*r_prmz + Deltauprime_prmz*pow(r, 2);
    double Deltat_prmz = 2*Deltau*r*r_prmz + Deltau_prmz*pow(r, 2);
    double Deltar_prmz = Deltat*Dinv_prmz + Deltat_prmz*Dinv;
    double Lambt_prmz = (Deltat*pow(a, 2)*sin2theta_prmz + Deltat_prmz*pow(a, 2)*sin2theta - 2*w2*w2_prmz)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmz = (1.0/2.0)*(Deltar*Deltat_prmz + Deltar_prmz*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmz*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmz = csi_prmz*(1 - fabs((double)tortoise - 1));
    double csi2_prmz = csi_prmz*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmz = csi2*(n1_prmz*p1 + n2_prmz*p2 + n3_prmz*p3) + csi2_prmz*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmz = n3*prT_prmz*(-1 + 1.0/csi1) + n3_prmz*prT*(-1 + 1.0/csi1) - csi1_prmz*n3*prT/pow(csi1, 2);
    double phat2_prmz = n2*prT_prmz*(-1 + 1.0/csi1) + n2_prmz*prT*(-1 + 1.0/csi1) - csi1_prmz*n2*prT/pow(csi1, 2);
    double phat1_prmz = n1*prT_prmz*(-1 + 1.0/csi1) + n1_prmz*prT*(-1 + 1.0/csi1) - csi1_prmz*n1*prT/pow(csi1, 2);
    double pdotxir_prmz = r*(phat1*xi1_prmz + phat1_prmz*xi1 + phat2*xi2_prmz + phat2_prmz*xi2 + phat3*xi3_prmz + phat3_prmz*xi3) + r_prmz*(phat1*xi1 + phat2*xi2 + phat3*xi3);
    double pdotn_prmz = n1*phat1_prmz + n1_prmz*phat1 + n2*phat2_prmz + n2_prmz*phat2 + n3*phat3_prmz + n3_prmz*phat3;
    double pdotvr_prmz = r*(phat1*v1_prmz + phat1_prmz*v1 + phat2*v2_prmz + phat2_prmz*v2 + phat3*v3_prmz + phat3_prmz*v3) + r_prmz*(phat1*v1 + phat2*v2 + phat3*v3);
    double pphi_prmz = pdotxir_prmz;
    double Qcoeff2_prmz = -sin2theta_prmz/(Sigma*pow(sin2theta, 2)) - Sigma_prmz/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmz = -Sigma*sin2theta_prmz/(Lambt*pow(sin2theta, 2)) + Sigma_prmz/(Lambt*sin2theta) - Lambt_prmz*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmz = 2*Deltar*pdotn*pdotn_prmz/Sigma - Deltar*Sigma_prmz*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmz*pow(pdotn, 2)/Sigma;
    double Q_prmz = DrSipn2_prmz + 2*Qcoeff1*pdotxir*pdotxir_prmz + Qcoeff1_prmz*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmz + Qcoeff2_prmz*pow(pdotvr, 2);
    double Qminus1_prmz = Q_prmz;
    double Jtilde_prmz = (1.0/2.0)*Deltar_prmz/sqrt(Deltar);
    double exp2mu_prmz = Sigma_prmz;
    double expmu_prmz = (1.0/2.0)*exp2mu_prmz/sqrt(exp2mu);
    double Brtilde_prmz = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmz - 2*Deltat_prmz + (1.0/2.0)*Deltar_prmz*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmz - 1.0/2.0*Deltar_prmz*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmz = (1.0/2.0)*Deltat_prmz/sqrt(Deltat);
    double exp2nu_prmz = Deltat*Sigma_prmz/Lambt - Deltat*Lambt_prmz*Sigma/pow(Lambt, 2) + Deltat_prmz*Sigma/Lambt;
    double expnu_prmz = (1.0/2.0)*exp2nu_prmz/sqrt(exp2nu);
    double omega_prmz = omegatilde_prmz/Lambt - Lambt_prmz*omegatilde/pow(Lambt, 2);
    double Lambtprime_prmz = -Deltatprime*pow(a, 2)*sin2theta_prmz - Deltatprime_prmz*pow(a, 2)*sin2theta + 8*pow(r, 2)*r_prmz + r_prmz*(4*pow(a, 2) + 4*pow(r, 2));
    double mucostheta_prmz = pow(a, 2)*costheta_prmz/Sigma - Sigma_prmz*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmz = pow(a, 2)*costheta*w2*(-Deltat_prmz + w2_prmz)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmz*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmz*w2*(-Deltat + w2)/(Lambt*Sigma) - Sigma_prmz*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmz*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmz = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmz/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmz*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmz*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmz*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmz = r_prmz/Sigma - Sigma_prmz*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmz/pow(Deltar, 3.0/2.0);
    double nur_prmz = r_prmz/Sigma - Sigma_prmz*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat*r_prmz - 4*Deltat_prmz*r + Deltatprime*w2_prmz + Deltatprime_prmz*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmz*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmz*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmz*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmz = (Lambt_prmz*omegatildeprime - Lambtprime*omegatilde_prmz - Lambtprime_prmz*omegatilde)/pow(Lambt, 2) + Lambt_prmz*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmz = 442.44299999999998*pow(chi, 2)*chi_prmz*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmz*eta + 198.59610000000001*pow(chi, 2)*chi_prmz - 686.62599999999998*chi*chi_prmz*eta + 2495.29*chi_prmz*pow(eta, 2);
    double sigmacoeffTerm3_prmz = 3*dSO*eta*pow(u, 2)*u_prmz + dSO_prmz*eta*pow(u, 3);
    double sigmacoeffTerm2_prmz = (1.0/144.0)*eta*(eta*(r*(-882*DrSipn2_prmz + 204*Qminus1_prmz + r*(1620*DrSipn2*DrSipn2_prmz - 234*DrSipn2*Qminus1_prmz - 234*DrSipn2_prmz*Qminus1) + r_prmz*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1)) + r_prmz*(-882*DrSipn2 + 204*Qminus1 + r*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1))) + r*(-96*DrSipn2_prmz - 436*Qminus1_prmz + r*(36*DrSipn2*Qminus1_prmz + 36*DrSipn2_prmz*Qminus1 - 90*Qminus1*Qminus1_prmz) + r_prmz*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))) + r_prmz*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))))/pow(r, 2) + (1.0/72.0)*eta*r_prmz*(-eta*(r*(-882*DrSipn2 + 204*Qminus1 + r*(810*pow(DrSipn2, 2) - 234*DrSipn2*Qminus1)) - 336) - r*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*pow(Qminus1, 2))) + 896)/pow(r, 3);
    double sigmacoeffTerm1_prmz = eta*(-3*DrSipn2_prmz + (1.0/4.0)*Qminus1_prmz + (2.0/3.0)*r_prmz/pow(r, 2));
    double sigmacoeff_prmz = sigmacoeffTerm1_prmz + sigmacoeffTerm2_prmz + sigmacoeffTerm3_prmz;
    double sigmastarcoeffTerm2_prmz = (1.0/72.0)*eta*(eta*(r*(-324*DrSipn2_prmz + 120*Qminus1_prmz + r*(720*DrSipn2*DrSipn2_prmz + Qminus1*(-126*DrSipn2_prmz - 3*Qminus1_prmz) + Qminus1_prmz*(-126*DrSipn2 - 3*Qminus1)) + r_prmz*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1))) + r_prmz*(-324*DrSipn2 + 120*Qminus1 + r*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1)))) + r*(282*DrSipn2_prmz + Qminus1*r*(96*DrSipn2_prmz - 23*Qminus1_prmz) + Qminus1*r_prmz*(96*DrSipn2 - 23*Qminus1) + Qminus1_prmz*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmz) + r_prmz*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1))/pow(r, 2) + (1.0/36.0)*eta*r_prmz*(-eta*(r*(-324*DrSipn2 + 120*Qminus1 + r*(360*pow(DrSipn2, 2) + Qminus1*(-126*DrSipn2 - 3*Qminus1))) - 54) - r*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1) - 706)/pow(r, 3);
    double sigmastarcoeffTerm1_prmz = eta*(-5.0/2.0*DrSipn2_prmz + (1.0/3.0)*Qminus1_prmz - 7.0/6.0*r_prmz/pow(r, 2));
    double sigmastarcoeff_prmz = sigmastarcoeffTerm1_prmz + sigmastarcoeffTerm2_prmz;
    double Deltasigmastar3_prmz = sigma3*sigmacoeff_prmz + sigmastar3*sigmastarcoeff_prmz;
    double Deltasigmastar2_prmz = sigma2*sigmacoeff_prmz + sigmastar2*sigmastarcoeff_prmz;
    double Deltasigmastar1_prmz = sigma1*sigmacoeff_prmz + sigmastar1*sigmastarcoeff_prmz;
    double Sstar3_prmz = Deltasigmastar3_prmz;
    double Sstar2_prmz = Deltasigmastar2_prmz;
    double Sstar1_prmz = Deltasigmastar1_prmz;
    double S3_prmz = Sstar3_prmz;
    double S2_prmz = Sstar2_prmz;
    double S1_prmz = Sstar1_prmz;
    double Sstardotn_prmz = Sstar1*n1_prmz + Sstar1_prmz*n1 + Sstar2*n2_prmz + Sstar2_prmz*n2 + Sstar3*n3_prmz + Sstar3_prmz*n3;
    double SdotSkerrhat_prmz = S1_prmz*Skerrhat1 + S2_prmz*Skerrhat2 + S3_prmz*Skerrhat3;
    double Sdotn_prmz = S1*n1_prmz + S1_prmz*n1 + S2*n2_prmz + S2_prmz*n2 + S3*n3_prmz + S3_prmz*n3;
    double Sdotv_prmz = S1*v1_prmz + S1_prmz*v1 + S2*v2_prmz + S2_prmz*v2 + S3*v3_prmz + S3_prmz*v3;
    double Sdotxi_prmz = S1*xi1_prmz + S1_prmz*xi1 + S2*xi2_prmz + S2_prmz*xi2 + S3*xi3_prmz + S3_prmz*xi3;
    double HdsumTerm2_prmz = 6*Sstardotn*Sstardotn_prmz;
    double HdsumTerm1_prmz = 2*Sstar1*Sstar1_prmz + 2*Sstar2*Sstar2_prmz + 2*Sstar3*Sstar3_prmz;
    double Hdsum_prmz = HdsumTerm1_prmz - HdsumTerm2_prmz;
    double Hdcoeff_prmz = -3.0/2.0*r_prmz/pow(r, 4);
    double Q4_prmz = eta*pow(prT, 4)*u*u_prmz*(16 - 12*eta) + eta*pow(prT, 3)*prT_prmz*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmz = 2*Deltar*pdotn*pdotn_prmz/Sigma - Deltar*Sigma_prmz*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmz*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmz/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmz/(Sigma*sin2theta) - Sigma_prmz*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmz/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmz/(Lambt*sin2theta) + Sigma_prmz*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmz*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmz = Q4_prmz + gammappsum_prmz;
    double alpha_prmz = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmz/Lambt - 1.0/2.0*Deltat*Lambt_prmz*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmz*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmz = omegatilde*pphi_prmz/Lambt + omegatilde_prmz*pphi/Lambt - Lambt_prmz*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmz = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmz - 1.0/2.0*Q_prmz/sqrt(Q)) + Sdotn*exp2mu*xisq_prmz*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmz*xisq*(-sqrt(Q) - Q) + Sdotn_prmz*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmz - Jtilde*Sdotv_prmz*pdotn - Jtilde_prmz*Sdotv*pdotn + Sdotn*pdotvr_prmz + Sdotn_prmz*pdotvr) + pdotvr_prmz*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmz*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmz + Btilde*Jtilde*Sdotxi_prmz*pdotn + Btilde*Jtilde_prmz*Sdotxi*pdotn + Btilde_prmz*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmz - Sdotn*expmu*expnu_prmz*pdotxir - Sdotn*expmu_prmz*expnu*pdotxir - Sdotn_prmz*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmz*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmz*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmz*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmz = (1.0/2.0)*omegacostheta*(-Q_prmz - 1.0/2.0*Q_prmz/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmz/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmz*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmz*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmz*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmz*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmz = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmz - Jtilde*Sdotv_prmz*pdotn - Jtilde_prmz*Sdotv*pdotn + Sdotn*pdotvr_prmz + Sdotn_prmz*pdotvr) + Jtilde*pdotn_prmz*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmz*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmz + (1.0/2.0)*Q_prmz/sqrt(Q)) + Sdotv*exp2mu_prmz*(sqrt(Q) + Q) + Sdotv_prmz*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmz*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmz*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmz - Btilde*Sdotxi*expnu_prmz*pdotvr - Btilde*Sdotxi_prmz*expnu*pdotvr - Btilde_prmz*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmz + Sdotv*exp2nu*expmu_prmz*pdotxir + Sdotv*exp2nu_prmz*expmu*pdotxir + Sdotv_prmz*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmz*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmz*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmz = (1.0/2.0)*Jtilde*omegar*(-Q_prmz - 1.0/2.0*Q_prmz/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmz/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmz/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmz*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmz*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmz*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmz*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmz*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmz = SdotSkerrhat*omega_prmz + SdotSkerrhat_prmz*omega;
    double Hss_prmz = HssTerm1_prmz + HssTerm2*HssTerm2coeff_prmz + HssTerm2_prmz*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmz + HssTerm3_prmz*HssTerm3coeff;
    double HsoTerm2c_prmz = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmz*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmz*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmz*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmz*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmz*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmz*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmz*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmz = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmz + Jtilde*Sdotv_prmz*nur + Jtilde_prmz*Sdotv*nur - Sdotn*nucostheta*xisq_prmz - Sdotn*nucostheta_prmz*xisq - Sdotn_prmz*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmz*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmz*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmz*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmz*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmz*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmz = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmz + nur_prmz*pdotvr + pdotn*xisq*(mucostheta_prmz - nucostheta_prmz) + pdotn*xisq_prmz*(mucostheta - nucostheta) + pdotn_prmz*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmz - mucostheta*pdotn_prmz*xisq - mucostheta_prmz*pdotn*xisq + mur*pdotvr_prmz*(sqrt(Q) + 1) + mur_prmz*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmz*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmz*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmz*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmz*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmz*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmz = HsoTerm2a_prmz + HsoTerm2b_prmz - HsoTerm2c_prmz;
    double HsoTerm2coeff_prmz = expnu*(-Q_prmz - 1.0/2.0*Q_prmz/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmz/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmz/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmz*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmz*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmz = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmz + expmu*expnu_prmz + expmu_prmz*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmz*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmz*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmz*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmz*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmz*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmz*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmz*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmz = HsoTerm1_prmz + HsoTerm2*HsoTerm2coeff_prmz + HsoTerm2_prmz*HsoTerm2coeff;
    double Hd_prmz = Hdcoeff*Hdsum_prmz + Hdcoeff_prmz*Hdsum;
    double Hns_prmz = sqrt(Hnsradicand)*alpha_prmz + betapsum_prmz + (1.0/2.0)*Hnsradicand_prmz*alpha/sqrt(Hnsradicand);
    double Hs_prmz = Hso_prmz + Hss_prmz;
    double dSS_prmz = 1585.5329999999999*pow(chi, 2)*chi_prmz*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmz*eta + 2323.5599999999999*chi*chi_prmz*pow(eta, 3) - 652.64999999999998*chi*chi_prmz*pow(eta, 2) + 37.196399999999997*chi_prmz*eta;
    double Heff_prmz = -Hd_prmz + Hns_prmz + Hs_prmz + dSS*eta*pow(u, 3)*u_prmz*(4*pow(S1x, 2) + 4*pow(S1y, 2) + 4*pow(S1z, 2) + 4*pow(S2x, 2) + 4*pow(S2y, 2) + 4*pow(S2z, 2)) + dSS_prmz*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmz = Heff_prmz*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double L3_prmp1 = -y;
    double L2_prmp1 = z;
    double Lnorm_prmp1 = (L2*L2_prmp1 + L3*L3_prmp1)/sqrt(pow(L1, 2) + pow(L2, 2) + pow(L3, 2));
    double Lhat3_prmp1 = -L3*Lnorm_prmp1/pow(Lnorm, 2) + L3_prmp1/Lnorm;
    double Lhat2_prmp1 = -L2*Lnorm_prmp1/pow(Lnorm, 2) + L2_prmp1/Lnorm;
    double Lhat1_prmp1 = -L1*Lnorm_prmp1/pow(Lnorm, 2);
    double S2dotLhat_prmp1 = Lhat1_prmp1*S2x + Lhat2_prmp1*S2y + Lhat3_prmp1*S2z;
    double S1dotLhat_prmp1 = Lhat1_prmp1*S1x + Lhat2_prmp1*S1y + Lhat3_prmp1*S1z;
    double S1perp3_prmp1 = -Lhat3*S1dotLhat_prmp1 - Lhat3_prmp1*S1dotLhat;
    double S1perp2_prmp1 = -Lhat2*S1dotLhat_prmp1 - Lhat2_prmp1*S1dotLhat;
    double S1perp1_prmp1 = -Lhat1*S1dotLhat_prmp1 - Lhat1_prmp1*S1dotLhat;
    double S2perp3_prmp1 = -Lhat3*S2dotLhat_prmp1 - Lhat3_prmp1*S2dotLhat;
    double S2perp2_prmp1 = -Lhat2*S2dotLhat_prmp1 - Lhat2_prmp1*S2dotLhat;
    double S2perp1_prmp1 = -Lhat1*S2dotLhat_prmp1 - Lhat1_prmp1*S2dotLhat;
    double Sperp3_prmp1 = S1perp3_prmp1 + S2perp3_prmp1;
    double Sperp2_prmp1 = S1perp2_prmp1 + S2perp2_prmp1;
    double Sperp1_prmp1 = S1perp1_prmp1 + S2perp1_prmp1;
    double chi_prmp1 = (Lhat1_prmp1*Skerr1 + Lhat2_prmp1*Skerr2 + Lhat3_prmp1*Skerr3)/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmp1 + (1.0/2.0)*Skerr2*Sperp2_prmp1 + (1.0/2.0)*Skerr3*Sperp3_prmp1)/(Skerrmag*(1.0 - 2.0*eta));
    double K_prmp1 = -177.4974*pow(chi, 2)*chi_prmp1*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmp1*eta + 4.3097700000000003*pow(chi, 2)*chi_prmp1 + 62.349200000000003*chi*chi_prmp1*pow(eta, 3) + 12.329319999999999*chi*chi_prmp1*pow(eta, 2) - 2.76172*chi*chi_prmp1 - 27.520099999999999*chi_prmp1*pow(eta, 3) + 17.3736*chi_prmp1*pow(eta, 2) + 2.26831*chi_prmp1*eta - 1.6204499999999999*chi_prmp1;
    double etaKminus1_prmp1 = K_prmp1*eta;
    double Delta0_prmp1 = K*K_prmp1*eta + K_prmp1*(K*eta - 2);
    double Delta1_prmp1 = etaKminus1*(-2*Delta0_prmp1 - 2*K_prmp1) + etaKminus1_prmp1*(-2*Delta0 - 2*K);
    double Delta2_prmp1 = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmp1 - Delta0_prmp1*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmp1 - 2*etaKminus1_prmp1) + Delta1_prmp1*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmp1 = -pow(Delta1, 2)*Delta1_prmp1 + pow(Delta1, 2)*etaKminus1_prmp1 + 2*Delta1*Delta1_prmp1*etaKminus1 + Delta1*Delta2_prmp1 - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmp1 + Delta1_prmp1*Delta2 - Delta1_prmp1*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmp1 + 2*etaKminus1_prmp1) + etaKminus1_prmp1*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmp1 = pow(Delta1, 3)*Delta1_prmp1 - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmp1 - 2*pow(Delta1, 2)*Delta1_prmp1*etaKminus1 - pow(Delta1, 2)*Delta2_prmp1 - 2*Delta1*Delta1_prmp1*Delta2 + Delta1*(2*Delta2*etaKminus1_prmp1 + 2*Delta2_prmp1*etaKminus1 + Delta3_prmp1) + Delta1_prmp1*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmp1 - 2*Delta3*etaKminus1_prmp1 - 2*Delta3_prmp1*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmp1 - 2*Delta2_prmp1) + pow(a, 2)*etaKminus1*etaKminus1_prmp1*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmp1*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmp1 = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmp1 - 3*Delta1*Delta2_prmp1 - 3*Delta1_prmp1*Delta2 + 3*Delta3_prmp1) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmp1 - 4*pow(Delta1, 2)*Delta2_prmp1 - 8*Delta1*Delta1_prmp1*Delta2 + 4*Delta1*Delta3_prmp1 + 4*Delta1_prmp1*Delta3 + 4*Delta2*Delta2_prmp1 - 4*Delta4_prmp1)/etaKminus1 - 1.0/2.0*etaKminus1_prmp1*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmp1 - 5*pow(Delta1, 3)*Delta2_prmp1 - 15*pow(Delta1, 2)*Delta1_prmp1*Delta2 + 5*pow(Delta1, 2)*Delta3_prmp1 + 10*Delta1*Delta1_prmp1*Delta3 + 10*Delta1*Delta2*Delta2_prmp1 - 5*Delta1*Delta4_prmp1 + 5*Delta1_prmp1*pow(Delta2, 2) - 5*Delta1_prmp1*Delta4 - 5*Delta2*Delta3_prmp1 - 5*Delta2_prmp1*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmp1*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmp1*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmp1 = (128.0/5.0)*etaKminus1*etaKminus1_prmp1;
    double logarg_prmp1 = u*(Delta1_prmp1 + u*(Delta2_prmp1 + u*(Delta3_prmp1 + u*(Delta4_prmp1 + u*(Delta5_prmp1 + Delta5l_prmp1*log(u))))));
    double Deltaucalib_prmp1 = eta*(Delta0_prmp1 + logarg_prmp1*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmp1 = eta*logarg_prmp1*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmp1 + u*(2*Delta2_prmp1 + u*(3*Delta3_prmp1 + u*(4*Delta4_prmp1 + u*(5*Delta5_prmp1 + 5*Delta5l_prmp1*log(u))))))/(logarg + 1);
    double Deltaubar_prmp1 = etaKminus1_prmp1*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmp1/pow(etaKminus1, 3);
    double Deltaubarprime_prmp1 = 2*etaKminus1_prmp1*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmp1 = (Deltaubar*Deltaucalib_prmp1 + Deltaubar_prmp1*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmp1 = Deltaubar*Deltaucalibprime_prmp1 + Deltaubar_prmp1*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmp1 + Deltaubarprime_prmp1*Deltaucalib;
    double Deltatprime_prmp1 = 2*Deltau_prmp1*r + Deltauprime_prmp1*pow(r, 2);
    double Deltat_prmp1 = Deltau_prmp1*pow(r, 2);
    double Deltar_prmp1 = Deltat_prmp1*Dinv;
    double Lambt_prmp1 = Deltat_prmp1*pow(a, 2)*sin2theta*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmp1 = (1.0/2.0)*(Deltar*Deltat_prmp1 + Deltar_prmp1*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat)));
    double csi1_prmp1 = csi_prmp1*(1 - fabs((double)tortoise - 1));
    double csi2_prmp1 = csi_prmp1*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmp1 = csi2*n1 + csi2_prmp1*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmp1 = n3*prT_prmp1*(-1 + 1.0/csi1) - csi1_prmp1*n3*prT/pow(csi1, 2);
    double phat2_prmp1 = n2*prT_prmp1*(-1 + 1.0/csi1) - csi1_prmp1*n2*prT/pow(csi1, 2);
    double phat1_prmp1 = n1*prT_prmp1*(-1 + 1.0/csi1) + 1 - csi1_prmp1*n1*prT/pow(csi1, 2);
    double pdotxir_prmp1 = r*(phat1_prmp1*xi1 + phat2_prmp1*xi2 + phat3_prmp1*xi3);
    double pdotn_prmp1 = n1*phat1_prmp1 + n2*phat2_prmp1 + n3*phat3_prmp1;
    double pdotvr_prmp1 = r*(phat1_prmp1*v1 + phat2_prmp1*v2 + phat3_prmp1*v3);
    double pphi_prmp1 = pdotxir_prmp1;
    double Qcoeff1_prmp1 = -Lambt_prmp1*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmp1 = 2*Deltar*pdotn*pdotn_prmp1/Sigma + Deltar_prmp1*pow(pdotn, 2)/Sigma;
    double Q_prmp1 = DrSipn2_prmp1 + 2*Qcoeff1*pdotxir*pdotxir_prmp1 + Qcoeff1_prmp1*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmp1;
    double Qminus1_prmp1 = Q_prmp1;
    double Jtilde_prmp1 = (1.0/2.0)*Deltar_prmp1/sqrt(Deltar);
    double Brtilde_prmp1 = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmp1 - 2*Deltat_prmp1 + (1.0/2.0)*Deltar_prmp1*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmp1 - 1.0/2.0*Deltar_prmp1*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmp1 = (1.0/2.0)*Deltat_prmp1/sqrt(Deltat);
    double exp2nu_prmp1 = -Deltat*Lambt_prmp1*Sigma/pow(Lambt, 2) + Deltat_prmp1*Sigma/Lambt;
    double expnu_prmp1 = (1.0/2.0)*exp2nu_prmp1/sqrt(exp2nu);
    double omega_prmp1 = -Lambt_prmp1*omegatilde/pow(Lambt, 2);
    double Lambtprime_prmp1 = -Deltatprime_prmp1*pow(a, 2)*sin2theta;
    double nucostheta_prmp1 = -Deltat_prmp1*pow(a, 2)*costheta*w2/(Lambt*Sigma) - Lambt_prmp1*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmp1 = 4*Deltat*Lambt_prmp1*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmp1*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmp1 = (1.0/2.0)*Deltar_prmp1/pow(Deltar, 3.0/2.0);
    double nur_prmp1 = (1.0/2.0)*w2*(-4*Deltat_prmp1*r + Deltatprime_prmp1*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmp1*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmp1*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmp1 = (Lambt_prmp1*omegatildeprime - Lambtprime_prmp1*omegatilde)/pow(Lambt, 2) + Lambt_prmp1*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmp1 = 442.44299999999998*pow(chi, 2)*chi_prmp1*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmp1*eta + 198.59610000000001*pow(chi, 2)*chi_prmp1 - 686.62599999999998*chi*chi_prmp1*eta + 2495.29*chi_prmp1*pow(eta, 2);
    double sigmacoeffTerm3_prmp1 = dSO_prmp1*eta*pow(u, 3);
    double sigmacoeffTerm2_prmp1 = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmp1 + 204*Qminus1_prmp1 + r*(1620*DrSipn2*DrSipn2_prmp1 - 234*DrSipn2*Qminus1_prmp1 - 234*DrSipn2_prmp1*Qminus1)) + r*(-96*DrSipn2_prmp1 - 436*Qminus1_prmp1 + r*(36*DrSipn2*Qminus1_prmp1 + 36*DrSipn2_prmp1*Qminus1 - 90*Qminus1*Qminus1_prmp1)))/pow(r, 2);
    double sigmacoeffTerm1_prmp1 = eta*(-3*DrSipn2_prmp1 + (1.0/4.0)*Qminus1_prmp1);
    double sigmacoeff_prmp1 = sigmacoeffTerm1_prmp1 + sigmacoeffTerm2_prmp1 + sigmacoeffTerm3_prmp1;
    double sigmastarcoeffTerm2_prmp1 = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmp1 + 120*Qminus1_prmp1 + r*(720*DrSipn2*DrSipn2_prmp1 + Qminus1*(-126*DrSipn2_prmp1 - 3*Qminus1_prmp1) + Qminus1_prmp1*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmp1 + Qminus1*r*(96*DrSipn2_prmp1 - 23*Qminus1_prmp1) + Qminus1_prmp1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmp1))/pow(r, 2);
    double sigmastarcoeffTerm1_prmp1 = eta*(-5.0/2.0*DrSipn2_prmp1 + (1.0/3.0)*Qminus1_prmp1);
    double sigmastarcoeff_prmp1 = sigmastarcoeffTerm1_prmp1 + sigmastarcoeffTerm2_prmp1;
    double Deltasigmastar3_prmp1 = sigma3*sigmacoeff_prmp1 + sigmastar3*sigmastarcoeff_prmp1;
    double Deltasigmastar2_prmp1 = sigma2*sigmacoeff_prmp1 + sigmastar2*sigmastarcoeff_prmp1;
    double Deltasigmastar1_prmp1 = sigma1*sigmacoeff_prmp1 + sigmastar1*sigmastarcoeff_prmp1;
    double Sstar3_prmp1 = Deltasigmastar3_prmp1;
    double Sstar2_prmp1 = Deltasigmastar2_prmp1;
    double Sstar1_prmp1 = Deltasigmastar1_prmp1;
    double S3_prmp1 = Sstar3_prmp1;
    double S2_prmp1 = Sstar2_prmp1;
    double S1_prmp1 = Sstar1_prmp1;
    double Sstardotn_prmp1 = Sstar1_prmp1*n1 + Sstar2_prmp1*n2 + Sstar3_prmp1*n3;
    double SdotSkerrhat_prmp1 = S1_prmp1*Skerrhat1 + S2_prmp1*Skerrhat2 + S3_prmp1*Skerrhat3;
    double Sdotn_prmp1 = S1_prmp1*n1 + S2_prmp1*n2 + S3_prmp1*n3;
    double Sdotv_prmp1 = S1_prmp1*v1 + S2_prmp1*v2 + S3_prmp1*v3;
    double Sdotxi_prmp1 = S1_prmp1*xi1 + S2_prmp1*xi2 + S3_prmp1*xi3;
    double HdsumTerm2_prmp1 = 6*Sstardotn*Sstardotn_prmp1;
    double HdsumTerm1_prmp1 = 2*Sstar1*Sstar1_prmp1 + 2*Sstar2*Sstar2_prmp1 + 2*Sstar3*Sstar3_prmp1;
    double Hdsum_prmp1 = HdsumTerm1_prmp1 - HdsumTerm2_prmp1;
    double Q4_prmp1 = eta*pow(prT, 3)*prT_prmp1*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmp1 = 2*Deltar*pdotn*pdotn_prmp1/Sigma + Deltar_prmp1*pow(pdotn, 2)/Sigma + 2*pdotvr*pdotvr_prmp1/(Sigma*sin2theta) + 2*Sigma*pdotxir*pdotxir_prmp1/(Lambt*sin2theta) - Lambt_prmp1*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmp1 = Q4_prmp1 + gammappsum_prmp1;
    double alpha_prmp1 = Lambt*sqrt(Deltat*Sigma/Lambt)*(-1.0/2.0*Deltat*Lambt_prmp1*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmp1*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmp1 = omegatilde*pphi_prmp1/Lambt - Lambt_prmp1*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmp1 = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmp1 - 1.0/2.0*Q_prmp1/sqrt(Q)) + Sdotn_prmp1*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmp1 - Jtilde*Sdotv_prmp1*pdotn - Jtilde_prmp1*Sdotv*pdotn + Sdotn*pdotvr_prmp1 + Sdotn_prmp1*pdotvr) + pdotvr_prmp1*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmp1*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmp1 + Btilde*Jtilde*Sdotxi_prmp1*pdotn + Btilde*Jtilde_prmp1*Sdotxi*pdotn + Btilde_prmp1*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmp1 - Sdotn*expmu*expnu_prmp1*pdotxir - Sdotn_prmp1*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmp1*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmp1*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmp1 = (1.0/2.0)*omegacostheta*(-Q_prmp1 - 1.0/2.0*Q_prmp1/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmp1/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmp1*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - Btilde_prmp1*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmp1 = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmp1 - Jtilde*Sdotv_prmp1*pdotn - Jtilde_prmp1*Sdotv*pdotn + Sdotn*pdotvr_prmp1 + Sdotn_prmp1*pdotvr) + Jtilde*pdotn_prmp1*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmp1*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmp1 + (1.0/2.0)*Q_prmp1/sqrt(Q)) + Sdotv_prmp1*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmp1*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmp1 - Btilde*Sdotxi*expnu_prmp1*pdotvr - Btilde*Sdotxi_prmp1*expnu*pdotvr - Btilde_prmp1*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmp1 + Sdotv*exp2nu_prmp1*expmu*pdotxir + Sdotv_prmp1*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmp1*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmp1 = (1.0/2.0)*Jtilde*omegar*(-Q_prmp1 - 1.0/2.0*Q_prmp1/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) + Jtilde*omegar_prmp1/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmp1*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmp1*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmp1*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmp1 = SdotSkerrhat*omega_prmp1 + SdotSkerrhat_prmp1*omega;
    double Hss_prmp1 = HssTerm1_prmp1 + HssTerm2*HssTerm2coeff_prmp1 + HssTerm2_prmp1*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmp1 + HssTerm3_prmp1*HssTerm3coeff;
    double HsoTerm2c_prmp1 = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmp1*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmp1*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmp1*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmp1*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmp1*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmp1*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmp1 = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmp1 + Jtilde*Sdotv_prmp1*nur + Jtilde_prmp1*Sdotv*nur - Sdotn*nucostheta_prmp1*xisq - Sdotn_prmp1*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmp1*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmp1*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmp1*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmp1*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmp1 = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(-nucostheta_prmp1*pdotn*xisq + nur*pdotvr_prmp1 + nur_prmp1*pdotvr + pdotn_prmp1*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn_prmp1*xisq + mur*pdotvr_prmp1*(sqrt(Q) + 1) + mur_prmp1*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmp1*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmp1*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmp1*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmp1*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmp1*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmp1 = HsoTerm2a_prmp1 + HsoTerm2b_prmp1 - HsoTerm2c_prmp1;
    double HsoTerm2coeff_prmp1 = expnu*(-Q_prmp1 - 1.0/2.0*Q_prmp1/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) + expnu_prmp1/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmp1*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmp1 = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmp1 + expmu*expnu_prmp1)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir_prmp1*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu_prmp1*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmp1*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmp1*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmp1*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmp1 = HsoTerm1_prmp1 + HsoTerm2*HsoTerm2coeff_prmp1 + HsoTerm2_prmp1*HsoTerm2coeff;
    double Hd_prmp1 = Hdcoeff*Hdsum_prmp1;
    double Hns_prmp1 = sqrt(Hnsradicand)*alpha_prmp1 + betapsum_prmp1 + (1.0/2.0)*Hnsradicand_prmp1*alpha/sqrt(Hnsradicand);
    double Hs_prmp1 = Hso_prmp1 + Hss_prmp1;
    double dSS_prmp1 = 1585.5329999999999*pow(chi, 2)*chi_prmp1*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmp1*eta + 2323.5599999999999*chi*chi_prmp1*pow(eta, 3) - 652.64999999999998*chi*chi_prmp1*pow(eta, 2) + 37.196399999999997*chi_prmp1*eta;
    double Heff_prmp1 = -Hd_prmp1 + Hns_prmp1 + Hs_prmp1 + dSS_prmp1*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmp1 = Heff_prmp1*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double L3_prmp2 = x;
    double L1_prmp2 = -z;
    double Lnorm_prmp2 = (L1*L1_prmp2 + L3*L3_prmp2)/sqrt(pow(L1, 2) + pow(L2, 2) + pow(L3, 2));
    double Lhat3_prmp2 = -L3*Lnorm_prmp2/pow(Lnorm, 2) + L3_prmp2/Lnorm;
    double Lhat2_prmp2 = -L2*Lnorm_prmp2/pow(Lnorm, 2);
    double Lhat1_prmp2 = -L1*Lnorm_prmp2/pow(Lnorm, 2) + L1_prmp2/Lnorm;
    double S2dotLhat_prmp2 = Lhat1_prmp2*S2x + Lhat2_prmp2*S2y + Lhat3_prmp2*S2z;
    double S1dotLhat_prmp2 = Lhat1_prmp2*S1x + Lhat2_prmp2*S1y + Lhat3_prmp2*S1z;
    double S1perp3_prmp2 = -Lhat3*S1dotLhat_prmp2 - Lhat3_prmp2*S1dotLhat;
    double S1perp2_prmp2 = -Lhat2*S1dotLhat_prmp2 - Lhat2_prmp2*S1dotLhat;
    double S1perp1_prmp2 = -Lhat1*S1dotLhat_prmp2 - Lhat1_prmp2*S1dotLhat;
    double S2perp3_prmp2 = -Lhat3*S2dotLhat_prmp2 - Lhat3_prmp2*S2dotLhat;
    double S2perp2_prmp2 = -Lhat2*S2dotLhat_prmp2 - Lhat2_prmp2*S2dotLhat;
    double S2perp1_prmp2 = -Lhat1*S2dotLhat_prmp2 - Lhat1_prmp2*S2dotLhat;
    double Sperp3_prmp2 = S1perp3_prmp2 + S2perp3_prmp2;
    double Sperp2_prmp2 = S1perp2_prmp2 + S2perp2_prmp2;
    double Sperp1_prmp2 = S1perp1_prmp2 + S2perp1_prmp2;
    double chi_prmp2 = (Lhat1_prmp2*Skerr1 + Lhat2_prmp2*Skerr2 + Lhat3_prmp2*Skerr3)/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmp2 + (1.0/2.0)*Skerr2*Sperp2_prmp2 + (1.0/2.0)*Skerr3*Sperp3_prmp2)/(Skerrmag*(1.0 - 2.0*eta));
    double K_prmp2 = -177.4974*pow(chi, 2)*chi_prmp2*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmp2*eta + 4.3097700000000003*pow(chi, 2)*chi_prmp2 + 62.349200000000003*chi*chi_prmp2*pow(eta, 3) + 12.329319999999999*chi*chi_prmp2*pow(eta, 2) - 2.76172*chi*chi_prmp2 - 27.520099999999999*chi_prmp2*pow(eta, 3) + 17.3736*chi_prmp2*pow(eta, 2) + 2.26831*chi_prmp2*eta - 1.6204499999999999*chi_prmp2;
    double etaKminus1_prmp2 = K_prmp2*eta;
    double Delta0_prmp2 = K*K_prmp2*eta + K_prmp2*(K*eta - 2);
    double Delta1_prmp2 = etaKminus1*(-2*Delta0_prmp2 - 2*K_prmp2) + etaKminus1_prmp2*(-2*Delta0 - 2*K);
    double Delta2_prmp2 = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmp2 - Delta0_prmp2*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmp2 - 2*etaKminus1_prmp2) + Delta1_prmp2*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmp2 = -pow(Delta1, 2)*Delta1_prmp2 + pow(Delta1, 2)*etaKminus1_prmp2 + 2*Delta1*Delta1_prmp2*etaKminus1 + Delta1*Delta2_prmp2 - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmp2 + Delta1_prmp2*Delta2 - Delta1_prmp2*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmp2 + 2*etaKminus1_prmp2) + etaKminus1_prmp2*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmp2 = pow(Delta1, 3)*Delta1_prmp2 - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmp2 - 2*pow(Delta1, 2)*Delta1_prmp2*etaKminus1 - pow(Delta1, 2)*Delta2_prmp2 - 2*Delta1*Delta1_prmp2*Delta2 + Delta1*(2*Delta2*etaKminus1_prmp2 + 2*Delta2_prmp2*etaKminus1 + Delta3_prmp2) + Delta1_prmp2*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmp2 - 2*Delta3*etaKminus1_prmp2 - 2*Delta3_prmp2*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmp2 - 2*Delta2_prmp2) + pow(a, 2)*etaKminus1*etaKminus1_prmp2*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmp2*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmp2 = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmp2 - 3*Delta1*Delta2_prmp2 - 3*Delta1_prmp2*Delta2 + 3*Delta3_prmp2) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmp2 - 4*pow(Delta1, 2)*Delta2_prmp2 - 8*Delta1*Delta1_prmp2*Delta2 + 4*Delta1*Delta3_prmp2 + 4*Delta1_prmp2*Delta3 + 4*Delta2*Delta2_prmp2 - 4*Delta4_prmp2)/etaKminus1 - 1.0/2.0*etaKminus1_prmp2*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmp2 - 5*pow(Delta1, 3)*Delta2_prmp2 - 15*pow(Delta1, 2)*Delta1_prmp2*Delta2 + 5*pow(Delta1, 2)*Delta3_prmp2 + 10*Delta1*Delta1_prmp2*Delta3 + 10*Delta1*Delta2*Delta2_prmp2 - 5*Delta1*Delta4_prmp2 + 5*Delta1_prmp2*pow(Delta2, 2) - 5*Delta1_prmp2*Delta4 - 5*Delta2*Delta3_prmp2 - 5*Delta2_prmp2*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmp2*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmp2*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmp2 = (128.0/5.0)*etaKminus1*etaKminus1_prmp2;
    double logarg_prmp2 = u*(Delta1_prmp2 + u*(Delta2_prmp2 + u*(Delta3_prmp2 + u*(Delta4_prmp2 + u*(Delta5_prmp2 + Delta5l_prmp2*log(u))))));
    double Deltaucalib_prmp2 = eta*(Delta0_prmp2 + logarg_prmp2*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmp2 = eta*logarg_prmp2*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmp2 + u*(2*Delta2_prmp2 + u*(3*Delta3_prmp2 + u*(4*Delta4_prmp2 + u*(5*Delta5_prmp2 + 5*Delta5l_prmp2*log(u))))))/(logarg + 1);
    double Deltaubar_prmp2 = etaKminus1_prmp2*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmp2/pow(etaKminus1, 3);
    double Deltaubarprime_prmp2 = 2*etaKminus1_prmp2*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmp2 = (Deltaubar*Deltaucalib_prmp2 + Deltaubar_prmp2*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmp2 = Deltaubar*Deltaucalibprime_prmp2 + Deltaubar_prmp2*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmp2 + Deltaubarprime_prmp2*Deltaucalib;
    double Deltatprime_prmp2 = 2*Deltau_prmp2*r + Deltauprime_prmp2*pow(r, 2);
    double Deltat_prmp2 = Deltau_prmp2*pow(r, 2);
    double Deltar_prmp2 = Deltat_prmp2*Dinv;
    double Lambt_prmp2 = Deltat_prmp2*pow(a, 2)*sin2theta*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmp2 = (1.0/2.0)*(Deltar*Deltat_prmp2 + Deltar_prmp2*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat)));
    double csi1_prmp2 = csi_prmp2*(1 - fabs((double)tortoise - 1));
    double csi2_prmp2 = csi_prmp2*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmp2 = csi2*n2 + csi2_prmp2*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmp2 = n3*prT_prmp2*(-1 + 1.0/csi1) - csi1_prmp2*n3*prT/pow(csi1, 2);
    double phat2_prmp2 = n2*prT_prmp2*(-1 + 1.0/csi1) + 1 - csi1_prmp2*n2*prT/pow(csi1, 2);
    double phat1_prmp2 = n1*prT_prmp2*(-1 + 1.0/csi1) - csi1_prmp2*n1*prT/pow(csi1, 2);
    double pdotxir_prmp2 = r*(phat1_prmp2*xi1 + phat2_prmp2*xi2 + phat3_prmp2*xi3);
    double pdotn_prmp2 = n1*phat1_prmp2 + n2*phat2_prmp2 + n3*phat3_prmp2;
    double pdotvr_prmp2 = r*(phat1_prmp2*v1 + phat2_prmp2*v2 + phat3_prmp2*v3);
    double pphi_prmp2 = pdotxir_prmp2;
    double Qcoeff1_prmp2 = -Lambt_prmp2*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmp2 = 2*Deltar*pdotn*pdotn_prmp2/Sigma + Deltar_prmp2*pow(pdotn, 2)/Sigma;
    double Q_prmp2 = DrSipn2_prmp2 + 2*Qcoeff1*pdotxir*pdotxir_prmp2 + Qcoeff1_prmp2*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmp2;
    double Qminus1_prmp2 = Q_prmp2;
    double Jtilde_prmp2 = (1.0/2.0)*Deltar_prmp2/sqrt(Deltar);
    double Brtilde_prmp2 = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmp2 - 2*Deltat_prmp2 + (1.0/2.0)*Deltar_prmp2*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmp2 - 1.0/2.0*Deltar_prmp2*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmp2 = (1.0/2.0)*Deltat_prmp2/sqrt(Deltat);
    double exp2nu_prmp2 = -Deltat*Lambt_prmp2*Sigma/pow(Lambt, 2) + Deltat_prmp2*Sigma/Lambt;
    double expnu_prmp2 = (1.0/2.0)*exp2nu_prmp2/sqrt(exp2nu);
    double omega_prmp2 = -Lambt_prmp2*omegatilde/pow(Lambt, 2);
    double Lambtprime_prmp2 = -Deltatprime_prmp2*pow(a, 2)*sin2theta;
    double nucostheta_prmp2 = -Deltat_prmp2*pow(a, 2)*costheta*w2/(Lambt*Sigma) - Lambt_prmp2*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmp2 = 4*Deltat*Lambt_prmp2*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmp2*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmp2 = (1.0/2.0)*Deltar_prmp2/pow(Deltar, 3.0/2.0);
    double nur_prmp2 = (1.0/2.0)*w2*(-4*Deltat_prmp2*r + Deltatprime_prmp2*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmp2*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmp2*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmp2 = (Lambt_prmp2*omegatildeprime - Lambtprime_prmp2*omegatilde)/pow(Lambt, 2) + Lambt_prmp2*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmp2 = 442.44299999999998*pow(chi, 2)*chi_prmp2*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmp2*eta + 198.59610000000001*pow(chi, 2)*chi_prmp2 - 686.62599999999998*chi*chi_prmp2*eta + 2495.29*chi_prmp2*pow(eta, 2);
    double sigmacoeffTerm3_prmp2 = dSO_prmp2*eta*pow(u, 3);
    double sigmacoeffTerm2_prmp2 = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmp2 + 204*Qminus1_prmp2 + r*(1620*DrSipn2*DrSipn2_prmp2 - 234*DrSipn2*Qminus1_prmp2 - 234*DrSipn2_prmp2*Qminus1)) + r*(-96*DrSipn2_prmp2 - 436*Qminus1_prmp2 + r*(36*DrSipn2*Qminus1_prmp2 + 36*DrSipn2_prmp2*Qminus1 - 90*Qminus1*Qminus1_prmp2)))/pow(r, 2);
    double sigmacoeffTerm1_prmp2 = eta*(-3*DrSipn2_prmp2 + (1.0/4.0)*Qminus1_prmp2);
    double sigmacoeff_prmp2 = sigmacoeffTerm1_prmp2 + sigmacoeffTerm2_prmp2 + sigmacoeffTerm3_prmp2;
    double sigmastarcoeffTerm2_prmp2 = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmp2 + 120*Qminus1_prmp2 + r*(720*DrSipn2*DrSipn2_prmp2 + Qminus1*(-126*DrSipn2_prmp2 - 3*Qminus1_prmp2) + Qminus1_prmp2*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmp2 + Qminus1*r*(96*DrSipn2_prmp2 - 23*Qminus1_prmp2) + Qminus1_prmp2*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmp2))/pow(r, 2);
    double sigmastarcoeffTerm1_prmp2 = eta*(-5.0/2.0*DrSipn2_prmp2 + (1.0/3.0)*Qminus1_prmp2);
    double sigmastarcoeff_prmp2 = sigmastarcoeffTerm1_prmp2 + sigmastarcoeffTerm2_prmp2;
    double Deltasigmastar3_prmp2 = sigma3*sigmacoeff_prmp2 + sigmastar3*sigmastarcoeff_prmp2;
    double Deltasigmastar2_prmp2 = sigma2*sigmacoeff_prmp2 + sigmastar2*sigmastarcoeff_prmp2;
    double Deltasigmastar1_prmp2 = sigma1*sigmacoeff_prmp2 + sigmastar1*sigmastarcoeff_prmp2;
    double Sstar3_prmp2 = Deltasigmastar3_prmp2;
    double Sstar2_prmp2 = Deltasigmastar2_prmp2;
    double Sstar1_prmp2 = Deltasigmastar1_prmp2;
    double S3_prmp2 = Sstar3_prmp2;
    double S2_prmp2 = Sstar2_prmp2;
    double S1_prmp2 = Sstar1_prmp2;
    double Sstardotn_prmp2 = Sstar1_prmp2*n1 + Sstar2_prmp2*n2 + Sstar3_prmp2*n3;
    double SdotSkerrhat_prmp2 = S1_prmp2*Skerrhat1 + S2_prmp2*Skerrhat2 + S3_prmp2*Skerrhat3;
    double Sdotn_prmp2 = S1_prmp2*n1 + S2_prmp2*n2 + S3_prmp2*n3;
    double Sdotv_prmp2 = S1_prmp2*v1 + S2_prmp2*v2 + S3_prmp2*v3;
    double Sdotxi_prmp2 = S1_prmp2*xi1 + S2_prmp2*xi2 + S3_prmp2*xi3;
    double HdsumTerm2_prmp2 = 6*Sstardotn*Sstardotn_prmp2;
    double HdsumTerm1_prmp2 = 2*Sstar1*Sstar1_prmp2 + 2*Sstar2*Sstar2_prmp2 + 2*Sstar3*Sstar3_prmp2;
    double Hdsum_prmp2 = HdsumTerm1_prmp2 - HdsumTerm2_prmp2;
    double Q4_prmp2 = eta*pow(prT, 3)*prT_prmp2*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmp2 = 2*Deltar*pdotn*pdotn_prmp2/Sigma + Deltar_prmp2*pow(pdotn, 2)/Sigma + 2*pdotvr*pdotvr_prmp2/(Sigma*sin2theta) + 2*Sigma*pdotxir*pdotxir_prmp2/(Lambt*sin2theta) - Lambt_prmp2*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmp2 = Q4_prmp2 + gammappsum_prmp2;
    double alpha_prmp2 = Lambt*sqrt(Deltat*Sigma/Lambt)*(-1.0/2.0*Deltat*Lambt_prmp2*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmp2*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmp2 = omegatilde*pphi_prmp2/Lambt - Lambt_prmp2*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmp2 = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmp2 - 1.0/2.0*Q_prmp2/sqrt(Q)) + Sdotn_prmp2*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmp2 - Jtilde*Sdotv_prmp2*pdotn - Jtilde_prmp2*Sdotv*pdotn + Sdotn*pdotvr_prmp2 + Sdotn_prmp2*pdotvr) + pdotvr_prmp2*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmp2*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmp2 + Btilde*Jtilde*Sdotxi_prmp2*pdotn + Btilde*Jtilde_prmp2*Sdotxi*pdotn + Btilde_prmp2*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmp2 - Sdotn*expmu*expnu_prmp2*pdotxir - Sdotn_prmp2*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmp2*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmp2*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmp2 = (1.0/2.0)*omegacostheta*(-Q_prmp2 - 1.0/2.0*Q_prmp2/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmp2/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmp2*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - Btilde_prmp2*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmp2 = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmp2 - Jtilde*Sdotv_prmp2*pdotn - Jtilde_prmp2*Sdotv*pdotn + Sdotn*pdotvr_prmp2 + Sdotn_prmp2*pdotvr) + Jtilde*pdotn_prmp2*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmp2*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmp2 + (1.0/2.0)*Q_prmp2/sqrt(Q)) + Sdotv_prmp2*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmp2*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmp2 - Btilde*Sdotxi*expnu_prmp2*pdotvr - Btilde*Sdotxi_prmp2*expnu*pdotvr - Btilde_prmp2*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmp2 + Sdotv*exp2nu_prmp2*expmu*pdotxir + Sdotv_prmp2*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmp2*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmp2 = (1.0/2.0)*Jtilde*omegar*(-Q_prmp2 - 1.0/2.0*Q_prmp2/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) + Jtilde*omegar_prmp2/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmp2*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmp2*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmp2*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmp2 = SdotSkerrhat*omega_prmp2 + SdotSkerrhat_prmp2*omega;
    double Hss_prmp2 = HssTerm1_prmp2 + HssTerm2*HssTerm2coeff_prmp2 + HssTerm2_prmp2*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmp2 + HssTerm3_prmp2*HssTerm3coeff;
    double HsoTerm2c_prmp2 = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmp2*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmp2*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmp2*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmp2*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmp2*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmp2*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmp2 = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmp2 + Jtilde*Sdotv_prmp2*nur + Jtilde_prmp2*Sdotv*nur - Sdotn*nucostheta_prmp2*xisq - Sdotn_prmp2*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmp2*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmp2*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmp2*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmp2*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmp2 = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(-nucostheta_prmp2*pdotn*xisq + nur*pdotvr_prmp2 + nur_prmp2*pdotvr + pdotn_prmp2*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn_prmp2*xisq + mur*pdotvr_prmp2*(sqrt(Q) + 1) + mur_prmp2*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmp2*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmp2*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmp2*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmp2*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmp2*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmp2 = HsoTerm2a_prmp2 + HsoTerm2b_prmp2 - HsoTerm2c_prmp2;
    double HsoTerm2coeff_prmp2 = expnu*(-Q_prmp2 - 1.0/2.0*Q_prmp2/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) + expnu_prmp2/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmp2*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmp2 = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmp2 + expmu*expnu_prmp2)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir_prmp2*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu_prmp2*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmp2*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmp2*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmp2*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmp2 = HsoTerm1_prmp2 + HsoTerm2*HsoTerm2coeff_prmp2 + HsoTerm2_prmp2*HsoTerm2coeff;
    double Hd_prmp2 = Hdcoeff*Hdsum_prmp2;
    double Hns_prmp2 = sqrt(Hnsradicand)*alpha_prmp2 + betapsum_prmp2 + (1.0/2.0)*Hnsradicand_prmp2*alpha/sqrt(Hnsradicand);
    double Hs_prmp2 = Hso_prmp2 + Hss_prmp2;
    double dSS_prmp2 = 1585.5329999999999*pow(chi, 2)*chi_prmp2*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmp2*eta + 2323.5599999999999*chi*chi_prmp2*pow(eta, 3) - 652.64999999999998*chi*chi_prmp2*pow(eta, 2) + 37.196399999999997*chi_prmp2*eta;
    double Heff_prmp2 = -Hd_prmp2 + Hns_prmp2 + Hs_prmp2 + dSS_prmp2*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmp2 = Heff_prmp2*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double L2_prmp3 = -x;
    double L1_prmp3 = y;
    double Lnorm_prmp3 = (L1*L1_prmp3 + L2*L2_prmp3)/sqrt(pow(L1, 2) + pow(L2, 2) + pow(L3, 2));
    double Lhat3_prmp3 = -L3*Lnorm_prmp3/pow(Lnorm, 2);
    double Lhat2_prmp3 = -L2*Lnorm_prmp3/pow(Lnorm, 2) + L2_prmp3/Lnorm;
    double Lhat1_prmp3 = -L1*Lnorm_prmp3/pow(Lnorm, 2) + L1_prmp3/Lnorm;
    double S2dotLhat_prmp3 = Lhat1_prmp3*S2x + Lhat2_prmp3*S2y + Lhat3_prmp3*S2z;
    double S1dotLhat_prmp3 = Lhat1_prmp3*S1x + Lhat2_prmp3*S1y + Lhat3_prmp3*S1z;
    double S1perp3_prmp3 = -Lhat3*S1dotLhat_prmp3 - Lhat3_prmp3*S1dotLhat;
    double S1perp2_prmp3 = -Lhat2*S1dotLhat_prmp3 - Lhat2_prmp3*S1dotLhat;
    double S1perp1_prmp3 = -Lhat1*S1dotLhat_prmp3 - Lhat1_prmp3*S1dotLhat;
    double S2perp3_prmp3 = -Lhat3*S2dotLhat_prmp3 - Lhat3_prmp3*S2dotLhat;
    double S2perp2_prmp3 = -Lhat2*S2dotLhat_prmp3 - Lhat2_prmp3*S2dotLhat;
    double S2perp1_prmp3 = -Lhat1*S2dotLhat_prmp3 - Lhat1_prmp3*S2dotLhat;
    double Sperp3_prmp3 = S1perp3_prmp3 + S2perp3_prmp3;
    double Sperp2_prmp3 = S1perp2_prmp3 + S2perp2_prmp3;
    double Sperp1_prmp3 = S1perp1_prmp3 + S2perp1_prmp3;
    double chi_prmp3 = (Lhat1_prmp3*Skerr1 + Lhat2_prmp3*Skerr2 + Lhat3_prmp3*Skerr3)/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmp3 + (1.0/2.0)*Skerr2*Sperp2_prmp3 + (1.0/2.0)*Skerr3*Sperp3_prmp3)/(Skerrmag*(1.0 - 2.0*eta));
    double K_prmp3 = -177.4974*pow(chi, 2)*chi_prmp3*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmp3*eta + 4.3097700000000003*pow(chi, 2)*chi_prmp3 + 62.349200000000003*chi*chi_prmp3*pow(eta, 3) + 12.329319999999999*chi*chi_prmp3*pow(eta, 2) - 2.76172*chi*chi_prmp3 - 27.520099999999999*chi_prmp3*pow(eta, 3) + 17.3736*chi_prmp3*pow(eta, 2) + 2.26831*chi_prmp3*eta - 1.6204499999999999*chi_prmp3;
    double etaKminus1_prmp3 = K_prmp3*eta;
    double Delta0_prmp3 = K*K_prmp3*eta + K_prmp3*(K*eta - 2);
    double Delta1_prmp3 = etaKminus1*(-2*Delta0_prmp3 - 2*K_prmp3) + etaKminus1_prmp3*(-2*Delta0 - 2*K);
    double Delta2_prmp3 = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmp3 - Delta0_prmp3*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmp3 - 2*etaKminus1_prmp3) + Delta1_prmp3*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmp3 = -pow(Delta1, 2)*Delta1_prmp3 + pow(Delta1, 2)*etaKminus1_prmp3 + 2*Delta1*Delta1_prmp3*etaKminus1 + Delta1*Delta2_prmp3 - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmp3 + Delta1_prmp3*Delta2 - Delta1_prmp3*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmp3 + 2*etaKminus1_prmp3) + etaKminus1_prmp3*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmp3 = pow(Delta1, 3)*Delta1_prmp3 - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmp3 - 2*pow(Delta1, 2)*Delta1_prmp3*etaKminus1 - pow(Delta1, 2)*Delta2_prmp3 - 2*Delta1*Delta1_prmp3*Delta2 + Delta1*(2*Delta2*etaKminus1_prmp3 + 2*Delta2_prmp3*etaKminus1 + Delta3_prmp3) + Delta1_prmp3*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmp3 - 2*Delta3*etaKminus1_prmp3 - 2*Delta3_prmp3*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmp3 - 2*Delta2_prmp3) + pow(a, 2)*etaKminus1*etaKminus1_prmp3*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmp3*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmp3 = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmp3 - 3*Delta1*Delta2_prmp3 - 3*Delta1_prmp3*Delta2 + 3*Delta3_prmp3) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmp3 - 4*pow(Delta1, 2)*Delta2_prmp3 - 8*Delta1*Delta1_prmp3*Delta2 + 4*Delta1*Delta3_prmp3 + 4*Delta1_prmp3*Delta3 + 4*Delta2*Delta2_prmp3 - 4*Delta4_prmp3)/etaKminus1 - 1.0/2.0*etaKminus1_prmp3*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmp3 - 5*pow(Delta1, 3)*Delta2_prmp3 - 15*pow(Delta1, 2)*Delta1_prmp3*Delta2 + 5*pow(Delta1, 2)*Delta3_prmp3 + 10*Delta1*Delta1_prmp3*Delta3 + 10*Delta1*Delta2*Delta2_prmp3 - 5*Delta1*Delta4_prmp3 + 5*Delta1_prmp3*pow(Delta2, 2) - 5*Delta1_prmp3*Delta4 - 5*Delta2*Delta3_prmp3 - 5*Delta2_prmp3*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmp3*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmp3*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmp3 = (128.0/5.0)*etaKminus1*etaKminus1_prmp3;
    double logarg_prmp3 = u*(Delta1_prmp3 + u*(Delta2_prmp3 + u*(Delta3_prmp3 + u*(Delta4_prmp3 + u*(Delta5_prmp3 + Delta5l_prmp3*log(u))))));
    double Deltaucalib_prmp3 = eta*(Delta0_prmp3 + logarg_prmp3*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmp3 = eta*logarg_prmp3*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmp3 + u*(2*Delta2_prmp3 + u*(3*Delta3_prmp3 + u*(4*Delta4_prmp3 + u*(5*Delta5_prmp3 + 5*Delta5l_prmp3*log(u))))))/(logarg + 1);
    double Deltaubar_prmp3 = etaKminus1_prmp3*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmp3/pow(etaKminus1, 3);
    double Deltaubarprime_prmp3 = 2*etaKminus1_prmp3*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmp3 = (Deltaubar*Deltaucalib_prmp3 + Deltaubar_prmp3*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmp3 = Deltaubar*Deltaucalibprime_prmp3 + Deltaubar_prmp3*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmp3 + Deltaubarprime_prmp3*Deltaucalib;
    double Deltatprime_prmp3 = 2*Deltau_prmp3*r + Deltauprime_prmp3*pow(r, 2);
    double Deltat_prmp3 = Deltau_prmp3*pow(r, 2);
    double Deltar_prmp3 = Deltat_prmp3*Dinv;
    double Lambt_prmp3 = Deltat_prmp3*pow(a, 2)*sin2theta*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmp3 = (1.0/2.0)*(Deltar*Deltat_prmp3 + Deltar_prmp3*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat)));
    double csi1_prmp3 = csi_prmp3*(1 - fabs((double)tortoise - 1));
    double csi2_prmp3 = csi_prmp3*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmp3 = csi2*n3 + csi2_prmp3*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmp3 = n3*prT_prmp3*(-1 + 1.0/csi1) + 1 - csi1_prmp3*n3*prT/pow(csi1, 2);
    double phat2_prmp3 = n2*prT_prmp3*(-1 + 1.0/csi1) - csi1_prmp3*n2*prT/pow(csi1, 2);
    double phat1_prmp3 = n1*prT_prmp3*(-1 + 1.0/csi1) - csi1_prmp3*n1*prT/pow(csi1, 2);
    double pdotxir_prmp3 = r*(phat1_prmp3*xi1 + phat2_prmp3*xi2 + phat3_prmp3*xi3);
    double pdotn_prmp3 = n1*phat1_prmp3 + n2*phat2_prmp3 + n3*phat3_prmp3;
    double pdotvr_prmp3 = r*(phat1_prmp3*v1 + phat2_prmp3*v2 + phat3_prmp3*v3);
    double pphi_prmp3 = pdotxir_prmp3;
    double Qcoeff1_prmp3 = -Lambt_prmp3*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmp3 = 2*Deltar*pdotn*pdotn_prmp3/Sigma + Deltar_prmp3*pow(pdotn, 2)/Sigma;
    double Q_prmp3 = DrSipn2_prmp3 + 2*Qcoeff1*pdotxir*pdotxir_prmp3 + Qcoeff1_prmp3*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmp3;
    double Qminus1_prmp3 = Q_prmp3;
    double Jtilde_prmp3 = (1.0/2.0)*Deltar_prmp3/sqrt(Deltar);
    double Brtilde_prmp3 = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmp3 - 2*Deltat_prmp3 + (1.0/2.0)*Deltar_prmp3*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmp3 - 1.0/2.0*Deltar_prmp3*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmp3 = (1.0/2.0)*Deltat_prmp3/sqrt(Deltat);
    double exp2nu_prmp3 = -Deltat*Lambt_prmp3*Sigma/pow(Lambt, 2) + Deltat_prmp3*Sigma/Lambt;
    double expnu_prmp3 = (1.0/2.0)*exp2nu_prmp3/sqrt(exp2nu);
    double omega_prmp3 = -Lambt_prmp3*omegatilde/pow(Lambt, 2);
    double Lambtprime_prmp3 = -Deltatprime_prmp3*pow(a, 2)*sin2theta;
    double nucostheta_prmp3 = -Deltat_prmp3*pow(a, 2)*costheta*w2/(Lambt*Sigma) - Lambt_prmp3*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmp3 = 4*Deltat*Lambt_prmp3*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmp3*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmp3 = (1.0/2.0)*Deltar_prmp3/pow(Deltar, 3.0/2.0);
    double nur_prmp3 = (1.0/2.0)*w2*(-4*Deltat_prmp3*r + Deltatprime_prmp3*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmp3*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmp3*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmp3 = (Lambt_prmp3*omegatildeprime - Lambtprime_prmp3*omegatilde)/pow(Lambt, 2) + Lambt_prmp3*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmp3 = 442.44299999999998*pow(chi, 2)*chi_prmp3*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmp3*eta + 198.59610000000001*pow(chi, 2)*chi_prmp3 - 686.62599999999998*chi*chi_prmp3*eta + 2495.29*chi_prmp3*pow(eta, 2);
    double sigmacoeffTerm3_prmp3 = dSO_prmp3*eta*pow(u, 3);
    double sigmacoeffTerm2_prmp3 = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmp3 + 204*Qminus1_prmp3 + r*(1620*DrSipn2*DrSipn2_prmp3 - 234*DrSipn2*Qminus1_prmp3 - 234*DrSipn2_prmp3*Qminus1)) + r*(-96*DrSipn2_prmp3 - 436*Qminus1_prmp3 + r*(36*DrSipn2*Qminus1_prmp3 + 36*DrSipn2_prmp3*Qminus1 - 90*Qminus1*Qminus1_prmp3)))/pow(r, 2);
    double sigmacoeffTerm1_prmp3 = eta*(-3*DrSipn2_prmp3 + (1.0/4.0)*Qminus1_prmp3);
    double sigmacoeff_prmp3 = sigmacoeffTerm1_prmp3 + sigmacoeffTerm2_prmp3 + sigmacoeffTerm3_prmp3;
    double sigmastarcoeffTerm2_prmp3 = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmp3 + 120*Qminus1_prmp3 + r*(720*DrSipn2*DrSipn2_prmp3 + Qminus1*(-126*DrSipn2_prmp3 - 3*Qminus1_prmp3) + Qminus1_prmp3*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmp3 + Qminus1*r*(96*DrSipn2_prmp3 - 23*Qminus1_prmp3) + Qminus1_prmp3*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmp3))/pow(r, 2);
    double sigmastarcoeffTerm1_prmp3 = eta*(-5.0/2.0*DrSipn2_prmp3 + (1.0/3.0)*Qminus1_prmp3);
    double sigmastarcoeff_prmp3 = sigmastarcoeffTerm1_prmp3 + sigmastarcoeffTerm2_prmp3;
    double Deltasigmastar3_prmp3 = sigma3*sigmacoeff_prmp3 + sigmastar3*sigmastarcoeff_prmp3;
    double Deltasigmastar2_prmp3 = sigma2*sigmacoeff_prmp3 + sigmastar2*sigmastarcoeff_prmp3;
    double Deltasigmastar1_prmp3 = sigma1*sigmacoeff_prmp3 + sigmastar1*sigmastarcoeff_prmp3;
    double Sstar3_prmp3 = Deltasigmastar3_prmp3;
    double Sstar2_prmp3 = Deltasigmastar2_prmp3;
    double Sstar1_prmp3 = Deltasigmastar1_prmp3;
    double S3_prmp3 = Sstar3_prmp3;
    double S2_prmp3 = Sstar2_prmp3;
    double S1_prmp3 = Sstar1_prmp3;
    double Sstardotn_prmp3 = Sstar1_prmp3*n1 + Sstar2_prmp3*n2 + Sstar3_prmp3*n3;
    double SdotSkerrhat_prmp3 = S1_prmp3*Skerrhat1 + S2_prmp3*Skerrhat2 + S3_prmp3*Skerrhat3;
    double Sdotn_prmp3 = S1_prmp3*n1 + S2_prmp3*n2 + S3_prmp3*n3;
    double Sdotv_prmp3 = S1_prmp3*v1 + S2_prmp3*v2 + S3_prmp3*v3;
    double Sdotxi_prmp3 = S1_prmp3*xi1 + S2_prmp3*xi2 + S3_prmp3*xi3;
    double HdsumTerm2_prmp3 = 6*Sstardotn*Sstardotn_prmp3;
    double HdsumTerm1_prmp3 = 2*Sstar1*Sstar1_prmp3 + 2*Sstar2*Sstar2_prmp3 + 2*Sstar3*Sstar3_prmp3;
    double Hdsum_prmp3 = HdsumTerm1_prmp3 - HdsumTerm2_prmp3;
    double Q4_prmp3 = eta*pow(prT, 3)*prT_prmp3*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmp3 = 2*Deltar*pdotn*pdotn_prmp3/Sigma + Deltar_prmp3*pow(pdotn, 2)/Sigma + 2*pdotvr*pdotvr_prmp3/(Sigma*sin2theta) + 2*Sigma*pdotxir*pdotxir_prmp3/(Lambt*sin2theta) - Lambt_prmp3*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmp3 = Q4_prmp3 + gammappsum_prmp3;
    double alpha_prmp3 = Lambt*sqrt(Deltat*Sigma/Lambt)*(-1.0/2.0*Deltat*Lambt_prmp3*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmp3*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmp3 = omegatilde*pphi_prmp3/Lambt - Lambt_prmp3*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmp3 = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmp3 - 1.0/2.0*Q_prmp3/sqrt(Q)) + Sdotn_prmp3*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmp3 - Jtilde*Sdotv_prmp3*pdotn - Jtilde_prmp3*Sdotv*pdotn + Sdotn*pdotvr_prmp3 + Sdotn_prmp3*pdotvr) + pdotvr_prmp3*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmp3*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmp3 + Btilde*Jtilde*Sdotxi_prmp3*pdotn + Btilde*Jtilde_prmp3*Sdotxi*pdotn + Btilde_prmp3*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmp3 - Sdotn*expmu*expnu_prmp3*pdotxir - Sdotn_prmp3*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmp3*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmp3*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmp3 = (1.0/2.0)*omegacostheta*(-Q_prmp3 - 1.0/2.0*Q_prmp3/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmp3/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmp3*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - Btilde_prmp3*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmp3 = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmp3 - Jtilde*Sdotv_prmp3*pdotn - Jtilde_prmp3*Sdotv*pdotn + Sdotn*pdotvr_prmp3 + Sdotn_prmp3*pdotvr) + Jtilde*pdotn_prmp3*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmp3*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmp3 + (1.0/2.0)*Q_prmp3/sqrt(Q)) + Sdotv_prmp3*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmp3*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmp3 - Btilde*Sdotxi*expnu_prmp3*pdotvr - Btilde*Sdotxi_prmp3*expnu*pdotvr - Btilde_prmp3*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmp3 + Sdotv*exp2nu_prmp3*expmu*pdotxir + Sdotv_prmp3*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmp3*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmp3 = (1.0/2.0)*Jtilde*omegar*(-Q_prmp3 - 1.0/2.0*Q_prmp3/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) + Jtilde*omegar_prmp3/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmp3*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmp3*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmp3*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmp3 = SdotSkerrhat*omega_prmp3 + SdotSkerrhat_prmp3*omega;
    double Hss_prmp3 = HssTerm1_prmp3 + HssTerm2*HssTerm2coeff_prmp3 + HssTerm2_prmp3*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmp3 + HssTerm3_prmp3*HssTerm3coeff;
    double HsoTerm2c_prmp3 = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmp3*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmp3*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmp3*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmp3*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmp3*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmp3*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmp3 = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmp3 + Jtilde*Sdotv_prmp3*nur + Jtilde_prmp3*Sdotv*nur - Sdotn*nucostheta_prmp3*xisq - Sdotn_prmp3*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmp3*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmp3*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmp3*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmp3*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmp3 = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(-nucostheta_prmp3*pdotn*xisq + nur*pdotvr_prmp3 + nur_prmp3*pdotvr + pdotn_prmp3*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn_prmp3*xisq + mur*pdotvr_prmp3*(sqrt(Q) + 1) + mur_prmp3*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmp3*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmp3*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmp3*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmp3*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmp3*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmp3 = HsoTerm2a_prmp3 + HsoTerm2b_prmp3 - HsoTerm2c_prmp3;
    double HsoTerm2coeff_prmp3 = expnu*(-Q_prmp3 - 1.0/2.0*Q_prmp3/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) + expnu_prmp3/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmp3*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmp3 = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmp3 + expmu*expnu_prmp3)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir_prmp3*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu_prmp3*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmp3*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmp3*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmp3*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmp3 = HsoTerm1_prmp3 + HsoTerm2*HsoTerm2coeff_prmp3 + HsoTerm2_prmp3*HsoTerm2coeff;
    double Hd_prmp3 = Hdcoeff*Hdsum_prmp3;
    double Hns_prmp3 = sqrt(Hnsradicand)*alpha_prmp3 + betapsum_prmp3 + (1.0/2.0)*Hnsradicand_prmp3*alpha/sqrt(Hnsradicand);
    double Hs_prmp3 = Hso_prmp3 + Hss_prmp3;
    double dSS_prmp3 = 1585.5329999999999*pow(chi, 2)*chi_prmp3*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmp3*eta + 2323.5599999999999*chi*chi_prmp3*pow(eta, 3) - 652.64999999999998*chi*chi_prmp3*pow(eta, 2) + 37.196399999999997*chi_prmp3*eta;
    double Heff_prmp3 = -Hd_prmp3 + Hns_prmp3 + Hs_prmp3 + dSS_prmp3*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmp3 = Heff_prmp3*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double sigmastar1_prmS1x = m2/m1;
    double sigma1_prmS1x = 1;
    double Skerr1_prmS1x = sigma1_prmS1x;
    double Skerrmag_prmS1x = Skerr1*Skerr1_prmS1x/sqrt(pow(Skerr1, 2) + pow(Skerr2, 2) + pow(Skerr3, 2));
    double Skerrhat3_prmS1x = -Skerr3*Skerrmag_prmS1x/pow(Skerrmag, 2);
    double Skerrhat2_prmS1x = -Skerr2*Skerrmag_prmS1x/pow(Skerrmag, 2);
    double Skerrhat1_prmS1x = -Skerr1*Skerrmag_prmS1x/pow(Skerrmag, 2) + Skerr1_prmS1x/Skerrmag;
    double a_prmS1x = Skerrmag_prmS1x;
    double S1dotLhat_prmS1x = Lhat1;
    double S1perp3_prmS1x = -Lhat3*S1dotLhat_prmS1x;
    double S1perp2_prmS1x = -Lhat2*S1dotLhat_prmS1x;
    double S1perp1_prmS1x = -Lhat1*S1dotLhat_prmS1x + 1;
    double Sperp3_prmS1x = S1perp3_prmS1x;
    double Sperp2_prmS1x = S1perp2_prmS1x;
    double Sperp1_prmS1x = S1perp1_prmS1x;
    double e33_prmS1x = Skerrhat3_prmS1x;
    double e32_prmS1x = Skerrhat2_prmS1x;
    double e31_prmS1x = Skerrhat1_prmS1x;
    double xi3_prmS1x = e31_prmS1x*n2 - e32_prmS1x*n1;
    double xi2_prmS1x = -e31_prmS1x*n3 + e33_prmS1x*n1;
    double xi1_prmS1x = e32_prmS1x*n3 - e33_prmS1x*n2;
    double v3_prmS1x = n1*xi2_prmS1x - n2*xi1_prmS1x;
    double v2_prmS1x = -n1*xi3_prmS1x + n3*xi1_prmS1x;
    double v1_prmS1x = n2*xi3_prmS1x - n3*xi2_prmS1x;
    double costheta_prmS1x = e31_prmS1x*n1 + e32_prmS1x*n2 + e33_prmS1x*n3;
    double sin2theta_prmS1x = -2*costheta*costheta_prmS1x;
    double xisq_prmS1x = sin2theta_prmS1x;
    double w2_prmS1x = 2*a*a_prmS1x;
    double Sigma_prmS1x = 2*pow(a, 2)*costheta*costheta_prmS1x + 2*a*a_prmS1x*pow(costheta, 2);
    double omegatilde_prmS1x = 2*a_prmS1x*r;
    double chi_prmS1x = Lhat1*Skerr1_prmS1x/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmS1x + (1.0/2.0)*Skerr1_prmS1x*Sperp1 + (1.0/2.0)*Skerr2*Sperp2_prmS1x + (1.0/2.0)*Skerr3*Sperp3_prmS1x)/(Skerrmag*(1.0 - 2.0*eta)) - Skerrmag_prmS1x*((1.0/2.0)*Skerr1*Sperp1 + (1.0/2.0)*Skerr2*Sperp2 + (1.0/2.0)*Skerr3*Sperp3)/(pow(Skerrmag, 2)*(1.0 - 2.0*eta));
    double K_prmS1x = -177.4974*pow(chi, 2)*chi_prmS1x*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmS1x*eta + 4.3097700000000003*pow(chi, 2)*chi_prmS1x + 62.349200000000003*chi*chi_prmS1x*pow(eta, 3) + 12.329319999999999*chi*chi_prmS1x*pow(eta, 2) - 2.76172*chi*chi_prmS1x - 27.520099999999999*chi_prmS1x*pow(eta, 3) + 17.3736*chi_prmS1x*pow(eta, 2) + 2.26831*chi_prmS1x*eta - 1.6204499999999999*chi_prmS1x;
    double etaKminus1_prmS1x = K_prmS1x*eta;
    double Delta0_prmS1x = K*K_prmS1x*eta + K_prmS1x*(K*eta - 2);
    double Delta1_prmS1x = etaKminus1*(-2*Delta0_prmS1x - 2*K_prmS1x) + etaKminus1_prmS1x*(-2*Delta0 - 2*K);
    double Delta2_prmS1x = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmS1x - 2*Delta0*a*a_prmS1x*pow(etaKminus1, 2) - Delta0_prmS1x*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmS1x - 2*etaKminus1_prmS1x) + Delta1_prmS1x*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmS1x = -pow(Delta1, 2)*Delta1_prmS1x + pow(Delta1, 2)*etaKminus1_prmS1x + 2*Delta1*Delta1_prmS1x*etaKminus1 + Delta1*Delta2_prmS1x - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmS1x - 2*Delta1*a*a_prmS1x*pow(etaKminus1, 2) + Delta1_prmS1x*Delta2 - Delta1_prmS1x*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmS1x + 2*etaKminus1_prmS1x) + etaKminus1_prmS1x*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmS1x = pow(Delta1, 3)*Delta1_prmS1x - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmS1x - 2*pow(Delta1, 2)*Delta1_prmS1x*etaKminus1 - pow(Delta1, 2)*Delta2_prmS1x - 2*Delta1*Delta1_prmS1x*Delta2 + Delta1*(2*Delta2*etaKminus1_prmS1x + 2*Delta2_prmS1x*etaKminus1 + Delta3_prmS1x) + Delta1_prmS1x*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmS1x - 2*Delta3*etaKminus1_prmS1x - 2*Delta3_prmS1x*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmS1x - 2*Delta2_prmS1x) + pow(a, 2)*etaKminus1*etaKminus1_prmS1x*(pow(Delta1, 2) - 2*Delta2) + a*a_prmS1x*pow(etaKminus1, 2)*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmS1x*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmS1x = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmS1x - 3*Delta1*Delta2_prmS1x - 3*Delta1_prmS1x*Delta2 + 3*Delta3_prmS1x) + (1.0/3.0)*a*a_prmS1x*(-2*pow(Delta1, 3) + 6*Delta1*Delta2 - 6*Delta3) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmS1x - 4*pow(Delta1, 2)*Delta2_prmS1x - 8*Delta1*Delta1_prmS1x*Delta2 + 4*Delta1*Delta3_prmS1x + 4*Delta1_prmS1x*Delta3 + 4*Delta2*Delta2_prmS1x - 4*Delta4_prmS1x)/etaKminus1 - 1.0/2.0*etaKminus1_prmS1x*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmS1x - 5*pow(Delta1, 3)*Delta2_prmS1x - 15*pow(Delta1, 2)*Delta1_prmS1x*Delta2 + 5*pow(Delta1, 2)*Delta3_prmS1x + 10*Delta1*Delta1_prmS1x*Delta3 + 10*Delta1*Delta2*Delta2_prmS1x - 5*Delta1*Delta4_prmS1x + 5*Delta1_prmS1x*pow(Delta2, 2) - 5*Delta1_prmS1x*Delta4 - 5*Delta2*Delta3_prmS1x - 5*Delta2_prmS1x*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmS1x*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmS1x*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmS1x = (128.0/5.0)*etaKminus1*etaKminus1_prmS1x;
    double logarg_prmS1x = u*(Delta1_prmS1x + u*(Delta2_prmS1x + u*(Delta3_prmS1x + u*(Delta4_prmS1x + u*(Delta5_prmS1x + Delta5l_prmS1x*log(u))))));
    double Deltaucalib_prmS1x = eta*(Delta0_prmS1x + logarg_prmS1x*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmS1x = eta*logarg_prmS1x*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmS1x + u*(2*Delta2_prmS1x + u*(3*Delta3_prmS1x + u*(4*Delta4_prmS1x + u*(5*Delta5_prmS1x + 5*Delta5l_prmS1x*log(u))))))/(logarg + 1);
    double Deltaubar_prmS1x = 2*a*a_prmS1x*pow(u, 2) + etaKminus1_prmS1x*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmS1x/pow(etaKminus1, 3);
    double Deltaubarprime_prmS1x = -4*a*a_prmS1x*pow(u, 3) + 2*etaKminus1_prmS1x*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmS1x = (Deltaubar*Deltaucalib_prmS1x + Deltaubar_prmS1x*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmS1x = Deltaubar*Deltaucalibprime_prmS1x + Deltaubar_prmS1x*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmS1x + Deltaubarprime_prmS1x*Deltaucalib;
    double Deltatprime_prmS1x = 2*Deltau_prmS1x*r + Deltauprime_prmS1x*pow(r, 2);
    double Deltat_prmS1x = Deltau_prmS1x*pow(r, 2);
    double Deltar_prmS1x = Deltat_prmS1x*Dinv;
    double Lambt_prmS1x = (Deltat*pow(a, 2)*sin2theta_prmS1x + 2*Deltat*a*a_prmS1x*sin2theta + Deltat_prmS1x*pow(a, 2)*sin2theta - 2*w2*w2_prmS1x)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmS1x = (1.0/2.0)*(Deltar*Deltat_prmS1x + Deltar_prmS1x*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmS1x*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmS1x = csi_prmS1x*(1 - fabs((double)tortoise - 1));
    double csi2_prmS1x = csi_prmS1x*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmS1x = csi2_prmS1x*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmS1x = n3*prT_prmS1x*(-1 + 1.0/csi1) - csi1_prmS1x*n3*prT/pow(csi1, 2);
    double phat2_prmS1x = n2*prT_prmS1x*(-1 + 1.0/csi1) - csi1_prmS1x*n2*prT/pow(csi1, 2);
    double phat1_prmS1x = n1*prT_prmS1x*(-1 + 1.0/csi1) - csi1_prmS1x*n1*prT/pow(csi1, 2);
    double pdotxir_prmS1x = r*(phat1*xi1_prmS1x + phat1_prmS1x*xi1 + phat2*xi2_prmS1x + phat2_prmS1x*xi2 + phat3*xi3_prmS1x + phat3_prmS1x*xi3);
    double pdotn_prmS1x = n1*phat1_prmS1x + n2*phat2_prmS1x + n3*phat3_prmS1x;
    double pdotvr_prmS1x = r*(phat1*v1_prmS1x + phat1_prmS1x*v1 + phat2*v2_prmS1x + phat2_prmS1x*v2 + phat3*v3_prmS1x + phat3_prmS1x*v3);
    double pphi_prmS1x = pdotxir_prmS1x;
    double Qcoeff2_prmS1x = -sin2theta_prmS1x/(Sigma*pow(sin2theta, 2)) - Sigma_prmS1x/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmS1x = -Sigma*sin2theta_prmS1x/(Lambt*pow(sin2theta, 2)) + Sigma_prmS1x/(Lambt*sin2theta) - Lambt_prmS1x*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmS1x = 2*Deltar*pdotn*pdotn_prmS1x/Sigma - Deltar*Sigma_prmS1x*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS1x*pow(pdotn, 2)/Sigma;
    double Q_prmS1x = DrSipn2_prmS1x + 2*Qcoeff1*pdotxir*pdotxir_prmS1x + Qcoeff1_prmS1x*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmS1x + Qcoeff2_prmS1x*pow(pdotvr, 2);
    double Qminus1_prmS1x = Q_prmS1x;
    double Jtilde_prmS1x = (1.0/2.0)*Deltar_prmS1x/sqrt(Deltar);
    double exp2mu_prmS1x = Sigma_prmS1x;
    double expmu_prmS1x = (1.0/2.0)*exp2mu_prmS1x/sqrt(exp2mu);
    double Brtilde_prmS1x = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmS1x - 2*Deltat_prmS1x + (1.0/2.0)*Deltar_prmS1x*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmS1x - 1.0/2.0*Deltar_prmS1x*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmS1x = (1.0/2.0)*Deltat_prmS1x/sqrt(Deltat);
    double exp2nu_prmS1x = Deltat*Sigma_prmS1x/Lambt - Deltat*Lambt_prmS1x*Sigma/pow(Lambt, 2) + Deltat_prmS1x*Sigma/Lambt;
    double expnu_prmS1x = (1.0/2.0)*exp2nu_prmS1x/sqrt(exp2nu);
    double omega_prmS1x = omegatilde_prmS1x/Lambt - Lambt_prmS1x*omegatilde/pow(Lambt, 2);
    double omegatildeprime_prmS1x = 2*a_prmS1x;
    double Lambtprime_prmS1x = -Deltatprime*pow(a, 2)*sin2theta_prmS1x - 2*Deltatprime*a*a_prmS1x*sin2theta - Deltatprime_prmS1x*pow(a, 2)*sin2theta + 8*a*a_prmS1x*r;
    double mucostheta_prmS1x = pow(a, 2)*costheta_prmS1x/Sigma + 2*a*a_prmS1x*costheta/Sigma - Sigma_prmS1x*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmS1x = pow(a, 2)*costheta*w2*(-Deltat_prmS1x + w2_prmS1x)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmS1x*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmS1x*w2*(-Deltat + w2)/(Lambt*Sigma) + a*a_prmS1x*costheta*w2*(-2*Deltat + 2*w2)/(Lambt*Sigma) - Sigma_prmS1x*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmS1x*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmS1x = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmS1x/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmS1x*omegatilde/pow(Lambt, 2) - 4*Deltat*a*a_prmS1x*costheta*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmS1x*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmS1x*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmS1x = -Sigma_prmS1x*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmS1x/pow(Deltar, 3.0/2.0);
    double nur_prmS1x = -Sigma_prmS1x*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat_prmS1x*r + Deltatprime*w2_prmS1x + Deltatprime_prmS1x*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmS1x*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmS1x*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmS1x*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmS1x = (Lambt*omegatildeprime_prmS1x + Lambt_prmS1x*omegatildeprime - Lambtprime*omegatilde_prmS1x - Lambtprime_prmS1x*omegatilde)/pow(Lambt, 2) + Lambt_prmS1x*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmS1x = 442.44299999999998*pow(chi, 2)*chi_prmS1x*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmS1x*eta + 198.59610000000001*pow(chi, 2)*chi_prmS1x - 686.62599999999998*chi*chi_prmS1x*eta + 2495.29*chi_prmS1x*pow(eta, 2);
    double sigmacoeffTerm3_prmS1x = dSO_prmS1x*eta*pow(u, 3);
    double sigmacoeffTerm2_prmS1x = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmS1x + 204*Qminus1_prmS1x + r*(1620*DrSipn2*DrSipn2_prmS1x - 234*DrSipn2*Qminus1_prmS1x - 234*DrSipn2_prmS1x*Qminus1)) + r*(-96*DrSipn2_prmS1x - 436*Qminus1_prmS1x + r*(36*DrSipn2*Qminus1_prmS1x + 36*DrSipn2_prmS1x*Qminus1 - 90*Qminus1*Qminus1_prmS1x)))/pow(r, 2);
    double sigmacoeffTerm1_prmS1x = eta*(-3*DrSipn2_prmS1x + (1.0/4.0)*Qminus1_prmS1x);
    double sigmacoeff_prmS1x = sigmacoeffTerm1_prmS1x + sigmacoeffTerm2_prmS1x + sigmacoeffTerm3_prmS1x;
    double sigmastarcoeffTerm2_prmS1x = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmS1x + 120*Qminus1_prmS1x + r*(720*DrSipn2*DrSipn2_prmS1x + Qminus1*(-126*DrSipn2_prmS1x - 3*Qminus1_prmS1x) + Qminus1_prmS1x*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmS1x + Qminus1*r*(96*DrSipn2_prmS1x - 23*Qminus1_prmS1x) + Qminus1_prmS1x*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmS1x))/pow(r, 2);
    double sigmastarcoeffTerm1_prmS1x = eta*(-5.0/2.0*DrSipn2_prmS1x + (1.0/3.0)*Qminus1_prmS1x);
    double sigmastarcoeff_prmS1x = sigmastarcoeffTerm1_prmS1x + sigmastarcoeffTerm2_prmS1x;
    double Deltasigmastar3_prmS1x = sigma3*sigmacoeff_prmS1x + sigmastar3*sigmastarcoeff_prmS1x;
    double Deltasigmastar2_prmS1x = sigma2*sigmacoeff_prmS1x + sigmastar2*sigmastarcoeff_prmS1x;
    double Deltasigmastar1_prmS1x = sigma1*sigmacoeff_prmS1x + sigma1_prmS1x*sigmacoeff + sigmastar1*sigmastarcoeff_prmS1x + sigmastar1_prmS1x*sigmastarcoeff;
    double Sstar3_prmS1x = Deltasigmastar3_prmS1x;
    double Sstar2_prmS1x = Deltasigmastar2_prmS1x;
    double Sstar1_prmS1x = Deltasigmastar1_prmS1x + sigmastar1_prmS1x;
    double S3_prmS1x = Sstar3_prmS1x;
    double S2_prmS1x = Sstar2_prmS1x;
    double S1_prmS1x = Sstar1_prmS1x;
    double Sstardotn_prmS1x = Sstar1_prmS1x*n1 + Sstar2_prmS1x*n2 + Sstar3_prmS1x*n3;
    double SdotSkerrhat_prmS1x = S1*Skerrhat1_prmS1x + S1_prmS1x*Skerrhat1 + S2*Skerrhat2_prmS1x + S2_prmS1x*Skerrhat2 + S3*Skerrhat3_prmS1x + S3_prmS1x*Skerrhat3;
    double Sdotn_prmS1x = S1_prmS1x*n1 + S2_prmS1x*n2 + S3_prmS1x*n3;
    double Sdotv_prmS1x = S1*v1_prmS1x + S1_prmS1x*v1 + S2*v2_prmS1x + S2_prmS1x*v2 + S3*v3_prmS1x + S3_prmS1x*v3;
    double Sdotxi_prmS1x = S1*xi1_prmS1x + S1_prmS1x*xi1 + S2*xi2_prmS1x + S2_prmS1x*xi2 + S3*xi3_prmS1x + S3_prmS1x*xi3;
    double HdsumTerm2_prmS1x = 6*Sstardotn*Sstardotn_prmS1x;
    double HdsumTerm1_prmS1x = 2*Sstar1*Sstar1_prmS1x + 2*Sstar2*Sstar2_prmS1x + 2*Sstar3*Sstar3_prmS1x;
    double Hdsum_prmS1x = HdsumTerm1_prmS1x - HdsumTerm2_prmS1x;
    double Q4_prmS1x = eta*pow(prT, 3)*prT_prmS1x*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmS1x = 2*Deltar*pdotn*pdotn_prmS1x/Sigma - Deltar*Sigma_prmS1x*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS1x*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmS1x/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmS1x/(Sigma*sin2theta) - Sigma_prmS1x*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmS1x/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmS1x/(Lambt*sin2theta) + Sigma_prmS1x*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmS1x*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmS1x = Q4_prmS1x + gammappsum_prmS1x;
    double alpha_prmS1x = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmS1x/Lambt - 1.0/2.0*Deltat*Lambt_prmS1x*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmS1x*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmS1x = omegatilde*pphi_prmS1x/Lambt + omegatilde_prmS1x*pphi/Lambt - Lambt_prmS1x*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmS1x = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmS1x - 1.0/2.0*Q_prmS1x/sqrt(Q)) + Sdotn*exp2mu*xisq_prmS1x*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmS1x*xisq*(-sqrt(Q) - Q) + Sdotn_prmS1x*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmS1x - Jtilde*Sdotv_prmS1x*pdotn - Jtilde_prmS1x*Sdotv*pdotn + Sdotn*pdotvr_prmS1x + Sdotn_prmS1x*pdotvr) + pdotvr_prmS1x*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmS1x*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmS1x + Btilde*Jtilde*Sdotxi_prmS1x*pdotn + Btilde*Jtilde_prmS1x*Sdotxi*pdotn + Btilde_prmS1x*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmS1x - Sdotn*expmu*expnu_prmS1x*pdotxir - Sdotn*expmu_prmS1x*expnu*pdotxir - Sdotn_prmS1x*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmS1x*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmS1x*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmS1x*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmS1x = (1.0/2.0)*omegacostheta*(-Q_prmS1x - 1.0/2.0*Q_prmS1x/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmS1x/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmS1x*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmS1x*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmS1x*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmS1x*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmS1x = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmS1x - Jtilde*Sdotv_prmS1x*pdotn - Jtilde_prmS1x*Sdotv*pdotn + Sdotn*pdotvr_prmS1x + Sdotn_prmS1x*pdotvr) + Jtilde*pdotn_prmS1x*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmS1x*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmS1x + (1.0/2.0)*Q_prmS1x/sqrt(Q)) + Sdotv*exp2mu_prmS1x*(sqrt(Q) + Q) + Sdotv_prmS1x*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmS1x*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmS1x*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmS1x - Btilde*Sdotxi*expnu_prmS1x*pdotvr - Btilde*Sdotxi_prmS1x*expnu*pdotvr - Btilde_prmS1x*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmS1x + Sdotv*exp2nu*expmu_prmS1x*pdotxir + Sdotv*exp2nu_prmS1x*expmu*pdotxir + Sdotv_prmS1x*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmS1x*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmS1x*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmS1x = (1.0/2.0)*Jtilde*omegar*(-Q_prmS1x - 1.0/2.0*Q_prmS1x/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmS1x/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmS1x/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmS1x*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmS1x*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmS1x*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmS1x*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmS1x*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmS1x = SdotSkerrhat*omega_prmS1x + SdotSkerrhat_prmS1x*omega;
    double Hss_prmS1x = HssTerm1_prmS1x + HssTerm2*HssTerm2coeff_prmS1x + HssTerm2_prmS1x*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmS1x + HssTerm3_prmS1x*HssTerm3coeff;
    double HsoTerm2c_prmS1x = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmS1x*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmS1x*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmS1x*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmS1x*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmS1x*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmS1x*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmS1x*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmS1x = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmS1x + Jtilde*Sdotv_prmS1x*nur + Jtilde_prmS1x*Sdotv*nur - Sdotn*nucostheta*xisq_prmS1x - Sdotn*nucostheta_prmS1x*xisq - Sdotn_prmS1x*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmS1x*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmS1x*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmS1x*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmS1x*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmS1x*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmS1x = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmS1x + nur_prmS1x*pdotvr + pdotn*xisq*(mucostheta_prmS1x - nucostheta_prmS1x) + pdotn*xisq_prmS1x*(mucostheta - nucostheta) + pdotn_prmS1x*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmS1x - mucostheta*pdotn_prmS1x*xisq - mucostheta_prmS1x*pdotn*xisq + mur*pdotvr_prmS1x*(sqrt(Q) + 1) + mur_prmS1x*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmS1x*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmS1x*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmS1x*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmS1x*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmS1x*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmS1x = HsoTerm2a_prmS1x + HsoTerm2b_prmS1x - HsoTerm2c_prmS1x;
    double HsoTerm2coeff_prmS1x = expnu*(-Q_prmS1x - 1.0/2.0*Q_prmS1x/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmS1x/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmS1x/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmS1x*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmS1x*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmS1x = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmS1x + expmu*expnu_prmS1x + expmu_prmS1x*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmS1x*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmS1x*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmS1x*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmS1x*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmS1x*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmS1x*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmS1x*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmS1x = HsoTerm1_prmS1x + HsoTerm2*HsoTerm2coeff_prmS1x + HsoTerm2_prmS1x*HsoTerm2coeff;
    double Hd_prmS1x = Hdcoeff*Hdsum_prmS1x;
    double Hns_prmS1x = sqrt(Hnsradicand)*alpha_prmS1x + betapsum_prmS1x + (1.0/2.0)*Hnsradicand_prmS1x*alpha/sqrt(Hnsradicand);
    double Hs_prmS1x = Hso_prmS1x + Hss_prmS1x;
    double dSS_prmS1x = 1585.5329999999999*pow(chi, 2)*chi_prmS1x*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmS1x*eta + 2323.5599999999999*chi*chi_prmS1x*pow(eta, 3) - 652.64999999999998*chi*chi_prmS1x*pow(eta, 2) + 37.196399999999997*chi_prmS1x*eta;
    double Heff_prmS1x = -Hd_prmS1x + Hns_prmS1x + Hs_prmS1x + 2*S1x*dSS*eta*pow(u, 4) + dSS_prmS1x*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmS1x = Heff_prmS1x*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double sigmastar2_prmS1y = m2/m1;
    double sigma2_prmS1y = 1;
    double Skerr2_prmS1y = sigma2_prmS1y;
    double Skerrmag_prmS1y = Skerr2*Skerr2_prmS1y/sqrt(pow(Skerr1, 2) + pow(Skerr2, 2) + pow(Skerr3, 2));
    double Skerrhat3_prmS1y = -Skerr3*Skerrmag_prmS1y/pow(Skerrmag, 2);
    double Skerrhat2_prmS1y = -Skerr2*Skerrmag_prmS1y/pow(Skerrmag, 2) + Skerr2_prmS1y/Skerrmag;
    double Skerrhat1_prmS1y = -Skerr1*Skerrmag_prmS1y/pow(Skerrmag, 2);
    double a_prmS1y = Skerrmag_prmS1y;
    double S1dotLhat_prmS1y = Lhat2;
    double S1perp3_prmS1y = -Lhat3*S1dotLhat_prmS1y;
    double S1perp2_prmS1y = -Lhat2*S1dotLhat_prmS1y + 1;
    double S1perp1_prmS1y = -Lhat1*S1dotLhat_prmS1y;
    double Sperp3_prmS1y = S1perp3_prmS1y;
    double Sperp2_prmS1y = S1perp2_prmS1y;
    double Sperp1_prmS1y = S1perp1_prmS1y;
    double e33_prmS1y = Skerrhat3_prmS1y;
    double e32_prmS1y = Skerrhat2_prmS1y;
    double e31_prmS1y = Skerrhat1_prmS1y;
    double xi3_prmS1y = e31_prmS1y*n2 - e32_prmS1y*n1;
    double xi2_prmS1y = -e31_prmS1y*n3 + e33_prmS1y*n1;
    double xi1_prmS1y = e32_prmS1y*n3 - e33_prmS1y*n2;
    double v3_prmS1y = n1*xi2_prmS1y - n2*xi1_prmS1y;
    double v2_prmS1y = -n1*xi3_prmS1y + n3*xi1_prmS1y;
    double v1_prmS1y = n2*xi3_prmS1y - n3*xi2_prmS1y;
    double costheta_prmS1y = e31_prmS1y*n1 + e32_prmS1y*n2 + e33_prmS1y*n3;
    double sin2theta_prmS1y = -2*costheta*costheta_prmS1y;
    double xisq_prmS1y = sin2theta_prmS1y;
    double w2_prmS1y = 2*a*a_prmS1y;
    double Sigma_prmS1y = 2*pow(a, 2)*costheta*costheta_prmS1y + 2*a*a_prmS1y*pow(costheta, 2);
    double omegatilde_prmS1y = 2*a_prmS1y*r;
    double chi_prmS1y = Lhat2*Skerr2_prmS1y/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmS1y + (1.0/2.0)*Skerr2*Sperp2_prmS1y + (1.0/2.0)*Skerr2_prmS1y*Sperp2 + (1.0/2.0)*Skerr3*Sperp3_prmS1y)/(Skerrmag*(1.0 - 2.0*eta)) - Skerrmag_prmS1y*((1.0/2.0)*Skerr1*Sperp1 + (1.0/2.0)*Skerr2*Sperp2 + (1.0/2.0)*Skerr3*Sperp3)/(pow(Skerrmag, 2)*(1.0 - 2.0*eta));
    double K_prmS1y = -177.4974*pow(chi, 2)*chi_prmS1y*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmS1y*eta + 4.3097700000000003*pow(chi, 2)*chi_prmS1y + 62.349200000000003*chi*chi_prmS1y*pow(eta, 3) + 12.329319999999999*chi*chi_prmS1y*pow(eta, 2) - 2.76172*chi*chi_prmS1y - 27.520099999999999*chi_prmS1y*pow(eta, 3) + 17.3736*chi_prmS1y*pow(eta, 2) + 2.26831*chi_prmS1y*eta - 1.6204499999999999*chi_prmS1y;
    double etaKminus1_prmS1y = K_prmS1y*eta;
    double Delta0_prmS1y = K*K_prmS1y*eta + K_prmS1y*(K*eta - 2);
    double Delta1_prmS1y = etaKminus1*(-2*Delta0_prmS1y - 2*K_prmS1y) + etaKminus1_prmS1y*(-2*Delta0 - 2*K);
    double Delta2_prmS1y = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmS1y - 2*Delta0*a*a_prmS1y*pow(etaKminus1, 2) - Delta0_prmS1y*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmS1y - 2*etaKminus1_prmS1y) + Delta1_prmS1y*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmS1y = -pow(Delta1, 2)*Delta1_prmS1y + pow(Delta1, 2)*etaKminus1_prmS1y + 2*Delta1*Delta1_prmS1y*etaKminus1 + Delta1*Delta2_prmS1y - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmS1y - 2*Delta1*a*a_prmS1y*pow(etaKminus1, 2) + Delta1_prmS1y*Delta2 - Delta1_prmS1y*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmS1y + 2*etaKminus1_prmS1y) + etaKminus1_prmS1y*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmS1y = pow(Delta1, 3)*Delta1_prmS1y - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmS1y - 2*pow(Delta1, 2)*Delta1_prmS1y*etaKminus1 - pow(Delta1, 2)*Delta2_prmS1y - 2*Delta1*Delta1_prmS1y*Delta2 + Delta1*(2*Delta2*etaKminus1_prmS1y + 2*Delta2_prmS1y*etaKminus1 + Delta3_prmS1y) + Delta1_prmS1y*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmS1y - 2*Delta3*etaKminus1_prmS1y - 2*Delta3_prmS1y*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmS1y - 2*Delta2_prmS1y) + pow(a, 2)*etaKminus1*etaKminus1_prmS1y*(pow(Delta1, 2) - 2*Delta2) + a*a_prmS1y*pow(etaKminus1, 2)*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmS1y*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmS1y = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmS1y - 3*Delta1*Delta2_prmS1y - 3*Delta1_prmS1y*Delta2 + 3*Delta3_prmS1y) + (1.0/3.0)*a*a_prmS1y*(-2*pow(Delta1, 3) + 6*Delta1*Delta2 - 6*Delta3) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmS1y - 4*pow(Delta1, 2)*Delta2_prmS1y - 8*Delta1*Delta1_prmS1y*Delta2 + 4*Delta1*Delta3_prmS1y + 4*Delta1_prmS1y*Delta3 + 4*Delta2*Delta2_prmS1y - 4*Delta4_prmS1y)/etaKminus1 - 1.0/2.0*etaKminus1_prmS1y*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmS1y - 5*pow(Delta1, 3)*Delta2_prmS1y - 15*pow(Delta1, 2)*Delta1_prmS1y*Delta2 + 5*pow(Delta1, 2)*Delta3_prmS1y + 10*Delta1*Delta1_prmS1y*Delta3 + 10*Delta1*Delta2*Delta2_prmS1y - 5*Delta1*Delta4_prmS1y + 5*Delta1_prmS1y*pow(Delta2, 2) - 5*Delta1_prmS1y*Delta4 - 5*Delta2*Delta3_prmS1y - 5*Delta2_prmS1y*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmS1y*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmS1y*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmS1y = (128.0/5.0)*etaKminus1*etaKminus1_prmS1y;
    double logarg_prmS1y = u*(Delta1_prmS1y + u*(Delta2_prmS1y + u*(Delta3_prmS1y + u*(Delta4_prmS1y + u*(Delta5_prmS1y + Delta5l_prmS1y*log(u))))));
    double Deltaucalib_prmS1y = eta*(Delta0_prmS1y + logarg_prmS1y*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmS1y = eta*logarg_prmS1y*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmS1y + u*(2*Delta2_prmS1y + u*(3*Delta3_prmS1y + u*(4*Delta4_prmS1y + u*(5*Delta5_prmS1y + 5*Delta5l_prmS1y*log(u))))))/(logarg + 1);
    double Deltaubar_prmS1y = 2*a*a_prmS1y*pow(u, 2) + etaKminus1_prmS1y*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmS1y/pow(etaKminus1, 3);
    double Deltaubarprime_prmS1y = -4*a*a_prmS1y*pow(u, 3) + 2*etaKminus1_prmS1y*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmS1y = (Deltaubar*Deltaucalib_prmS1y + Deltaubar_prmS1y*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmS1y = Deltaubar*Deltaucalibprime_prmS1y + Deltaubar_prmS1y*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmS1y + Deltaubarprime_prmS1y*Deltaucalib;
    double Deltatprime_prmS1y = 2*Deltau_prmS1y*r + Deltauprime_prmS1y*pow(r, 2);
    double Deltat_prmS1y = Deltau_prmS1y*pow(r, 2);
    double Deltar_prmS1y = Deltat_prmS1y*Dinv;
    double Lambt_prmS1y = (Deltat*pow(a, 2)*sin2theta_prmS1y + 2*Deltat*a*a_prmS1y*sin2theta + Deltat_prmS1y*pow(a, 2)*sin2theta - 2*w2*w2_prmS1y)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmS1y = (1.0/2.0)*(Deltar*Deltat_prmS1y + Deltar_prmS1y*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmS1y*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmS1y = csi_prmS1y*(1 - fabs((double)tortoise - 1));
    double csi2_prmS1y = csi_prmS1y*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmS1y = csi2_prmS1y*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmS1y = n3*prT_prmS1y*(-1 + 1.0/csi1) - csi1_prmS1y*n3*prT/pow(csi1, 2);
    double phat2_prmS1y = n2*prT_prmS1y*(-1 + 1.0/csi1) - csi1_prmS1y*n2*prT/pow(csi1, 2);
    double phat1_prmS1y = n1*prT_prmS1y*(-1 + 1.0/csi1) - csi1_prmS1y*n1*prT/pow(csi1, 2);
    double pdotxir_prmS1y = r*(phat1*xi1_prmS1y + phat1_prmS1y*xi1 + phat2*xi2_prmS1y + phat2_prmS1y*xi2 + phat3*xi3_prmS1y + phat3_prmS1y*xi3);
    double pdotn_prmS1y = n1*phat1_prmS1y + n2*phat2_prmS1y + n3*phat3_prmS1y;
    double pdotvr_prmS1y = r*(phat1*v1_prmS1y + phat1_prmS1y*v1 + phat2*v2_prmS1y + phat2_prmS1y*v2 + phat3*v3_prmS1y + phat3_prmS1y*v3);
    double pphi_prmS1y = pdotxir_prmS1y;
    double Qcoeff2_prmS1y = -sin2theta_prmS1y/(Sigma*pow(sin2theta, 2)) - Sigma_prmS1y/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmS1y = -Sigma*sin2theta_prmS1y/(Lambt*pow(sin2theta, 2)) + Sigma_prmS1y/(Lambt*sin2theta) - Lambt_prmS1y*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmS1y = 2*Deltar*pdotn*pdotn_prmS1y/Sigma - Deltar*Sigma_prmS1y*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS1y*pow(pdotn, 2)/Sigma;
    double Q_prmS1y = DrSipn2_prmS1y + 2*Qcoeff1*pdotxir*pdotxir_prmS1y + Qcoeff1_prmS1y*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmS1y + Qcoeff2_prmS1y*pow(pdotvr, 2);
    double Qminus1_prmS1y = Q_prmS1y;
    double Jtilde_prmS1y = (1.0/2.0)*Deltar_prmS1y/sqrt(Deltar);
    double exp2mu_prmS1y = Sigma_prmS1y;
    double expmu_prmS1y = (1.0/2.0)*exp2mu_prmS1y/sqrt(exp2mu);
    double Brtilde_prmS1y = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmS1y - 2*Deltat_prmS1y + (1.0/2.0)*Deltar_prmS1y*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmS1y - 1.0/2.0*Deltar_prmS1y*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmS1y = (1.0/2.0)*Deltat_prmS1y/sqrt(Deltat);
    double exp2nu_prmS1y = Deltat*Sigma_prmS1y/Lambt - Deltat*Lambt_prmS1y*Sigma/pow(Lambt, 2) + Deltat_prmS1y*Sigma/Lambt;
    double expnu_prmS1y = (1.0/2.0)*exp2nu_prmS1y/sqrt(exp2nu);
    double omega_prmS1y = omegatilde_prmS1y/Lambt - Lambt_prmS1y*omegatilde/pow(Lambt, 2);
    double omegatildeprime_prmS1y = 2*a_prmS1y;
    double Lambtprime_prmS1y = -Deltatprime*pow(a, 2)*sin2theta_prmS1y - 2*Deltatprime*a*a_prmS1y*sin2theta - Deltatprime_prmS1y*pow(a, 2)*sin2theta + 8*a*a_prmS1y*r;
    double mucostheta_prmS1y = pow(a, 2)*costheta_prmS1y/Sigma + 2*a*a_prmS1y*costheta/Sigma - Sigma_prmS1y*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmS1y = pow(a, 2)*costheta*w2*(-Deltat_prmS1y + w2_prmS1y)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmS1y*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmS1y*w2*(-Deltat + w2)/(Lambt*Sigma) + a*a_prmS1y*costheta*w2*(-2*Deltat + 2*w2)/(Lambt*Sigma) - Sigma_prmS1y*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmS1y*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmS1y = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmS1y/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmS1y*omegatilde/pow(Lambt, 2) - 4*Deltat*a*a_prmS1y*costheta*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmS1y*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmS1y*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmS1y = -Sigma_prmS1y*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmS1y/pow(Deltar, 3.0/2.0);
    double nur_prmS1y = -Sigma_prmS1y*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat_prmS1y*r + Deltatprime*w2_prmS1y + Deltatprime_prmS1y*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmS1y*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmS1y*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmS1y*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmS1y = (Lambt*omegatildeprime_prmS1y + Lambt_prmS1y*omegatildeprime - Lambtprime*omegatilde_prmS1y - Lambtprime_prmS1y*omegatilde)/pow(Lambt, 2) + Lambt_prmS1y*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmS1y = 442.44299999999998*pow(chi, 2)*chi_prmS1y*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmS1y*eta + 198.59610000000001*pow(chi, 2)*chi_prmS1y - 686.62599999999998*chi*chi_prmS1y*eta + 2495.29*chi_prmS1y*pow(eta, 2);
    double sigmacoeffTerm3_prmS1y = dSO_prmS1y*eta*pow(u, 3);
    double sigmacoeffTerm2_prmS1y = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmS1y + 204*Qminus1_prmS1y + r*(1620*DrSipn2*DrSipn2_prmS1y - 234*DrSipn2*Qminus1_prmS1y - 234*DrSipn2_prmS1y*Qminus1)) + r*(-96*DrSipn2_prmS1y - 436*Qminus1_prmS1y + r*(36*DrSipn2*Qminus1_prmS1y + 36*DrSipn2_prmS1y*Qminus1 - 90*Qminus1*Qminus1_prmS1y)))/pow(r, 2);
    double sigmacoeffTerm1_prmS1y = eta*(-3*DrSipn2_prmS1y + (1.0/4.0)*Qminus1_prmS1y);
    double sigmacoeff_prmS1y = sigmacoeffTerm1_prmS1y + sigmacoeffTerm2_prmS1y + sigmacoeffTerm3_prmS1y;
    double sigmastarcoeffTerm2_prmS1y = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmS1y + 120*Qminus1_prmS1y + r*(720*DrSipn2*DrSipn2_prmS1y + Qminus1*(-126*DrSipn2_prmS1y - 3*Qminus1_prmS1y) + Qminus1_prmS1y*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmS1y + Qminus1*r*(96*DrSipn2_prmS1y - 23*Qminus1_prmS1y) + Qminus1_prmS1y*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmS1y))/pow(r, 2);
    double sigmastarcoeffTerm1_prmS1y = eta*(-5.0/2.0*DrSipn2_prmS1y + (1.0/3.0)*Qminus1_prmS1y);
    double sigmastarcoeff_prmS1y = sigmastarcoeffTerm1_prmS1y + sigmastarcoeffTerm2_prmS1y;
    double Deltasigmastar3_prmS1y = sigma3*sigmacoeff_prmS1y + sigmastar3*sigmastarcoeff_prmS1y;
    double Deltasigmastar2_prmS1y = sigma2*sigmacoeff_prmS1y + sigma2_prmS1y*sigmacoeff + sigmastar2*sigmastarcoeff_prmS1y + sigmastar2_prmS1y*sigmastarcoeff;
    double Deltasigmastar1_prmS1y = sigma1*sigmacoeff_prmS1y + sigmastar1*sigmastarcoeff_prmS1y;
    double Sstar3_prmS1y = Deltasigmastar3_prmS1y;
    double Sstar2_prmS1y = Deltasigmastar2_prmS1y + sigmastar2_prmS1y;
    double Sstar1_prmS1y = Deltasigmastar1_prmS1y;
    double S3_prmS1y = Sstar3_prmS1y;
    double S2_prmS1y = Sstar2_prmS1y;
    double S1_prmS1y = Sstar1_prmS1y;
    double Sstardotn_prmS1y = Sstar1_prmS1y*n1 + Sstar2_prmS1y*n2 + Sstar3_prmS1y*n3;
    double SdotSkerrhat_prmS1y = S1*Skerrhat1_prmS1y + S1_prmS1y*Skerrhat1 + S2*Skerrhat2_prmS1y + S2_prmS1y*Skerrhat2 + S3*Skerrhat3_prmS1y + S3_prmS1y*Skerrhat3;
    double Sdotn_prmS1y = S1_prmS1y*n1 + S2_prmS1y*n2 + S3_prmS1y*n3;
    double Sdotv_prmS1y = S1*v1_prmS1y + S1_prmS1y*v1 + S2*v2_prmS1y + S2_prmS1y*v2 + S3*v3_prmS1y + S3_prmS1y*v3;
    double Sdotxi_prmS1y = S1*xi1_prmS1y + S1_prmS1y*xi1 + S2*xi2_prmS1y + S2_prmS1y*xi2 + S3*xi3_prmS1y + S3_prmS1y*xi3;
    double HdsumTerm2_prmS1y = 6*Sstardotn*Sstardotn_prmS1y;
    double HdsumTerm1_prmS1y = 2*Sstar1*Sstar1_prmS1y + 2*Sstar2*Sstar2_prmS1y + 2*Sstar3*Sstar3_prmS1y;
    double Hdsum_prmS1y = HdsumTerm1_prmS1y - HdsumTerm2_prmS1y;
    double Q4_prmS1y = eta*pow(prT, 3)*prT_prmS1y*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmS1y = 2*Deltar*pdotn*pdotn_prmS1y/Sigma - Deltar*Sigma_prmS1y*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS1y*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmS1y/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmS1y/(Sigma*sin2theta) - Sigma_prmS1y*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmS1y/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmS1y/(Lambt*sin2theta) + Sigma_prmS1y*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmS1y*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmS1y = Q4_prmS1y + gammappsum_prmS1y;
    double alpha_prmS1y = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmS1y/Lambt - 1.0/2.0*Deltat*Lambt_prmS1y*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmS1y*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmS1y = omegatilde*pphi_prmS1y/Lambt + omegatilde_prmS1y*pphi/Lambt - Lambt_prmS1y*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmS1y = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmS1y - 1.0/2.0*Q_prmS1y/sqrt(Q)) + Sdotn*exp2mu*xisq_prmS1y*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmS1y*xisq*(-sqrt(Q) - Q) + Sdotn_prmS1y*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmS1y - Jtilde*Sdotv_prmS1y*pdotn - Jtilde_prmS1y*Sdotv*pdotn + Sdotn*pdotvr_prmS1y + Sdotn_prmS1y*pdotvr) + pdotvr_prmS1y*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmS1y*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmS1y + Btilde*Jtilde*Sdotxi_prmS1y*pdotn + Btilde*Jtilde_prmS1y*Sdotxi*pdotn + Btilde_prmS1y*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmS1y - Sdotn*expmu*expnu_prmS1y*pdotxir - Sdotn*expmu_prmS1y*expnu*pdotxir - Sdotn_prmS1y*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmS1y*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmS1y*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmS1y*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmS1y = (1.0/2.0)*omegacostheta*(-Q_prmS1y - 1.0/2.0*Q_prmS1y/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmS1y/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmS1y*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmS1y*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmS1y*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmS1y*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmS1y = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmS1y - Jtilde*Sdotv_prmS1y*pdotn - Jtilde_prmS1y*Sdotv*pdotn + Sdotn*pdotvr_prmS1y + Sdotn_prmS1y*pdotvr) + Jtilde*pdotn_prmS1y*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmS1y*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmS1y + (1.0/2.0)*Q_prmS1y/sqrt(Q)) + Sdotv*exp2mu_prmS1y*(sqrt(Q) + Q) + Sdotv_prmS1y*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmS1y*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmS1y*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmS1y - Btilde*Sdotxi*expnu_prmS1y*pdotvr - Btilde*Sdotxi_prmS1y*expnu*pdotvr - Btilde_prmS1y*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmS1y + Sdotv*exp2nu*expmu_prmS1y*pdotxir + Sdotv*exp2nu_prmS1y*expmu*pdotxir + Sdotv_prmS1y*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmS1y*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmS1y*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmS1y = (1.0/2.0)*Jtilde*omegar*(-Q_prmS1y - 1.0/2.0*Q_prmS1y/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmS1y/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmS1y/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmS1y*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmS1y*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmS1y*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmS1y*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmS1y*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmS1y = SdotSkerrhat*omega_prmS1y + SdotSkerrhat_prmS1y*omega;
    double Hss_prmS1y = HssTerm1_prmS1y + HssTerm2*HssTerm2coeff_prmS1y + HssTerm2_prmS1y*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmS1y + HssTerm3_prmS1y*HssTerm3coeff;
    double HsoTerm2c_prmS1y = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmS1y*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmS1y*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmS1y*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmS1y*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmS1y*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmS1y*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmS1y*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmS1y = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmS1y + Jtilde*Sdotv_prmS1y*nur + Jtilde_prmS1y*Sdotv*nur - Sdotn*nucostheta*xisq_prmS1y - Sdotn*nucostheta_prmS1y*xisq - Sdotn_prmS1y*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmS1y*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmS1y*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmS1y*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmS1y*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmS1y*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmS1y = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmS1y + nur_prmS1y*pdotvr + pdotn*xisq*(mucostheta_prmS1y - nucostheta_prmS1y) + pdotn*xisq_prmS1y*(mucostheta - nucostheta) + pdotn_prmS1y*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmS1y - mucostheta*pdotn_prmS1y*xisq - mucostheta_prmS1y*pdotn*xisq + mur*pdotvr_prmS1y*(sqrt(Q) + 1) + mur_prmS1y*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmS1y*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmS1y*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmS1y*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmS1y*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmS1y*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmS1y = HsoTerm2a_prmS1y + HsoTerm2b_prmS1y - HsoTerm2c_prmS1y;
    double HsoTerm2coeff_prmS1y = expnu*(-Q_prmS1y - 1.0/2.0*Q_prmS1y/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmS1y/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmS1y/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmS1y*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmS1y*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmS1y = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmS1y + expmu*expnu_prmS1y + expmu_prmS1y*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmS1y*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmS1y*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmS1y*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmS1y*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmS1y*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmS1y*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmS1y*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmS1y = HsoTerm1_prmS1y + HsoTerm2*HsoTerm2coeff_prmS1y + HsoTerm2_prmS1y*HsoTerm2coeff;
    double Hd_prmS1y = Hdcoeff*Hdsum_prmS1y;
    double Hns_prmS1y = sqrt(Hnsradicand)*alpha_prmS1y + betapsum_prmS1y + (1.0/2.0)*Hnsradicand_prmS1y*alpha/sqrt(Hnsradicand);
    double Hs_prmS1y = Hso_prmS1y + Hss_prmS1y;
    double dSS_prmS1y = 1585.5329999999999*pow(chi, 2)*chi_prmS1y*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmS1y*eta + 2323.5599999999999*chi*chi_prmS1y*pow(eta, 3) - 652.64999999999998*chi*chi_prmS1y*pow(eta, 2) + 37.196399999999997*chi_prmS1y*eta;
    double Heff_prmS1y = -Hd_prmS1y + Hns_prmS1y + Hs_prmS1y + 2*S1y*dSS*eta*pow(u, 4) + dSS_prmS1y*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmS1y = Heff_prmS1y*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double sigmastar3_prmS1z = m2/m1;
    double sigma3_prmS1z = 1;
    double Skerr3_prmS1z = sigma3_prmS1z;
    double Skerrmag_prmS1z = Skerr3*Skerr3_prmS1z/sqrt(pow(Skerr1, 2) + pow(Skerr2, 2) + pow(Skerr3, 2));
    double Skerrhat3_prmS1z = -Skerr3*Skerrmag_prmS1z/pow(Skerrmag, 2) + Skerr3_prmS1z/Skerrmag;
    double Skerrhat2_prmS1z = -Skerr2*Skerrmag_prmS1z/pow(Skerrmag, 2);
    double Skerrhat1_prmS1z = -Skerr1*Skerrmag_prmS1z/pow(Skerrmag, 2);
    double a_prmS1z = Skerrmag_prmS1z;
    double S1dotLhat_prmS1z = Lhat3;
    double S1perp3_prmS1z = -Lhat3*S1dotLhat_prmS1z + 1;
    double S1perp2_prmS1z = -Lhat2*S1dotLhat_prmS1z;
    double S1perp1_prmS1z = -Lhat1*S1dotLhat_prmS1z;
    double Sperp3_prmS1z = S1perp3_prmS1z;
    double Sperp2_prmS1z = S1perp2_prmS1z;
    double Sperp1_prmS1z = S1perp1_prmS1z;
    double e33_prmS1z = Skerrhat3_prmS1z;
    double e32_prmS1z = Skerrhat2_prmS1z;
    double e31_prmS1z = Skerrhat1_prmS1z;
    double xi3_prmS1z = e31_prmS1z*n2 - e32_prmS1z*n1;
    double xi2_prmS1z = -e31_prmS1z*n3 + e33_prmS1z*n1;
    double xi1_prmS1z = e32_prmS1z*n3 - e33_prmS1z*n2;
    double v3_prmS1z = n1*xi2_prmS1z - n2*xi1_prmS1z;
    double v2_prmS1z = -n1*xi3_prmS1z + n3*xi1_prmS1z;
    double v1_prmS1z = n2*xi3_prmS1z - n3*xi2_prmS1z;
    double costheta_prmS1z = e31_prmS1z*n1 + e32_prmS1z*n2 + e33_prmS1z*n3;
    double sin2theta_prmS1z = -2*costheta*costheta_prmS1z;
    double xisq_prmS1z = sin2theta_prmS1z;
    double w2_prmS1z = 2*a*a_prmS1z;
    double Sigma_prmS1z = 2*pow(a, 2)*costheta*costheta_prmS1z + 2*a*a_prmS1z*pow(costheta, 2);
    double omegatilde_prmS1z = 2*a_prmS1z*r;
    double chi_prmS1z = Lhat3*Skerr3_prmS1z/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmS1z + (1.0/2.0)*Skerr2*Sperp2_prmS1z + (1.0/2.0)*Skerr3*Sperp3_prmS1z + (1.0/2.0)*Skerr3_prmS1z*Sperp3)/(Skerrmag*(1.0 - 2.0*eta)) - Skerrmag_prmS1z*((1.0/2.0)*Skerr1*Sperp1 + (1.0/2.0)*Skerr2*Sperp2 + (1.0/2.0)*Skerr3*Sperp3)/(pow(Skerrmag, 2)*(1.0 - 2.0*eta));
    double K_prmS1z = -177.4974*pow(chi, 2)*chi_prmS1z*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmS1z*eta + 4.3097700000000003*pow(chi, 2)*chi_prmS1z + 62.349200000000003*chi*chi_prmS1z*pow(eta, 3) + 12.329319999999999*chi*chi_prmS1z*pow(eta, 2) - 2.76172*chi*chi_prmS1z - 27.520099999999999*chi_prmS1z*pow(eta, 3) + 17.3736*chi_prmS1z*pow(eta, 2) + 2.26831*chi_prmS1z*eta - 1.6204499999999999*chi_prmS1z;
    double etaKminus1_prmS1z = K_prmS1z*eta;
    double Delta0_prmS1z = K*K_prmS1z*eta + K_prmS1z*(K*eta - 2);
    double Delta1_prmS1z = etaKminus1*(-2*Delta0_prmS1z - 2*K_prmS1z) + etaKminus1_prmS1z*(-2*Delta0 - 2*K);
    double Delta2_prmS1z = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmS1z - 2*Delta0*a*a_prmS1z*pow(etaKminus1, 2) - Delta0_prmS1z*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmS1z - 2*etaKminus1_prmS1z) + Delta1_prmS1z*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmS1z = -pow(Delta1, 2)*Delta1_prmS1z + pow(Delta1, 2)*etaKminus1_prmS1z + 2*Delta1*Delta1_prmS1z*etaKminus1 + Delta1*Delta2_prmS1z - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmS1z - 2*Delta1*a*a_prmS1z*pow(etaKminus1, 2) + Delta1_prmS1z*Delta2 - Delta1_prmS1z*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmS1z + 2*etaKminus1_prmS1z) + etaKminus1_prmS1z*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmS1z = pow(Delta1, 3)*Delta1_prmS1z - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmS1z - 2*pow(Delta1, 2)*Delta1_prmS1z*etaKminus1 - pow(Delta1, 2)*Delta2_prmS1z - 2*Delta1*Delta1_prmS1z*Delta2 + Delta1*(2*Delta2*etaKminus1_prmS1z + 2*Delta2_prmS1z*etaKminus1 + Delta3_prmS1z) + Delta1_prmS1z*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmS1z - 2*Delta3*etaKminus1_prmS1z - 2*Delta3_prmS1z*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmS1z - 2*Delta2_prmS1z) + pow(a, 2)*etaKminus1*etaKminus1_prmS1z*(pow(Delta1, 2) - 2*Delta2) + a*a_prmS1z*pow(etaKminus1, 2)*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmS1z*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmS1z = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmS1z - 3*Delta1*Delta2_prmS1z - 3*Delta1_prmS1z*Delta2 + 3*Delta3_prmS1z) + (1.0/3.0)*a*a_prmS1z*(-2*pow(Delta1, 3) + 6*Delta1*Delta2 - 6*Delta3) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmS1z - 4*pow(Delta1, 2)*Delta2_prmS1z - 8*Delta1*Delta1_prmS1z*Delta2 + 4*Delta1*Delta3_prmS1z + 4*Delta1_prmS1z*Delta3 + 4*Delta2*Delta2_prmS1z - 4*Delta4_prmS1z)/etaKminus1 - 1.0/2.0*etaKminus1_prmS1z*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmS1z - 5*pow(Delta1, 3)*Delta2_prmS1z - 15*pow(Delta1, 2)*Delta1_prmS1z*Delta2 + 5*pow(Delta1, 2)*Delta3_prmS1z + 10*Delta1*Delta1_prmS1z*Delta3 + 10*Delta1*Delta2*Delta2_prmS1z - 5*Delta1*Delta4_prmS1z + 5*Delta1_prmS1z*pow(Delta2, 2) - 5*Delta1_prmS1z*Delta4 - 5*Delta2*Delta3_prmS1z - 5*Delta2_prmS1z*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmS1z*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmS1z*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmS1z = (128.0/5.0)*etaKminus1*etaKminus1_prmS1z;
    double logarg_prmS1z = u*(Delta1_prmS1z + u*(Delta2_prmS1z + u*(Delta3_prmS1z + u*(Delta4_prmS1z + u*(Delta5_prmS1z + Delta5l_prmS1z*log(u))))));
    double Deltaucalib_prmS1z = eta*(Delta0_prmS1z + logarg_prmS1z*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmS1z = eta*logarg_prmS1z*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmS1z + u*(2*Delta2_prmS1z + u*(3*Delta3_prmS1z + u*(4*Delta4_prmS1z + u*(5*Delta5_prmS1z + 5*Delta5l_prmS1z*log(u))))))/(logarg + 1);
    double Deltaubar_prmS1z = 2*a*a_prmS1z*pow(u, 2) + etaKminus1_prmS1z*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmS1z/pow(etaKminus1, 3);
    double Deltaubarprime_prmS1z = -4*a*a_prmS1z*pow(u, 3) + 2*etaKminus1_prmS1z*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmS1z = (Deltaubar*Deltaucalib_prmS1z + Deltaubar_prmS1z*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmS1z = Deltaubar*Deltaucalibprime_prmS1z + Deltaubar_prmS1z*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmS1z + Deltaubarprime_prmS1z*Deltaucalib;
    double Deltatprime_prmS1z = 2*Deltau_prmS1z*r + Deltauprime_prmS1z*pow(r, 2);
    double Deltat_prmS1z = Deltau_prmS1z*pow(r, 2);
    double Deltar_prmS1z = Deltat_prmS1z*Dinv;
    double Lambt_prmS1z = (Deltat*pow(a, 2)*sin2theta_prmS1z + 2*Deltat*a*a_prmS1z*sin2theta + Deltat_prmS1z*pow(a, 2)*sin2theta - 2*w2*w2_prmS1z)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmS1z = (1.0/2.0)*(Deltar*Deltat_prmS1z + Deltar_prmS1z*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmS1z*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmS1z = csi_prmS1z*(1 - fabs((double)tortoise - 1));
    double csi2_prmS1z = csi_prmS1z*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmS1z = csi2_prmS1z*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmS1z = n3*prT_prmS1z*(-1 + 1.0/csi1) - csi1_prmS1z*n3*prT/pow(csi1, 2);
    double phat2_prmS1z = n2*prT_prmS1z*(-1 + 1.0/csi1) - csi1_prmS1z*n2*prT/pow(csi1, 2);
    double phat1_prmS1z = n1*prT_prmS1z*(-1 + 1.0/csi1) - csi1_prmS1z*n1*prT/pow(csi1, 2);
    double pdotxir_prmS1z = r*(phat1*xi1_prmS1z + phat1_prmS1z*xi1 + phat2*xi2_prmS1z + phat2_prmS1z*xi2 + phat3*xi3_prmS1z + phat3_prmS1z*xi3);
    double pdotn_prmS1z = n1*phat1_prmS1z + n2*phat2_prmS1z + n3*phat3_prmS1z;
    double pdotvr_prmS1z = r*(phat1*v1_prmS1z + phat1_prmS1z*v1 + phat2*v2_prmS1z + phat2_prmS1z*v2 + phat3*v3_prmS1z + phat3_prmS1z*v3);
    double pphi_prmS1z = pdotxir_prmS1z;
    double Qcoeff2_prmS1z = -sin2theta_prmS1z/(Sigma*pow(sin2theta, 2)) - Sigma_prmS1z/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmS1z = -Sigma*sin2theta_prmS1z/(Lambt*pow(sin2theta, 2)) + Sigma_prmS1z/(Lambt*sin2theta) - Lambt_prmS1z*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmS1z = 2*Deltar*pdotn*pdotn_prmS1z/Sigma - Deltar*Sigma_prmS1z*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS1z*pow(pdotn, 2)/Sigma;
    double Q_prmS1z = DrSipn2_prmS1z + 2*Qcoeff1*pdotxir*pdotxir_prmS1z + Qcoeff1_prmS1z*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmS1z + Qcoeff2_prmS1z*pow(pdotvr, 2);
    double Qminus1_prmS1z = Q_prmS1z;
    double Jtilde_prmS1z = (1.0/2.0)*Deltar_prmS1z/sqrt(Deltar);
    double exp2mu_prmS1z = Sigma_prmS1z;
    double expmu_prmS1z = (1.0/2.0)*exp2mu_prmS1z/sqrt(exp2mu);
    double Brtilde_prmS1z = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmS1z - 2*Deltat_prmS1z + (1.0/2.0)*Deltar_prmS1z*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmS1z - 1.0/2.0*Deltar_prmS1z*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmS1z = (1.0/2.0)*Deltat_prmS1z/sqrt(Deltat);
    double exp2nu_prmS1z = Deltat*Sigma_prmS1z/Lambt - Deltat*Lambt_prmS1z*Sigma/pow(Lambt, 2) + Deltat_prmS1z*Sigma/Lambt;
    double expnu_prmS1z = (1.0/2.0)*exp2nu_prmS1z/sqrt(exp2nu);
    double omega_prmS1z = omegatilde_prmS1z/Lambt - Lambt_prmS1z*omegatilde/pow(Lambt, 2);
    double omegatildeprime_prmS1z = 2*a_prmS1z;
    double Lambtprime_prmS1z = -Deltatprime*pow(a, 2)*sin2theta_prmS1z - 2*Deltatprime*a*a_prmS1z*sin2theta - Deltatprime_prmS1z*pow(a, 2)*sin2theta + 8*a*a_prmS1z*r;
    double mucostheta_prmS1z = pow(a, 2)*costheta_prmS1z/Sigma + 2*a*a_prmS1z*costheta/Sigma - Sigma_prmS1z*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmS1z = pow(a, 2)*costheta*w2*(-Deltat_prmS1z + w2_prmS1z)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmS1z*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmS1z*w2*(-Deltat + w2)/(Lambt*Sigma) + a*a_prmS1z*costheta*w2*(-2*Deltat + 2*w2)/(Lambt*Sigma) - Sigma_prmS1z*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmS1z*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmS1z = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmS1z/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmS1z*omegatilde/pow(Lambt, 2) - 4*Deltat*a*a_prmS1z*costheta*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmS1z*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmS1z*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmS1z = -Sigma_prmS1z*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmS1z/pow(Deltar, 3.0/2.0);
    double nur_prmS1z = -Sigma_prmS1z*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat_prmS1z*r + Deltatprime*w2_prmS1z + Deltatprime_prmS1z*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmS1z*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmS1z*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmS1z*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmS1z = (Lambt*omegatildeprime_prmS1z + Lambt_prmS1z*omegatildeprime - Lambtprime*omegatilde_prmS1z - Lambtprime_prmS1z*omegatilde)/pow(Lambt, 2) + Lambt_prmS1z*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmS1z = 442.44299999999998*pow(chi, 2)*chi_prmS1z*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmS1z*eta + 198.59610000000001*pow(chi, 2)*chi_prmS1z - 686.62599999999998*chi*chi_prmS1z*eta + 2495.29*chi_prmS1z*pow(eta, 2);
    double sigmacoeffTerm3_prmS1z = dSO_prmS1z*eta*pow(u, 3);
    double sigmacoeffTerm2_prmS1z = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmS1z + 204*Qminus1_prmS1z + r*(1620*DrSipn2*DrSipn2_prmS1z - 234*DrSipn2*Qminus1_prmS1z - 234*DrSipn2_prmS1z*Qminus1)) + r*(-96*DrSipn2_prmS1z - 436*Qminus1_prmS1z + r*(36*DrSipn2*Qminus1_prmS1z + 36*DrSipn2_prmS1z*Qminus1 - 90*Qminus1*Qminus1_prmS1z)))/pow(r, 2);
    double sigmacoeffTerm1_prmS1z = eta*(-3*DrSipn2_prmS1z + (1.0/4.0)*Qminus1_prmS1z);
    double sigmacoeff_prmS1z = sigmacoeffTerm1_prmS1z + sigmacoeffTerm2_prmS1z + sigmacoeffTerm3_prmS1z;
    double sigmastarcoeffTerm2_prmS1z = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmS1z + 120*Qminus1_prmS1z + r*(720*DrSipn2*DrSipn2_prmS1z + Qminus1*(-126*DrSipn2_prmS1z - 3*Qminus1_prmS1z) + Qminus1_prmS1z*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmS1z + Qminus1*r*(96*DrSipn2_prmS1z - 23*Qminus1_prmS1z) + Qminus1_prmS1z*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmS1z))/pow(r, 2);
    double sigmastarcoeffTerm1_prmS1z = eta*(-5.0/2.0*DrSipn2_prmS1z + (1.0/3.0)*Qminus1_prmS1z);
    double sigmastarcoeff_prmS1z = sigmastarcoeffTerm1_prmS1z + sigmastarcoeffTerm2_prmS1z;
    double Deltasigmastar3_prmS1z = sigma3*sigmacoeff_prmS1z + sigma3_prmS1z*sigmacoeff + sigmastar3*sigmastarcoeff_prmS1z + sigmastar3_prmS1z*sigmastarcoeff;
    double Deltasigmastar2_prmS1z = sigma2*sigmacoeff_prmS1z + sigmastar2*sigmastarcoeff_prmS1z;
    double Deltasigmastar1_prmS1z = sigma1*sigmacoeff_prmS1z + sigmastar1*sigmastarcoeff_prmS1z;
    double Sstar3_prmS1z = Deltasigmastar3_prmS1z + sigmastar3_prmS1z;
    double Sstar2_prmS1z = Deltasigmastar2_prmS1z;
    double Sstar1_prmS1z = Deltasigmastar1_prmS1z;
    double S3_prmS1z = Sstar3_prmS1z;
    double S2_prmS1z = Sstar2_prmS1z;
    double S1_prmS1z = Sstar1_prmS1z;
    double Sstardotn_prmS1z = Sstar1_prmS1z*n1 + Sstar2_prmS1z*n2 + Sstar3_prmS1z*n3;
    double SdotSkerrhat_prmS1z = S1*Skerrhat1_prmS1z + S1_prmS1z*Skerrhat1 + S2*Skerrhat2_prmS1z + S2_prmS1z*Skerrhat2 + S3*Skerrhat3_prmS1z + S3_prmS1z*Skerrhat3;
    double Sdotn_prmS1z = S1_prmS1z*n1 + S2_prmS1z*n2 + S3_prmS1z*n3;
    double Sdotv_prmS1z = S1*v1_prmS1z + S1_prmS1z*v1 + S2*v2_prmS1z + S2_prmS1z*v2 + S3*v3_prmS1z + S3_prmS1z*v3;
    double Sdotxi_prmS1z = S1*xi1_prmS1z + S1_prmS1z*xi1 + S2*xi2_prmS1z + S2_prmS1z*xi2 + S3*xi3_prmS1z + S3_prmS1z*xi3;
    double HdsumTerm2_prmS1z = 6*Sstardotn*Sstardotn_prmS1z;
    double HdsumTerm1_prmS1z = 2*Sstar1*Sstar1_prmS1z + 2*Sstar2*Sstar2_prmS1z + 2*Sstar3*Sstar3_prmS1z;
    double Hdsum_prmS1z = HdsumTerm1_prmS1z - HdsumTerm2_prmS1z;
    double Q4_prmS1z = eta*pow(prT, 3)*prT_prmS1z*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmS1z = 2*Deltar*pdotn*pdotn_prmS1z/Sigma - Deltar*Sigma_prmS1z*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS1z*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmS1z/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmS1z/(Sigma*sin2theta) - Sigma_prmS1z*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmS1z/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmS1z/(Lambt*sin2theta) + Sigma_prmS1z*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmS1z*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmS1z = Q4_prmS1z + gammappsum_prmS1z;
    double alpha_prmS1z = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmS1z/Lambt - 1.0/2.0*Deltat*Lambt_prmS1z*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmS1z*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmS1z = omegatilde*pphi_prmS1z/Lambt + omegatilde_prmS1z*pphi/Lambt - Lambt_prmS1z*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmS1z = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmS1z - 1.0/2.0*Q_prmS1z/sqrt(Q)) + Sdotn*exp2mu*xisq_prmS1z*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmS1z*xisq*(-sqrt(Q) - Q) + Sdotn_prmS1z*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmS1z - Jtilde*Sdotv_prmS1z*pdotn - Jtilde_prmS1z*Sdotv*pdotn + Sdotn*pdotvr_prmS1z + Sdotn_prmS1z*pdotvr) + pdotvr_prmS1z*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmS1z*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmS1z + Btilde*Jtilde*Sdotxi_prmS1z*pdotn + Btilde*Jtilde_prmS1z*Sdotxi*pdotn + Btilde_prmS1z*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmS1z - Sdotn*expmu*expnu_prmS1z*pdotxir - Sdotn*expmu_prmS1z*expnu*pdotxir - Sdotn_prmS1z*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmS1z*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmS1z*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmS1z*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmS1z = (1.0/2.0)*omegacostheta*(-Q_prmS1z - 1.0/2.0*Q_prmS1z/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmS1z/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmS1z*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmS1z*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmS1z*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmS1z*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmS1z = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmS1z - Jtilde*Sdotv_prmS1z*pdotn - Jtilde_prmS1z*Sdotv*pdotn + Sdotn*pdotvr_prmS1z + Sdotn_prmS1z*pdotvr) + Jtilde*pdotn_prmS1z*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmS1z*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmS1z + (1.0/2.0)*Q_prmS1z/sqrt(Q)) + Sdotv*exp2mu_prmS1z*(sqrt(Q) + Q) + Sdotv_prmS1z*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmS1z*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmS1z*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmS1z - Btilde*Sdotxi*expnu_prmS1z*pdotvr - Btilde*Sdotxi_prmS1z*expnu*pdotvr - Btilde_prmS1z*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmS1z + Sdotv*exp2nu*expmu_prmS1z*pdotxir + Sdotv*exp2nu_prmS1z*expmu*pdotxir + Sdotv_prmS1z*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmS1z*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmS1z*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmS1z = (1.0/2.0)*Jtilde*omegar*(-Q_prmS1z - 1.0/2.0*Q_prmS1z/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmS1z/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmS1z/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmS1z*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmS1z*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmS1z*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmS1z*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmS1z*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmS1z = SdotSkerrhat*omega_prmS1z + SdotSkerrhat_prmS1z*omega;
    double Hss_prmS1z = HssTerm1_prmS1z + HssTerm2*HssTerm2coeff_prmS1z + HssTerm2_prmS1z*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmS1z + HssTerm3_prmS1z*HssTerm3coeff;
    double HsoTerm2c_prmS1z = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmS1z*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmS1z*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmS1z*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmS1z*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmS1z*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmS1z*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmS1z*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmS1z = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmS1z + Jtilde*Sdotv_prmS1z*nur + Jtilde_prmS1z*Sdotv*nur - Sdotn*nucostheta*xisq_prmS1z - Sdotn*nucostheta_prmS1z*xisq - Sdotn_prmS1z*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmS1z*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmS1z*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmS1z*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmS1z*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmS1z*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmS1z = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmS1z + nur_prmS1z*pdotvr + pdotn*xisq*(mucostheta_prmS1z - nucostheta_prmS1z) + pdotn*xisq_prmS1z*(mucostheta - nucostheta) + pdotn_prmS1z*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmS1z - mucostheta*pdotn_prmS1z*xisq - mucostheta_prmS1z*pdotn*xisq + mur*pdotvr_prmS1z*(sqrt(Q) + 1) + mur_prmS1z*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmS1z*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmS1z*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmS1z*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmS1z*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmS1z*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmS1z = HsoTerm2a_prmS1z + HsoTerm2b_prmS1z - HsoTerm2c_prmS1z;
    double HsoTerm2coeff_prmS1z = expnu*(-Q_prmS1z - 1.0/2.0*Q_prmS1z/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmS1z/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmS1z/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmS1z*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmS1z*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmS1z = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmS1z + expmu*expnu_prmS1z + expmu_prmS1z*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmS1z*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmS1z*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmS1z*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmS1z*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmS1z*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmS1z*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmS1z*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmS1z = HsoTerm1_prmS1z + HsoTerm2*HsoTerm2coeff_prmS1z + HsoTerm2_prmS1z*HsoTerm2coeff;
    double Hd_prmS1z = Hdcoeff*Hdsum_prmS1z;
    double Hns_prmS1z = sqrt(Hnsradicand)*alpha_prmS1z + betapsum_prmS1z + (1.0/2.0)*Hnsradicand_prmS1z*alpha/sqrt(Hnsradicand);
    double Hs_prmS1z = Hso_prmS1z + Hss_prmS1z;
    double dSS_prmS1z = 1585.5329999999999*pow(chi, 2)*chi_prmS1z*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmS1z*eta + 2323.5599999999999*chi*chi_prmS1z*pow(eta, 3) - 652.64999999999998*chi*chi_prmS1z*pow(eta, 2) + 37.196399999999997*chi_prmS1z*eta;
    double Heff_prmS1z = -Hd_prmS1z + Hns_prmS1z + Hs_prmS1z + 2*S1z*dSS*eta*pow(u, 4) + dSS_prmS1z*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmS1z = Heff_prmS1z*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double sigmastar1_prmS2x = m1/m2;
    double sigma1_prmS2x = 1;
    double Skerr1_prmS2x = sigma1_prmS2x;
    double Skerrmag_prmS2x = Skerr1*Skerr1_prmS2x/sqrt(pow(Skerr1, 2) + pow(Skerr2, 2) + pow(Skerr3, 2));
    double Skerrhat3_prmS2x = -Skerr3*Skerrmag_prmS2x/pow(Skerrmag, 2);
    double Skerrhat2_prmS2x = -Skerr2*Skerrmag_prmS2x/pow(Skerrmag, 2);
    double Skerrhat1_prmS2x = -Skerr1*Skerrmag_prmS2x/pow(Skerrmag, 2) + Skerr1_prmS2x/Skerrmag;
    double a_prmS2x = Skerrmag_prmS2x;
    double S2dotLhat_prmS2x = Lhat1;
    double S2perp3_prmS2x = -Lhat3*S2dotLhat_prmS2x;
    double S2perp2_prmS2x = -Lhat2*S2dotLhat_prmS2x;
    double S2perp1_prmS2x = -Lhat1*S2dotLhat_prmS2x + 1;
    double Sperp3_prmS2x = S2perp3_prmS2x;
    double Sperp2_prmS2x = S2perp2_prmS2x;
    double Sperp1_prmS2x = S2perp1_prmS2x;
    double e33_prmS2x = Skerrhat3_prmS2x;
    double e32_prmS2x = Skerrhat2_prmS2x;
    double e31_prmS2x = Skerrhat1_prmS2x;
    double xi3_prmS2x = e31_prmS2x*n2 - e32_prmS2x*n1;
    double xi2_prmS2x = -e31_prmS2x*n3 + e33_prmS2x*n1;
    double xi1_prmS2x = e32_prmS2x*n3 - e33_prmS2x*n2;
    double v3_prmS2x = n1*xi2_prmS2x - n2*xi1_prmS2x;
    double v2_prmS2x = -n1*xi3_prmS2x + n3*xi1_prmS2x;
    double v1_prmS2x = n2*xi3_prmS2x - n3*xi2_prmS2x;
    double costheta_prmS2x = e31_prmS2x*n1 + e32_prmS2x*n2 + e33_prmS2x*n3;
    double sin2theta_prmS2x = -2*costheta*costheta_prmS2x;
    double xisq_prmS2x = sin2theta_prmS2x;
    double w2_prmS2x = 2*a*a_prmS2x;
    double Sigma_prmS2x = 2*pow(a, 2)*costheta*costheta_prmS2x + 2*a*a_prmS2x*pow(costheta, 2);
    double omegatilde_prmS2x = 2*a_prmS2x*r;
    double chi_prmS2x = Lhat1*Skerr1_prmS2x/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmS2x + (1.0/2.0)*Skerr1_prmS2x*Sperp1 + (1.0/2.0)*Skerr2*Sperp2_prmS2x + (1.0/2.0)*Skerr3*Sperp3_prmS2x)/(Skerrmag*(1.0 - 2.0*eta)) - Skerrmag_prmS2x*((1.0/2.0)*Skerr1*Sperp1 + (1.0/2.0)*Skerr2*Sperp2 + (1.0/2.0)*Skerr3*Sperp3)/(pow(Skerrmag, 2)*(1.0 - 2.0*eta));
    double K_prmS2x = -177.4974*pow(chi, 2)*chi_prmS2x*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmS2x*eta + 4.3097700000000003*pow(chi, 2)*chi_prmS2x + 62.349200000000003*chi*chi_prmS2x*pow(eta, 3) + 12.329319999999999*chi*chi_prmS2x*pow(eta, 2) - 2.76172*chi*chi_prmS2x - 27.520099999999999*chi_prmS2x*pow(eta, 3) + 17.3736*chi_prmS2x*pow(eta, 2) + 2.26831*chi_prmS2x*eta - 1.6204499999999999*chi_prmS2x;
    double etaKminus1_prmS2x = K_prmS2x*eta;
    double Delta0_prmS2x = K*K_prmS2x*eta + K_prmS2x*(K*eta - 2);
    double Delta1_prmS2x = etaKminus1*(-2*Delta0_prmS2x - 2*K_prmS2x) + etaKminus1_prmS2x*(-2*Delta0 - 2*K);
    double Delta2_prmS2x = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmS2x - 2*Delta0*a*a_prmS2x*pow(etaKminus1, 2) - Delta0_prmS2x*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmS2x - 2*etaKminus1_prmS2x) + Delta1_prmS2x*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmS2x = -pow(Delta1, 2)*Delta1_prmS2x + pow(Delta1, 2)*etaKminus1_prmS2x + 2*Delta1*Delta1_prmS2x*etaKminus1 + Delta1*Delta2_prmS2x - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmS2x - 2*Delta1*a*a_prmS2x*pow(etaKminus1, 2) + Delta1_prmS2x*Delta2 - Delta1_prmS2x*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmS2x + 2*etaKminus1_prmS2x) + etaKminus1_prmS2x*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmS2x = pow(Delta1, 3)*Delta1_prmS2x - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmS2x - 2*pow(Delta1, 2)*Delta1_prmS2x*etaKminus1 - pow(Delta1, 2)*Delta2_prmS2x - 2*Delta1*Delta1_prmS2x*Delta2 + Delta1*(2*Delta2*etaKminus1_prmS2x + 2*Delta2_prmS2x*etaKminus1 + Delta3_prmS2x) + Delta1_prmS2x*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmS2x - 2*Delta3*etaKminus1_prmS2x - 2*Delta3_prmS2x*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmS2x - 2*Delta2_prmS2x) + pow(a, 2)*etaKminus1*etaKminus1_prmS2x*(pow(Delta1, 2) - 2*Delta2) + a*a_prmS2x*pow(etaKminus1, 2)*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmS2x*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmS2x = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmS2x - 3*Delta1*Delta2_prmS2x - 3*Delta1_prmS2x*Delta2 + 3*Delta3_prmS2x) + (1.0/3.0)*a*a_prmS2x*(-2*pow(Delta1, 3) + 6*Delta1*Delta2 - 6*Delta3) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmS2x - 4*pow(Delta1, 2)*Delta2_prmS2x - 8*Delta1*Delta1_prmS2x*Delta2 + 4*Delta1*Delta3_prmS2x + 4*Delta1_prmS2x*Delta3 + 4*Delta2*Delta2_prmS2x - 4*Delta4_prmS2x)/etaKminus1 - 1.0/2.0*etaKminus1_prmS2x*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmS2x - 5*pow(Delta1, 3)*Delta2_prmS2x - 15*pow(Delta1, 2)*Delta1_prmS2x*Delta2 + 5*pow(Delta1, 2)*Delta3_prmS2x + 10*Delta1*Delta1_prmS2x*Delta3 + 10*Delta1*Delta2*Delta2_prmS2x - 5*Delta1*Delta4_prmS2x + 5*Delta1_prmS2x*pow(Delta2, 2) - 5*Delta1_prmS2x*Delta4 - 5*Delta2*Delta3_prmS2x - 5*Delta2_prmS2x*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmS2x*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmS2x*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmS2x = (128.0/5.0)*etaKminus1*etaKminus1_prmS2x;
    double logarg_prmS2x = u*(Delta1_prmS2x + u*(Delta2_prmS2x + u*(Delta3_prmS2x + u*(Delta4_prmS2x + u*(Delta5_prmS2x + Delta5l_prmS2x*log(u))))));
    double Deltaucalib_prmS2x = eta*(Delta0_prmS2x + logarg_prmS2x*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmS2x = eta*logarg_prmS2x*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmS2x + u*(2*Delta2_prmS2x + u*(3*Delta3_prmS2x + u*(4*Delta4_prmS2x + u*(5*Delta5_prmS2x + 5*Delta5l_prmS2x*log(u))))))/(logarg + 1);
    double Deltaubar_prmS2x = 2*a*a_prmS2x*pow(u, 2) + etaKminus1_prmS2x*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmS2x/pow(etaKminus1, 3);
    double Deltaubarprime_prmS2x = -4*a*a_prmS2x*pow(u, 3) + 2*etaKminus1_prmS2x*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmS2x = (Deltaubar*Deltaucalib_prmS2x + Deltaubar_prmS2x*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmS2x = Deltaubar*Deltaucalibprime_prmS2x + Deltaubar_prmS2x*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmS2x + Deltaubarprime_prmS2x*Deltaucalib;
    double Deltatprime_prmS2x = 2*Deltau_prmS2x*r + Deltauprime_prmS2x*pow(r, 2);
    double Deltat_prmS2x = Deltau_prmS2x*pow(r, 2);
    double Deltar_prmS2x = Deltat_prmS2x*Dinv;
    double Lambt_prmS2x = (Deltat*pow(a, 2)*sin2theta_prmS2x + 2*Deltat*a*a_prmS2x*sin2theta + Deltat_prmS2x*pow(a, 2)*sin2theta - 2*w2*w2_prmS2x)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmS2x = (1.0/2.0)*(Deltar*Deltat_prmS2x + Deltar_prmS2x*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmS2x*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmS2x = csi_prmS2x*(1 - fabs((double)tortoise - 1));
    double csi2_prmS2x = csi_prmS2x*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmS2x = csi2_prmS2x*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmS2x = n3*prT_prmS2x*(-1 + 1.0/csi1) - csi1_prmS2x*n3*prT/pow(csi1, 2);
    double phat2_prmS2x = n2*prT_prmS2x*(-1 + 1.0/csi1) - csi1_prmS2x*n2*prT/pow(csi1, 2);
    double phat1_prmS2x = n1*prT_prmS2x*(-1 + 1.0/csi1) - csi1_prmS2x*n1*prT/pow(csi1, 2);
    double pdotxir_prmS2x = r*(phat1*xi1_prmS2x + phat1_prmS2x*xi1 + phat2*xi2_prmS2x + phat2_prmS2x*xi2 + phat3*xi3_prmS2x + phat3_prmS2x*xi3);
    double pdotn_prmS2x = n1*phat1_prmS2x + n2*phat2_prmS2x + n3*phat3_prmS2x;
    double pdotvr_prmS2x = r*(phat1*v1_prmS2x + phat1_prmS2x*v1 + phat2*v2_prmS2x + phat2_prmS2x*v2 + phat3*v3_prmS2x + phat3_prmS2x*v3);
    double pphi_prmS2x = pdotxir_prmS2x;
    double Qcoeff2_prmS2x = -sin2theta_prmS2x/(Sigma*pow(sin2theta, 2)) - Sigma_prmS2x/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmS2x = -Sigma*sin2theta_prmS2x/(Lambt*pow(sin2theta, 2)) + Sigma_prmS2x/(Lambt*sin2theta) - Lambt_prmS2x*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmS2x = 2*Deltar*pdotn*pdotn_prmS2x/Sigma - Deltar*Sigma_prmS2x*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS2x*pow(pdotn, 2)/Sigma;
    double Q_prmS2x = DrSipn2_prmS2x + 2*Qcoeff1*pdotxir*pdotxir_prmS2x + Qcoeff1_prmS2x*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmS2x + Qcoeff2_prmS2x*pow(pdotvr, 2);
    double Qminus1_prmS2x = Q_prmS2x;
    double Jtilde_prmS2x = (1.0/2.0)*Deltar_prmS2x/sqrt(Deltar);
    double exp2mu_prmS2x = Sigma_prmS2x;
    double expmu_prmS2x = (1.0/2.0)*exp2mu_prmS2x/sqrt(exp2mu);
    double Brtilde_prmS2x = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmS2x - 2*Deltat_prmS2x + (1.0/2.0)*Deltar_prmS2x*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmS2x - 1.0/2.0*Deltar_prmS2x*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmS2x = (1.0/2.0)*Deltat_prmS2x/sqrt(Deltat);
    double exp2nu_prmS2x = Deltat*Sigma_prmS2x/Lambt - Deltat*Lambt_prmS2x*Sigma/pow(Lambt, 2) + Deltat_prmS2x*Sigma/Lambt;
    double expnu_prmS2x = (1.0/2.0)*exp2nu_prmS2x/sqrt(exp2nu);
    double omega_prmS2x = omegatilde_prmS2x/Lambt - Lambt_prmS2x*omegatilde/pow(Lambt, 2);
    double omegatildeprime_prmS2x = 2*a_prmS2x;
    double Lambtprime_prmS2x = -Deltatprime*pow(a, 2)*sin2theta_prmS2x - 2*Deltatprime*a*a_prmS2x*sin2theta - Deltatprime_prmS2x*pow(a, 2)*sin2theta + 8*a*a_prmS2x*r;
    double mucostheta_prmS2x = pow(a, 2)*costheta_prmS2x/Sigma + 2*a*a_prmS2x*costheta/Sigma - Sigma_prmS2x*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmS2x = pow(a, 2)*costheta*w2*(-Deltat_prmS2x + w2_prmS2x)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmS2x*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmS2x*w2*(-Deltat + w2)/(Lambt*Sigma) + a*a_prmS2x*costheta*w2*(-2*Deltat + 2*w2)/(Lambt*Sigma) - Sigma_prmS2x*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmS2x*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmS2x = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmS2x/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmS2x*omegatilde/pow(Lambt, 2) - 4*Deltat*a*a_prmS2x*costheta*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmS2x*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmS2x*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmS2x = -Sigma_prmS2x*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmS2x/pow(Deltar, 3.0/2.0);
    double nur_prmS2x = -Sigma_prmS2x*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat_prmS2x*r + Deltatprime*w2_prmS2x + Deltatprime_prmS2x*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmS2x*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmS2x*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmS2x*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmS2x = (Lambt*omegatildeprime_prmS2x + Lambt_prmS2x*omegatildeprime - Lambtprime*omegatilde_prmS2x - Lambtprime_prmS2x*omegatilde)/pow(Lambt, 2) + Lambt_prmS2x*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmS2x = 442.44299999999998*pow(chi, 2)*chi_prmS2x*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmS2x*eta + 198.59610000000001*pow(chi, 2)*chi_prmS2x - 686.62599999999998*chi*chi_prmS2x*eta + 2495.29*chi_prmS2x*pow(eta, 2);
    double sigmacoeffTerm3_prmS2x = dSO_prmS2x*eta*pow(u, 3);
    double sigmacoeffTerm2_prmS2x = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmS2x + 204*Qminus1_prmS2x + r*(1620*DrSipn2*DrSipn2_prmS2x - 234*DrSipn2*Qminus1_prmS2x - 234*DrSipn2_prmS2x*Qminus1)) + r*(-96*DrSipn2_prmS2x - 436*Qminus1_prmS2x + r*(36*DrSipn2*Qminus1_prmS2x + 36*DrSipn2_prmS2x*Qminus1 - 90*Qminus1*Qminus1_prmS2x)))/pow(r, 2);
    double sigmacoeffTerm1_prmS2x = eta*(-3*DrSipn2_prmS2x + (1.0/4.0)*Qminus1_prmS2x);
    double sigmacoeff_prmS2x = sigmacoeffTerm1_prmS2x + sigmacoeffTerm2_prmS2x + sigmacoeffTerm3_prmS2x;
    double sigmastarcoeffTerm2_prmS2x = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmS2x + 120*Qminus1_prmS2x + r*(720*DrSipn2*DrSipn2_prmS2x + Qminus1*(-126*DrSipn2_prmS2x - 3*Qminus1_prmS2x) + Qminus1_prmS2x*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmS2x + Qminus1*r*(96*DrSipn2_prmS2x - 23*Qminus1_prmS2x) + Qminus1_prmS2x*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmS2x))/pow(r, 2);
    double sigmastarcoeffTerm1_prmS2x = eta*(-5.0/2.0*DrSipn2_prmS2x + (1.0/3.0)*Qminus1_prmS2x);
    double sigmastarcoeff_prmS2x = sigmastarcoeffTerm1_prmS2x + sigmastarcoeffTerm2_prmS2x;
    double Deltasigmastar3_prmS2x = sigma3*sigmacoeff_prmS2x + sigmastar3*sigmastarcoeff_prmS2x;
    double Deltasigmastar2_prmS2x = sigma2*sigmacoeff_prmS2x + sigmastar2*sigmastarcoeff_prmS2x;
    double Deltasigmastar1_prmS2x = sigma1*sigmacoeff_prmS2x + sigma1_prmS2x*sigmacoeff + sigmastar1*sigmastarcoeff_prmS2x + sigmastar1_prmS2x*sigmastarcoeff;
    double Sstar3_prmS2x = Deltasigmastar3_prmS2x;
    double Sstar2_prmS2x = Deltasigmastar2_prmS2x;
    double Sstar1_prmS2x = Deltasigmastar1_prmS2x + sigmastar1_prmS2x;
    double S3_prmS2x = Sstar3_prmS2x;
    double S2_prmS2x = Sstar2_prmS2x;
    double S1_prmS2x = Sstar1_prmS2x;
    double Sstardotn_prmS2x = Sstar1_prmS2x*n1 + Sstar2_prmS2x*n2 + Sstar3_prmS2x*n3;
    double SdotSkerrhat_prmS2x = S1*Skerrhat1_prmS2x + S1_prmS2x*Skerrhat1 + S2*Skerrhat2_prmS2x + S2_prmS2x*Skerrhat2 + S3*Skerrhat3_prmS2x + S3_prmS2x*Skerrhat3;
    double Sdotn_prmS2x = S1_prmS2x*n1 + S2_prmS2x*n2 + S3_prmS2x*n3;
    double Sdotv_prmS2x = S1*v1_prmS2x + S1_prmS2x*v1 + S2*v2_prmS2x + S2_prmS2x*v2 + S3*v3_prmS2x + S3_prmS2x*v3;
    double Sdotxi_prmS2x = S1*xi1_prmS2x + S1_prmS2x*xi1 + S2*xi2_prmS2x + S2_prmS2x*xi2 + S3*xi3_prmS2x + S3_prmS2x*xi3;
    double HdsumTerm2_prmS2x = 6*Sstardotn*Sstardotn_prmS2x;
    double HdsumTerm1_prmS2x = 2*Sstar1*Sstar1_prmS2x + 2*Sstar2*Sstar2_prmS2x + 2*Sstar3*Sstar3_prmS2x;
    double Hdsum_prmS2x = HdsumTerm1_prmS2x - HdsumTerm2_prmS2x;
    double Q4_prmS2x = eta*pow(prT, 3)*prT_prmS2x*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmS2x = 2*Deltar*pdotn*pdotn_prmS2x/Sigma - Deltar*Sigma_prmS2x*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS2x*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmS2x/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmS2x/(Sigma*sin2theta) - Sigma_prmS2x*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmS2x/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmS2x/(Lambt*sin2theta) + Sigma_prmS2x*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmS2x*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmS2x = Q4_prmS2x + gammappsum_prmS2x;
    double alpha_prmS2x = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmS2x/Lambt - 1.0/2.0*Deltat*Lambt_prmS2x*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmS2x*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmS2x = omegatilde*pphi_prmS2x/Lambt + omegatilde_prmS2x*pphi/Lambt - Lambt_prmS2x*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmS2x = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmS2x - 1.0/2.0*Q_prmS2x/sqrt(Q)) + Sdotn*exp2mu*xisq_prmS2x*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmS2x*xisq*(-sqrt(Q) - Q) + Sdotn_prmS2x*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmS2x - Jtilde*Sdotv_prmS2x*pdotn - Jtilde_prmS2x*Sdotv*pdotn + Sdotn*pdotvr_prmS2x + Sdotn_prmS2x*pdotvr) + pdotvr_prmS2x*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmS2x*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmS2x + Btilde*Jtilde*Sdotxi_prmS2x*pdotn + Btilde*Jtilde_prmS2x*Sdotxi*pdotn + Btilde_prmS2x*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmS2x - Sdotn*expmu*expnu_prmS2x*pdotxir - Sdotn*expmu_prmS2x*expnu*pdotxir - Sdotn_prmS2x*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmS2x*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmS2x*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmS2x*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmS2x = (1.0/2.0)*omegacostheta*(-Q_prmS2x - 1.0/2.0*Q_prmS2x/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmS2x/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmS2x*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmS2x*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmS2x*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmS2x*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmS2x = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmS2x - Jtilde*Sdotv_prmS2x*pdotn - Jtilde_prmS2x*Sdotv*pdotn + Sdotn*pdotvr_prmS2x + Sdotn_prmS2x*pdotvr) + Jtilde*pdotn_prmS2x*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmS2x*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmS2x + (1.0/2.0)*Q_prmS2x/sqrt(Q)) + Sdotv*exp2mu_prmS2x*(sqrt(Q) + Q) + Sdotv_prmS2x*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmS2x*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmS2x*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmS2x - Btilde*Sdotxi*expnu_prmS2x*pdotvr - Btilde*Sdotxi_prmS2x*expnu*pdotvr - Btilde_prmS2x*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmS2x + Sdotv*exp2nu*expmu_prmS2x*pdotxir + Sdotv*exp2nu_prmS2x*expmu*pdotxir + Sdotv_prmS2x*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmS2x*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmS2x*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmS2x = (1.0/2.0)*Jtilde*omegar*(-Q_prmS2x - 1.0/2.0*Q_prmS2x/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmS2x/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmS2x/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmS2x*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmS2x*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmS2x*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmS2x*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmS2x*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmS2x = SdotSkerrhat*omega_prmS2x + SdotSkerrhat_prmS2x*omega;
    double Hss_prmS2x = HssTerm1_prmS2x + HssTerm2*HssTerm2coeff_prmS2x + HssTerm2_prmS2x*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmS2x + HssTerm3_prmS2x*HssTerm3coeff;
    double HsoTerm2c_prmS2x = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmS2x*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmS2x*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmS2x*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmS2x*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmS2x*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmS2x*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmS2x*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmS2x = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmS2x + Jtilde*Sdotv_prmS2x*nur + Jtilde_prmS2x*Sdotv*nur - Sdotn*nucostheta*xisq_prmS2x - Sdotn*nucostheta_prmS2x*xisq - Sdotn_prmS2x*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmS2x*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmS2x*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmS2x*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmS2x*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmS2x*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmS2x = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmS2x + nur_prmS2x*pdotvr + pdotn*xisq*(mucostheta_prmS2x - nucostheta_prmS2x) + pdotn*xisq_prmS2x*(mucostheta - nucostheta) + pdotn_prmS2x*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmS2x - mucostheta*pdotn_prmS2x*xisq - mucostheta_prmS2x*pdotn*xisq + mur*pdotvr_prmS2x*(sqrt(Q) + 1) + mur_prmS2x*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmS2x*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmS2x*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmS2x*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmS2x*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmS2x*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmS2x = HsoTerm2a_prmS2x + HsoTerm2b_prmS2x - HsoTerm2c_prmS2x;
    double HsoTerm2coeff_prmS2x = expnu*(-Q_prmS2x - 1.0/2.0*Q_prmS2x/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmS2x/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmS2x/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmS2x*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmS2x*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmS2x = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmS2x + expmu*expnu_prmS2x + expmu_prmS2x*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmS2x*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmS2x*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmS2x*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmS2x*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmS2x*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmS2x*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmS2x*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmS2x = HsoTerm1_prmS2x + HsoTerm2*HsoTerm2coeff_prmS2x + HsoTerm2_prmS2x*HsoTerm2coeff;
    double Hd_prmS2x = Hdcoeff*Hdsum_prmS2x;
    double Hns_prmS2x = sqrt(Hnsradicand)*alpha_prmS2x + betapsum_prmS2x + (1.0/2.0)*Hnsradicand_prmS2x*alpha/sqrt(Hnsradicand);
    double Hs_prmS2x = Hso_prmS2x + Hss_prmS2x;
    double dSS_prmS2x = 1585.5329999999999*pow(chi, 2)*chi_prmS2x*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmS2x*eta + 2323.5599999999999*chi*chi_prmS2x*pow(eta, 3) - 652.64999999999998*chi*chi_prmS2x*pow(eta, 2) + 37.196399999999997*chi_prmS2x*eta;
    double Heff_prmS2x = -Hd_prmS2x + Hns_prmS2x + Hs_prmS2x + 2*S2x*dSS*eta*pow(u, 4) + dSS_prmS2x*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmS2x = Heff_prmS2x*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double sigmastar2_prmS2y = m1/m2;
    double sigma2_prmS2y = 1;
    double Skerr2_prmS2y = sigma2_prmS2y;
    double Skerrmag_prmS2y = Skerr2*Skerr2_prmS2y/sqrt(pow(Skerr1, 2) + pow(Skerr2, 2) + pow(Skerr3, 2));
    double Skerrhat3_prmS2y = -Skerr3*Skerrmag_prmS2y/pow(Skerrmag, 2);
    double Skerrhat2_prmS2y = -Skerr2*Skerrmag_prmS2y/pow(Skerrmag, 2) + Skerr2_prmS2y/Skerrmag;
    double Skerrhat1_prmS2y = -Skerr1*Skerrmag_prmS2y/pow(Skerrmag, 2);
    double a_prmS2y = Skerrmag_prmS2y;
    double S2dotLhat_prmS2y = Lhat2;
    double S2perp3_prmS2y = -Lhat3*S2dotLhat_prmS2y;
    double S2perp2_prmS2y = -Lhat2*S2dotLhat_prmS2y + 1;
    double S2perp1_prmS2y = -Lhat1*S2dotLhat_prmS2y;
    double Sperp3_prmS2y = S2perp3_prmS2y;
    double Sperp2_prmS2y = S2perp2_prmS2y;
    double Sperp1_prmS2y = S2perp1_prmS2y;
    double e33_prmS2y = Skerrhat3_prmS2y;
    double e32_prmS2y = Skerrhat2_prmS2y;
    double e31_prmS2y = Skerrhat1_prmS2y;
    double xi3_prmS2y = e31_prmS2y*n2 - e32_prmS2y*n1;
    double xi2_prmS2y = -e31_prmS2y*n3 + e33_prmS2y*n1;
    double xi1_prmS2y = e32_prmS2y*n3 - e33_prmS2y*n2;
    double v3_prmS2y = n1*xi2_prmS2y - n2*xi1_prmS2y;
    double v2_prmS2y = -n1*xi3_prmS2y + n3*xi1_prmS2y;
    double v1_prmS2y = n2*xi3_prmS2y - n3*xi2_prmS2y;
    double costheta_prmS2y = e31_prmS2y*n1 + e32_prmS2y*n2 + e33_prmS2y*n3;
    double sin2theta_prmS2y = -2*costheta*costheta_prmS2y;
    double xisq_prmS2y = sin2theta_prmS2y;
    double w2_prmS2y = 2*a*a_prmS2y;
    double Sigma_prmS2y = 2*pow(a, 2)*costheta*costheta_prmS2y + 2*a*a_prmS2y*pow(costheta, 2);
    double omegatilde_prmS2y = 2*a_prmS2y*r;
    double chi_prmS2y = Lhat2*Skerr2_prmS2y/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmS2y + (1.0/2.0)*Skerr2*Sperp2_prmS2y + (1.0/2.0)*Skerr2_prmS2y*Sperp2 + (1.0/2.0)*Skerr3*Sperp3_prmS2y)/(Skerrmag*(1.0 - 2.0*eta)) - Skerrmag_prmS2y*((1.0/2.0)*Skerr1*Sperp1 + (1.0/2.0)*Skerr2*Sperp2 + (1.0/2.0)*Skerr3*Sperp3)/(pow(Skerrmag, 2)*(1.0 - 2.0*eta));
    double K_prmS2y = -177.4974*pow(chi, 2)*chi_prmS2y*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmS2y*eta + 4.3097700000000003*pow(chi, 2)*chi_prmS2y + 62.349200000000003*chi*chi_prmS2y*pow(eta, 3) + 12.329319999999999*chi*chi_prmS2y*pow(eta, 2) - 2.76172*chi*chi_prmS2y - 27.520099999999999*chi_prmS2y*pow(eta, 3) + 17.3736*chi_prmS2y*pow(eta, 2) + 2.26831*chi_prmS2y*eta - 1.6204499999999999*chi_prmS2y;
    double etaKminus1_prmS2y = K_prmS2y*eta;
    double Delta0_prmS2y = K*K_prmS2y*eta + K_prmS2y*(K*eta - 2);
    double Delta1_prmS2y = etaKminus1*(-2*Delta0_prmS2y - 2*K_prmS2y) + etaKminus1_prmS2y*(-2*Delta0 - 2*K);
    double Delta2_prmS2y = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmS2y - 2*Delta0*a*a_prmS2y*pow(etaKminus1, 2) - Delta0_prmS2y*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmS2y - 2*etaKminus1_prmS2y) + Delta1_prmS2y*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmS2y = -pow(Delta1, 2)*Delta1_prmS2y + pow(Delta1, 2)*etaKminus1_prmS2y + 2*Delta1*Delta1_prmS2y*etaKminus1 + Delta1*Delta2_prmS2y - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmS2y - 2*Delta1*a*a_prmS2y*pow(etaKminus1, 2) + Delta1_prmS2y*Delta2 - Delta1_prmS2y*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmS2y + 2*etaKminus1_prmS2y) + etaKminus1_prmS2y*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmS2y = pow(Delta1, 3)*Delta1_prmS2y - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmS2y - 2*pow(Delta1, 2)*Delta1_prmS2y*etaKminus1 - pow(Delta1, 2)*Delta2_prmS2y - 2*Delta1*Delta1_prmS2y*Delta2 + Delta1*(2*Delta2*etaKminus1_prmS2y + 2*Delta2_prmS2y*etaKminus1 + Delta3_prmS2y) + Delta1_prmS2y*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmS2y - 2*Delta3*etaKminus1_prmS2y - 2*Delta3_prmS2y*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmS2y - 2*Delta2_prmS2y) + pow(a, 2)*etaKminus1*etaKminus1_prmS2y*(pow(Delta1, 2) - 2*Delta2) + a*a_prmS2y*pow(etaKminus1, 2)*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmS2y*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmS2y = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmS2y - 3*Delta1*Delta2_prmS2y - 3*Delta1_prmS2y*Delta2 + 3*Delta3_prmS2y) + (1.0/3.0)*a*a_prmS2y*(-2*pow(Delta1, 3) + 6*Delta1*Delta2 - 6*Delta3) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmS2y - 4*pow(Delta1, 2)*Delta2_prmS2y - 8*Delta1*Delta1_prmS2y*Delta2 + 4*Delta1*Delta3_prmS2y + 4*Delta1_prmS2y*Delta3 + 4*Delta2*Delta2_prmS2y - 4*Delta4_prmS2y)/etaKminus1 - 1.0/2.0*etaKminus1_prmS2y*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmS2y - 5*pow(Delta1, 3)*Delta2_prmS2y - 15*pow(Delta1, 2)*Delta1_prmS2y*Delta2 + 5*pow(Delta1, 2)*Delta3_prmS2y + 10*Delta1*Delta1_prmS2y*Delta3 + 10*Delta1*Delta2*Delta2_prmS2y - 5*Delta1*Delta4_prmS2y + 5*Delta1_prmS2y*pow(Delta2, 2) - 5*Delta1_prmS2y*Delta4 - 5*Delta2*Delta3_prmS2y - 5*Delta2_prmS2y*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmS2y*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmS2y*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmS2y = (128.0/5.0)*etaKminus1*etaKminus1_prmS2y;
    double logarg_prmS2y = u*(Delta1_prmS2y + u*(Delta2_prmS2y + u*(Delta3_prmS2y + u*(Delta4_prmS2y + u*(Delta5_prmS2y + Delta5l_prmS2y*log(u))))));
    double Deltaucalib_prmS2y = eta*(Delta0_prmS2y + logarg_prmS2y*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmS2y = eta*logarg_prmS2y*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmS2y + u*(2*Delta2_prmS2y + u*(3*Delta3_prmS2y + u*(4*Delta4_prmS2y + u*(5*Delta5_prmS2y + 5*Delta5l_prmS2y*log(u))))))/(logarg + 1);
    double Deltaubar_prmS2y = 2*a*a_prmS2y*pow(u, 2) + etaKminus1_prmS2y*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmS2y/pow(etaKminus1, 3);
    double Deltaubarprime_prmS2y = -4*a*a_prmS2y*pow(u, 3) + 2*etaKminus1_prmS2y*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmS2y = (Deltaubar*Deltaucalib_prmS2y + Deltaubar_prmS2y*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmS2y = Deltaubar*Deltaucalibprime_prmS2y + Deltaubar_prmS2y*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmS2y + Deltaubarprime_prmS2y*Deltaucalib;
    double Deltatprime_prmS2y = 2*Deltau_prmS2y*r + Deltauprime_prmS2y*pow(r, 2);
    double Deltat_prmS2y = Deltau_prmS2y*pow(r, 2);
    double Deltar_prmS2y = Deltat_prmS2y*Dinv;
    double Lambt_prmS2y = (Deltat*pow(a, 2)*sin2theta_prmS2y + 2*Deltat*a*a_prmS2y*sin2theta + Deltat_prmS2y*pow(a, 2)*sin2theta - 2*w2*w2_prmS2y)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmS2y = (1.0/2.0)*(Deltar*Deltat_prmS2y + Deltar_prmS2y*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmS2y*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmS2y = csi_prmS2y*(1 - fabs((double)tortoise - 1));
    double csi2_prmS2y = csi_prmS2y*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmS2y = csi2_prmS2y*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmS2y = n3*prT_prmS2y*(-1 + 1.0/csi1) - csi1_prmS2y*n3*prT/pow(csi1, 2);
    double phat2_prmS2y = n2*prT_prmS2y*(-1 + 1.0/csi1) - csi1_prmS2y*n2*prT/pow(csi1, 2);
    double phat1_prmS2y = n1*prT_prmS2y*(-1 + 1.0/csi1) - csi1_prmS2y*n1*prT/pow(csi1, 2);
    double pdotxir_prmS2y = r*(phat1*xi1_prmS2y + phat1_prmS2y*xi1 + phat2*xi2_prmS2y + phat2_prmS2y*xi2 + phat3*xi3_prmS2y + phat3_prmS2y*xi3);
    double pdotn_prmS2y = n1*phat1_prmS2y + n2*phat2_prmS2y + n3*phat3_prmS2y;
    double pdotvr_prmS2y = r*(phat1*v1_prmS2y + phat1_prmS2y*v1 + phat2*v2_prmS2y + phat2_prmS2y*v2 + phat3*v3_prmS2y + phat3_prmS2y*v3);
    double pphi_prmS2y = pdotxir_prmS2y;
    double Qcoeff2_prmS2y = -sin2theta_prmS2y/(Sigma*pow(sin2theta, 2)) - Sigma_prmS2y/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmS2y = -Sigma*sin2theta_prmS2y/(Lambt*pow(sin2theta, 2)) + Sigma_prmS2y/(Lambt*sin2theta) - Lambt_prmS2y*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmS2y = 2*Deltar*pdotn*pdotn_prmS2y/Sigma - Deltar*Sigma_prmS2y*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS2y*pow(pdotn, 2)/Sigma;
    double Q_prmS2y = DrSipn2_prmS2y + 2*Qcoeff1*pdotxir*pdotxir_prmS2y + Qcoeff1_prmS2y*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmS2y + Qcoeff2_prmS2y*pow(pdotvr, 2);
    double Qminus1_prmS2y = Q_prmS2y;
    double Jtilde_prmS2y = (1.0/2.0)*Deltar_prmS2y/sqrt(Deltar);
    double exp2mu_prmS2y = Sigma_prmS2y;
    double expmu_prmS2y = (1.0/2.0)*exp2mu_prmS2y/sqrt(exp2mu);
    double Brtilde_prmS2y = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmS2y - 2*Deltat_prmS2y + (1.0/2.0)*Deltar_prmS2y*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmS2y - 1.0/2.0*Deltar_prmS2y*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmS2y = (1.0/2.0)*Deltat_prmS2y/sqrt(Deltat);
    double exp2nu_prmS2y = Deltat*Sigma_prmS2y/Lambt - Deltat*Lambt_prmS2y*Sigma/pow(Lambt, 2) + Deltat_prmS2y*Sigma/Lambt;
    double expnu_prmS2y = (1.0/2.0)*exp2nu_prmS2y/sqrt(exp2nu);
    double omega_prmS2y = omegatilde_prmS2y/Lambt - Lambt_prmS2y*omegatilde/pow(Lambt, 2);
    double omegatildeprime_prmS2y = 2*a_prmS2y;
    double Lambtprime_prmS2y = -Deltatprime*pow(a, 2)*sin2theta_prmS2y - 2*Deltatprime*a*a_prmS2y*sin2theta - Deltatprime_prmS2y*pow(a, 2)*sin2theta + 8*a*a_prmS2y*r;
    double mucostheta_prmS2y = pow(a, 2)*costheta_prmS2y/Sigma + 2*a*a_prmS2y*costheta/Sigma - Sigma_prmS2y*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmS2y = pow(a, 2)*costheta*w2*(-Deltat_prmS2y + w2_prmS2y)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmS2y*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmS2y*w2*(-Deltat + w2)/(Lambt*Sigma) + a*a_prmS2y*costheta*w2*(-2*Deltat + 2*w2)/(Lambt*Sigma) - Sigma_prmS2y*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmS2y*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmS2y = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmS2y/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmS2y*omegatilde/pow(Lambt, 2) - 4*Deltat*a*a_prmS2y*costheta*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmS2y*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmS2y*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmS2y = -Sigma_prmS2y*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmS2y/pow(Deltar, 3.0/2.0);
    double nur_prmS2y = -Sigma_prmS2y*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat_prmS2y*r + Deltatprime*w2_prmS2y + Deltatprime_prmS2y*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmS2y*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmS2y*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmS2y*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmS2y = (Lambt*omegatildeprime_prmS2y + Lambt_prmS2y*omegatildeprime - Lambtprime*omegatilde_prmS2y - Lambtprime_prmS2y*omegatilde)/pow(Lambt, 2) + Lambt_prmS2y*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmS2y = 442.44299999999998*pow(chi, 2)*chi_prmS2y*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmS2y*eta + 198.59610000000001*pow(chi, 2)*chi_prmS2y - 686.62599999999998*chi*chi_prmS2y*eta + 2495.29*chi_prmS2y*pow(eta, 2);
    double sigmacoeffTerm3_prmS2y = dSO_prmS2y*eta*pow(u, 3);
    double sigmacoeffTerm2_prmS2y = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmS2y + 204*Qminus1_prmS2y + r*(1620*DrSipn2*DrSipn2_prmS2y - 234*DrSipn2*Qminus1_prmS2y - 234*DrSipn2_prmS2y*Qminus1)) + r*(-96*DrSipn2_prmS2y - 436*Qminus1_prmS2y + r*(36*DrSipn2*Qminus1_prmS2y + 36*DrSipn2_prmS2y*Qminus1 - 90*Qminus1*Qminus1_prmS2y)))/pow(r, 2);
    double sigmacoeffTerm1_prmS2y = eta*(-3*DrSipn2_prmS2y + (1.0/4.0)*Qminus1_prmS2y);
    double sigmacoeff_prmS2y = sigmacoeffTerm1_prmS2y + sigmacoeffTerm2_prmS2y + sigmacoeffTerm3_prmS2y;
    double sigmastarcoeffTerm2_prmS2y = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmS2y + 120*Qminus1_prmS2y + r*(720*DrSipn2*DrSipn2_prmS2y + Qminus1*(-126*DrSipn2_prmS2y - 3*Qminus1_prmS2y) + Qminus1_prmS2y*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmS2y + Qminus1*r*(96*DrSipn2_prmS2y - 23*Qminus1_prmS2y) + Qminus1_prmS2y*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmS2y))/pow(r, 2);
    double sigmastarcoeffTerm1_prmS2y = eta*(-5.0/2.0*DrSipn2_prmS2y + (1.0/3.0)*Qminus1_prmS2y);
    double sigmastarcoeff_prmS2y = sigmastarcoeffTerm1_prmS2y + sigmastarcoeffTerm2_prmS2y;
    double Deltasigmastar3_prmS2y = sigma3*sigmacoeff_prmS2y + sigmastar3*sigmastarcoeff_prmS2y;
    double Deltasigmastar2_prmS2y = sigma2*sigmacoeff_prmS2y + sigma2_prmS2y*sigmacoeff + sigmastar2*sigmastarcoeff_prmS2y + sigmastar2_prmS2y*sigmastarcoeff;
    double Deltasigmastar1_prmS2y = sigma1*sigmacoeff_prmS2y + sigmastar1*sigmastarcoeff_prmS2y;
    double Sstar3_prmS2y = Deltasigmastar3_prmS2y;
    double Sstar2_prmS2y = Deltasigmastar2_prmS2y + sigmastar2_prmS2y;
    double Sstar1_prmS2y = Deltasigmastar1_prmS2y;
    double S3_prmS2y = Sstar3_prmS2y;
    double S2_prmS2y = Sstar2_prmS2y;
    double S1_prmS2y = Sstar1_prmS2y;
    double Sstardotn_prmS2y = Sstar1_prmS2y*n1 + Sstar2_prmS2y*n2 + Sstar3_prmS2y*n3;
    double SdotSkerrhat_prmS2y = S1*Skerrhat1_prmS2y + S1_prmS2y*Skerrhat1 + S2*Skerrhat2_prmS2y + S2_prmS2y*Skerrhat2 + S3*Skerrhat3_prmS2y + S3_prmS2y*Skerrhat3;
    double Sdotn_prmS2y = S1_prmS2y*n1 + S2_prmS2y*n2 + S3_prmS2y*n3;
    double Sdotv_prmS2y = S1*v1_prmS2y + S1_prmS2y*v1 + S2*v2_prmS2y + S2_prmS2y*v2 + S3*v3_prmS2y + S3_prmS2y*v3;
    double Sdotxi_prmS2y = S1*xi1_prmS2y + S1_prmS2y*xi1 + S2*xi2_prmS2y + S2_prmS2y*xi2 + S3*xi3_prmS2y + S3_prmS2y*xi3;
    double HdsumTerm2_prmS2y = 6*Sstardotn*Sstardotn_prmS2y;
    double HdsumTerm1_prmS2y = 2*Sstar1*Sstar1_prmS2y + 2*Sstar2*Sstar2_prmS2y + 2*Sstar3*Sstar3_prmS2y;
    double Hdsum_prmS2y = HdsumTerm1_prmS2y - HdsumTerm2_prmS2y;
    double Q4_prmS2y = eta*pow(prT, 3)*prT_prmS2y*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmS2y = 2*Deltar*pdotn*pdotn_prmS2y/Sigma - Deltar*Sigma_prmS2y*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS2y*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmS2y/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmS2y/(Sigma*sin2theta) - Sigma_prmS2y*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmS2y/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmS2y/(Lambt*sin2theta) + Sigma_prmS2y*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmS2y*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmS2y = Q4_prmS2y + gammappsum_prmS2y;
    double alpha_prmS2y = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmS2y/Lambt - 1.0/2.0*Deltat*Lambt_prmS2y*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmS2y*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmS2y = omegatilde*pphi_prmS2y/Lambt + omegatilde_prmS2y*pphi/Lambt - Lambt_prmS2y*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmS2y = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmS2y - 1.0/2.0*Q_prmS2y/sqrt(Q)) + Sdotn*exp2mu*xisq_prmS2y*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmS2y*xisq*(-sqrt(Q) - Q) + Sdotn_prmS2y*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmS2y - Jtilde*Sdotv_prmS2y*pdotn - Jtilde_prmS2y*Sdotv*pdotn + Sdotn*pdotvr_prmS2y + Sdotn_prmS2y*pdotvr) + pdotvr_prmS2y*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmS2y*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmS2y + Btilde*Jtilde*Sdotxi_prmS2y*pdotn + Btilde*Jtilde_prmS2y*Sdotxi*pdotn + Btilde_prmS2y*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmS2y - Sdotn*expmu*expnu_prmS2y*pdotxir - Sdotn*expmu_prmS2y*expnu*pdotxir - Sdotn_prmS2y*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmS2y*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmS2y*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmS2y*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmS2y = (1.0/2.0)*omegacostheta*(-Q_prmS2y - 1.0/2.0*Q_prmS2y/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmS2y/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmS2y*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmS2y*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmS2y*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmS2y*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmS2y = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmS2y - Jtilde*Sdotv_prmS2y*pdotn - Jtilde_prmS2y*Sdotv*pdotn + Sdotn*pdotvr_prmS2y + Sdotn_prmS2y*pdotvr) + Jtilde*pdotn_prmS2y*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmS2y*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmS2y + (1.0/2.0)*Q_prmS2y/sqrt(Q)) + Sdotv*exp2mu_prmS2y*(sqrt(Q) + Q) + Sdotv_prmS2y*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmS2y*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmS2y*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmS2y - Btilde*Sdotxi*expnu_prmS2y*pdotvr - Btilde*Sdotxi_prmS2y*expnu*pdotvr - Btilde_prmS2y*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmS2y + Sdotv*exp2nu*expmu_prmS2y*pdotxir + Sdotv*exp2nu_prmS2y*expmu*pdotxir + Sdotv_prmS2y*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmS2y*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmS2y*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmS2y = (1.0/2.0)*Jtilde*omegar*(-Q_prmS2y - 1.0/2.0*Q_prmS2y/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmS2y/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmS2y/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmS2y*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmS2y*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmS2y*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmS2y*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmS2y*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmS2y = SdotSkerrhat*omega_prmS2y + SdotSkerrhat_prmS2y*omega;
    double Hss_prmS2y = HssTerm1_prmS2y + HssTerm2*HssTerm2coeff_prmS2y + HssTerm2_prmS2y*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmS2y + HssTerm3_prmS2y*HssTerm3coeff;
    double HsoTerm2c_prmS2y = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmS2y*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmS2y*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmS2y*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmS2y*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmS2y*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmS2y*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmS2y*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmS2y = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmS2y + Jtilde*Sdotv_prmS2y*nur + Jtilde_prmS2y*Sdotv*nur - Sdotn*nucostheta*xisq_prmS2y - Sdotn*nucostheta_prmS2y*xisq - Sdotn_prmS2y*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmS2y*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmS2y*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmS2y*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmS2y*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmS2y*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmS2y = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmS2y + nur_prmS2y*pdotvr + pdotn*xisq*(mucostheta_prmS2y - nucostheta_prmS2y) + pdotn*xisq_prmS2y*(mucostheta - nucostheta) + pdotn_prmS2y*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmS2y - mucostheta*pdotn_prmS2y*xisq - mucostheta_prmS2y*pdotn*xisq + mur*pdotvr_prmS2y*(sqrt(Q) + 1) + mur_prmS2y*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmS2y*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmS2y*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmS2y*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmS2y*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmS2y*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmS2y = HsoTerm2a_prmS2y + HsoTerm2b_prmS2y - HsoTerm2c_prmS2y;
    double HsoTerm2coeff_prmS2y = expnu*(-Q_prmS2y - 1.0/2.0*Q_prmS2y/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmS2y/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmS2y/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmS2y*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmS2y*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmS2y = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmS2y + expmu*expnu_prmS2y + expmu_prmS2y*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmS2y*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmS2y*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmS2y*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmS2y*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmS2y*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmS2y*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmS2y*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmS2y = HsoTerm1_prmS2y + HsoTerm2*HsoTerm2coeff_prmS2y + HsoTerm2_prmS2y*HsoTerm2coeff;
    double Hd_prmS2y = Hdcoeff*Hdsum_prmS2y;
    double Hns_prmS2y = sqrt(Hnsradicand)*alpha_prmS2y + betapsum_prmS2y + (1.0/2.0)*Hnsradicand_prmS2y*alpha/sqrt(Hnsradicand);
    double Hs_prmS2y = Hso_prmS2y + Hss_prmS2y;
    double dSS_prmS2y = 1585.5329999999999*pow(chi, 2)*chi_prmS2y*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmS2y*eta + 2323.5599999999999*chi*chi_prmS2y*pow(eta, 3) - 652.64999999999998*chi*chi_prmS2y*pow(eta, 2) + 37.196399999999997*chi_prmS2y*eta;
    double Heff_prmS2y = -Hd_prmS2y + Hns_prmS2y + Hs_prmS2y + 2*S2y*dSS*eta*pow(u, 4) + dSS_prmS2y*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmS2y = Heff_prmS2y*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);

    double sigmastar3_prmS2z = m1/m2;
    double sigma3_prmS2z = 1;
    double Skerr3_prmS2z = sigma3_prmS2z;
    double Skerrmag_prmS2z = Skerr3*Skerr3_prmS2z/sqrt(pow(Skerr1, 2) + pow(Skerr2, 2) + pow(Skerr3, 2));
    double Skerrhat3_prmS2z = -Skerr3*Skerrmag_prmS2z/pow(Skerrmag, 2) + Skerr3_prmS2z/Skerrmag;
    double Skerrhat2_prmS2z = -Skerr2*Skerrmag_prmS2z/pow(Skerrmag, 2);
    double Skerrhat1_prmS2z = -Skerr1*Skerrmag_prmS2z/pow(Skerrmag, 2);
    double a_prmS2z = Skerrmag_prmS2z;
    double S2dotLhat_prmS2z = Lhat3;
    double S2perp3_prmS2z = -Lhat3*S2dotLhat_prmS2z + 1;
    double S2perp2_prmS2z = -Lhat2*S2dotLhat_prmS2z;
    double S2perp1_prmS2z = -Lhat1*S2dotLhat_prmS2z;
    double Sperp3_prmS2z = S2perp3_prmS2z;
    double Sperp2_prmS2z = S2perp2_prmS2z;
    double Sperp1_prmS2z = S2perp1_prmS2z;
    double e33_prmS2z = Skerrhat3_prmS2z;
    double e32_prmS2z = Skerrhat2_prmS2z;
    double e31_prmS2z = Skerrhat1_prmS2z;
    double xi3_prmS2z = e31_prmS2z*n2 - e32_prmS2z*n1;
    double xi2_prmS2z = -e31_prmS2z*n3 + e33_prmS2z*n1;
    double xi1_prmS2z = e32_prmS2z*n3 - e33_prmS2z*n2;
    double v3_prmS2z = n1*xi2_prmS2z - n2*xi1_prmS2z;
    double v2_prmS2z = -n1*xi3_prmS2z + n3*xi1_prmS2z;
    double v1_prmS2z = n2*xi3_prmS2z - n3*xi2_prmS2z;
    double costheta_prmS2z = e31_prmS2z*n1 + e32_prmS2z*n2 + e33_prmS2z*n3;
    double sin2theta_prmS2z = -2*costheta*costheta_prmS2z;
    double xisq_prmS2z = sin2theta_prmS2z;
    double w2_prmS2z = 2*a*a_prmS2z;
    double Sigma_prmS2z = 2*pow(a, 2)*costheta*costheta_prmS2z + 2*a*a_prmS2z*pow(costheta, 2);
    double omegatilde_prmS2z = 2*a_prmS2z*r;
    double chi_prmS2z = Lhat3*Skerr3_prmS2z/(1 - 2*eta) + ((1.0/2.0)*Skerr1*Sperp1_prmS2z + (1.0/2.0)*Skerr2*Sperp2_prmS2z + (1.0/2.0)*Skerr3*Sperp3_prmS2z + (1.0/2.0)*Skerr3_prmS2z*Sperp3)/(Skerrmag*(1.0 - 2.0*eta)) - Skerrmag_prmS2z*((1.0/2.0)*Skerr1*Sperp1 + (1.0/2.0)*Skerr2*Sperp2 + (1.0/2.0)*Skerr3*Sperp3)/(pow(Skerrmag, 2)*(1.0 - 2.0*eta));
    double K_prmS2z = -177.4974*pow(chi, 2)*chi_prmS2z*pow(eta, 3) - 1.2808740000000001*pow(chi, 2)*chi_prmS2z*eta + 4.3097700000000003*pow(chi, 2)*chi_prmS2z + 62.349200000000003*chi*chi_prmS2z*pow(eta, 3) + 12.329319999999999*chi*chi_prmS2z*pow(eta, 2) - 2.76172*chi*chi_prmS2z - 27.520099999999999*chi_prmS2z*pow(eta, 3) + 17.3736*chi_prmS2z*pow(eta, 2) + 2.26831*chi_prmS2z*eta - 1.6204499999999999*chi_prmS2z;
    double etaKminus1_prmS2z = K_prmS2z*eta;
    double Delta0_prmS2z = K*K_prmS2z*eta + K_prmS2z*(K*eta - 2);
    double Delta1_prmS2z = etaKminus1*(-2*Delta0_prmS2z - 2*K_prmS2z) + etaKminus1_prmS2z*(-2*Delta0 - 2*K);
    double Delta2_prmS2z = -2*Delta0*pow(a, 2)*etaKminus1*etaKminus1_prmS2z - 2*Delta0*a*a_prmS2z*pow(etaKminus1, 2) - Delta0_prmS2z*pow(a, 2)*pow(etaKminus1, 2) + Delta1*((1.0/2.0)*Delta1_prmS2z - 2*etaKminus1_prmS2z) + Delta1_prmS2z*((1.0/2.0)*Delta1 - 2*etaKminus1);
    double Delta3_prmS2z = -pow(Delta1, 2)*Delta1_prmS2z + pow(Delta1, 2)*etaKminus1_prmS2z + 2*Delta1*Delta1_prmS2z*etaKminus1 + Delta1*Delta2_prmS2z - 2*Delta1*pow(a, 2)*etaKminus1*etaKminus1_prmS2z - 2*Delta1*a*a_prmS2z*pow(etaKminus1, 2) + Delta1_prmS2z*Delta2 - Delta1_prmS2z*pow(a, 2)*pow(etaKminus1, 2) + etaKminus1*(-2*Delta2_prmS2z + 2*etaKminus1_prmS2z) + etaKminus1_prmS2z*(-2*Delta2 + 2*etaKminus1);
    double Delta4_prmS2z = pow(Delta1, 3)*Delta1_prmS2z - 2.0/3.0*pow(Delta1, 3)*etaKminus1_prmS2z - 2*pow(Delta1, 2)*Delta1_prmS2z*etaKminus1 - pow(Delta1, 2)*Delta2_prmS2z - 2*Delta1*Delta1_prmS2z*Delta2 + Delta1*(2*Delta2*etaKminus1_prmS2z + 2*Delta2_prmS2z*etaKminus1 + Delta3_prmS2z) + Delta1_prmS2z*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmS2z - 2*Delta3*etaKminus1_prmS2z - 2*Delta3_prmS2z*etaKminus1 + (1.0/2.0)*pow(a, 2)*pow(etaKminus1, 2)*(2*Delta1*Delta1_prmS2z - 2*Delta2_prmS2z) + pow(a, 2)*etaKminus1*etaKminus1_prmS2z*(pow(Delta1, 2) - 2*Delta2) + a*a_prmS2z*pow(etaKminus1, 2)*(pow(Delta1, 2) - 2*Delta2) + (1.0/6.0)*etaKminus1*etaKminus1_prmS2z*(376 - 123.0/8.0*pow(M_PI, 2));
    double Delta5_prmS2z = pow(etaKminus1, 2)*(-1.0/3.0*pow(a, 2)*(3*pow(Delta1, 2)*Delta1_prmS2z - 3*Delta1*Delta2_prmS2z - 3*Delta1_prmS2z*Delta2 + 3*Delta3_prmS2z) + (1.0/3.0)*a*a_prmS2z*(-2*pow(Delta1, 3) + 6*Delta1*Delta2 - 6*Delta3) + (1.0/2.0)*(4*pow(Delta1, 3)*Delta1_prmS2z - 4*pow(Delta1, 2)*Delta2_prmS2z - 8*Delta1*Delta1_prmS2z*Delta2 + 4*Delta1*Delta3_prmS2z + 4*Delta1_prmS2z*Delta3 + 4*Delta2*Delta2_prmS2z - 4*Delta4_prmS2z)/etaKminus1 - 1.0/2.0*etaKminus1_prmS2z*(pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/pow(etaKminus1, 2) - 1.0/5.0*(5*pow(Delta1, 4)*Delta1_prmS2z - 5*pow(Delta1, 3)*Delta2_prmS2z - 15*pow(Delta1, 2)*Delta1_prmS2z*Delta2 + 5*pow(Delta1, 2)*Delta3_prmS2z + 10*Delta1*Delta1_prmS2z*Delta3 + 10*Delta1*Delta2*Delta2_prmS2z - 5*Delta1*Delta4_prmS2z + 5*Delta1_prmS2z*pow(Delta2, 2) - 5*Delta1_prmS2z*Delta4 - 5*Delta2*Delta3_prmS2z - 5*Delta2_prmS2z*Delta3)/pow(etaKminus1, 2) + (1.0/5.0)*etaKminus1_prmS2z*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 3)) + etaKminus1*etaKminus1_prmS2z*((256.0/5.0)*EMgamma + (2.0/3.0)*pow(a, 2)*(-pow(Delta1, 3) + 3*Delta1*Delta2 - 3*Delta3) + 2*eta*(-221.0/6.0 + (41.0/32.0)*pow(M_PI, 2)) - 4237.0/30.0 + (512.0/5.0)*M_LN2 + (2275.0/256.0)*pow(M_PI, 2) + (pow(Delta1, 4) - 4*pow(Delta1, 2)*Delta2 + 4*Delta1*Delta3 + 2*pow(Delta2, 2) - 4*Delta4)/etaKminus1 - 1.0/5.0*(2*pow(Delta1, 5) - 10*pow(Delta1, 3)*Delta2 + 10*pow(Delta1, 2)*Delta3 + 10*Delta1*pow(Delta2, 2) - 10*Delta1*Delta4 - 10*Delta2*Delta3)/pow(etaKminus1, 2));
    double Delta5l_prmS2z = (128.0/5.0)*etaKminus1*etaKminus1_prmS2z;
    double logarg_prmS2z = u*(Delta1_prmS2z + u*(Delta2_prmS2z + u*(Delta3_prmS2z + u*(Delta4_prmS2z + u*(Delta5_prmS2z + Delta5l_prmS2z*log(u))))));
    double Deltaucalib_prmS2z = eta*(Delta0_prmS2z + logarg_prmS2z*(((logarg + 1) > 0) - ((logarg + 1) < 0))/fabs(logarg + 1));
    double Deltaucalibprime_prmS2z = eta*logarg_prmS2z*pow(u, 2)*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*log(u))))))/pow(logarg + 1, 2) - eta*pow(u, 2)*(Delta1_prmS2z + u*(2*Delta2_prmS2z + u*(3*Delta3_prmS2z + u*(4*Delta4_prmS2z + u*(5*Delta5_prmS2z + 5*Delta5l_prmS2z*log(u))))))/(logarg + 1);
    double Deltaubar_prmS2z = 2*a*a_prmS2z*pow(u, 2) + etaKminus1_prmS2z*(-2*u - 1/etaKminus1)/pow(etaKminus1, 2) - etaKminus1_prmS2z/pow(etaKminus1, 3);
    double Deltaubarprime_prmS2z = -4*a*a_prmS2z*pow(u, 3) + 2*etaKminus1_prmS2z*pow(u, 2)/pow(etaKminus1, 2);
    double Deltau_prmS2z = (Deltaubar*Deltaucalib_prmS2z + Deltaubar_prmS2z*Deltaucalib)*(((Deltaubar*Deltaucalib) > 0) - ((Deltaubar*Deltaucalib) < 0));
    double Deltauprime_prmS2z = Deltaubar*Deltaucalibprime_prmS2z + Deltaubar_prmS2z*Deltaucalibprime + Deltaubarprime*Deltaucalib_prmS2z + Deltaubarprime_prmS2z*Deltaucalib;
    double Deltatprime_prmS2z = 2*Deltau_prmS2z*r + Deltauprime_prmS2z*pow(r, 2);
    double Deltat_prmS2z = Deltau_prmS2z*pow(r, 2);
    double Deltar_prmS2z = Deltat_prmS2z*Dinv;
    double Lambt_prmS2z = (Deltat*pow(a, 2)*sin2theta_prmS2z + 2*Deltat*a*a_prmS2z*sin2theta + Deltat_prmS2z*pow(a, 2)*sin2theta - 2*w2*w2_prmS2z)*(((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) > 0) - ((Deltat*pow(a, 2)*sin2theta - pow(w2, 2)) < 0));
    double csi_prmS2z = (1.0/2.0)*(Deltar*Deltat_prmS2z + Deltar_prmS2z*Deltat)*(((Deltar*Deltat) > 0) - ((Deltar*Deltat) < 0))/(w2*sqrt(fabs(Deltar*Deltat))) - w2_prmS2z*sqrt(fabs(Deltar*Deltat))/pow(w2, 2);
    double csi1_prmS2z = csi_prmS2z*(1 - fabs((double)tortoise - 1));
    double csi2_prmS2z = csi_prmS2z*(1.0/2.0 - 1.0/2.0*(((3.0/2.0 - (double)tortoise) > 0) - ((3.0/2.0 - (double)tortoise) < 0)));
    double prT_prmS2z = csi2_prmS2z*(n1*p1 + n2*p2 + n3*p3);
    double phat3_prmS2z = n3*prT_prmS2z*(-1 + 1.0/csi1) - csi1_prmS2z*n3*prT/pow(csi1, 2);
    double phat2_prmS2z = n2*prT_prmS2z*(-1 + 1.0/csi1) - csi1_prmS2z*n2*prT/pow(csi1, 2);
    double phat1_prmS2z = n1*prT_prmS2z*(-1 + 1.0/csi1) - csi1_prmS2z*n1*prT/pow(csi1, 2);
    double pdotxir_prmS2z = r*(phat1*xi1_prmS2z + phat1_prmS2z*xi1 + phat2*xi2_prmS2z + phat2_prmS2z*xi2 + phat3*xi3_prmS2z + phat3_prmS2z*xi3);
    double pdotn_prmS2z = n1*phat1_prmS2z + n2*phat2_prmS2z + n3*phat3_prmS2z;
    double pdotvr_prmS2z = r*(phat1*v1_prmS2z + phat1_prmS2z*v1 + phat2*v2_prmS2z + phat2_prmS2z*v2 + phat3*v3_prmS2z + phat3_prmS2z*v3);
    double pphi_prmS2z = pdotxir_prmS2z;
    double Qcoeff2_prmS2z = -sin2theta_prmS2z/(Sigma*pow(sin2theta, 2)) - Sigma_prmS2z/(pow(Sigma, 2)*sin2theta);
    double Qcoeff1_prmS2z = -Sigma*sin2theta_prmS2z/(Lambt*pow(sin2theta, 2)) + Sigma_prmS2z/(Lambt*sin2theta) - Lambt_prmS2z*Sigma/(pow(Lambt, 2)*sin2theta);
    double DrSipn2_prmS2z = 2*Deltar*pdotn*pdotn_prmS2z/Sigma - Deltar*Sigma_prmS2z*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS2z*pow(pdotn, 2)/Sigma;
    double Q_prmS2z = DrSipn2_prmS2z + 2*Qcoeff1*pdotxir*pdotxir_prmS2z + Qcoeff1_prmS2z*pow(pdotxir, 2) + 2*Qcoeff2*pdotvr*pdotvr_prmS2z + Qcoeff2_prmS2z*pow(pdotvr, 2);
    double Qminus1_prmS2z = Q_prmS2z;
    double Jtilde_prmS2z = (1.0/2.0)*Deltar_prmS2z/sqrt(Deltar);
    double exp2mu_prmS2z = Sigma_prmS2z;
    double expmu_prmS2z = (1.0/2.0)*exp2mu_prmS2z/sqrt(exp2mu);
    double Brtilde_prmS2z = (1.0/2.0)*(sqrt(Deltar)*Deltatprime_prmS2z - 2*Deltat_prmS2z + (1.0/2.0)*Deltar_prmS2z*Deltatprime/sqrt(Deltar))/sqrt(Deltar*Deltat) + (1.0/2.0)*(sqrt(Deltar)*Deltatprime - 2*Deltat)*(-1.0/2.0*Deltar*Deltat_prmS2z - 1.0/2.0*Deltar_prmS2z*Deltat)/(Deltar*Deltat*sqrt(Deltar*Deltat));
    double Btilde_prmS2z = (1.0/2.0)*Deltat_prmS2z/sqrt(Deltat);
    double exp2nu_prmS2z = Deltat*Sigma_prmS2z/Lambt - Deltat*Lambt_prmS2z*Sigma/pow(Lambt, 2) + Deltat_prmS2z*Sigma/Lambt;
    double expnu_prmS2z = (1.0/2.0)*exp2nu_prmS2z/sqrt(exp2nu);
    double omega_prmS2z = omegatilde_prmS2z/Lambt - Lambt_prmS2z*omegatilde/pow(Lambt, 2);
    double omegatildeprime_prmS2z = 2*a_prmS2z;
    double Lambtprime_prmS2z = -Deltatprime*pow(a, 2)*sin2theta_prmS2z - 2*Deltatprime*a*a_prmS2z*sin2theta - Deltatprime_prmS2z*pow(a, 2)*sin2theta + 8*a*a_prmS2z*r;
    double mucostheta_prmS2z = pow(a, 2)*costheta_prmS2z/Sigma + 2*a*a_prmS2z*costheta/Sigma - Sigma_prmS2z*pow(a, 2)*costheta/pow(Sigma, 2);
    double nucostheta_prmS2z = pow(a, 2)*costheta*w2*(-Deltat_prmS2z + w2_prmS2z)/(Lambt*Sigma) + pow(a, 2)*costheta*w2_prmS2z*(-Deltat + w2)/(Lambt*Sigma) + pow(a, 2)*costheta_prmS2z*w2*(-Deltat + w2)/(Lambt*Sigma) + a*a_prmS2z*costheta*w2*(-2*Deltat + 2*w2)/(Lambt*Sigma) - Sigma_prmS2z*pow(a, 2)*costheta*w2*(-Deltat + w2)/(Lambt*pow(Sigma, 2)) - Lambt_prmS2z*pow(a, 2)*costheta*w2*(-Deltat + w2)/(pow(Lambt, 2)*Sigma);
    double omegacostheta_prmS2z = -2*Deltat*pow(a, 2)*costheta*omegatilde_prmS2z/pow(Lambt, 2) - 2*Deltat*pow(a, 2)*costheta_prmS2z*omegatilde/pow(Lambt, 2) - 4*Deltat*a*a_prmS2z*costheta*omegatilde/pow(Lambt, 2) + 4*Deltat*Lambt_prmS2z*pow(a, 2)*costheta*omegatilde/pow(Lambt, 3) - 2*Deltat_prmS2z*pow(a, 2)*costheta*omegatilde/pow(Lambt, 2);
    double mur_prmS2z = -Sigma_prmS2z*r/pow(Sigma, 2) + (1.0/2.0)*Deltar_prmS2z/pow(Deltar, 3.0/2.0);
    double nur_prmS2z = -Sigma_prmS2z*r/pow(Sigma, 2) + (1.0/2.0)*w2*(-4*Deltat_prmS2z*r + Deltatprime*w2_prmS2z + Deltatprime_prmS2z*w2)/(Deltat*Lambt) + (1.0/2.0)*w2_prmS2z*(-4*Deltat*r + Deltatprime*w2)/(Deltat*Lambt) - 1.0/2.0*Lambt_prmS2z*w2*(-4*Deltat*r + Deltatprime*w2)/(Deltat*pow(Lambt, 2)) - 1.0/2.0*Deltat_prmS2z*w2*(-4*Deltat*r + Deltatprime*w2)/(pow(Deltat, 2)*Lambt);
    double omegar_prmS2z = (Lambt*omegatildeprime_prmS2z + Lambt_prmS2z*omegatildeprime - Lambtprime*omegatilde_prmS2z - Lambtprime_prmS2z*omegatilde)/pow(Lambt, 2) + Lambt_prmS2z*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/pow(Lambt, 3);
    double dSO_prmS2z = 442.44299999999998*pow(chi, 2)*chi_prmS2z*pow(eta, 2) - 1705.953*pow(chi, 2)*chi_prmS2z*eta + 198.59610000000001*pow(chi, 2)*chi_prmS2z - 686.62599999999998*chi*chi_prmS2z*eta + 2495.29*chi_prmS2z*pow(eta, 2);
    double sigmacoeffTerm3_prmS2z = dSO_prmS2z*eta*pow(u, 3);
    double sigmacoeffTerm2_prmS2z = (1.0/144.0)*eta*(eta*r*(-882*DrSipn2_prmS2z + 204*Qminus1_prmS2z + r*(1620*DrSipn2*DrSipn2_prmS2z - 234*DrSipn2*Qminus1_prmS2z - 234*DrSipn2_prmS2z*Qminus1)) + r*(-96*DrSipn2_prmS2z - 436*Qminus1_prmS2z + r*(36*DrSipn2*Qminus1_prmS2z + 36*DrSipn2_prmS2z*Qminus1 - 90*Qminus1*Qminus1_prmS2z)))/pow(r, 2);
    double sigmacoeffTerm1_prmS2z = eta*(-3*DrSipn2_prmS2z + (1.0/4.0)*Qminus1_prmS2z);
    double sigmacoeff_prmS2z = sigmacoeffTerm1_prmS2z + sigmacoeffTerm2_prmS2z + sigmacoeffTerm3_prmS2z;
    double sigmastarcoeffTerm2_prmS2z = (1.0/72.0)*eta*(eta*r*(-324*DrSipn2_prmS2z + 120*Qminus1_prmS2z + r*(720*DrSipn2*DrSipn2_prmS2z + Qminus1*(-126*DrSipn2_prmS2z - 3*Qminus1_prmS2z) + Qminus1_prmS2z*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmS2z + Qminus1*r*(96*DrSipn2_prmS2z - 23*Qminus1_prmS2z) + Qminus1_prmS2z*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmS2z))/pow(r, 2);
    double sigmastarcoeffTerm1_prmS2z = eta*(-5.0/2.0*DrSipn2_prmS2z + (1.0/3.0)*Qminus1_prmS2z);
    double sigmastarcoeff_prmS2z = sigmastarcoeffTerm1_prmS2z + sigmastarcoeffTerm2_prmS2z;
    double Deltasigmastar3_prmS2z = sigma3*sigmacoeff_prmS2z + sigma3_prmS2z*sigmacoeff + sigmastar3*sigmastarcoeff_prmS2z + sigmastar3_prmS2z*sigmastarcoeff;
    double Deltasigmastar2_prmS2z = sigma2*sigmacoeff_prmS2z + sigmastar2*sigmastarcoeff_prmS2z;
    double Deltasigmastar1_prmS2z = sigma1*sigmacoeff_prmS2z + sigmastar1*sigmastarcoeff_prmS2z;
    double Sstar3_prmS2z = Deltasigmastar3_prmS2z + sigmastar3_prmS2z;
    double Sstar2_prmS2z = Deltasigmastar2_prmS2z;
    double Sstar1_prmS2z = Deltasigmastar1_prmS2z;
    double S3_prmS2z = Sstar3_prmS2z;
    double S2_prmS2z = Sstar2_prmS2z;
    double S1_prmS2z = Sstar1_prmS2z;
    double Sstardotn_prmS2z = Sstar1_prmS2z*n1 + Sstar2_prmS2z*n2 + Sstar3_prmS2z*n3;
    double SdotSkerrhat_prmS2z = S1*Skerrhat1_prmS2z + S1_prmS2z*Skerrhat1 + S2*Skerrhat2_prmS2z + S2_prmS2z*Skerrhat2 + S3*Skerrhat3_prmS2z + S3_prmS2z*Skerrhat3;
    double Sdotn_prmS2z = S1_prmS2z*n1 + S2_prmS2z*n2 + S3_prmS2z*n3;
    double Sdotv_prmS2z = S1*v1_prmS2z + S1_prmS2z*v1 + S2*v2_prmS2z + S2_prmS2z*v2 + S3*v3_prmS2z + S3_prmS2z*v3;
    double Sdotxi_prmS2z = S1*xi1_prmS2z + S1_prmS2z*xi1 + S2*xi2_prmS2z + S2_prmS2z*xi2 + S3*xi3_prmS2z + S3_prmS2z*xi3;
    double HdsumTerm2_prmS2z = 6*Sstardotn*Sstardotn_prmS2z;
    double HdsumTerm1_prmS2z = 2*Sstar1*Sstar1_prmS2z + 2*Sstar2*Sstar2_prmS2z + 2*Sstar3*Sstar3_prmS2z;
    double Hdsum_prmS2z = HdsumTerm1_prmS2z - HdsumTerm2_prmS2z;
    double Q4_prmS2z = eta*pow(prT, 3)*prT_prmS2z*pow(u, 2)*(32 - 24*eta);
    double gammappsum_prmS2z = 2*Deltar*pdotn*pdotn_prmS2z/Sigma - Deltar*Sigma_prmS2z*pow(pdotn, 2)/pow(Sigma, 2) + Deltar_prmS2z*pow(pdotn, 2)/Sigma - pow(pdotvr, 2)*sin2theta_prmS2z/(Sigma*pow(sin2theta, 2)) + 2*pdotvr*pdotvr_prmS2z/(Sigma*sin2theta) - Sigma_prmS2z*pow(pdotvr, 2)/(pow(Sigma, 2)*sin2theta) - Sigma*pow(pdotxir, 2)*sin2theta_prmS2z/(Lambt*pow(sin2theta, 2)) + 2*Sigma*pdotxir*pdotxir_prmS2z/(Lambt*sin2theta) + Sigma_prmS2z*pow(pdotxir, 2)/(Lambt*sin2theta) - Lambt_prmS2z*Sigma*pow(pdotxir, 2)/(pow(Lambt, 2)*sin2theta);
    double Hnsradicand_prmS2z = Q4_prmS2z + gammappsum_prmS2z;
    double alpha_prmS2z = Lambt*sqrt(Deltat*Sigma/Lambt)*((1.0/2.0)*Deltat*Sigma_prmS2z/Lambt - 1.0/2.0*Deltat*Lambt_prmS2z*Sigma/pow(Lambt, 2) + (1.0/2.0)*Deltat_prmS2z*Sigma/Lambt)/(Deltat*Sigma);
    double betapsum_prmS2z = omegatilde*pphi_prmS2z/Lambt + omegatilde_prmS2z*pphi/Lambt - Lambt_prmS2z*omegatilde*pphi/pow(Lambt, 2);
    double HssTerm3_prmS2z = pow(Btilde, 2)*(Sdotn*exp2mu*xisq*(-Q_prmS2z - 1.0/2.0*Q_prmS2z/sqrt(Q)) + Sdotn*exp2mu*xisq_prmS2z*(-sqrt(Q) - Q) + Sdotn*exp2mu_prmS2z*xisq*(-sqrt(Q) - Q) + Sdotn_prmS2z*exp2mu*xisq*(-sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmS2z - Jtilde*Sdotv_prmS2z*pdotn - Jtilde_prmS2z*Sdotv*pdotn + Sdotn*pdotvr_prmS2z + Sdotn_prmS2z*pdotvr) + pdotvr_prmS2z*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmS2z*(-2*Sdotn*exp2mu*xisq*(sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmS2z + Btilde*Jtilde*Sdotxi_prmS2z*pdotn + Btilde*Jtilde_prmS2z*Sdotxi*pdotn + Btilde_prmS2z*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmS2z - Sdotn*expmu*expnu_prmS2z*pdotxir - Sdotn*expmu_prmS2z*expnu*pdotxir - Sdotn_prmS2z*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmS2z*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmS2z*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmS2z*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir);
    double HssTerm3coeff_prmS2z = (1.0/2.0)*omegacostheta*(-Q_prmS2z - 1.0/2.0*Q_prmS2z/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*pow(sqrt(Q) + Q, 2)) + omegacostheta_prmS2z/(Btilde*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q)) - expnu_prmS2z*omegacostheta/(Btilde*exp2mu*expmu*pow(expnu, 2)*(2*sqrt(Q) + 2*Q)) - expmu_prmS2z*omegacostheta/(Btilde*exp2mu*pow(expmu, 2)*expnu*(2*sqrt(Q) + 2*Q)) - exp2mu_prmS2z*omegacostheta/(Btilde*pow(exp2mu, 2)*expmu*expnu*(2*sqrt(Q) + 2*Q)) - Btilde_prmS2z*omegacostheta/(pow(Btilde, 2)*exp2mu*expmu*expnu*(2*sqrt(Q) + 2*Q));
    double HssTerm2_prmS2z = pow(Btilde, 2)*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmS2z - Jtilde*Sdotv_prmS2z*pdotn - Jtilde_prmS2z*Sdotv*pdotn + Sdotn*pdotvr_prmS2z + Sdotn_prmS2z*pdotvr) + Jtilde*pdotn_prmS2z*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmS2z*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmS2z + (1.0/2.0)*Q_prmS2z/sqrt(Q)) + Sdotv*exp2mu_prmS2z*(sqrt(Q) + Q) + Sdotv_prmS2z*exp2mu*(sqrt(Q) + Q)) + pow(Btilde, 2)*xisq_prmS2z*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sqrt(Q) + Q)) + Btilde*Btilde_prmS2z*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmS2z - Btilde*Sdotxi*expnu_prmS2z*pdotvr - Btilde*Sdotxi_prmS2z*expnu*pdotvr - Btilde_prmS2z*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmS2z + Sdotv*exp2nu*expmu_prmS2z*pdotxir + Sdotv*exp2nu_prmS2z*expmu*pdotxir + Sdotv_prmS2z*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmS2z*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmS2z*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir);
    double HssTerm2coeff_prmS2z = (1.0/2.0)*Jtilde*omegar*(-Q_prmS2z - 1.0/2.0*Q_prmS2z/sqrt(Q))/(Btilde*exp2mu*expmu*expnu*xisq*pow(sqrt(Q) + Q, 2)) - Jtilde*omegar*xisq_prmS2z/(Btilde*exp2mu*expmu*expnu*pow(xisq, 2)*(2*sqrt(Q) + 2*Q)) + Jtilde*omegar_prmS2z/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expnu_prmS2z*omegar/(Btilde*exp2mu*expmu*pow(expnu, 2)*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*expmu_prmS2z*omegar/(Btilde*exp2mu*pow(expmu, 2)*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmS2z*omegar/(Btilde*pow(exp2mu, 2)*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) + Jtilde_prmS2z*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q)) - Btilde_prmS2z*Jtilde*omegar/(pow(Btilde, 2)*exp2mu*expmu*expnu*xisq*(2*sqrt(Q) + 2*Q));
    double HssTerm1_prmS2z = SdotSkerrhat*omega_prmS2z + SdotSkerrhat_prmS2z*omega;
    double Hss_prmS2z = HssTerm1_prmS2z + HssTerm2*HssTerm2coeff_prmS2z + HssTerm2_prmS2z*HssTerm2coeff + HssTerm3*HssTerm3coeff_prmS2z + HssTerm3_prmS2z*HssTerm3coeff;
    double HsoTerm2c_prmS2z = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmS2z*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmS2z*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmS2z*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmS2z*expmu*expnu*pdotxir*(sqrt(Q) + 1) + (1.0/2.0)*Brtilde*Jtilde*Q_prmS2z*Sdotv*expmu*expnu*pdotxir/sqrt(Q) + Brtilde*Jtilde_prmS2z*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1) + Brtilde_prmS2z*Jtilde*Sdotv*expmu*expnu*pdotxir*(sqrt(Q) + 1);
    double HsoTerm2b_prmS2z = Btilde*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmS2z + Jtilde*Sdotv_prmS2z*nur + Jtilde_prmS2z*Sdotv*nur - Sdotn*nucostheta*xisq_prmS2z - Sdotn*nucostheta_prmS2z*xisq - Sdotn_prmS2z*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmS2z*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmS2z*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmS2z*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmS2z*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sqrt(Q) + Btilde_prmS2z*expmu*expnu*pdotxir*(2*sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq);
    double HsoTerm2a_prmS2z = pow(Btilde, 2)*Jtilde*Sdotxi*(-sqrt(Q)*(nur*pdotvr_prmS2z + nur_prmS2z*pdotvr + pdotn*xisq*(mucostheta_prmS2z - nucostheta_prmS2z) + pdotn*xisq_prmS2z*(mucostheta - nucostheta) + pdotn_prmS2z*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmS2z - mucostheta*pdotn_prmS2z*xisq - mucostheta_prmS2z*pdotn*xisq + mur*pdotvr_prmS2z*(sqrt(Q) + 1) + mur_prmS2z*pdotvr*(sqrt(Q) + 1) + (1.0/2.0)*Q_prmS2z*mur*pdotvr/sqrt(Q) + (1.0/2.0)*Q_prmS2z*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/sqrt(Q)) + pow(Btilde, 2)*Jtilde*Sdotxi_prmS2z*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + pow(Btilde, 2)*Jtilde_prmS2z*Sdotxi*(sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sqrt(Q) + 1)) + Btilde*Btilde_prmS2z*Jtilde*Sdotxi*(2*sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sqrt(Q) + 1));
    double HsoTerm2_prmS2z = HsoTerm2a_prmS2z + HsoTerm2b_prmS2z - HsoTerm2c_prmS2z;
    double HsoTerm2coeff_prmS2z = expnu*(-Q_prmS2z - 1.0/2.0*Q_prmS2z/sqrt(Q))/(pow(Btilde, 2)*exp2mu*xisq*pow(sqrt(Q) + Q, 2)) - expnu*xisq_prmS2z/(pow(Btilde, 2)*exp2mu*pow(xisq, 2)*(sqrt(Q) + Q)) + expnu_prmS2z/(pow(Btilde, 2)*exp2mu*xisq*(sqrt(Q) + Q)) - exp2mu_prmS2z*expnu/(pow(Btilde, 2)*pow(exp2mu, 2)*xisq*(sqrt(Q) + Q)) - 2*Btilde_prmS2z*expnu/(pow(Btilde, 3)*exp2mu*xisq*(sqrt(Q) + Q));
    double HsoTerm1_prmS2z = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmS2z + expmu*expnu_prmS2z + expmu_prmS2z*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmS2z*(Btilde - expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*pow(xisq, 2)) + SdotSkerrhat*exp2nu*pdotxir_prmS2z*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmS2z*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*pow(expmu, 2)*xisq) + SdotSkerrhat*exp2nu_prmS2z*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmS2z*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*sqrt(Q)*expmu*xisq) - 1.0/2.0*Q_prmS2z*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(pow(Btilde, 2)*pow(Q, 3.0/2.0)*expmu*xisq) - Btilde_prmS2z*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(pow(Btilde, 3)*sqrt(Q)*expmu*xisq);
    double Hso_prmS2z = HsoTerm1_prmS2z + HsoTerm2*HsoTerm2coeff_prmS2z + HsoTerm2_prmS2z*HsoTerm2coeff;
    double Hd_prmS2z = Hdcoeff*Hdsum_prmS2z;
    double Hns_prmS2z = sqrt(Hnsradicand)*alpha_prmS2z + betapsum_prmS2z + (1.0/2.0)*Hnsradicand_prmS2z*alpha/sqrt(Hnsradicand);
    double Hs_prmS2z = Hso_prmS2z + Hss_prmS2z;
    double dSS_prmS2z = 1585.5329999999999*pow(chi, 2)*chi_prmS2z*pow(eta, 2) - 123.0009*pow(chi, 2)*chi_prmS2z*eta + 2323.5599999999999*chi*chi_prmS2z*pow(eta, 3) - 652.64999999999998*chi*chi_prmS2z*pow(eta, 2) + 37.196399999999997*chi_prmS2z*eta;
    double Heff_prmS2z = -Hd_prmS2z + Hns_prmS2z + Hs_prmS2z + 2*S2z*dSS*eta*pow(u, 4) + dSS_prmS2z*eta*pow(u, 4)*(pow(S1x, 2) + pow(S1y, 2) + pow(S1z, 2) + pow(S2x, 2) + pow(S2y, 2) + pow(S2z, 2));
    double Hreal_prmS2z = Heff_prmS2z*eta*(((Heff) > 0) - ((Heff) < 0))/sqrt(eta*(2*fabs(Heff) - 2) + 1);
    dvalues[0] = Hreal_prmx1;
    dvalues[1] = Hreal_prmx2;
    dvalues[2] = Hreal_prmx3;
    dvalues[3] = Hreal_prmp1;
    dvalues[4] = Hreal_prmp2;
    dvalues[5] = Hreal_prmp3;
    dvalues[6] = Hreal_prmS1x;
    dvalues[7] = Hreal_prmS1y;
    dvalues[8] = Hreal_prmS1z;
    dvalues[9] = Hreal_prmS2x;
    dvalues[10] = Hreal_prmS2y;
    dvalues[11] = Hreal_prmS2z;
    dcsi[0] = csi;
    dcsi[0 = csi_prmx1;
    dcsi[0] = csi_prmx2;
    dcsi[0] = csi_prmx3;
    return 1;
}