EMgamma = 0.577215664901532860606512090082402431
M = m1+m2
mu = m1*m2/M
eta = mu/M
r = sp.sqrt(x*x+y*y+z*z)
u = 1/r
sigmastar3 = m2/m1*S1z+m1/m2*S2z
sigmastar2 = m2/m1*S1y+m1/m2*S2y
sigmastar1 = m2/m1*S1x+m1/m2*S2x
sigma3 = S1z+S2z
sigma2 = S1y+S2y
sigma1 = S1x+S2x
Skerr3 = sigma3
Skerr2 = sigma2
Skerr1 = sigma1
Skerrmag = sp.sqrt(Skerr1*Skerr1+Skerr2*Skerr2+Skerr3*Skerr3)
Skerrhat3 = Skerr3/Skerrmag
Skerrhat2 = Skerr2/Skerrmag
Skerrhat1 = Skerr1/Skerrmag
a = Skerrmag
L3 = x*p2-y*p1
L2 = z*p1-x*p3
L1 = y*p3-z*p2
Lnorm = sp.sqrt(L1*L1+L2*L2+L3*L3)
Lhat3 = L3/Lnorm
Lhat2 = L2/Lnorm
Lhat1 = L1/Lnorm
S2dotLhat = S2x*Lhat1+S2y*Lhat2+S2z*Lhat3
S1dotLhat = S1x*Lhat1+S1y*Lhat2+S1z*Lhat3
S1perp3 = S1z-S1dotLhat*Lhat3
S1perp2 = S1y-S1dotLhat*Lhat2
S1perp1 = S1x-S1dotLhat*Lhat1
S2perp3 = S2z-S2dotLhat*Lhat3
S2perp2 = S2y-S2dotLhat*Lhat2
S2perp1 = S2x-S2dotLhat*Lhat1
Sperp3 = S1perp3+S2perp3
Sperp2 = S1perp2+S2perp2
Sperp1 = S1perp1+S2perp1
n3 = z/r
n2 = y/r
n1 = x/r
e33 = Skerrhat3
e32 = Skerrhat2
e31 = Skerrhat1
xi3 = e31*n2-e32*n1
xi2 = -e31*n3+e33*n1
xi1 = e32*n3-e33*n2
v3 = n1*xi2-n2*xi1
v2 = n3*xi1-n1*xi3
v1 = n2*xi3-n3*xi2
costheta = e31*n1+e32*n2+e33*n3
sin2theta = 1-costheta*costheta
xisq = sin2theta
w2 = a*a+r*r
Sigma = r*r+a*a*costheta*costheta
Dinv = 1+sp.log(1+6*eta*u*u+2*(26-3*eta)*eta*u*u*u)
omegatilde = 2*a*r
chi = (Skerr1*Lhat1+Skerr2*Lhat2+Skerr3*Lhat3)/(1-2*eta)+sp.Rational(1,2)*(Sperp1*Skerr1+Sperp2*Skerr2+Sperp3*Skerr3)/(Skerrmag*(1.-2.*eta))
Kchi0 = 267.788*eta*eta*eta-126.687*eta*eta+10.2573*eta+1.7336
K = -59.1658*chi*chi*chi*eta*eta*eta-0.426958*chi*chi*chi*eta+1.43659*chi*chi*chi+31.1746*chi*chi*eta*eta*eta+6.16466*chi*chi*eta*eta-1.38086*chi*chi-27.5201*chi*eta*eta*eta+17.3736*chi*eta*eta+2.26831*chi*eta-1.62045*chi+Kchi0
etaKminus1 = eta*K-1
Delta0 = K*(eta*K-2)
Delta1 = -2*etaKminus1*(K+Delta0)
Delta2 = sp.Rational(1,2)*Delta1*(Delta1-4*etaKminus1)-a*a*etaKminus1*etaKminus1*Delta0
Delta3 = -sp.Rational(1,3)*Delta1*Delta1*Delta1+etaKminus1*Delta1*Delta1+Delta2*Delta1-2*etaKminus1*(Delta2-etaKminus1)-a*a*etaKminus1*etaKminus1*Delta1
Delta4 = sp.Rational(1,12)*(6*a*a*(Delta1*Delta1-2*Delta2)*etaKminus1*etaKminus1+3*Delta1*Delta1*Delta1*Delta1-8*etaKminus1*Delta1*Delta1*Delta1-12*Delta2*Delta1*Delta1+12*(2*etaKminus1*Delta2+Delta3)*Delta1+12*(sp.Rational(94,3)-sp.Rational(41,32)*sp.pi*sp.pi)*etaKminus1*etaKminus1+6*(Delta2*Delta2-4*Delta3*etaKminus1))
Delta5 = etaKminus1*etaKminus1*(sp.Rational(-4237,60)+sp.Rational(128,5)*EMgamma+sp.Rational(2275,512)*sp.pi*sp.pi-sp.Rational(1,3)*a*a*(Delta1*Delta1*Delta1-3*Delta1*Delta2+3*Delta3)-(Delta1*Delta1*Delta1*Delta1*Delta1-5*Delta1*Delta1*Delta1*Delta2+5*Delta1*Delta2*Delta2+5*Delta1*Delta1*Delta3-5*Delta2*Delta3-5*Delta1*Delta4)/(5*etaKminus1*etaKminus1)+(Delta1*Delta1*Delta1*Delta1-4*Delta1*Delta1*Delta2+2*Delta2*Delta2+4*Delta1*Delta3-4*Delta4)/(2*etaKminus1)+sp.Rational(256,5)*sp.log(2)+(sp.Rational(41,32)*sp.pi*sp.pi-sp.Rational(221,6))*eta)
Delta5l = etaKminus1*etaKminus1*sp.Rational(64,5)
logarg = u*(Delta1+u*(Delta2+u*(Delta3+u*(Delta4+u*(Delta5+Delta5l*sp.log(u))))))
Deltaucalib = 1+eta*(Delta0+sp.log(1+logarg))
Deltaucalibprime = -eta*u*u*(Delta1+u*(2*Delta2+u*(3*Delta3+u*(4*Delta4+u*(5*(Delta5+Delta5l*sp.log(u)))))))/(1+logarg)
Deltaubar = a*a*u*u+(2*u+1/etaKminus1)/etaKminus1
Deltaubarprime = -2*a*a*u*u*u-2*u*u/(etaKminus1)
Deltau = sp.Abs(Deltaubar*Deltaucalib)
Deltauprime = Deltaubarprime*Deltaucalib+Deltaubar*Deltaucalibprime
Deltatprime = 2*r*Deltau+r*r*Deltauprime
Deltat = r*r*Deltau
Deltar = Deltat*Dinv
Lambt = sp.Abs(w2*w2-a*a*Deltat*sin2theta)
csi = sp.sqrt(Deltar*Deltat)/w2
csi1 = 1+(1-sp.Abs(1-tortoise))*(csi-1)
csi2 = 1+(sp.Rational(1,2)-sp.Rational(1,2)*sp.sign(sp.Rational(3,2)-tortoise))*(csi-1)
prT = csi2*(p1*n1+p2*n2+p3*n3)
phat3 = p3-prT*(1-1/csi1)*n3
phat2 = p2-prT*(1-1/csi1)*n2
phat1 = p1-prT*(1-1/csi1)*n1
pdotxir = (phat1*xi1+phat2*xi2+phat3*xi3)*r
pdotn = phat1*n1+phat2*n2+phat3*n3
pdotvr = (phat1*v1+phat2*v2+phat3*v3)*r
pphi = pdotxir
Qcoeff2 = 1/(Sigma*sin2theta)
Qcoeff1 = Sigma/(Lambt*sin2theta)
DrSipn2 = Deltar*pdotn*pdotn/Sigma
Q = 1+DrSipn2+Qcoeff1*pdotxir*pdotxir+Qcoeff2*pdotvr*pdotvr
Qminus1 = Q-1
Jtilde = sp.sqrt(Deltar)
exp2mu = Sigma
expmu = sp.sqrt(exp2mu)
Brtilde = (sp.sqrt(Deltar)*Deltatprime-2*Deltat)/(2*sp.sqrt(Deltar*Deltat))
Btilde = sp.sqrt(Deltat)
exp2nu = Deltat*Sigma/Lambt
expnu = sp.sqrt(exp2nu)
omega = omegatilde/Lambt
omegatildeprime = 2*a
Lambtprime = 4*(a*a+r*r)*r-a*a*Deltatprime*sin2theta
mucostheta = a*a*costheta/Sigma
nucostheta = a*a*w2*costheta*(w2-Deltat)/(Lambt*Sigma)
omegacostheta = -2*a*a*costheta*Deltat*omegatilde/(Lambt*Lambt)
mur = r/Sigma-1/sp.sqrt(Deltar)
nur = r/Sigma+w2*(w2*Deltatprime-4*r*Deltat)/(2*Lambt*Deltat)
omegar = (Lambt*omegatildeprime-Lambtprime*omegatilde)/(Lambt*Lambt)
dSO = 147.481*chi*chi*chi*eta*eta-568.651*chi*chi*chi*eta+66.1987*chi*chi*chi-343.313*chi*chi*eta+2495.29*chi*eta*eta-44.5324
sigmacoeffTerm3 = eta*dSO*u*u*u
sigmacoeffTerm2 = eta/(144*r*r)*(-896+r*(-436*Qminus1-96*DrSipn2+r*(-45*Qminus1*Qminus1+36*Qminus1*DrSipn2))+eta*(-336+r*(204*Qminus1-882*DrSipn2+r*(810*DrSipn2*DrSipn2-234*Qminus1*DrSipn2))))
sigmacoeffTerm1 = eta/12*(-8/r+3*Qminus1-36*DrSipn2)
sigmacoeff = sigmacoeffTerm1+sigmacoeffTerm2+sigmacoeffTerm3
sigmastarcoeffTerm2 = eta/(72*r*r)*(706+r*(-206*Qminus1+282*DrSipn2+r*Qminus1*(96*DrSipn2-23*Qminus1))+eta*(-54+r*(120*Qminus1-324*DrSipn2+r*(360*DrSipn2*DrSipn2+Qminus1*(-126*DrSipn2-3*Qminus1)))))
sigmastarcoeffTerm1 = eta/12*(14/r+4*Qminus1-30*DrSipn2)
sigmastarcoeff = sigmastarcoeffTerm1+sigmastarcoeffTerm2
Deltasigmastar3 = sigmastar3*sigmastarcoeff+sigma3*sigmacoeff
Deltasigmastar2 = sigmastar2*sigmastarcoeff+sigma2*sigmacoeff
Deltasigmastar1 = sigmastar1*sigmastarcoeff+sigma1*sigmacoeff
Sstar3 = sigmastar3+Deltasigmastar3
Sstar2 = sigmastar2+Deltasigmastar2
Sstar1 = sigmastar1+Deltasigmastar1
S3 = Sstar3
S2 = Sstar2
S1 = Sstar1
Sstardotn = Sstar1*n1+Sstar2*n2+Sstar3*n3
SdotSkerrhat = S1*Skerrhat1+S2*Skerrhat2+S3*Skerrhat3
Sdotn = S1*n1+S2*n2+S3*n3
Sdotv = S1*v1+S2*v2+S3*v3
Sdotxi = S1*xi1+S2*xi2+S3*xi3
HdsumTerm2 = 3*Sstardotn*Sstardotn
HdsumTerm1 = Sstar1*Sstar1+Sstar2*Sstar2+Sstar3*Sstar3
Hdsum = HdsumTerm1-HdsumTerm2
Hdcoeff = sp.Rational(1,2)/(r*r*r)
Q4 = 2*prT*prT*prT*prT*u*u*(4-3*eta)*eta
gammappsum = Deltar/Sigma*pdotn*pdotn+1/Sigma*pdotvr*pdotvr/sin2theta+Sigma/Lambt/sin2theta*pdotxir*pdotxir
Hnsradicand = 1+gammappsum+Q4
alpha = sp.sqrt(Deltat*Sigma/Lambt)
betapsum = omegatilde*pphi/Lambt
HssTerm3 = expmu*expnu*pdotxir*(Jtilde*pdotn*Sdotxi*Btilde-expmu*expnu*pdotxir*Sdotn)+(pdotvr*(Sdotn*pdotvr-Jtilde*pdotn*Sdotv)-exp2mu*(sp.sqrt(Q)+Q)*Sdotn*xisq)*Btilde*Btilde
HssTerm3coeff = omegacostheta/(2*exp2mu*expmu*expnu*Btilde*(Q+sp.sqrt(Q)))
HssTerm2 = expmu*pdotxir*(expmu*exp2nu*pdotxir*Sdotv-expnu*pdotvr*Sdotxi*Btilde)+xisq*Btilde*Btilde*(exp2mu*(sp.sqrt(Q)+Q)*Sdotv+Jtilde*pdotn*(pdotvr*Sdotn-Jtilde*pdotn*Sdotv))
HssTerm2coeff = Jtilde*omegar/(2*exp2mu*expmu*expnu*Btilde*(Q+sp.sqrt(Q))*xisq)
HssTerm1 = omega*SdotSkerrhat
Hss = HssTerm1+HssTerm2coeff*HssTerm2+HssTerm3coeff*HssTerm3
HsoTerm2c = Jtilde*Brtilde*expmu*expnu*pdotxir*(sp.sqrt(Q)+1)*Sdotv
HsoTerm2b = expmu*expnu*pdotxir*(2*sp.sqrt(Q)+1)*(Jtilde*nur*Sdotv-nucostheta*Sdotn*xisq)*Btilde
HsoTerm2a = Sdotxi*Jtilde*(mur*pdotvr*(sp.sqrt(Q)+1)-mucostheta*pdotn*xisq-sp.sqrt(Q)*(nur*pdotvr+(mucostheta-nucostheta)*pdotn*xisq))*Btilde*Btilde
HsoTerm2 = HsoTerm2a+HsoTerm2b-HsoTerm2c
HsoTerm2coeff = expnu/(exp2mu*Btilde*Btilde*(Q+sp.sqrt(Q))*xisq)
HsoTerm1 = exp2nu*(expmu*expnu-Btilde)*pdotxir*SdotSkerrhat/(expmu*Btilde*Btilde*sp.sqrt(Q)*xisq)
Hso = HsoTerm1+HsoTerm2coeff*HsoTerm2
Hd = Hdcoeff*Hdsum
Hns = betapsum+alpha*sp.sqrt(Hnsradicand)
Hs = Hso+Hss
dSS = 528.511*chi*chi*chi*eta*eta-41.0003*chi*chi*chi*eta+1161.78*chi*chi*eta*eta*eta-326.325*chi*chi*eta*eta+37.1964*chi*eta+706.958*eta*eta*eta-36.0272*eta+6.06807
Heff = Hs+Hns-Hd+dSS*eta*u*u*u*u*(S1x*S1x+S1y*S1y+S1z*S1z+S2x*S2x+S2y*S2y+S2z*S2z)
Hreal = sp.sqrt(1+2*eta*(Heff-1))
r_prmx = x/sp.sqrt(x**2 + y**2 + z**2)
u_prmx = -r_prmx/r**2
L3_prmx = p2
L3_prmp2 = x
L2_prmx = -p3
L2_prmp3 = -x
L1_prmp2 = -z
L1_prmp3 = y
Lnorm_prmx = (L2*L2_prmx + L3*L3_prmx)/sp.sqrt(L1**2 + L2**2 + L3**2)
Lnorm_prmp2 = (L1*L1_prmp2 + L3*L3_prmp2)/sp.sqrt(L1**2 + L2**2 + L3**2)
Lnorm_prmp3 = (L1*L1_prmp3 + L2*L2_prmp3)/sp.sqrt(L1**2 + L2**2 + L3**2)
Lhat3_prmx = -L3*Lnorm_prmx/Lnorm**2 + L3_prmx/Lnorm
Lhat3_prmp2 = -L3*Lnorm_prmp2/Lnorm**2 + L3_prmp2/Lnorm
Lhat3_prmp3 = -L3*Lnorm_prmp3/Lnorm**2
Lhat2_prmx = -L2*Lnorm_prmx/Lnorm**2 + L2_prmx/Lnorm
Lhat2_prmp2 = -L2*Lnorm_prmp2/Lnorm**2
Lhat2_prmp3 = -L2*Lnorm_prmp3/Lnorm**2 + L2_prmp3/Lnorm
Lhat1_prmx = -L1*Lnorm_prmx/Lnorm**2
Lhat1_prmp2 = -L1*Lnorm_prmp2/Lnorm**2 + L1_prmp2/Lnorm
Lhat1_prmp3 = -L1*Lnorm_prmp3/Lnorm**2 + L1_prmp3/Lnorm
S2dotLhat_prmx = Lhat1_prmx*S2x + Lhat2_prmx*S2y + Lhat3_prmx*S2z
S2dotLhat_prmp2 = Lhat1_prmp2*S2x + Lhat2_prmp2*S2y + Lhat3_prmp2*S2z
S2dotLhat_prmp3 = Lhat1_prmp3*S2x + Lhat2_prmp3*S2y + Lhat3_prmp3*S2z
S1dotLhat_prmx = Lhat1_prmx*S1x + Lhat2_prmx*S1y + Lhat3_prmx*S1z
S1dotLhat_prmp2 = Lhat1_prmp2*S1x + Lhat2_prmp2*S1y + Lhat3_prmp2*S1z
S1dotLhat_prmp3 = Lhat1_prmp3*S1x + Lhat2_prmp3*S1y + Lhat3_prmp3*S1z
S1perp3_prmx = -Lhat3*S1dotLhat_prmx - Lhat3_prmx*S1dotLhat
S1perp3_prmp2 = -Lhat3*S1dotLhat_prmp2 - Lhat3_prmp2*S1dotLhat
S1perp3_prmp3 = -Lhat3*S1dotLhat_prmp3 - Lhat3_prmp3*S1dotLhat
S1perp2_prmx = -Lhat2*S1dotLhat_prmx - Lhat2_prmx*S1dotLhat
S1perp2_prmp2 = -Lhat2*S1dotLhat_prmp2 - Lhat2_prmp2*S1dotLhat
S1perp2_prmp3 = -Lhat2*S1dotLhat_prmp3 - Lhat2_prmp3*S1dotLhat
S1perp1_prmx = -Lhat1*S1dotLhat_prmx - Lhat1_prmx*S1dotLhat
S1perp1_prmp2 = -Lhat1*S1dotLhat_prmp2 - Lhat1_prmp2*S1dotLhat
S1perp1_prmp3 = -Lhat1*S1dotLhat_prmp3 - Lhat1_prmp3*S1dotLhat
S2perp3_prmx = -Lhat3*S2dotLhat_prmx - Lhat3_prmx*S2dotLhat
S2perp3_prmp2 = -Lhat3*S2dotLhat_prmp2 - Lhat3_prmp2*S2dotLhat
S2perp3_prmp3 = -Lhat3*S2dotLhat_prmp3 - Lhat3_prmp3*S2dotLhat
S2perp2_prmx = -Lhat2*S2dotLhat_prmx - Lhat2_prmx*S2dotLhat
S2perp2_prmp2 = -Lhat2*S2dotLhat_prmp2 - Lhat2_prmp2*S2dotLhat
S2perp2_prmp3 = -Lhat2*S2dotLhat_prmp3 - Lhat2_prmp3*S2dotLhat
S2perp1_prmx = -Lhat1*S2dotLhat_prmx - Lhat1_prmx*S2dotLhat
S2perp1_prmp2 = -Lhat1*S2dotLhat_prmp2 - Lhat1_prmp2*S2dotLhat
S2perp1_prmp3 = -Lhat1*S2dotLhat_prmp3 - Lhat1_prmp3*S2dotLhat
Sperp3_prmx = S1perp3_prmx + S2perp3_prmx
Sperp3_prmp2 = S1perp3_prmp2 + S2perp3_prmp2
Sperp3_prmp3 = S1perp3_prmp3 + S2perp3_prmp3
Sperp2_prmx = S1perp2_prmx + S2perp2_prmx
Sperp2_prmp2 = S1perp2_prmp2 + S2perp2_prmp2
Sperp2_prmp3 = S1perp2_prmp3 + S2perp2_prmp3
Sperp1_prmx = S1perp1_prmx + S2perp1_prmx
Sperp1_prmp2 = S1perp1_prmp2 + S2perp1_prmp2
Sperp1_prmp3 = S1perp1_prmp3 + S2perp1_prmp3
n3_prmx = -r_prmx*z/r**2
n2_prmx = -r_prmx*y/r**2
n1_prmx = 1/r - r_prmx*x/r**2
xi3_prmx = e31*n2_prmx - e32*n1_prmx
xi2_prmx = -e31*n3_prmx + e33*n1_prmx
xi1_prmx = e32*n3_prmx - e33*n2_prmx
v3_prmx = n1*xi2_prmx + n1_prmx*xi2 - n2*xi1_prmx - n2_prmx*xi1
v2_prmx = -n1*xi3_prmx - n1_prmx*xi3 + n3*xi1_prmx + n3_prmx*xi1
v1_prmx = n2*xi3_prmx + n2_prmx*xi3 - n3*xi2_prmx - n3_prmx*xi2
costheta_prmx = e31*n1_prmx + e32*n2_prmx + e33*n3_prmx
sin2theta_prmx = -2*costheta*costheta_prmx
xisq_prmx = sin2theta_prmx
w2_prmx = 2*r*r_prmx
Sigma_prmx = 2*a**2*costheta*costheta_prmx + 2*r*r_prmx
Dinv_prmx = (3*eta*u**2*u_prmx*(52 - 6*eta) + 12*eta*u*u_prmx)/(eta*u**3*(52 - 6*eta) + 6*eta*u**2 + 1)
omegatilde_prmx = 2*a*r_prmx
chi_prmx = (Lhat1_prmx*Skerr1 + Lhat2_prmx*Skerr2 + Lhat3_prmx*Skerr3)/(1 - 2*eta) + (Skerr1*Sperp1_prmx/2 + Skerr2*Sperp2_prmx/2 + Skerr3*Sperp3_prmx/2)/(Skerrmag*(1.0 - 2.0*eta))
chi_prmp2 = (Lhat1_prmp2*Skerr1 + Lhat2_prmp2*Skerr2 + Lhat3_prmp2*Skerr3)/(1 - 2*eta) + (Skerr1*Sperp1_prmp2/2 + Skerr2*Sperp2_prmp2/2 + Skerr3*Sperp3_prmp2/2)/(Skerrmag*(1.0 - 2.0*eta))
chi_prmp3 = (Lhat1_prmp3*Skerr1 + Lhat2_prmp3*Skerr2 + Lhat3_prmp3*Skerr3)/(1 - 2*eta) + (Skerr1*Sperp1_prmp3/2 + Skerr2*Sperp2_prmp3/2 + Skerr3*Sperp3_prmp3/2)/(Skerrmag*(1.0 - 2.0*eta))
K_prmx = -177.4974*chi**2*chi_prmx*eta**3 - 1.280874*chi**2*chi_prmx*eta + 4.30977*chi**2*chi_prmx + 62.3492*chi*chi_prmx*eta**3 + 12.32932*chi*chi_prmx*eta**2 - 2.76172*chi*chi_prmx - 27.5201*chi_prmx*eta**3 + 17.3736*chi_prmx*eta**2 + 2.26831*chi_prmx*eta - 1.62045*chi_prmx
K_prmp2 = -177.4974*chi**2*chi_prmp2*eta**3 - 1.280874*chi**2*chi_prmp2*eta + 4.30977*chi**2*chi_prmp2 + 62.3492*chi*chi_prmp2*eta**3 + 12.32932*chi*chi_prmp2*eta**2 - 2.76172*chi*chi_prmp2 - 27.5201*chi_prmp2*eta**3 + 17.3736*chi_prmp2*eta**2 + 2.26831*chi_prmp2*eta - 1.62045*chi_prmp2
K_prmp3 = -177.4974*chi**2*chi_prmp3*eta**3 - 1.280874*chi**2*chi_prmp3*eta + 4.30977*chi**2*chi_prmp3 + 62.3492*chi*chi_prmp3*eta**3 + 12.32932*chi*chi_prmp3*eta**2 - 2.76172*chi*chi_prmp3 - 27.5201*chi_prmp3*eta**3 + 17.3736*chi_prmp3*eta**2 + 2.26831*chi_prmp3*eta - 1.62045*chi_prmp3
etaKminus1_prmx = K_prmx*eta
etaKminus1_prmp2 = K_prmp2*eta
etaKminus1_prmp3 = K_prmp3*eta
Delta0_prmx = K*K_prmx*eta + K_prmx*(K*eta - 2)
Delta0_prmp2 = K*K_prmp2*eta + K_prmp2*(K*eta - 2)
Delta0_prmp3 = K*K_prmp3*eta + K_prmp3*(K*eta - 2)
Delta1_prmx = etaKminus1*(-2*Delta0_prmx - 2*K_prmx) + etaKminus1_prmx*(-2*Delta0 - 2*K)
Delta1_prmp2 = etaKminus1*(-2*Delta0_prmp2 - 2*K_prmp2) + etaKminus1_prmp2*(-2*Delta0 - 2*K)
Delta1_prmp3 = etaKminus1*(-2*Delta0_prmp3 - 2*K_prmp3) + etaKminus1_prmp3*(-2*Delta0 - 2*K)
Delta2_prmx = -2*Delta0*a**2*etaKminus1*etaKminus1_prmx - Delta0_prmx*a**2*etaKminus1**2 + Delta1*(Delta1_prmx/2 - 2*etaKminus1_prmx) + Delta1_prmx*(Delta1/2 - 2*etaKminus1)
Delta2_prmp2 = -2*Delta0*a**2*etaKminus1*etaKminus1_prmp2 - Delta0_prmp2*a**2*etaKminus1**2 + Delta1*(Delta1_prmp2/2 - 2*etaKminus1_prmp2) + Delta1_prmp2*(Delta1/2 - 2*etaKminus1)
Delta2_prmp3 = -2*Delta0*a**2*etaKminus1*etaKminus1_prmp3 - Delta0_prmp3*a**2*etaKminus1**2 + Delta1*(Delta1_prmp3/2 - 2*etaKminus1_prmp3) + Delta1_prmp3*(Delta1/2 - 2*etaKminus1)
Delta3_prmx = -Delta1**2*Delta1_prmx + Delta1**2*etaKminus1_prmx + 2*Delta1*Delta1_prmx*etaKminus1 + Delta1*Delta2_prmx - 2*Delta1*a**2*etaKminus1*etaKminus1_prmx + Delta1_prmx*Delta2 - Delta1_prmx*a**2*etaKminus1**2 + etaKminus1*(-2*Delta2_prmx + 2*etaKminus1_prmx) + etaKminus1_prmx*(-2*Delta2 + 2*etaKminus1)
Delta3_prmp2 = -Delta1**2*Delta1_prmp2 + Delta1**2*etaKminus1_prmp2 + 2*Delta1*Delta1_prmp2*etaKminus1 + Delta1*Delta2_prmp2 - 2*Delta1*a**2*etaKminus1*etaKminus1_prmp2 + Delta1_prmp2*Delta2 - Delta1_prmp2*a**2*etaKminus1**2 + etaKminus1*(-2*Delta2_prmp2 + 2*etaKminus1_prmp2) + etaKminus1_prmp2*(-2*Delta2 + 2*etaKminus1)
Delta3_prmp3 = -Delta1**2*Delta1_prmp3 + Delta1**2*etaKminus1_prmp3 + 2*Delta1*Delta1_prmp3*etaKminus1 + Delta1*Delta2_prmp3 - 2*Delta1*a**2*etaKminus1*etaKminus1_prmp3 + Delta1_prmp3*Delta2 - Delta1_prmp3*a**2*etaKminus1**2 + etaKminus1*(-2*Delta2_prmp3 + 2*etaKminus1_prmp3) + etaKminus1_prmp3*(-2*Delta2 + 2*etaKminus1)
Delta4_prmx = Delta1**3*Delta1_prmx - 2*Delta1**3*etaKminus1_prmx/3 - 2*Delta1**2*Delta1_prmx*etaKminus1 - Delta1**2*Delta2_prmx - 2*Delta1*Delta1_prmx*Delta2 + Delta1*(2*Delta2*etaKminus1_prmx + 2*Delta2_prmx*etaKminus1 + Delta3_prmx) + Delta1_prmx*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmx - 2*Delta3*etaKminus1_prmx - 2*Delta3_prmx*etaKminus1 + a**2*etaKminus1**2*(2*Delta1*Delta1_prmx - 2*Delta2_prmx)/2 + a**2*etaKminus1*etaKminus1_prmx*(Delta1**2 - 2*Delta2) + etaKminus1*etaKminus1_prmx*(376 - 123*sp.pi**2/8)/6
Delta4_prmp2 = Delta1**3*Delta1_prmp2 - 2*Delta1**3*etaKminus1_prmp2/3 - 2*Delta1**2*Delta1_prmp2*etaKminus1 - Delta1**2*Delta2_prmp2 - 2*Delta1*Delta1_prmp2*Delta2 + Delta1*(2*Delta2*etaKminus1_prmp2 + 2*Delta2_prmp2*etaKminus1 + Delta3_prmp2) + Delta1_prmp2*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmp2 - 2*Delta3*etaKminus1_prmp2 - 2*Delta3_prmp2*etaKminus1 + a**2*etaKminus1**2*(2*Delta1*Delta1_prmp2 - 2*Delta2_prmp2)/2 + a**2*etaKminus1*etaKminus1_prmp2*(Delta1**2 - 2*Delta2) + etaKminus1*etaKminus1_prmp2*(376 - 123*sp.pi**2/8)/6
Delta4_prmp3 = Delta1**3*Delta1_prmp3 - 2*Delta1**3*etaKminus1_prmp3/3 - 2*Delta1**2*Delta1_prmp3*etaKminus1 - Delta1**2*Delta2_prmp3 - 2*Delta1*Delta1_prmp3*Delta2 + Delta1*(2*Delta2*etaKminus1_prmp3 + 2*Delta2_prmp3*etaKminus1 + Delta3_prmp3) + Delta1_prmp3*(2*Delta2*etaKminus1 + Delta3) + Delta2*Delta2_prmp3 - 2*Delta3*etaKminus1_prmp3 - 2*Delta3_prmp3*etaKminus1 + a**2*etaKminus1**2*(2*Delta1*Delta1_prmp3 - 2*Delta2_prmp3)/2 + a**2*etaKminus1*etaKminus1_prmp3*(Delta1**2 - 2*Delta2) + etaKminus1*etaKminus1_prmp3*(376 - 123*sp.pi**2/8)/6
Delta5_prmx = etaKminus1**2*(-a**2*(3*Delta1**2*Delta1_prmx - 3*Delta1*Delta2_prmx - 3*Delta1_prmx*Delta2 + 3*Delta3_prmx)/3 + (4*Delta1**3*Delta1_prmx - 4*Delta1**2*Delta2_prmx - 8*Delta1*Delta1_prmx*Delta2 + 4*Delta1*Delta3_prmx + 4*Delta1_prmx*Delta3 + 4*Delta2*Delta2_prmx - 4*Delta4_prmx)/(2*etaKminus1) - etaKminus1_prmx*(Delta1**4 - 4*Delta1**2*Delta2 + 4*Delta1*Delta3 + 2*Delta2**2 - 4*Delta4)/(2*etaKminus1**2) - (5*Delta1**4*Delta1_prmx - 5*Delta1**3*Delta2_prmx - 15*Delta1**2*Delta1_prmx*Delta2 + 5*Delta1**2*Delta3_prmx + 10*Delta1*Delta1_prmx*Delta3 + 10*Delta1*Delta2*Delta2_prmx - 5*Delta1*Delta4_prmx + 5*Delta1_prmx*Delta2**2 - 5*Delta1_prmx*Delta4 - 5*Delta2*Delta3_prmx - 5*Delta2_prmx*Delta3)/(5*etaKminus1**2) + etaKminus1_prmx*(2*Delta1**5 - 10*Delta1**3*Delta2 + 10*Delta1**2*Delta3 + 10*Delta1*Delta2**2 - 10*Delta1*Delta4 - 10*Delta2*Delta3)/(5*etaKminus1**3)) + etaKminus1*etaKminus1_prmx*(256*EMgamma/5 - 2*a**2*(Delta1**3 - 3*Delta1*Delta2 + 3*Delta3)/3 + 2*eta*(-221/6 + 41*sp.pi**2/32) - 4237/30 + 512*sp.log(2)/5 + 2275*sp.pi**2/256 + (Delta1**4 - 4*Delta1**2*Delta2 + 4*Delta1*Delta3 + 2*Delta2**2 - 4*Delta4)/etaKminus1 - 2*(Delta1**5 - 5*Delta1**3*Delta2 + 5*Delta1**2*Delta3 + 5*Delta1*Delta2**2 - 5*Delta1*Delta4 - 5*Delta2*Delta3)/(5*etaKminus1**2))
Delta5_prmp2 = etaKminus1**2*(-a**2*(3*Delta1**2*Delta1_prmp2 - 3*Delta1*Delta2_prmp2 - 3*Delta1_prmp2*Delta2 + 3*Delta3_prmp2)/3 + (4*Delta1**3*Delta1_prmp2 - 4*Delta1**2*Delta2_prmp2 - 8*Delta1*Delta1_prmp2*Delta2 + 4*Delta1*Delta3_prmp2 + 4*Delta1_prmp2*Delta3 + 4*Delta2*Delta2_prmp2 - 4*Delta4_prmp2)/(2*etaKminus1) - etaKminus1_prmp2*(Delta1**4 - 4*Delta1**2*Delta2 + 4*Delta1*Delta3 + 2*Delta2**2 - 4*Delta4)/(2*etaKminus1**2) - (5*Delta1**4*Delta1_prmp2 - 5*Delta1**3*Delta2_prmp2 - 15*Delta1**2*Delta1_prmp2*Delta2 + 5*Delta1**2*Delta3_prmp2 + 10*Delta1*Delta1_prmp2*Delta3 + 10*Delta1*Delta2*Delta2_prmp2 - 5*Delta1*Delta4_prmp2 + 5*Delta1_prmp2*Delta2**2 - 5*Delta1_prmp2*Delta4 - 5*Delta2*Delta3_prmp2 - 5*Delta2_prmp2*Delta3)/(5*etaKminus1**2) + etaKminus1_prmp2*(2*Delta1**5 - 10*Delta1**3*Delta2 + 10*Delta1**2*Delta3 + 10*Delta1*Delta2**2 - 10*Delta1*Delta4 - 10*Delta2*Delta3)/(5*etaKminus1**3)) + etaKminus1*etaKminus1_prmp2*(256*EMgamma/5 - 2*a**2*(Delta1**3 - 3*Delta1*Delta2 + 3*Delta3)/3 + 2*eta*(-221/6 + 41*sp.pi**2/32) - 4237/30 + 512*sp.log(2)/5 + 2275*sp.pi**2/256 + (Delta1**4 - 4*Delta1**2*Delta2 + 4*Delta1*Delta3 + 2*Delta2**2 - 4*Delta4)/etaKminus1 - 2*(Delta1**5 - 5*Delta1**3*Delta2 + 5*Delta1**2*Delta3 + 5*Delta1*Delta2**2 - 5*Delta1*Delta4 - 5*Delta2*Delta3)/(5*etaKminus1**2))
Delta5_prmp3 = etaKminus1**2*(-a**2*(3*Delta1**2*Delta1_prmp3 - 3*Delta1*Delta2_prmp3 - 3*Delta1_prmp3*Delta2 + 3*Delta3_prmp3)/3 + (4*Delta1**3*Delta1_prmp3 - 4*Delta1**2*Delta2_prmp3 - 8*Delta1*Delta1_prmp3*Delta2 + 4*Delta1*Delta3_prmp3 + 4*Delta1_prmp3*Delta3 + 4*Delta2*Delta2_prmp3 - 4*Delta4_prmp3)/(2*etaKminus1) - etaKminus1_prmp3*(Delta1**4 - 4*Delta1**2*Delta2 + 4*Delta1*Delta3 + 2*Delta2**2 - 4*Delta4)/(2*etaKminus1**2) - (5*Delta1**4*Delta1_prmp3 - 5*Delta1**3*Delta2_prmp3 - 15*Delta1**2*Delta1_prmp3*Delta2 + 5*Delta1**2*Delta3_prmp3 + 10*Delta1*Delta1_prmp3*Delta3 + 10*Delta1*Delta2*Delta2_prmp3 - 5*Delta1*Delta4_prmp3 + 5*Delta1_prmp3*Delta2**2 - 5*Delta1_prmp3*Delta4 - 5*Delta2*Delta3_prmp3 - 5*Delta2_prmp3*Delta3)/(5*etaKminus1**2) + etaKminus1_prmp3*(2*Delta1**5 - 10*Delta1**3*Delta2 + 10*Delta1**2*Delta3 + 10*Delta1*Delta2**2 - 10*Delta1*Delta4 - 10*Delta2*Delta3)/(5*etaKminus1**3)) + etaKminus1*etaKminus1_prmp3*(256*EMgamma/5 - 2*a**2*(Delta1**3 - 3*Delta1*Delta2 + 3*Delta3)/3 + 2*eta*(-221/6 + 41*sp.pi**2/32) - 4237/30 + 512*sp.log(2)/5 + 2275*sp.pi**2/256 + (Delta1**4 - 4*Delta1**2*Delta2 + 4*Delta1*Delta3 + 2*Delta2**2 - 4*Delta4)/etaKminus1 - 2*(Delta1**5 - 5*Delta1**3*Delta2 + 5*Delta1**2*Delta3 + 5*Delta1*Delta2**2 - 5*Delta1*Delta4 - 5*Delta2*Delta3)/(5*etaKminus1**2))
Delta5l_prmx = 128*etaKminus1*etaKminus1_prmx/5
Delta5l_prmp2 = 128*etaKminus1*etaKminus1_prmp2/5
Delta5l_prmp3 = 128*etaKminus1*etaKminus1_prmp3/5
logarg_prmx = u*(Delta1_prmx + u*(Delta2_prmx + u*(Delta3_prmx + u*(Delta4_prmx + u*(Delta5l*u_prmx/u + Delta5l_prmx*sp.log(u) + Delta5_prmx) + u_prmx*(Delta5 + Delta5l*sp.log(u))) + u_prmx*(Delta4 + u*(Delta5 + Delta5l*sp.log(u)))) + u_prmx*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*sp.log(u))))) + u_prmx*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*sp.log(u)))))) + u_prmx*(Delta1 + u*(Delta2 + u*(Delta3 + u*(Delta4 + u*(Delta5 + Delta5l*sp.log(u))))))
logarg_prmp2 = u*(Delta1_prmp2 + u*(Delta2_prmp2 + u*(Delta3_prmp2 + u*(Delta4_prmp2 + u*(Delta5l_prmp2*sp.log(u) + Delta5_prmp2)))))
logarg_prmp3 = u*(Delta1_prmp3 + u*(Delta2_prmp3 + u*(Delta3_prmp3 + u*(Delta4_prmp3 + u*(Delta5l_prmp3*sp.log(u) + Delta5_prmp3)))))
Deltaucalib_prmx = eta*(Delta0_prmx + logarg_prmx/(logarg + 1))
Deltaucalib_prmp2 = eta*(Delta0_prmp2 + logarg_prmp2/(logarg + 1))
Deltaucalib_prmp3 = eta*(Delta0_prmp3 + logarg_prmp3/(logarg + 1))
Deltaucalibprime_prmx = eta*logarg_prmx*u**2*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*sp.log(u))))))/(logarg + 1)**2 - eta*u**2*(Delta1_prmx + u*(2*Delta2_prmx + u*(3*Delta3_prmx + u*(4*Delta4_prmx + u*(5*Delta5l*u_prmx/u + 5*Delta5l_prmx*sp.log(u) + 5*Delta5_prmx) + u_prmx*(5*Delta5 + 5*Delta5l*sp.log(u))) + u_prmx*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*sp.log(u)))) + u_prmx*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*sp.log(u))))) + u_prmx*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*sp.log(u))))))/(logarg + 1) - 2*eta*u*u_prmx*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*sp.log(u))))))/(logarg + 1)
Deltaucalibprime_prmp2 = eta*logarg_prmp2*u**2*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*sp.log(u))))))/(logarg + 1)**2 - eta*u**2*(Delta1_prmp2 + u*(2*Delta2_prmp2 + u*(3*Delta3_prmp2 + u*(4*Delta4_prmp2 + u*(5*Delta5l_prmp2*sp.log(u) + 5*Delta5_prmp2)))))/(logarg + 1)
Deltaucalibprime_prmp3 = eta*logarg_prmp3*u**2*(Delta1 + u*(2*Delta2 + u*(3*Delta3 + u*(4*Delta4 + u*(5*Delta5 + 5*Delta5l*sp.log(u))))))/(logarg + 1)**2 - eta*u**2*(Delta1_prmp3 + u*(2*Delta2_prmp3 + u*(3*Delta3_prmp3 + u*(4*Delta4_prmp3 + u*(5*Delta5l_prmp3*sp.log(u) + 5*Delta5_prmp3)))))/(logarg + 1)
Deltaubar_prmx = 2*a**2*u*u_prmx + (2*u_prmx - etaKminus1_prmx/etaKminus1**2)/etaKminus1 + etaKminus1_prmx*(-2*u - 1/etaKminus1)/etaKminus1**2
Deltaubar_prmp2 = etaKminus1_prmp2*(-2*u - 1/etaKminus1)/etaKminus1**2 - etaKminus1_prmp2/etaKminus1**3
Deltaubar_prmp3 = etaKminus1_prmp3*(-2*u - 1/etaKminus1)/etaKminus1**2 - etaKminus1_prmp3/etaKminus1**3
Deltaubarprime_prmx = -6*a**2*u**2*u_prmx - 4*u*u_prmx/etaKminus1 + 2*etaKminus1_prmx*u**2/etaKminus1**2
Deltaubarprime_prmp2 = 2*etaKminus1_prmp2*u**2/etaKminus1**2
Deltaubarprime_prmp3 = 2*etaKminus1_prmp3*u**2/etaKminus1**2
Deltau_prmx = (Deltaubar*Deltaucalib_prmx + Deltaubar_prmx*Deltaucalib)*sp.sign(Deltaubar*Deltaucalib)
Deltau_prmp2 = (Deltaubar*Deltaucalib_prmp2 + Deltaubar_prmp2*Deltaucalib)*sp.sign(Deltaubar*Deltaucalib)
Deltau_prmp3 = (Deltaubar*Deltaucalib_prmp3 + Deltaubar_prmp3*Deltaucalib)*sp.sign(Deltaubar*Deltaucalib)
Deltauprime_prmx = Deltaubar*Deltaucalibprime_prmx + Deltaubarprime*Deltaucalib_prmx + Deltaubarprime_prmx*Deltaucalib + Deltaubar_prmx*Deltaucalibprime
Deltauprime_prmp2 = Deltaubar*Deltaucalibprime_prmp2 + Deltaubarprime*Deltaucalib_prmp2 + Deltaubarprime_prmp2*Deltaucalib + Deltaubar_prmp2*Deltaucalibprime
Deltauprime_prmp3 = Deltaubar*Deltaucalibprime_prmp3 + Deltaubarprime*Deltaucalib_prmp3 + Deltaubarprime_prmp3*Deltaucalib + Deltaubar_prmp3*Deltaucalibprime
Deltatprime_prmx = 2*Deltau*r_prmx + 2*Deltauprime*r*r_prmx + Deltauprime_prmx*r**2 + 2*Deltau_prmx*r
Deltatprime_prmp2 = Deltauprime_prmp2*r**2 + 2*Deltau_prmp2*r
Deltatprime_prmp3 = Deltauprime_prmp3*r**2 + 2*Deltau_prmp3*r
Deltat_prmx = 2*Deltau*r*r_prmx + Deltau_prmx*r**2
Deltat_prmp2 = Deltau_prmp2*r**2
Deltat_prmp3 = Deltau_prmp3*r**2
Deltar_prmx = Deltat*Dinv_prmx + Deltat_prmx*Dinv
Deltar_prmp2 = Deltat_prmp2*Dinv
Deltar_prmp3 = Deltat_prmp3*Dinv
Lambt_prmx = (Deltat*a**2*sin2theta_prmx + Deltat_prmx*a**2*sin2theta - 2*w2*w2_prmx)*sp.sign(Deltat*a**2*sin2theta - w2**2)
Lambt_prmp2 = Deltat_prmp2*a**2*sin2theta*sp.sign(Deltat*a**2*sin2theta - w2**2)
Lambt_prmp3 = Deltat_prmp3*a**2*sin2theta*sp.sign(Deltat*a**2*sin2theta - w2**2)
csi_prmx = -w2_prmx*sp.sqrt(Deltar*Deltat)/w2**2 + sp.sqrt(Deltar*Deltat)*(Deltar*Deltat_prmx/2 + Deltar_prmx*Deltat/2)/(Deltar*Deltat*w2)
csi_prmp2 = sp.sqrt(Deltar*Deltat)*(Deltar*Deltat_prmp2/2 + Deltar_prmp2*Deltat/2)/(Deltar*Deltat*w2)
csi_prmp3 = sp.sqrt(Deltar*Deltat)*(Deltar*Deltat_prmp3/2 + Deltar_prmp3*Deltat/2)/(Deltar*Deltat*w2)
csi1_prmx = csi_prmx*(1 - sp.Abs(tortoise - 1))
csi1_prmp2 = csi_prmp2*(1 - sp.Abs(tortoise - 1))
csi1_prmp3 = csi_prmp3*(1 - sp.Abs(tortoise - 1))
csi2_prmx = csi_prmx*(1/2 - sp.sign(3/2 - tortoise)/2)
csi2_prmp2 = csi_prmp2*(1/2 - sp.sign(3/2 - tortoise)/2)
csi2_prmp3 = csi_prmp3*(1/2 - sp.sign(3/2 - tortoise)/2)
prT_prmx = csi2*(n1_prmx*p1 + n2_prmx*p2 + n3_prmx*p3) + csi2_prmx*(n1*p1 + n2*p2 + n3*p3)
prT_prmp2 = csi2*n2 + csi2_prmp2*(n1*p1 + n2*p2 + n3*p3)
prT_prmp3 = csi2*n3 + csi2_prmp3*(n1*p1 + n2*p2 + n3*p3)
phat3_prmx = n3*prT_prmx*(-1 + 1/csi1) + n3_prmx*prT*(-1 + 1/csi1) - csi1_prmx*n3*prT/csi1**2
phat3_prmp2 = n3*prT_prmp2*(-1 + 1/csi1) - csi1_prmp2*n3*prT/csi1**2
phat3_prmp3 = n3*prT_prmp3*(-1 + 1/csi1) + 1 - csi1_prmp3*n3*prT/csi1**2
phat2_prmx = n2*prT_prmx*(-1 + 1/csi1) + n2_prmx*prT*(-1 + 1/csi1) - csi1_prmx*n2*prT/csi1**2
phat2_prmp2 = n2*prT_prmp2*(-1 + 1/csi1) + 1 - csi1_prmp2*n2*prT/csi1**2
phat2_prmp3 = n2*prT_prmp3*(-1 + 1/csi1) - csi1_prmp3*n2*prT/csi1**2
phat1_prmx = n1*prT_prmx*(-1 + 1/csi1) + n1_prmx*prT*(-1 + 1/csi1) - csi1_prmx*n1*prT/csi1**2
phat1_prmp2 = n1*prT_prmp2*(-1 + 1/csi1) - csi1_prmp2*n1*prT/csi1**2
phat1_prmp3 = n1*prT_prmp3*(-1 + 1/csi1) - csi1_prmp3*n1*prT/csi1**2
pdotxir_prmx = r*(phat1*xi1_prmx + phat1_prmx*xi1 + phat2*xi2_prmx + phat2_prmx*xi2 + phat3*xi3_prmx + phat3_prmx*xi3) + r_prmx*(phat1*xi1 + phat2*xi2 + phat3*xi3)
pdotxir_prmp2 = r*(phat1_prmp2*xi1 + phat2_prmp2*xi2 + phat3_prmp2*xi3)
pdotxir_prmp3 = r*(phat1_prmp3*xi1 + phat2_prmp3*xi2 + phat3_prmp3*xi3)
pdotn_prmx = n1*phat1_prmx + n1_prmx*phat1 + n2*phat2_prmx + n2_prmx*phat2 + n3*phat3_prmx + n3_prmx*phat3
pdotn_prmp2 = n1*phat1_prmp2 + n2*phat2_prmp2 + n3*phat3_prmp2
pdotn_prmp3 = n1*phat1_prmp3 + n2*phat2_prmp3 + n3*phat3_prmp3
pdotvr_prmx = r*(phat1*v1_prmx + phat1_prmx*v1 + phat2*v2_prmx + phat2_prmx*v2 + phat3*v3_prmx + phat3_prmx*v3) + r_prmx*(phat1*v1 + phat2*v2 + phat3*v3)
pdotvr_prmp2 = r*(phat1_prmp2*v1 + phat2_prmp2*v2 + phat3_prmp2*v3)
pdotvr_prmp3 = r*(phat1_prmp3*v1 + phat2_prmp3*v2 + phat3_prmp3*v3)
pphi_prmx = pdotxir_prmx
pphi_prmp2 = pdotxir_prmp2
pphi_prmp3 = pdotxir_prmp3
Qcoeff2_prmx = -sin2theta_prmx/(Sigma*sin2theta**2) - Sigma_prmx/(Sigma**2*sin2theta)
Qcoeff1_prmx = -Sigma*sin2theta_prmx/(Lambt*sin2theta**2) + Sigma_prmx/(Lambt*sin2theta) - Lambt_prmx*Sigma/(Lambt**2*sin2theta)
Qcoeff1_prmp2 = -Lambt_prmp2*Sigma/(Lambt**2*sin2theta)
Qcoeff1_prmp3 = -Lambt_prmp3*Sigma/(Lambt**2*sin2theta)
DrSipn2_prmx = 2*Deltar*pdotn*pdotn_prmx/Sigma - Deltar*Sigma_prmx*pdotn**2/Sigma**2 + Deltar_prmx*pdotn**2/Sigma
DrSipn2_prmp2 = 2*Deltar*pdotn*pdotn_prmp2/Sigma + Deltar_prmp2*pdotn**2/Sigma
DrSipn2_prmp3 = 2*Deltar*pdotn*pdotn_prmp3/Sigma + Deltar_prmp3*pdotn**2/Sigma
Q_prmx = DrSipn2_prmx + 2*Qcoeff1*pdotxir*pdotxir_prmx + Qcoeff1_prmx*pdotxir**2 + 2*Qcoeff2*pdotvr*pdotvr_prmx + Qcoeff2_prmx*pdotvr**2
Q_prmp2 = DrSipn2_prmp2 + 2*Qcoeff1*pdotxir*pdotxir_prmp2 + Qcoeff1_prmp2*pdotxir**2 + 2*Qcoeff2*pdotvr*pdotvr_prmp2
Q_prmp3 = DrSipn2_prmp3 + 2*Qcoeff1*pdotxir*pdotxir_prmp3 + Qcoeff1_prmp3*pdotxir**2 + 2*Qcoeff2*pdotvr*pdotvr_prmp3
Qminus1_prmx = Q_prmx
Qminus1_prmp2 = Q_prmp2
Qminus1_prmp3 = Q_prmp3
Jtilde_prmx = Deltar_prmx/(2*sp.sqrt(Deltar))
Jtilde_prmp2 = Deltar_prmp2/(2*sp.sqrt(Deltar))
Jtilde_prmp3 = Deltar_prmp3/(2*sp.sqrt(Deltar))
exp2mu_prmx = Sigma_prmx
expmu_prmx = exp2mu_prmx/(2*sp.sqrt(exp2mu))
Brtilde_prmx = (sp.sqrt(Deltar)*Deltatprime_prmx - 2*Deltat_prmx + Deltar_prmx*Deltatprime/(2*sp.sqrt(Deltar)))/(2*sp.sqrt(Deltar*Deltat)) + (sp.sqrt(Deltar)*Deltatprime - 2*Deltat)*(-Deltar*Deltat_prmx/2 - Deltar_prmx*Deltat/2)/(2*Deltar*Deltat*sp.sqrt(Deltar*Deltat))
Brtilde_prmp2 = (sp.sqrt(Deltar)*Deltatprime_prmp2 - 2*Deltat_prmp2 + Deltar_prmp2*Deltatprime/(2*sp.sqrt(Deltar)))/(2*sp.sqrt(Deltar*Deltat)) + (sp.sqrt(Deltar)*Deltatprime - 2*Deltat)*(-Deltar*Deltat_prmp2/2 - Deltar_prmp2*Deltat/2)/(2*Deltar*Deltat*sp.sqrt(Deltar*Deltat))
Brtilde_prmp3 = (sp.sqrt(Deltar)*Deltatprime_prmp3 - 2*Deltat_prmp3 + Deltar_prmp3*Deltatprime/(2*sp.sqrt(Deltar)))/(2*sp.sqrt(Deltar*Deltat)) + (sp.sqrt(Deltar)*Deltatprime - 2*Deltat)*(-Deltar*Deltat_prmp3/2 - Deltar_prmp3*Deltat/2)/(2*Deltar*Deltat*sp.sqrt(Deltar*Deltat))
Btilde_prmx = Deltat_prmx/(2*sp.sqrt(Deltat))
Btilde_prmp2 = Deltat_prmp2/(2*sp.sqrt(Deltat))
Btilde_prmp3 = Deltat_prmp3/(2*sp.sqrt(Deltat))
exp2nu_prmx = Deltat*Sigma_prmx/Lambt - Deltat*Lambt_prmx*Sigma/Lambt**2 + Deltat_prmx*Sigma/Lambt
exp2nu_prmp2 = -Deltat*Lambt_prmp2*Sigma/Lambt**2 + Deltat_prmp2*Sigma/Lambt
exp2nu_prmp3 = -Deltat*Lambt_prmp3*Sigma/Lambt**2 + Deltat_prmp3*Sigma/Lambt
expnu_prmx = exp2nu_prmx/(2*sp.sqrt(exp2nu))
expnu_prmp2 = exp2nu_prmp2/(2*sp.sqrt(exp2nu))
expnu_prmp3 = exp2nu_prmp3/(2*sp.sqrt(exp2nu))
omega_prmx = omegatilde_prmx/Lambt - Lambt_prmx*omegatilde/Lambt**2
omega_prmp2 = -Lambt_prmp2*omegatilde/Lambt**2
omega_prmp3 = -Lambt_prmp3*omegatilde/Lambt**2
Lambtprime_prmx = -Deltatprime*a**2*sin2theta_prmx - Deltatprime_prmx*a**2*sin2theta + 8*r**2*r_prmx + r_prmx*(4*a**2 + 4*r**2)
Lambtprime_prmp2 = -Deltatprime_prmp2*a**2*sin2theta
Lambtprime_prmp3 = -Deltatprime_prmp3*a**2*sin2theta
mucostheta_prmx = a**2*costheta_prmx/Sigma - Sigma_prmx*a**2*costheta/Sigma**2
nucostheta_prmx = a**2*costheta*w2*(-Deltat_prmx + w2_prmx)/(Lambt*Sigma) + a**2*costheta*w2_prmx*(-Deltat + w2)/(Lambt*Sigma) + a**2*costheta_prmx*w2*(-Deltat + w2)/(Lambt*Sigma) - Sigma_prmx*a**2*costheta*w2*(-Deltat + w2)/(Lambt*Sigma**2) - Lambt_prmx*a**2*costheta*w2*(-Deltat + w2)/(Lambt**2*Sigma)
nucostheta_prmp2 = -Deltat_prmp2*a**2*costheta*w2/(Lambt*Sigma) - Lambt_prmp2*a**2*costheta*w2*(-Deltat + w2)/(Lambt**2*Sigma)
nucostheta_prmp3 = -Deltat_prmp3*a**2*costheta*w2/(Lambt*Sigma) - Lambt_prmp3*a**2*costheta*w2*(-Deltat + w2)/(Lambt**2*Sigma)
omegacostheta_prmx = -2*Deltat*a**2*costheta*omegatilde_prmx/Lambt**2 - 2*Deltat*a**2*costheta_prmx*omegatilde/Lambt**2 + 4*Deltat*Lambt_prmx*a**2*costheta*omegatilde/Lambt**3 - 2*Deltat_prmx*a**2*costheta*omegatilde/Lambt**2
omegacostheta_prmp2 = 4*Deltat*Lambt_prmp2*a**2*costheta*omegatilde/Lambt**3 - 2*Deltat_prmp2*a**2*costheta*omegatilde/Lambt**2
omegacostheta_prmp3 = 4*Deltat*Lambt_prmp3*a**2*costheta*omegatilde/Lambt**3 - 2*Deltat_prmp3*a**2*costheta*omegatilde/Lambt**2
mur_prmx = r_prmx/Sigma - Sigma_prmx*r/Sigma**2 + Deltar_prmx/(2*Deltar**(3/2))
mur_prmp2 = Deltar_prmp2/(2*Deltar**(3/2))
mur_prmp3 = Deltar_prmp3/(2*Deltar**(3/2))
nur_prmx = r_prmx/Sigma - Sigma_prmx*r/Sigma**2 + w2*(-4*Deltat*r_prmx + Deltatprime*w2_prmx + Deltatprime_prmx*w2 - 4*Deltat_prmx*r)/(2*Deltat*Lambt) + w2_prmx*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt) - Lambt_prmx*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt**2) - Deltat_prmx*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt)
nur_prmp2 = w2*(Deltatprime_prmp2*w2 - 4*Deltat_prmp2*r)/(2*Deltat*Lambt) - Lambt_prmp2*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt**2) - Deltat_prmp2*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt)
nur_prmp3 = w2*(Deltatprime_prmp3*w2 - 4*Deltat_prmp3*r)/(2*Deltat*Lambt) - Lambt_prmp3*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat*Lambt**2) - Deltat_prmp3*w2*(-4*Deltat*r + Deltatprime*w2)/(2*Deltat**2*Lambt)
omegar_prmx = (-Lambtprime*omegatilde_prmx - Lambtprime_prmx*omegatilde + Lambt_prmx*omegatildeprime)/Lambt**2 + Lambt_prmx*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/Lambt**3
omegar_prmp2 = (-Lambtprime_prmp2*omegatilde + Lambt_prmp2*omegatildeprime)/Lambt**2 + Lambt_prmp2*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/Lambt**3
omegar_prmp3 = (-Lambtprime_prmp3*omegatilde + Lambt_prmp3*omegatildeprime)/Lambt**2 + Lambt_prmp3*(-2*Lambt*omegatildeprime + 2*Lambtprime*omegatilde)/Lambt**3
dSO_prmx = 442.443*chi**2*chi_prmx*eta**2 - 1705.953*chi**2*chi_prmx*eta + 198.5961*chi**2*chi_prmx - 686.626*chi*chi_prmx*eta + 2495.29*chi_prmx*eta**2
dSO_prmp2 = 442.443*chi**2*chi_prmp2*eta**2 - 1705.953*chi**2*chi_prmp2*eta + 198.5961*chi**2*chi_prmp2 - 686.626*chi*chi_prmp2*eta + 2495.29*chi_prmp2*eta**2
dSO_prmp3 = 442.443*chi**2*chi_prmp3*eta**2 - 1705.953*chi**2*chi_prmp3*eta + 198.5961*chi**2*chi_prmp3 - 686.626*chi*chi_prmp3*eta + 2495.29*chi_prmp3*eta**2
sigmacoeffTerm3_prmx = 3*dSO*eta*u**2*u_prmx + dSO_prmx*eta*u**3
sigmacoeffTerm3_prmp2 = dSO_prmp2*eta*u**3
sigmacoeffTerm3_prmp3 = dSO_prmp3*eta*u**3
sigmacoeffTerm2_prmx = eta*(eta*(r*(-882*DrSipn2_prmx + 204*Qminus1_prmx + r*(1620*DrSipn2*DrSipn2_prmx - 234*DrSipn2*Qminus1_prmx - 234*DrSipn2_prmx*Qminus1) + r_prmx*(810*DrSipn2**2 - 234*DrSipn2*Qminus1)) + r_prmx*(-882*DrSipn2 + 204*Qminus1 + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1))) + r*(-96*DrSipn2_prmx - 436*Qminus1_prmx + r*(36*DrSipn2*Qminus1_prmx + 36*DrSipn2_prmx*Qminus1 - 90*Qminus1*Qminus1_prmx) + r_prmx*(36*DrSipn2*Qminus1 - 45*Qminus1**2)) + r_prmx*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*Qminus1**2)))/(144*r**2) - eta*r_prmx*(eta*(r*(-882*DrSipn2 + 204*Qminus1 + r*(810*DrSipn2**2 - 234*DrSipn2*Qminus1)) - 336) + r*(-96*DrSipn2 - 436*Qminus1 + r*(36*DrSipn2*Qminus1 - 45*Qminus1**2)) - 896)/(72*r**3)
sigmacoeffTerm2_prmp2 = eta*(eta*r*(-882*DrSipn2_prmp2 + 204*Qminus1_prmp2 + r*(1620*DrSipn2*DrSipn2_prmp2 - 234*DrSipn2*Qminus1_prmp2 - 234*DrSipn2_prmp2*Qminus1)) + r*(-96*DrSipn2_prmp2 - 436*Qminus1_prmp2 + r*(36*DrSipn2*Qminus1_prmp2 + 36*DrSipn2_prmp2*Qminus1 - 90*Qminus1*Qminus1_prmp2)))/(144*r**2)
sigmacoeffTerm2_prmp3 = eta*(eta*r*(-882*DrSipn2_prmp3 + 204*Qminus1_prmp3 + r*(1620*DrSipn2*DrSipn2_prmp3 - 234*DrSipn2*Qminus1_prmp3 - 234*DrSipn2_prmp3*Qminus1)) + r*(-96*DrSipn2_prmp3 - 436*Qminus1_prmp3 + r*(36*DrSipn2*Qminus1_prmp3 + 36*DrSipn2_prmp3*Qminus1 - 90*Qminus1*Qminus1_prmp3)))/(144*r**2)
sigmacoeffTerm1_prmx = eta*(-36*DrSipn2_prmx + 3*Qminus1_prmx + 8*r_prmx/r**2)/12
sigmacoeffTerm1_prmp2 = eta*(-36*DrSipn2_prmp2 + 3*Qminus1_prmp2)/12
sigmacoeffTerm1_prmp3 = eta*(-36*DrSipn2_prmp3 + 3*Qminus1_prmp3)/12
sigmacoeff_prmx = sigmacoeffTerm1_prmx + sigmacoeffTerm2_prmx + sigmacoeffTerm3_prmx
sigmacoeff_prmp2 = sigmacoeffTerm1_prmp2 + sigmacoeffTerm2_prmp2 + sigmacoeffTerm3_prmp2
sigmacoeff_prmp3 = sigmacoeffTerm1_prmp3 + sigmacoeffTerm2_prmp3 + sigmacoeffTerm3_prmp3
sigmastarcoeffTerm2_prmx = eta*(eta*(r*(-324*DrSipn2_prmx + 120*Qminus1_prmx + r*(720*DrSipn2*DrSipn2_prmx + Qminus1*(-126*DrSipn2_prmx - 3*Qminus1_prmx) + Qminus1_prmx*(-126*DrSipn2 - 3*Qminus1)) + r_prmx*(360*DrSipn2**2 + Qminus1*(-126*DrSipn2 - 3*Qminus1))) + r_prmx*(-324*DrSipn2 + 120*Qminus1 + r*(360*DrSipn2**2 + Qminus1*(-126*DrSipn2 - 3*Qminus1)))) + r*(282*DrSipn2_prmx + Qminus1*r*(96*DrSipn2_prmx - 23*Qminus1_prmx) + Qminus1*r_prmx*(96*DrSipn2 - 23*Qminus1) + Qminus1_prmx*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmx) + r_prmx*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1))/(72*r**2) - eta*r_prmx*(eta*(r*(-324*DrSipn2 + 120*Qminus1 + r*(360*DrSipn2**2 + Qminus1*(-126*DrSipn2 - 3*Qminus1))) - 54) + r*(282*DrSipn2 + Qminus1*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1) + 706)/(36*r**3)
sigmastarcoeffTerm2_prmp2 = eta*(eta*r*(-324*DrSipn2_prmp2 + 120*Qminus1_prmp2 + r*(720*DrSipn2*DrSipn2_prmp2 + Qminus1*(-126*DrSipn2_prmp2 - 3*Qminus1_prmp2) + Qminus1_prmp2*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmp2 + Qminus1*r*(96*DrSipn2_prmp2 - 23*Qminus1_prmp2) + Qminus1_prmp2*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmp2))/(72*r**2)
sigmastarcoeffTerm2_prmp3 = eta*(eta*r*(-324*DrSipn2_prmp3 + 120*Qminus1_prmp3 + r*(720*DrSipn2*DrSipn2_prmp3 + Qminus1*(-126*DrSipn2_prmp3 - 3*Qminus1_prmp3) + Qminus1_prmp3*(-126*DrSipn2 - 3*Qminus1))) + r*(282*DrSipn2_prmp3 + Qminus1*r*(96*DrSipn2_prmp3 - 23*Qminus1_prmp3) + Qminus1_prmp3*r*(96*DrSipn2 - 23*Qminus1) - 206*Qminus1_prmp3))/(72*r**2)
sigmastarcoeffTerm1_prmx = eta*(-30*DrSipn2_prmx + 4*Qminus1_prmx - 14*r_prmx/r**2)/12
sigmastarcoeffTerm1_prmp2 = eta*(-30*DrSipn2_prmp2 + 4*Qminus1_prmp2)/12
sigmastarcoeffTerm1_prmp3 = eta*(-30*DrSipn2_prmp3 + 4*Qminus1_prmp3)/12
sigmastarcoeff_prmx = sigmastarcoeffTerm1_prmx + sigmastarcoeffTerm2_prmx
sigmastarcoeff_prmp2 = sigmastarcoeffTerm1_prmp2 + sigmastarcoeffTerm2_prmp2
sigmastarcoeff_prmp3 = sigmastarcoeffTerm1_prmp3 + sigmastarcoeffTerm2_prmp3
Deltasigmastar3_prmx = sigma3*sigmacoeff_prmx + sigmastar3*sigmastarcoeff_prmx
Deltasigmastar3_prmp2 = sigma3*sigmacoeff_prmp2 + sigmastar3*sigmastarcoeff_prmp2
Deltasigmastar3_prmp3 = sigma3*sigmacoeff_prmp3 + sigmastar3*sigmastarcoeff_prmp3
Deltasigmastar2_prmx = sigma2*sigmacoeff_prmx + sigmastar2*sigmastarcoeff_prmx
Deltasigmastar2_prmp2 = sigma2*sigmacoeff_prmp2 + sigmastar2*sigmastarcoeff_prmp2
Deltasigmastar2_prmp3 = sigma2*sigmacoeff_prmp3 + sigmastar2*sigmastarcoeff_prmp3
Deltasigmastar1_prmx = sigma1*sigmacoeff_prmx + sigmastar1*sigmastarcoeff_prmx
Deltasigmastar1_prmp2 = sigma1*sigmacoeff_prmp2 + sigmastar1*sigmastarcoeff_prmp2
Deltasigmastar1_prmp3 = sigma1*sigmacoeff_prmp3 + sigmastar1*sigmastarcoeff_prmp3
Sstar3_prmx = Deltasigmastar3_prmx
Sstar3_prmp2 = Deltasigmastar3_prmp2
Sstar3_prmp3 = Deltasigmastar3_prmp3
Sstar2_prmx = Deltasigmastar2_prmx
Sstar2_prmp2 = Deltasigmastar2_prmp2
Sstar2_prmp3 = Deltasigmastar2_prmp3
Sstar1_prmx = Deltasigmastar1_prmx
Sstar1_prmp2 = Deltasigmastar1_prmp2
Sstar1_prmp3 = Deltasigmastar1_prmp3
S3_prmx = Sstar3_prmx
S3_prmp2 = Sstar3_prmp2
S3_prmp3 = Sstar3_prmp3
S2_prmx = Sstar2_prmx
S2_prmp2 = Sstar2_prmp2
S2_prmp3 = Sstar2_prmp3
S1_prmx = Sstar1_prmx
S1_prmp2 = Sstar1_prmp2
S1_prmp3 = Sstar1_prmp3
Sstardotn_prmx = Sstar1*n1_prmx + Sstar1_prmx*n1 + Sstar2*n2_prmx + Sstar2_prmx*n2 + Sstar3*n3_prmx + Sstar3_prmx*n3
Sstardotn_prmp2 = Sstar1_prmp2*n1 + Sstar2_prmp2*n2 + Sstar3_prmp2*n3
Sstardotn_prmp3 = Sstar1_prmp3*n1 + Sstar2_prmp3*n2 + Sstar3_prmp3*n3
SdotSkerrhat_prmx = S1_prmx*Skerrhat1 + S2_prmx*Skerrhat2 + S3_prmx*Skerrhat3
SdotSkerrhat_prmp2 = S1_prmp2*Skerrhat1 + S2_prmp2*Skerrhat2 + S3_prmp2*Skerrhat3
SdotSkerrhat_prmp3 = S1_prmp3*Skerrhat1 + S2_prmp3*Skerrhat2 + S3_prmp3*Skerrhat3
Sdotn_prmx = S1*n1_prmx + S1_prmx*n1 + S2*n2_prmx + S2_prmx*n2 + S3*n3_prmx + S3_prmx*n3
Sdotn_prmp2 = S1_prmp2*n1 + S2_prmp2*n2 + S3_prmp2*n3
Sdotn_prmp3 = S1_prmp3*n1 + S2_prmp3*n2 + S3_prmp3*n3
Sdotv_prmx = S1*v1_prmx + S1_prmx*v1 + S2*v2_prmx + S2_prmx*v2 + S3*v3_prmx + S3_prmx*v3
Sdotv_prmp2 = S1_prmp2*v1 + S2_prmp2*v2 + S3_prmp2*v3
Sdotv_prmp3 = S1_prmp3*v1 + S2_prmp3*v2 + S3_prmp3*v3
Sdotxi_prmx = S1*xi1_prmx + S1_prmx*xi1 + S2*xi2_prmx + S2_prmx*xi2 + S3*xi3_prmx + S3_prmx*xi3
Sdotxi_prmp2 = S1_prmp2*xi1 + S2_prmp2*xi2 + S3_prmp2*xi3
Sdotxi_prmp3 = S1_prmp3*xi1 + S2_prmp3*xi2 + S3_prmp3*xi3
HdsumTerm2_prmx = 6*Sstardotn*Sstardotn_prmx
HdsumTerm2_prmp2 = 6*Sstardotn*Sstardotn_prmp2
HdsumTerm2_prmp3 = 6*Sstardotn*Sstardotn_prmp3
HdsumTerm1_prmx = 2*Sstar1*Sstar1_prmx + 2*Sstar2*Sstar2_prmx + 2*Sstar3*Sstar3_prmx
HdsumTerm1_prmp2 = 2*Sstar1*Sstar1_prmp2 + 2*Sstar2*Sstar2_prmp2 + 2*Sstar3*Sstar3_prmp2
HdsumTerm1_prmp3 = 2*Sstar1*Sstar1_prmp3 + 2*Sstar2*Sstar2_prmp3 + 2*Sstar3*Sstar3_prmp3
Hdsum_prmx = HdsumTerm1_prmx - HdsumTerm2_prmx
Hdsum_prmp2 = HdsumTerm1_prmp2 - HdsumTerm2_prmp2
Hdsum_prmp3 = HdsumTerm1_prmp3 - HdsumTerm2_prmp3
Hdcoeff_prmx = -3*r_prmx/(2*r**4)
Q4_prmx = 4*eta*prT**4*u*u_prmx*(4 - 3*eta) + 8*eta*prT**3*prT_prmx*u**2*(4 - 3*eta)
Q4_prmp2 = 8*eta*prT**3*prT_prmp2*u**2*(4 - 3*eta)
Q4_prmp3 = 8*eta*prT**3*prT_prmp3*u**2*(4 - 3*eta)
gammappsum_prmx = 2*Deltar*pdotn*pdotn_prmx/Sigma - Deltar*Sigma_prmx*pdotn**2/Sigma**2 + Deltar_prmx*pdotn**2/Sigma - pdotvr**2*sin2theta_prmx/(Sigma*sin2theta**2) + 2*pdotvr*pdotvr_prmx/(Sigma*sin2theta) - Sigma_prmx*pdotvr**2/(Sigma**2*sin2theta) - Sigma*pdotxir**2*sin2theta_prmx/(Lambt*sin2theta**2) + 2*Sigma*pdotxir*pdotxir_prmx/(Lambt*sin2theta) + Sigma_prmx*pdotxir**2/(Lambt*sin2theta) - Lambt_prmx*Sigma*pdotxir**2/(Lambt**2*sin2theta)
gammappsum_prmp2 = 2*Deltar*pdotn*pdotn_prmp2/Sigma + Deltar_prmp2*pdotn**2/Sigma + 2*pdotvr*pdotvr_prmp2/(Sigma*sin2theta) + 2*Sigma*pdotxir*pdotxir_prmp2/(Lambt*sin2theta) - Lambt_prmp2*Sigma*pdotxir**2/(Lambt**2*sin2theta)
gammappsum_prmp3 = 2*Deltar*pdotn*pdotn_prmp3/Sigma + Deltar_prmp3*pdotn**2/Sigma + 2*pdotvr*pdotvr_prmp3/(Sigma*sin2theta) + 2*Sigma*pdotxir*pdotxir_prmp3/(Lambt*sin2theta) - Lambt_prmp3*Sigma*pdotxir**2/(Lambt**2*sin2theta)
Hnsradicand_prmx = Q4_prmx + gammappsum_prmx
Hnsradicand_prmp2 = Q4_prmp2 + gammappsum_prmp2
Hnsradicand_prmp3 = Q4_prmp3 + gammappsum_prmp3
alpha_prmx = Lambt*sp.sqrt(Deltat*Sigma/Lambt)*(Deltat*Sigma_prmx/(2*Lambt) - Deltat*Lambt_prmx*Sigma/(2*Lambt**2) + Deltat_prmx*Sigma/(2*Lambt))/(Deltat*Sigma)
alpha_prmp2 = Lambt*sp.sqrt(Deltat*Sigma/Lambt)*(-Deltat*Lambt_prmp2*Sigma/(2*Lambt**2) + Deltat_prmp2*Sigma/(2*Lambt))/(Deltat*Sigma)
alpha_prmp3 = Lambt*sp.sqrt(Deltat*Sigma/Lambt)*(-Deltat*Lambt_prmp3*Sigma/(2*Lambt**2) + Deltat_prmp3*Sigma/(2*Lambt))/(Deltat*Sigma)
betapsum_prmx = omegatilde*pphi_prmx/Lambt + omegatilde_prmx*pphi/Lambt - Lambt_prmx*omegatilde*pphi/Lambt**2
betapsum_prmp2 = omegatilde*pphi_prmp2/Lambt - Lambt_prmp2*omegatilde*pphi/Lambt**2
betapsum_prmp3 = omegatilde*pphi_prmp3/Lambt - Lambt_prmp3*omegatilde*pphi/Lambt**2
HssTerm3_prmx = Btilde**2*(Sdotn*exp2mu*xisq*(-Q_prmx - Q_prmx/(2*sp.sqrt(Q))) + Sdotn*exp2mu*xisq_prmx*(-sp.sqrt(Q) - Q) + Sdotn*exp2mu_prmx*xisq*(-sp.sqrt(Q) - Q) + Sdotn_prmx*exp2mu*xisq*(-sp.sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmx - Jtilde*Sdotv_prmx*pdotn - Jtilde_prmx*Sdotv*pdotn + Sdotn*pdotvr_prmx + Sdotn_prmx*pdotvr) + pdotvr_prmx*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmx*(-2*Sdotn*exp2mu*xisq*(sp.sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmx + Btilde*Jtilde*Sdotxi_prmx*pdotn + Btilde*Jtilde_prmx*Sdotxi*pdotn + Btilde_prmx*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmx - Sdotn*expmu*expnu_prmx*pdotxir - Sdotn*expmu_prmx*expnu*pdotxir - Sdotn_prmx*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmx*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmx*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu_prmx*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir)
HssTerm3_prmp2 = Btilde**2*(Sdotn*exp2mu*xisq*(-Q_prmp2 - Q_prmp2/(2*sp.sqrt(Q))) + Sdotn_prmp2*exp2mu*xisq*(-sp.sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmp2 - Jtilde*Sdotv_prmp2*pdotn - Jtilde_prmp2*Sdotv*pdotn + Sdotn*pdotvr_prmp2 + Sdotn_prmp2*pdotvr) + pdotvr_prmp2*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmp2*(-2*Sdotn*exp2mu*xisq*(sp.sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmp2 + Btilde*Jtilde*Sdotxi_prmp2*pdotn + Btilde*Jtilde_prmp2*Sdotxi*pdotn + Btilde_prmp2*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmp2 - Sdotn*expmu*expnu_prmp2*pdotxir - Sdotn_prmp2*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmp2*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmp2*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir)
HssTerm3_prmp3 = Btilde**2*(Sdotn*exp2mu*xisq*(-Q_prmp3 - Q_prmp3/(2*sp.sqrt(Q))) + Sdotn_prmp3*exp2mu*xisq*(-sp.sqrt(Q) - Q) + pdotvr*(-Jtilde*Sdotv*pdotn_prmp3 - Jtilde*Sdotv_prmp3*pdotn - Jtilde_prmp3*Sdotv*pdotn + Sdotn*pdotvr_prmp3 + Sdotn_prmp3*pdotvr) + pdotvr_prmp3*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + Btilde*Btilde_prmp3*(-2*Sdotn*exp2mu*xisq*(sp.sqrt(Q) + Q) + 2*pdotvr*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr)) + expmu*expnu*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn_prmp3 + Btilde*Jtilde*Sdotxi_prmp3*pdotn + Btilde*Jtilde_prmp3*Sdotxi*pdotn + Btilde_prmp3*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir_prmp3 - Sdotn*expmu*expnu_prmp3*pdotxir - Sdotn_prmp3*expmu*expnu*pdotxir) + expmu*expnu*pdotxir_prmp3*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir) + expmu*expnu_prmp3*pdotxir*(Btilde*Jtilde*Sdotxi*pdotn - Sdotn*expmu*expnu*pdotxir)
HssTerm3coeff_prmx = omegacostheta*(-Q_prmx - Q_prmx/(2*sp.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*(sp.sqrt(Q) + Q)**2) + omegacostheta_prmx/(Btilde*exp2mu*expmu*expnu*(2*sp.sqrt(Q) + 2*Q)) - expnu_prmx*omegacostheta/(Btilde*exp2mu*expmu*expnu**2*(2*sp.sqrt(Q) + 2*Q)) - expmu_prmx*omegacostheta/(Btilde*exp2mu*expmu**2*expnu*(2*sp.sqrt(Q) + 2*Q)) - exp2mu_prmx*omegacostheta/(Btilde*exp2mu**2*expmu*expnu*(2*sp.sqrt(Q) + 2*Q)) - Btilde_prmx*omegacostheta/(Btilde**2*exp2mu*expmu*expnu*(2*sp.sqrt(Q) + 2*Q))
HssTerm3coeff_prmp2 = omegacostheta*(-Q_prmp2 - Q_prmp2/(2*sp.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*(sp.sqrt(Q) + Q)**2) + omegacostheta_prmp2/(Btilde*exp2mu*expmu*expnu*(2*sp.sqrt(Q) + 2*Q)) - expnu_prmp2*omegacostheta/(Btilde*exp2mu*expmu*expnu**2*(2*sp.sqrt(Q) + 2*Q)) - Btilde_prmp2*omegacostheta/(Btilde**2*exp2mu*expmu*expnu*(2*sp.sqrt(Q) + 2*Q))
HssTerm3coeff_prmp3 = omegacostheta*(-Q_prmp3 - Q_prmp3/(2*sp.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*(sp.sqrt(Q) + Q)**2) + omegacostheta_prmp3/(Btilde*exp2mu*expmu*expnu*(2*sp.sqrt(Q) + 2*Q)) - expnu_prmp3*omegacostheta/(Btilde*exp2mu*expmu*expnu**2*(2*sp.sqrt(Q) + 2*Q)) - Btilde_prmp3*omegacostheta/(Btilde**2*exp2mu*expmu*expnu*(2*sp.sqrt(Q) + 2*Q))
HssTerm2_prmx = Btilde**2*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmx - Jtilde*Sdotv_prmx*pdotn - Jtilde_prmx*Sdotv*pdotn + Sdotn*pdotvr_prmx + Sdotn_prmx*pdotvr) + Jtilde*pdotn_prmx*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmx*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmx + Q_prmx/(2*sp.sqrt(Q))) + Sdotv*exp2mu_prmx*(sp.sqrt(Q) + Q) + Sdotv_prmx*exp2mu*(sp.sqrt(Q) + Q)) + Btilde**2*xisq_prmx*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(sp.sqrt(Q) + Q)) + Btilde*Btilde_prmx*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sp.sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmx - Btilde*Sdotxi*expnu_prmx*pdotvr - Btilde*Sdotxi_prmx*expnu*pdotvr - Btilde_prmx*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmx + Sdotv*exp2nu*expmu_prmx*pdotxir + Sdotv*exp2nu_prmx*expmu*pdotxir + Sdotv_prmx*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmx*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir) + expmu_prmx*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir)
HssTerm2_prmp2 = Btilde**2*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmp2 - Jtilde*Sdotv_prmp2*pdotn - Jtilde_prmp2*Sdotv*pdotn + Sdotn*pdotvr_prmp2 + Sdotn_prmp2*pdotvr) + Jtilde*pdotn_prmp2*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmp2*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmp2 + Q_prmp2/(2*sp.sqrt(Q))) + Sdotv_prmp2*exp2mu*(sp.sqrt(Q) + Q)) + Btilde*Btilde_prmp2*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sp.sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmp2 - Btilde*Sdotxi*expnu_prmp2*pdotvr - Btilde*Sdotxi_prmp2*expnu*pdotvr - Btilde_prmp2*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmp2 + Sdotv*exp2nu_prmp2*expmu*pdotxir + Sdotv_prmp2*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmp2*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir)
HssTerm2_prmp3 = Btilde**2*xisq*(Jtilde*pdotn*(-Jtilde*Sdotv*pdotn_prmp3 - Jtilde*Sdotv_prmp3*pdotn - Jtilde_prmp3*Sdotv*pdotn + Sdotn*pdotvr_prmp3 + Sdotn_prmp3*pdotvr) + Jtilde*pdotn_prmp3*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Jtilde_prmp3*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + Sdotv*exp2mu*(Q_prmp3 + Q_prmp3/(2*sp.sqrt(Q))) + Sdotv_prmp3*exp2mu*(sp.sqrt(Q) + Q)) + Btilde*Btilde_prmp3*xisq*(2*Jtilde*pdotn*(-Jtilde*Sdotv*pdotn + Sdotn*pdotvr) + 2*Sdotv*exp2mu*(sp.sqrt(Q) + Q)) + expmu*pdotxir*(-Btilde*Sdotxi*expnu*pdotvr_prmp3 - Btilde*Sdotxi*expnu_prmp3*pdotvr - Btilde*Sdotxi_prmp3*expnu*pdotvr - Btilde_prmp3*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir_prmp3 + Sdotv*exp2nu_prmp3*expmu*pdotxir + Sdotv_prmp3*exp2nu*expmu*pdotxir) + expmu*pdotxir_prmp3*(-Btilde*Sdotxi*expnu*pdotvr + Sdotv*exp2nu*expmu*pdotxir)
HssTerm2coeff_prmx = Jtilde*omegar*(-Q_prmx - Q_prmx/(2*sp.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*xisq*(sp.sqrt(Q) + Q)**2) - Jtilde*omegar*xisq_prmx/(Btilde*exp2mu*expmu*expnu*xisq**2*(2*sp.sqrt(Q) + 2*Q)) + Jtilde*omegar_prmx/(Btilde*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q)) - Jtilde*expnu_prmx*omegar/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*sp.sqrt(Q) + 2*Q)) - Jtilde*expmu_prmx*omegar/(Btilde*exp2mu*expmu**2*expnu*xisq*(2*sp.sqrt(Q) + 2*Q)) - Jtilde*exp2mu_prmx*omegar/(Btilde*exp2mu**2*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q)) + Jtilde_prmx*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q)) - Btilde_prmx*Jtilde*omegar/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q))
HssTerm2coeff_prmp2 = Jtilde*omegar*(-Q_prmp2 - Q_prmp2/(2*sp.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*xisq*(sp.sqrt(Q) + Q)**2) + Jtilde*omegar_prmp2/(Btilde*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q)) - Jtilde*expnu_prmp2*omegar/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*sp.sqrt(Q) + 2*Q)) + Jtilde_prmp2*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q)) - Btilde_prmp2*Jtilde*omegar/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q))
HssTerm2coeff_prmp3 = Jtilde*omegar*(-Q_prmp3 - Q_prmp3/(2*sp.sqrt(Q)))/(2*Btilde*exp2mu*expmu*expnu*xisq*(sp.sqrt(Q) + Q)**2) + Jtilde*omegar_prmp3/(Btilde*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q)) - Jtilde*expnu_prmp3*omegar/(Btilde*exp2mu*expmu*expnu**2*xisq*(2*sp.sqrt(Q) + 2*Q)) + Jtilde_prmp3*omegar/(Btilde*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q)) - Btilde_prmp3*Jtilde*omegar/(Btilde**2*exp2mu*expmu*expnu*xisq*(2*sp.sqrt(Q) + 2*Q))
HssTerm1_prmx = SdotSkerrhat*omega_prmx + SdotSkerrhat_prmx*omega
HssTerm1_prmp2 = SdotSkerrhat*omega_prmp2 + SdotSkerrhat_prmp2*omega
HssTerm1_prmp3 = SdotSkerrhat*omega_prmp3 + SdotSkerrhat_prmp3*omega
Hss_prmx = HssTerm1_prmx + HssTerm2*HssTerm2coeff_prmx + HssTerm2coeff*HssTerm2_prmx + HssTerm3*HssTerm3coeff_prmx + HssTerm3coeff*HssTerm3_prmx
Hss_prmp2 = HssTerm1_prmp2 + HssTerm2*HssTerm2coeff_prmp2 + HssTerm2coeff*HssTerm2_prmp2 + HssTerm3*HssTerm3coeff_prmp2 + HssTerm3coeff*HssTerm3_prmp2
Hss_prmp3 = HssTerm1_prmp3 + HssTerm2*HssTerm2coeff_prmp3 + HssTerm2coeff*HssTerm2_prmp3 + HssTerm3*HssTerm3coeff_prmp3 + HssTerm3coeff*HssTerm3_prmp3
HsoTerm2c_prmx = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmx*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmx*pdotxir*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu_prmx*expnu*pdotxir*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmx*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Q_prmx*Sdotv*expmu*expnu*pdotxir/(2*sp.sqrt(Q)) + Brtilde*Jtilde_prmx*Sdotv*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1) + Brtilde_prmx*Jtilde*Sdotv*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1)
HsoTerm2c_prmp2 = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmp2*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmp2*pdotxir*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmp2*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Q_prmp2*Sdotv*expmu*expnu*pdotxir/(2*sp.sqrt(Q)) + Brtilde*Jtilde_prmp2*Sdotv*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1) + Brtilde_prmp2*Jtilde*Sdotv*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1)
HsoTerm2c_prmp3 = Brtilde*Jtilde*Sdotv*expmu*expnu*pdotxir_prmp3*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv*expmu*expnu_prmp3*pdotxir*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Sdotv_prmp3*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1) + Brtilde*Jtilde*Q_prmp3*Sdotv*expmu*expnu*pdotxir/(2*sp.sqrt(Q)) + Brtilde*Jtilde_prmp3*Sdotv*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1) + Brtilde_prmp3*Jtilde*Sdotv*expmu*expnu*pdotxir*(sp.sqrt(Q) + 1)
HsoTerm2b_prmx = Btilde*expmu*expnu*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmx + Jtilde*Sdotv_prmx*nur + Jtilde_prmx*Sdotv*nur - Sdotn*nucostheta*xisq_prmx - Sdotn*nucostheta_prmx*xisq - Sdotn_prmx*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmx*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmx*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu_prmx*expnu*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmx*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sp.sqrt(Q) + Btilde_prmx*expmu*expnu*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)
HsoTerm2b_prmp2 = Btilde*expmu*expnu*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmp2 + Jtilde*Sdotv_prmp2*nur + Jtilde_prmp2*Sdotv*nur - Sdotn*nucostheta_prmp2*xisq - Sdotn_prmp2*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmp2*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmp2*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmp2*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sp.sqrt(Q) + Btilde_prmp2*expmu*expnu*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)
HsoTerm2b_prmp3 = Btilde*expmu*expnu*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur_prmp3 + Jtilde*Sdotv_prmp3*nur + Jtilde_prmp3*Sdotv*nur - Sdotn*nucostheta_prmp3*xisq - Sdotn_prmp3*nucostheta*xisq) + Btilde*expmu*expnu*pdotxir_prmp3*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*expmu*expnu_prmp3*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq) + Btilde*Q_prmp3*expmu*expnu*pdotxir*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)/sp.sqrt(Q) + Btilde_prmp3*expmu*expnu*pdotxir*(2*sp.sqrt(Q) + 1)*(Jtilde*Sdotv*nur - Sdotn*nucostheta*xisq)
HsoTerm2a_prmx = Btilde**2*Jtilde*Sdotxi*(-sp.sqrt(Q)*(nur*pdotvr_prmx + nur_prmx*pdotvr + pdotn*xisq*(mucostheta_prmx - nucostheta_prmx) + pdotn*xisq_prmx*(mucostheta - nucostheta) + pdotn_prmx*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq_prmx - mucostheta*pdotn_prmx*xisq - mucostheta_prmx*pdotn*xisq + mur*pdotvr_prmx*(sp.sqrt(Q) + 1) + mur_prmx*pdotvr*(sp.sqrt(Q) + 1) + Q_prmx*mur*pdotvr/(2*sp.sqrt(Q)) + Q_prmx*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/(2*sp.sqrt(Q))) + Btilde**2*Jtilde*Sdotxi_prmx*(sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sp.sqrt(Q) + 1)) + Btilde**2*Jtilde_prmx*Sdotxi*(sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sp.sqrt(Q) + 1)) + Btilde*Btilde_prmx*Jtilde*Sdotxi*(2*sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sp.sqrt(Q) + 1))
HsoTerm2a_prmp2 = Btilde**2*Jtilde*Sdotxi*(-sp.sqrt(Q)*(-nucostheta_prmp2*pdotn*xisq + nur*pdotvr_prmp2 + nur_prmp2*pdotvr + pdotn_prmp2*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn_prmp2*xisq + mur*pdotvr_prmp2*(sp.sqrt(Q) + 1) + mur_prmp2*pdotvr*(sp.sqrt(Q) + 1) + Q_prmp2*mur*pdotvr/(2*sp.sqrt(Q)) + Q_prmp2*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/(2*sp.sqrt(Q))) + Btilde**2*Jtilde*Sdotxi_prmp2*(sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sp.sqrt(Q) + 1)) + Btilde**2*Jtilde_prmp2*Sdotxi*(sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sp.sqrt(Q) + 1)) + Btilde*Btilde_prmp2*Jtilde*Sdotxi*(2*sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sp.sqrt(Q) + 1))
HsoTerm2a_prmp3 = Btilde**2*Jtilde*Sdotxi*(-sp.sqrt(Q)*(-nucostheta_prmp3*pdotn*xisq + nur*pdotvr_prmp3 + nur_prmp3*pdotvr + pdotn_prmp3*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn_prmp3*xisq + mur*pdotvr_prmp3*(sp.sqrt(Q) + 1) + mur_prmp3*pdotvr*(sp.sqrt(Q) + 1) + Q_prmp3*mur*pdotvr/(2*sp.sqrt(Q)) + Q_prmp3*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta))/(2*sp.sqrt(Q))) + Btilde**2*Jtilde*Sdotxi_prmp3*(sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sp.sqrt(Q) + 1)) + Btilde**2*Jtilde_prmp3*Sdotxi*(sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - mucostheta*pdotn*xisq + mur*pdotvr*(sp.sqrt(Q) + 1)) + Btilde*Btilde_prmp3*Jtilde*Sdotxi*(2*sp.sqrt(Q)*(-nur*pdotvr - pdotn*xisq*(mucostheta - nucostheta)) - 2*mucostheta*pdotn*xisq + 2*mur*pdotvr*(sp.sqrt(Q) + 1))
HsoTerm2_prmx = HsoTerm2a_prmx + HsoTerm2b_prmx - HsoTerm2c_prmx
HsoTerm2_prmp2 = HsoTerm2a_prmp2 + HsoTerm2b_prmp2 - HsoTerm2c_prmp2
HsoTerm2_prmp3 = HsoTerm2a_prmp3 + HsoTerm2b_prmp3 - HsoTerm2c_prmp3
HsoTerm2coeff_prmx = expnu*(-Q_prmx - Q_prmx/(2*sp.sqrt(Q)))/(Btilde**2*exp2mu*xisq*(sp.sqrt(Q) + Q)**2) - expnu*xisq_prmx/(Btilde**2*exp2mu*xisq**2*(sp.sqrt(Q) + Q)) + expnu_prmx/(Btilde**2*exp2mu*xisq*(sp.sqrt(Q) + Q)) - exp2mu_prmx*expnu/(Btilde**2*exp2mu**2*xisq*(sp.sqrt(Q) + Q)) - 2*Btilde_prmx*expnu/(Btilde**3*exp2mu*xisq*(sp.sqrt(Q) + Q))
HsoTerm2coeff_prmp2 = expnu*(-Q_prmp2 - Q_prmp2/(2*sp.sqrt(Q)))/(Btilde**2*exp2mu*xisq*(sp.sqrt(Q) + Q)**2) + expnu_prmp2/(Btilde**2*exp2mu*xisq*(sp.sqrt(Q) + Q)) - 2*Btilde_prmp2*expnu/(Btilde**3*exp2mu*xisq*(sp.sqrt(Q) + Q))
HsoTerm2coeff_prmp3 = expnu*(-Q_prmp3 - Q_prmp3/(2*sp.sqrt(Q)))/(Btilde**2*exp2mu*xisq*(sp.sqrt(Q) + Q)**2) + expnu_prmp3/(Btilde**2*exp2mu*xisq*(sp.sqrt(Q) + Q)) - 2*Btilde_prmp3*expnu/(Btilde**3*exp2mu*xisq*(sp.sqrt(Q) + Q))
HsoTerm1_prmx = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmx + expmu*expnu_prmx + expmu_prmx*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir*xisq_prmx*(Btilde - expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq**2) + SdotSkerrhat*exp2nu*pdotxir_prmx*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) - SdotSkerrhat*exp2nu*expmu_prmx*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu**2*xisq) + SdotSkerrhat*exp2nu_prmx*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmx*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) - Q_prmx*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Btilde_prmx*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*sp.sqrt(Q)*expmu*xisq)
HsoTerm1_prmp2 = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmp2 + expmu*expnu_prmp2)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir_prmp2*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu_prmp2*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmp2*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) - Q_prmp2*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Btilde_prmp2*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*sp.sqrt(Q)*expmu*xisq)
HsoTerm1_prmp3 = SdotSkerrhat*exp2nu*pdotxir*(-Btilde_prmp3 + expmu*expnu_prmp3)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu*pdotxir_prmp3*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) + SdotSkerrhat*exp2nu_prmp3*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) + SdotSkerrhat_prmp3*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(Btilde**2*sp.sqrt(Q)*expmu*xisq) - Q_prmp3*SdotSkerrhat*exp2nu*pdotxir*(-Btilde + expmu*expnu)/(2*Btilde**2*Q**(3/2)*expmu*xisq) - Btilde_prmp3*SdotSkerrhat*exp2nu*pdotxir*(-2*Btilde + 2*expmu*expnu)/(Btilde**3*sp.sqrt(Q)*expmu*xisq)
Hso_prmx = HsoTerm1_prmx + HsoTerm2*HsoTerm2coeff_prmx + HsoTerm2coeff*HsoTerm2_prmx
Hso_prmp2 = HsoTerm1_prmp2 + HsoTerm2*HsoTerm2coeff_prmp2 + HsoTerm2coeff*HsoTerm2_prmp2
Hso_prmp3 = HsoTerm1_prmp3 + HsoTerm2*HsoTerm2coeff_prmp3 + HsoTerm2coeff*HsoTerm2_prmp3
Hd_prmx = Hdcoeff*Hdsum_prmx + Hdcoeff_prmx*Hdsum
Hd_prmp2 = Hdcoeff*Hdsum_prmp2
Hd_prmp3 = Hdcoeff*Hdsum_prmp3
Hns_prmx = sp.sqrt(Hnsradicand)*alpha_prmx + betapsum_prmx + Hnsradicand_prmx*alpha/(2*sp.sqrt(Hnsradicand))
Hns_prmp2 = sp.sqrt(Hnsradicand)*alpha_prmp2 + betapsum_prmp2 + Hnsradicand_prmp2*alpha/(2*sp.sqrt(Hnsradicand))
Hns_prmp3 = sp.sqrt(Hnsradicand)*alpha_prmp3 + betapsum_prmp3 + Hnsradicand_prmp3*alpha/(2*sp.sqrt(Hnsradicand))
Hs_prmx = Hso_prmx + Hss_prmx
Hs_prmp2 = Hso_prmp2 + Hss_prmp2
Hs_prmp3 = Hso_prmp3 + Hss_prmp3
dSS_prmx = 1585.533*chi**2*chi_prmx*eta**2 - 123.0009*chi**2*chi_prmx*eta + 2323.56*chi*chi_prmx*eta**3 - 652.65*chi*chi_prmx*eta**2 + 37.1964*chi_prmx*eta
dSS_prmp2 = 1585.533*chi**2*chi_prmp2*eta**2 - 123.0009*chi**2*chi_prmp2*eta + 2323.56*chi*chi_prmp2*eta**3 - 652.65*chi*chi_prmp2*eta**2 + 37.1964*chi_prmp2*eta
dSS_prmp3 = 1585.533*chi**2*chi_prmp3*eta**2 - 123.0009*chi**2*chi_prmp3*eta + 2323.56*chi*chi_prmp3*eta**3 - 652.65*chi*chi_prmp3*eta**2 + 37.1964*chi_prmp3*eta
Heff_prmx = -Hd_prmx + Hns_prmx + Hs_prmx + 4*dSS*eta*u**3*u_prmx*(S1x**2 + S1y**2 + S1z**2 + S2x**2 + S2y**2 + S2z**2) + dSS_prmx*eta*u**4*(S1x**2 + S1y**2 + S1z**2 + S2x**2 + S2y**2 + S2z**2)
Heff_prmp2 = -Hd_prmp2 + Hns_prmp2 + Hs_prmp2 + dSS_prmp2*eta*u**4*(S1x**2 + S1y**2 + S1z**2 + S2x**2 + S2y**2 + S2z**2)
Heff_prmp3 = -Hd_prmp3 + Hns_prmp3 + Hs_prmp3 + dSS_prmp3*eta*u**4*(S1x**2 + S1y**2 + S1z**2 + S2x**2 + S2y**2 + S2z**2)
Hreal_prmx = Heff_prmx*eta/sp.sqrt(2*eta*(Heff - 1) + 1)
Hreal_prmp2 = Heff_prmp2*eta/sp.sqrt(2*eta*(Heff - 1) + 1)
Hreal_prmp3 = Heff_prmp3*eta/sp.sqrt(2*eta*(Heff - 1) + 1)
