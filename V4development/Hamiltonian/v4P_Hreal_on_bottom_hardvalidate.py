import numpy as np
def compute_v4P_Hreal(m1=23., m2=10., EMgamma=0.577215664901532860606512090082402431, tortoise=1, x=2.1242072413581923e+01, y=0., z=0., p1=0., p2=2.1696072000958128e-01, p3=1.0000000000000000e-03, S1x=4.8576675849403119e-03, S1y=9.7153351698806237e-03, S1z=-1.4573002754820936e-02, S2x=3.6730945821854912e-03, S2y=-4.5913682277318639e-03, S2z=5.5096418732782371e-03):
    printout = open("outputnrpyv4PHamiltonian.txt","w")
    EMgamma = 0.577215664901532860606512090082402431
    printout.write('EMgamma  = %.16e\n' % EMgamma )
    M=m1+m2
    printout.write('M = %.16e\n' % M)
    mu=m1*m2/M
    printout.write('mu = %.16e\n' % mu)
    eta=mu/M
    printout.write('eta = %.16e\n' % eta)
    r=np.sqrt(x*x+y*y+z*z)
    printout.write('r = %.16e\n' % r)
    u=1/r
    printout.write('u = %.16e\n' % u)
    sigmastar3=m2/m1*S1z+m1/m2*S2z
    printout.write('sigmastar3 = %.16e\n' % sigmastar3)
    sigmastar2 = m2/m1*S1y + m1/m2*S2y
    printout.write('sigmastar2  = %.16e\n' % sigmastar2 )
    sigmastar1 = m2/m1*S1x + m1/m2*S2x
    printout.write('sigmastar1  = %.16e\n' % sigmastar1 )
    sigma3=S1z+S2z
    printout.write('sigma3 = %.16e\n' % sigma3)
    sigma2 = S1y + S2y
    printout.write('sigma2  = %.16e\n' % sigma2 )
    sigma1 = S1x + S2x
    printout.write('sigma1  = %.16e\n' % sigma1 )
    Skerr3=sigma3
    printout.write('Skerr3 = %.16e\n' % Skerr3)
    Skerr2 = sigma2
    printout.write('Skerr2  = %.16e\n' % Skerr2 )
    Skerr1 = sigma1
    printout.write('Skerr1  = %.16e\n' % Skerr1 )
    Skerrmag=np.sqrt(Skerr1*Skerr1+Skerr2*Skerr2+Skerr3*Skerr3)
    printout.write('Skerrmag = %.16e\n' % Skerrmag)
    Skerrhat3=Skerr3/Skerrmag
    printout.write('Skerrhat3 = %.16e\n' % Skerrhat3)
    Skerrhat2 = Skerr2/Skerrmag
    printout.write('Skerrhat2  = %.16e\n' % Skerrhat2 )
    Skerrhat1 = Skerr1/Skerrmag
    printout.write('Skerrhat1  = %.16e\n' % Skerrhat1 )
    a=Skerrmag
    printout.write('a = %.16e\n' % a)
    L3=x*p2-y*p1
    printout.write('L3 = %.16e\n' % L3)
    L2 = z*p1 - x*p3
    printout.write('L2  = %.16e\n' % L2 )
    L1 = y*p3 - z*p2
    printout.write('L1  = %.16e\n' % L1 )
    Lnorm=np.sqrt(L1*L1+L2*L2+L3*L3)
    printout.write('Lnorm = %.16e\n' % Lnorm)
    Lhat3=L3/Lnorm
    printout.write('Lhat3 = %.16e\n' % Lhat3)
    Lhat2 = L2/Lnorm
    printout.write('Lhat2  = %.16e\n' % Lhat2 )
    Lhat1 = L1/Lnorm
    printout.write('Lhat1  = %.16e\n' % Lhat1 )
    S2dotLhat=S2x*Lhat1+S2y*Lhat2+S2z*Lhat3
    printout.write('S2dotLhat = %.16e\n' % S2dotLhat)
    S1dotLhat = S1x*Lhat1 + S1y*Lhat2 + S1z*Lhat3
    printout.write('S1dotLhat  = %.16e\n' % S1dotLhat )
    S1perp3=S1z-S1dotLhat*Lhat3
    printout.write('S1perp3 = %.16e\n' % S1perp3)
    S1perp2 = S1y - S1dotLhat*Lhat2
    printout.write('S1perp2  = %.16e\n' % S1perp2 )
    S1perp1 = S1x - S1dotLhat*Lhat1
    printout.write('S1perp1  = %.16e\n' % S1perp1 )
    S2perp3=S2z-S2dotLhat*Lhat3
    printout.write('S2perp3 = %.16e\n' % S2perp3)
    S2perp2 = S2y - S2dotLhat*Lhat2
    printout.write('S2perp2  = %.16e\n' % S2perp2 )
    S2perp1 = S2x - S2dotLhat*Lhat1
    printout.write('S2perp1  = %.16e\n' % S2perp1 )
    Sperp3=S1perp3+S2perp3
    printout.write('Sperp3 = %.16e\n' % Sperp3)
    Sperp2 = S1perp2 + S2perp2
    printout.write('Sperp2  = %.16e\n' % Sperp2 )
    Sperp1 = S1perp1 + S2perp1
    printout.write('Sperp1  = %.16e\n' % Sperp1 )
    n3=z/r
    printout.write('n3 = %.16e\n' % n3)
    n2 = y/r
    printout.write('n2  = %.16e\n' % n2 )
    n1 = x/r
    printout.write('n1  = %.16e\n' % n1 )
    e33=Skerrhat3
    printout.write('e33 = %.16e\n' % e33)
    e32 = Skerrhat2
    printout.write('e32  = %.16e\n' % e32 )
    e31 = Skerrhat1
    printout.write('e31  = %.16e\n' % e31 )
    xi3=e31*n2-e32*n1
    printout.write('xi3 = %.16e\n' % xi3)
    xi2 = e31*n3 + e33*n1
    printout.write('xi2  = %.16e\n' % xi2 )
    xi1 = e32*n3 - e33*n2
    printout.write('xi1  = %.16e\n' % xi1 )
    v3=n1*xi2-n2*xi1
    printout.write('v3 = %.16e\n' % v3)
    v2 = n3*xi1 - n1*xi3
    printout.write('v2  = %.16e\n' % v2 )
    v1 = n2*xi3 - n3*xi2
    printout.write('v1  = %.16e\n' % v1 )
    costheta=e31*n1+e32*n2+e33*n3
    printout.write('costheta = %.16e\n' % costheta)
    sin2theta=1-costheta*costheta
    printout.write('sin2theta = %.16e\n' % sin2theta)
    xisq = sin2theta
    printout.write('xisq  = %.16e\n' % xisq )
    w2=a*a+r*r
    printout.write('w2 = %.16e\n' % w2)
    Sigma=r*r+a*a*costheta*costheta
    printout.write('Sigma = %.16e\n' % Sigma)
    Dinv=1+np.log(1+6*eta*u*u+2*(26-3*eta)*eta*u*u*u)
    printout.write('Dinv = %.16e\n' % Dinv)
    omegatilde=2*a*r
    printout.write('omegatilde = %.16e\n' % omegatilde)
    chi=(Skerr1*Lhat1+Skerr2*Lhat2+Skerr3*Lhat3)/(1-2*eta)+np.divide(1,2)*(Sperp1*Skerr1+Sperp2*Skerr2+Sperp3*Skerr3)/(Skerrmag*(1.-2.*eta))
    printout.write('chi = %.16e\n' % chi)
    Kchi0=267.788*eta*eta*eta-126.687*eta*eta+10.2573*eta+1.7336
    printout.write('Kchi0 = %.16e\n' % Kchi0)
    K=-59.1658*chi*chi*chi*eta*eta*eta-0.426958*chi*chi*chi*eta+1.43659*chi*chi*chi+31.1746*chi*chi*eta*eta*eta+6.16466*chi*chi*eta*eta-1.38086*chi*chi-27.5201*chi*eta*eta*eta+17.3736*chi*eta*eta+2.26831*chi*eta-1.62045*chi+Kchi0
    printout.write('K = %.16e\n' % K)
    etaKminus1 = eta*K - 1
    printout.write('etaKminus1  = %.16e\n' % etaKminus1 )
    Delta0=K*(eta*K-2)
    printout.write('Delta0 = %.16e\n' % Delta0)
    Delta1=-2*etaKminus1*(K+Delta0)
    printout.write('Delta1 = %.16e\n' % Delta1)
    Delta2=np.divide(1,2)*Delta1*(Delta1-4*etaKminus1)-a*a*etaKminus1*etaKminus1*Delta0
    printout.write('Delta2 = %.16e\n' % Delta2)
    Delta3=-np.divide(1,3)*Delta1*Delta1*Delta1+etaKminus1*Delta1*Delta1+Delta2*Delta1-2*etaKminus1*(Delta2-etaKminus1)-a*a*etaKminus1*etaKminus1*Delta1
    printout.write('Delta3 = %.16e\n' % Delta3)
    Delta4=np.divide(1,12)*(6*a*a*(Delta1*Delta1-2*Delta2)*etaKminus1*etaKminus1+3*Delta1*Delta1*Delta1*Delta1-8*etaKminus1*Delta1*Delta1*Delta1-12*Delta2*Delta1*Delta1+12*(2*etaKminus1*Delta2+Delta3)*Delta1+12*(np.divide(94,3)-np.divide(41,32)*np.pi*np.pi)*etaKminus1*etaKminus1+6*(Delta2*Delta2-4*Delta3*etaKminus1))
    printout.write('Delta4 = %.16e\n' % Delta4)
    Delta5=etaKminus1*etaKminus1*(np.divide(-4237,60)+np.divide(128,5)*EMgamma+np.divide(2275,512)*np.pi*np.pi-np.divide(1,3)*a*a*(Delta1*Delta1*Delta1-3*Delta1*Delta2+3*Delta3)-(Delta1*Delta1*Delta1*Delta1*Delta1-5*Delta1*Delta1*Delta1*Delta2+5*Delta1*Delta2*Delta2+5*Delta1*Delta1*Delta3-5*Delta2*Delta3-5*Delta1*Delta4)/(5*etaKminus1*etaKminus1)+(Delta1*Delta1*Delta1*Delta1-4*Delta1*Delta1*Delta2+2*Delta2*Delta2+4*Delta1*Delta3-4*Delta4)/(2*etaKminus1)+np.divide(256,5)*np.log(2)+(np.divide(41,32)*np.pi*np.pi-np.divide(221,6))*eta)
    printout.write('Delta5 = %.16e\n' % Delta5)
    Delta5l=etaKminus1*etaKminus1*np.divide(64,5)
    printout.write('Delta5l = %.16e\n' % Delta5l)
    logarg=u*(Delta1+u*(Delta2+u*(Delta3+u*(Delta4+u*(Delta5+Delta5l*np.log(u))))))
    printout.write('logarg = %.16e\n' % logarg)
    Deltaucalib = 1 + eta*(Delta0 + np.log(1 + logarg))
    printout.write('Deltaucalib  = %.16e\n' % Deltaucalib )
    Deltaucalibprm=-eta*u*u*(Delta1+u*(2*Delta2+u*(3*Delta3+u*(4*Delta4+u*(5*(Delta5+Delta5l*np.log(u)))))))/(1+logarg)
    printout.write('Deltaucalibprm = %.16e\n' % Deltaucalibprm)
    Deltaubar=a*a*u*u+(2*u+1/etaKminus1)/etaKminus1
    printout.write('Deltaubar = %.16e\n' % Deltaubar)
    Deltaubarprm = -2*a*a*u*u*u - 2*u*u/(etaKminus1)
    printout.write('Deltaubarprm  = %.16e\n' % Deltaubarprm )
    Deltau=Deltaubar*Deltaucalib
    printout.write('Deltau = %.16e\n' % Deltau)
    Deltauprm = Deltaubarprm*Deltaucalib + Deltaubar*Deltaucalibprm
    printout.write('Deltauprm  = %.16e\n' % Deltauprm )
    Deltatprm=2*r*Deltau+r*r*Deltauprm
    printout.write('Deltatprm = %.16e\n' % Deltatprm)
    Deltat=r*r*Deltau
    printout.write('Deltat = %.16e\n' % Deltat)
    Deltar=Deltat*Dinv
    printout.write('Deltar = %.16e\n' % Deltar)
    Lambdat=w2*w2-a*a*Deltat*sin2theta
    printout.write('Lambdat = %.16e\n' % Lambdat)
    csi=np.sqrt(Deltar*Deltat)/w2
    printout.write('csi = %.16e\n' % csi)
    csi1=1+(1-np.abs(1-tortoise))*(csi-1)
    printout.write('csi1 = %.16e\n' % csi1)
    csi2=1+(np.divide(1,2)-np.divide(1,2)*np.sign(np.divide(3,2)-tortoise))*(csi-1)
    printout.write('csi2 = %.16e\n' % csi2)
    prT=csi2*(p1*n1+p2*n2+p3*n3)
    printout.write('prT = %.16e\n' % prT)
    phat3=p3+prT*(1-1/csi1)*n3
    printout.write('phat3 = %.16e\n' % phat3)
    phat2 = p2 + prT*(1 - 1/csi1)*n2
    printout.write('phat2  = %.16e\n' % phat2 )
    phat1 = p1 + prT*(1 - 1/csi1)*n1
    printout.write('phat1  = %.16e\n' % phat1 )
    pdotxir=(phat1*xi1+phat2*xi2+phat3*xi3)*r
    printout.write('pdotxir = %.16e\n' % pdotxir)
    pdotn=phat1*n1+phat2*n2+phat3*n3
    printout.write('pdotn = %.16e\n' % pdotn)
    pdotvr=(phat1*v1+phat2*v2+phat3*v3)*r
    printout.write('pdotvr = %.16e\n' % pdotvr)
    pphi=pdotxir
    printout.write('pphi = %.16e\n' % pphi)
    Qcoeff2=1/(Sigma*sin2theta)
    printout.write('Qcoeff2 = %.16e\n' % Qcoeff2)
    Qcoeff1=Sigma/(Lambdat*sin2theta)
    printout.write('Qcoeff1 = %.16e\n' % Qcoeff1)
    DrSipn2=Deltar*pdotn*pdotn/Sigma
    printout.write('DrSipn2 = %.16e\n' % DrSipn2)
    Q=1+DrSipn2+Qcoeff1*pdotxir*pdotxir+Qcoeff2*pdotvr*pdotvr
    printout.write('Q = %.16e\n' % Q)
    Qminus1 = Q - 1
    printout.write('Qminus1  = %.16e\n' % Qminus1 )
    Jtilde=np.sqrt(Deltar)
    printout.write('Jtilde = %.16e\n' % Jtilde)
    exp2mu=Sigma
    printout.write('exp2mu = %.16e\n' % exp2mu)
    expmu = np.sqrt(exp2mu)
    printout.write('expmu  = %.16e\n' % expmu )
    Brtilde=(np.sqrt(Deltar)*Deltatprm-2*Deltat)/(2*np.sqrt(Deltar*Deltat))
    printout.write('Brtilde = %.16e\n' % Brtilde)
    Btilde=np.sqrt(Deltat)
    printout.write('Btilde = %.16e\n' % Btilde)
    exp2nu=Deltat*Sigma/Lambdat
    printout.write('exp2nu = %.16e\n' % exp2nu)
    expnu = np.sqrt(exp2nu)
    printout.write('expnu  = %.16e\n' % expnu )
    omega=omegatilde/Lambdat
    printout.write('omega = %.16e\n' % omega)
    omegatildeprm=2*a
    printout.write('omegatildeprm = %.16e\n' % omegatildeprm)
    Lambdatprm=4*(a*a+r*r)*r-2*a*a*Deltatprm*sin2theta
    printout.write('Lambdatprm = %.16e\n' % Lambdatprm)
    mucostheta=a*a*costheta/Sigma
    printout.write('mucostheta = %.16e\n' % mucostheta)
    nucostheta=a*a*w2*costheta*(w2-Deltat)/(Lambdat*Sigma)
    printout.write('nucostheta = %.16e\n' % nucostheta)
    omegacostheta=-2*a*a*costheta*Deltat*omegatilde/(Lambdat*Lambdat)
    printout.write('omegacostheta = %.16e\n' % omegacostheta)
    mur=r/Sigma-1/np.sqrt(Deltar)
    printout.write('mur = %.16e\n' % mur)
    nur=r/Sigma+w2*(w2*Deltatprm-4*r*Deltat)/(2*Lambdat*Deltat)
    printout.write('nur = %.16e\n' % nur)
    omegar=(Lambdat*omegatildeprm-Lambdatprm*omegatilde)/(Lambdat*Lambdat)
    printout.write('omegar = %.16e\n' % omegar)
    dSO=147.481*chi*chi*chi*eta*eta-568.651*chi*chi*chi*eta+66.1987*chi*chi*chi-343.313*chi*chi*eta+2495.29*chi*eta*eta-44.5324
    printout.write('dSO = %.16e\n' % dSO)
    sigmacoeffTerm3 = eta*dSO*u*u*u
    printout.write('sigmacoeffTerm3  = %.16e\n' % sigmacoeffTerm3 )
    sigmacoeffTerm2=eta/(144*r*r)*(-896+r*(-436*Qminus1-96*DrSipn2+r*(-45*Qminus1*Qminus1+36*Qminus1*DrSipn2))+eta*(-336+r*(204*Qminus1-882*DrSipn2+r*(810*DrSipn2*DrSipn2-234*Qminus1*DrSipn2))))
    printout.write('sigmacoeffTerm2 = %.16e\n' % sigmacoeffTerm2)
    sigmacoeffTerm1=eta/12*(-8/r+3*Qminus1-36*DrSipn2)
    printout.write('sigmacoeffTerm1 = %.16e\n' % sigmacoeffTerm1)
    sigmacoeff=sigmacoeffTerm1+sigmacoeffTerm2+sigmacoeffTerm3
    printout.write('sigmacoeff = %.16e\n' % sigmacoeff)
    sigmastarcoeffTerm2=eta/(72*r*r)*(706+r*(-206*Qminus1+282*DrSipn2+r*Qminus1*(96*DrSipn2-23*Qminus1))+eta*(-54+r*(120*Qminus1-324*DrSipn2+r*(360*DrSipn2*DrSipn2+Qminus1*(-126*DrSipn2-3*Qminus1)))))
    printout.write('sigmastarcoeffTerm2 = %.16e\n' % sigmastarcoeffTerm2)
    sigmastarcoeffTerm1=eta/12*(14/r+4*Qminus1-30*DrSipn2)
    printout.write('sigmastarcoeffTerm1 = %.16e\n' % sigmastarcoeffTerm1)
    sigmastarcoeff=sigmastarcoeffTerm1+sigmastarcoeffTerm2
    printout.write('sigmastarcoeff = %.16e\n' % sigmastarcoeff)
    Deltasigmastar3=sigmastar3*sigmastarcoeff+sigma3*sigmacoeff
    printout.write('Deltasigmastar3 = %.16e\n' % Deltasigmastar3)
    Deltasigmastar2 = sigmastar2*sigmastarcoeff + sigma2*sigmacoeff
    printout.write('Deltasigmastar2  = %.16e\n' % Deltasigmastar2 )
    Deltasigmastar1 = sigmastar1*sigmastarcoeff + sigma1*sigmacoeff
    printout.write('Deltasigmastar1  = %.16e\n' % Deltasigmastar1 )
    Sstar3=sigmastar3+Deltasigmastar3
    printout.write('Sstar3 = %.16e\n' % Sstar3)
    Sstar2 = sigmastar2 + Deltasigmastar2
    printout.write('Sstar2  = %.16e\n' % Sstar2 )
    Sstar1 = sigmastar1 + Deltasigmastar1
    printout.write('Sstar1  = %.16e\n' % Sstar1 )
    S3 = Sstar3
    printout.write('S3  = %.16e\n' % S3 )
    S2 = Sstar2
    printout.write('S2  = %.16e\n' % S2 )
    S1 = Sstar1
    printout.write('S1  = %.16e\n' % S1 )
    Sstardotn=Sstar1*n1+Sstar2*n2+Sstar3*n3
    printout.write('Sstardotn = %.16e\n' % Sstardotn)
    SdotSkerrhat=S1*Skerrhat1+S2*Skerrhat2+S3*Skerrhat3
    printout.write('SdotSkerrhat = %.16e\n' % SdotSkerrhat)
    Sdotn=S1*n1+S2*n2+S3*n3
    printout.write('Sdotn = %.16e\n' % Sdotn)
    Sdotv=S1*v1+S2*v2+S3*v3
    printout.write('Sdotv = %.16e\n' % Sdotv)
    Sdotxi=S1*xi1+S2*xi2+S3*xi3
    printout.write('Sdotxi = %.16e\n' % Sdotxi)
    HdsumTerm2=3*Sstardotn*Sstardotn
    printout.write('HdsumTerm2 = %.16e\n' % HdsumTerm2)
    HdsumTerm1=Sstar1*Sstar1+Sstar2*Sstar2+Sstar3*Sstar3
    printout.write('HdsumTerm1 = %.16e\n' % HdsumTerm1)
    Hdsum=HdsumTerm1-HdsumTerm2
    printout.write('Hdsum = %.16e\n' % Hdsum)
    Hdcoeff=np.divide(1,2)/(r*r*r)
    printout.write('Hdcoeff = %.16e\n' % Hdcoeff)
    Q4=2*prT*prT*prT*prT*u*u*(4-3*eta)*eta
    printout.write('Q4 = %.16e\n' % Q4)
    gammappsum=Deltar/Sigma*pdotn*pdotn+1/Sigma*pdotvr*pdotvr/sin2theta+Sigma/Lambdat/sin2theta*pdotxir*pdotxir
    printout.write('gammappsum = %.16e\n' % gammappsum)
    Hnsradicand=1+gammappsum+Q4
    printout.write('Hnsradicand = %.16e\n' % Hnsradicand)
    alpha=np.sqrt(Deltat*Sigma/Lambdat)
    printout.write('alpha = %.16e\n' % alpha)
    betapsum=omegatilde*pphi/Lambdat
    printout.write('betapsum = %.16e\n' % betapsum)
    HssTerm3=expmu*expnu*pdotxir*(Jtilde*pdotn*Sdotxi*Btilde-expmu*expnu*pdotxir*Sdotn)+(pdotvr*(Sdotn*pdotvr-Jtilde*pdotn*Sdotv)-exp2mu*(np.sqrt(Q)+Q)*Sdotn*xisq)*Btilde*Btilde
    printout.write('HssTerm3 = %.16e\n' % HssTerm3)
    HssTerm3coeff=omegacostheta/(2*exp2mu*expmu*expnu*Btilde*(Q+np.sqrt(Q)))
    printout.write('HssTerm3coeff = %.16e\n' % HssTerm3coeff)
    HssTerm2=expmu*pdotxir*(expmu*exp2nu*pdotxir*Sdotv-expnu*pdotvr*Sdotxi*Btilde)+xisq*Btilde*Btilde*(exp2mu*(np.sqrt(Q)+Q)*Sdotv+Jtilde*pdotn*(pdotvr*Sdotn-Jtilde*pdotn*Sdotv))
    printout.write('HssTerm2 = %.16e\n' % HssTerm2)
    HssTerm2coeff=Jtilde*omegar/(2*exp2mu*expmu*expnu*Btilde*(Q+np.sqrt(Q))*xisq)
    printout.write('HssTerm2coeff = %.16e\n' % HssTerm2coeff)
    HssTerm1=omega*SdotSkerrhat
    printout.write('HssTerm1 = %.16e\n' % HssTerm1)
    Hss=HssTerm1+HssTerm2coeff*HssTerm2+HssTerm3coeff*HssTerm3
    printout.write('Hss = %.16e\n' % Hss)
    HsoTerm2c=Jtilde*Brtilde*expmu*expnu*pdotxir*(np.sqrt(Q)+1)*Sdotv
    printout.write('HsoTerm2c = %.16e\n' % HsoTerm2c)
    HsoTerm2b=expmu*expnu*pdotxir*(2*np.sqrt(Q)+1)*(Jtilde*nur*Sdotv-nucostheta*Sdotn*xisq)*Btilde
    printout.write('HsoTerm2b = %.16e\n' % HsoTerm2b)
    HsoTerm2a=Sdotxi*Jtilde*(mur*pdotvr*(np.sqrt(Q)+1)-mucostheta*pdotn*xisq-np.sqrt(Q)*(nur*pdotvr+(mucostheta-nucostheta)*pdotn*xisq))*Btilde*Btilde
    printout.write('HsoTerm2a = %.16e\n' % HsoTerm2a)
    HsoTerm2=HsoTerm2a+HsoTerm2b-HsoTerm2c
    printout.write('HsoTerm2 = %.16e\n' % HsoTerm2)
    HsoTerm2coeff=expnu/(exp2mu*Btilde*Btilde*(Q+np.sqrt(Q))*xisq)
    printout.write('HsoTerm2coeff = %.16e\n' % HsoTerm2coeff)
    HsoTerm1=exp2nu*(expmu*expnu-Btilde)*pdotxir*SdotSkerrhat/(expmu*Btilde*Btilde*np.sqrt(Q)*xisq)
    printout.write('HsoTerm1 = %.16e\n' % HsoTerm1)
    Hso=HsoTerm1+HsoTerm2coeff*HsoTerm2
    printout.write('Hso = %.16e\n' % Hso)
    Hd=Hdcoeff*Hdsum
    printout.write('Hd = %.16e\n' % Hd)
    Hns=betapsum+alpha*np.sqrt(Hnsradicand)
    printout.write('Hns = %.16e\n' % Hns)
    Hs=Hso+Hss
    printout.write('Hs = %.16e\n' % Hs)
    dSS=528.511*chi*chi*chi*eta*eta-41.0003*chi*chi*chi*eta+1161.78*chi*chi*eta*eta*eta-326.325*chi*chi*eta*eta+37.1964*chi*eta+706.958*eta*eta*eta-36.0272*eta+6.06807
    printout.write('dSS = %.16e\n' % dSS)
    Heff = Hs + Hns - Hd + dSS*eta*u*u*u*u*(S1x*S1x + S1y*S1y + S1z*S1z + S2x*S2x + S2y*S2y + S2z*S2z)
    printout.write('Heff  = %.16e\n' % Heff )
    Hreal=np.sqrt(1+2*eta*(Heff-1))
    printout.write('Hreal = %.16e\n' % Hreal)
    return Hreal